<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>ä»é›¶å¼€å§‹æ­å»ºä¸€ä¸ªåå°æ¨¡æ¿</title>
    <url>/admin_template/</url>
    <content><![CDATA[<p>é—²æ¥æ²¡äº‹ï¼Œåˆå¼€å§‹é€ è½®å­ç©ç©äº†ï¼Œç”¨vue + element-ui æ’¸ä¸ªåå°æ¨¡æ¿ã€‚</p>
<span id="more"></span>

<h2 id="ä¸»è¦ç”¨çš„ä½¿ç”¨ä¾èµ–"><a href="#ä¸»è¦ç”¨çš„ä½¿ç”¨ä¾èµ–" class="headerlink" title="ä¸»è¦ç”¨çš„ä½¿ç”¨ä¾èµ–"></a>ä¸»è¦ç”¨çš„ä½¿ç”¨ä¾èµ–</h2><ul>
<li>vue          </li>
<li>vuex         </li>
<li>vue-router   </li>
<li>vue-i18n     </li>
<li>axios        </li>
<li>element-ui   </li>
<li>nprogress    </li>
<li>antv&#x2F;g2</li>
</ul>
<h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">â”Œâ”€â”€ public                     </span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index.html             // htmlæ¨¡æ¿</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ favicon.ico            // faviconå›¾æ ‡</span><br><span class="line">â”‚Â </span><br><span class="line">â”œâ”€â”€ src                        // æºä»£ç </span><br><span class="line">â”‚Â Â  â”œâ”€â”€ api                    // æ‰€æœ‰è¯·æ±‚</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ assets                 // é™æ€èµ„æº</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ components             // å…¨å±€å…¬ç”¨ç»„ä»¶</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ config                 // é…ç½®æ–‡ä»¶</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ libs                   // å…¨å±€å…¬ç”¨æ–¹æ³•</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ locale                 // å›½é™…åŒ– </span><br><span class="line">â”‚Â Â  â”œâ”€â”€ mock                   // æ¨¡æ‹Ÿæ•°æ®</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ plugin                 // vueæ’ä»¶</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ router                 // è·¯ç”±</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ store                  // å…¨å±€ storeç®¡ç†</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ views                  // view</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ App.vue                // å…¥å£é¡µé¢</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index.less             // å…¨å±€æ ·å¼</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ main.js                // å…¥å£ åŠ è½½ç»„ä»¶ åˆå§‹åŒ–ç­‰</span><br><span class="line">â”‚Â </span><br><span class="line">â”œâ”€â”€ vue.config.js              // vue-cli é…ç½®</span><br><span class="line">â”œâ”€â”€ .gitignore                 // git å¿½ç•¥é¡¹</span><br><span class="line">â””â”€â”€ package.json               // package.json</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p><a href="//ml13.gitee.io/admin-template">æ¼”ç¤ºåœ°å€</a>   <a href="//gitee.com/ml13/admin-template">é¡¹ç›®åœ°å€</a></p>
<h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><p><img src="/images/posts/admin_template/CEt1w5WJrs.gif" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>ç¤ºä¾‹</em></p>
]]></content>
      <categories>
        <category>åˆ›ä½œç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vuex</tag>
        <tag>vue-route</tag>
        <tag>elemelt-ui</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸºäº devenv å®ç°è‡ªåŠ¨åŒ–ç¼–è¯‘,ç”Ÿæˆæµ‹è¯•æ–‡ä»¶</title>
    <url>/aotubuild/</url>
    <content><![CDATA[<p>æƒ³è¦å®ç°è‡ªåŠ¨åŒ–ç¼–è¯‘å¹¶ç”Ÿäº§æ‰“åŒ…æ›¿æ¢æ–‡ä»¶ï¼Œé¦–è¦çš„å¯¹é¡¹ç›®è¿›è¡Œç¼–è¯‘ç”Ÿæˆã€‚ä¸€èˆ¬ç¼–è¯‘ donnet é¡¹ç›®æœ‰ä¸‰ç§æ–¹å¼ csc.exeï¼ŒMSbuild(ä¸éœ€è¦å®‰è£…vs)ï¼Œdevenv(éœ€è¦å®‰è£…vs)ã€‚å› ä¸ºè‡ªå·±å·²ç»å®‰è£…äº† vs äº†ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨ devenv å»ç¼–è¯‘ç¨‹åºäº†ã€‚</p>
<span id="more"></span>

<p>å¤§è‡´æµç¨‹å¦‚ä¸‹</p>
<p><img src="/images/posts/aotubuild/20200102105829.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>æµç¨‹å›¾</em></p>
<h1 id="SVN-æ›´æ–°æäº¤æ–‡ä»¶"><a href="#SVN-æ›´æ–°æäº¤æ–‡ä»¶" class="headerlink" title="SVN æ›´æ–°æäº¤æ–‡ä»¶"></a>SVN æ›´æ–°æäº¤æ–‡ä»¶</h1><p>SVN å·¥å…·ä½¿ç”¨ TortoiseSVNï¼Œä¸ºäº†ç®€åŒ–æ“è¿™é‡Œç›´æ¥ä½¿ç”¨ TortoiseProc.exe(TortoiseSVNçš„GUIç¨‹åº) æ‰€æä¾›çš„å‘½ä»¤è¡Œï¼Œå¯¹é¡¹ç›®è¿›è¡Œæ›´æ–°ç­‰æ“ä½œã€‚<br>ä½¿ç”¨ Demo </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">TortoiseProc.exe /command:commit</span><br><span class="line">                 /path:&quot;c:\svn_wc\file1.txt*c:\svn_wc\file2.txt&quot;</span><br><span class="line">                 /logmsg:&quot;test log message&quot; /closeonend:2</span><br><span class="line"></span><br><span class="line">å‚æ•°å¤§æ¦‚æ„æ€</span><br><span class="line"></span><br><span class="line">/closeonend:2 å¦‚æœæ²¡å‘ç”Ÿé”™è¯¯å’Œå†²çªåˆ™è‡ªåŠ¨å…³é—­å¯¹è¯æ¡†</span><br><span class="line">/command    æ‰§è¡Œçš„æ“ä½œ</span><br><span class="line">        :update æ›´æ–°</span><br><span class="line">        :commit æäº¤</span><br><span class="line">/path   è·¯å¾„</span><br><span class="line">/logmsg æäº¤å¤‡æ³¨ä¿¡æ¯</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…·ä½“çš„ä½¿ç”¨æ–¹å¼å¯ä»¥åœ¨ TortoiseSVN æä¾›å¸®åŠ©æ–‡æ¡£é‡Œå»æŸ¥çœ‹ã€‚</p>
<p><img src="/images/posts/aotubuild/20200102174220.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h1 id="åŠ¨æ€å»ä¿®æ”¹ç¨‹åºç‰ˆæœ¬å’Œæ—¥æœŸ"><a href="#åŠ¨æ€å»ä¿®æ”¹ç¨‹åºç‰ˆæœ¬å’Œæ—¥æœŸ" class="headerlink" title="åŠ¨æ€å»ä¿®æ”¹ç¨‹åºç‰ˆæœ¬å’Œæ—¥æœŸ"></a>åŠ¨æ€å»ä¿®æ”¹ç¨‹åºç‰ˆæœ¬å’Œæ—¥æœŸ</h1><p>å› ä¸ºé¡¹ç›®çš„æ—¥æœŸå’Œç‰ˆæœ¬æ˜¯å†™æ­»åœ¨äº†ç¨‹åºé‡Œçš„ï¼Œæ¯æ¬¡ç»™æµ‹è¯•ç”Ÿäº§æ›¿æ¢æ–‡ä»¶æ—¶å€™éƒ½å¾—å»ä¿®æ”¹ç¨‹åºæ—¥æœŸ.å¤§è‡´æ€è·¯æ˜¯é€šè¿‡æ­£åˆ™å»ä¿®æ”¹æ–‡ä»¶ã€‚è€ƒè™‘åˆ°éœ€è¦åé¢å¯èƒ½éœ€è¦ä¿®æ”¹çš„åœ°æ–¹è¾ƒå¤šï¼Œç›®å‰æ˜¯é€šè¿‡ Json å»é…ç½®éœ€è¦ä¿®æ”¹æ–‡ä»¶ å’Œ å¯¹åº”æ­£åˆ™ å’Œ è°ƒç”¨çš„æ–¹æ³•(è·å–çš„å€¼)ã€‚ä¸ºäº†æä¾›ä¿®æ”¹çµæ´»æ€§ï¼Œç›®å‰æ˜¯é€šè¿‡ CSharpCodeProvider å»ç¼–è¯‘ C# æ–‡ä»¶ï¼Œæ¥æ–¹ä¾¿éšæ—¶ä¿®æ”¹è·å–æ–°çš„å€¼å¾—è§„åˆ™ã€‚</p>
<p>å¤§è‡´æµç¨‹å¦‚ä¸‹<br><img src="/images/posts/aotubuild/20200102162138.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p>json é…ç½®æ–‡ä»¶å¦‚ä¸‹</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;FilePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;C:\\Test.cs&quot;</span><span class="punctuation">,</span><span class="comment">//è·¯å¾„</span></span><br><span class="line">    <span class="attr">&quot;Pattern&quot;</span><span class="punctuation">:</span> <span class="string">&quot;.* string SerEdition .*&quot;</span><span class="punctuation">,</span><span class="comment">//æ­£åˆ™è§„åˆ™</span></span><br><span class="line">    <span class="attr">&quot;FunctionName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;GetEditDataTime&quot;</span><span class="punctuation">,</span> <span class="comment">//ä»¥åŠéœ€è¦è°ƒç”¨çš„æ–¹æ³•</span></span><br><span class="line">    <span class="attr">&quot;Params&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span> <span class="comment">//å‚æ•°</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>å‡å¦‚ Test.cs æ–‡ä»¶éœ€è¦ä¿®æ”¹å†…å¦‚ä¸‹</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> SerVer = <span class="string">&quot;V7.6.0&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> SerEdition = <span class="string">&quot;2019.12.25&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>æ–°å¢ä¸€ä¸ª Units.cs(ç”¨äºåŠ¨æ€ç¼–è¯‘) æ–‡ä»¶ï¼Œç”Ÿæˆæ“ä½œæ”¹ä¸ºå†…å®¹ï¼Œä¸å‚ä¸ç¼–è¯‘ã€‚</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Units.cs æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">namespace</span> <span class="title">DynamicRunCode</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Units</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">string</span> <span class="title">GetEditDataTime</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;        public static string SerEdition = \&quot;&quot;</span> + DateTime.Now.ToString(<span class="string">&quot;yyyy.MM.dd&quot;</span>) + <span class="string">&quot;\&quot;;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯è‡ªå·±åœ¨è¿™æ·»åŠ æ–¹æ³•</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¯¹ CSharpCodeProvider è¿›è¡Œç®€å•å°è£…ï¼ŒCSharpRunCode ç±» ä¸»è¦æ˜¯å¯¹ C# å­—ç¬¦ä¸²è¿›è¡Œç¼–è¯‘ï¼Œå’Œæä¾›ä¸€ä¸ªå¯ä»¥è°ƒç”¨ C# å­—ç¬¦ä¸²ä¸­æ–¹æ³•ã€‚</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CSharpRunCode</span></span><br><span class="line">&#123;</span><br><span class="line">    CompilerResults cr;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç¼–è¯‘ C# Code å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;csharpStr&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>è¿”å›ç¼–è¯‘ç»“æœ<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CSharpRunCode</span> (<span class="params"><span class="built_in">string</span> csharpStr</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        CSharpCodeProvider cs = <span class="keyword">new</span> CSharpCodeProvider();</span><br><span class="line">        CompilerParameters cp = <span class="keyword">new</span> CompilerParameters</span><br><span class="line">        &#123;</span><br><span class="line">            GenerateInMemory = <span class="literal">true</span>,<span class="comment">//è®¾å®šåœ¨å†…å­˜ä¸­åˆ›å»ºç¨‹åºé›†</span></span><br><span class="line">            GenerateExecutable = <span class="literal">false</span><span class="comment">//è®¾å®šæ˜¯å¦åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶,ä¹Ÿå°±æ˜¯exeæ–‡ä»¶æˆ–è€…dllæ–‡ä»¶</span></span><br><span class="line">        &#125;;</span><br><span class="line">        cr = cs.CompileAssemblyFromSource(cp, csharpStr);</span><br><span class="line">        <span class="keyword">if</span> (cr.Errors.HasErrors)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (CompilerError item <span class="keyword">in</span> cr.Errors)</span><br><span class="line">            &#123;</span><br><span class="line">                Console.WriteLine(item.ToString());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> è°ƒç”¨æ–¹æ³•</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;typeName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;functionName&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;pars&quot;&gt;</span><span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span><span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">object</span> <span class="title">RunFunctino</span>(<span class="params"><span class="built_in">string</span> typeName, <span class="built_in">string</span> functionName, <span class="keyword">params</span> <span class="built_in">object</span>[] pars</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Assembly ass = cr.CompiledAssembly;</span><br><span class="line">        <span class="built_in">object</span> obj = ass.CreateInstance(typeName);</span><br><span class="line">        MethodInfo mi = obj.GetType().GetMethod(functionName);</span><br><span class="line">        <span class="keyword">return</span> mi.Invoke(obj, pars);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨æ–¹æ³•</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//FunctionName é…ç½®ä¸­å‡½æ•°å</span></span><br><span class="line"><span class="comment">//FilePath æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="comment">//Pattern æ­£åˆ™è§„åˆ™</span></span><br><span class="line"></span><br><span class="line">CSharpRunCode runCode = <span class="keyword">new</span> CSharpRunCode(File.ReadAllText(<span class="string">&quot;xxx\\Units.cs&quot;</span>));</span><br><span class="line"><span class="built_in">string</span> result = (<span class="built_in">string</span>)runCode.RunFunctino(<span class="string">&quot;DynamicRunCode.Units&quot;</span>, FunctionName);</span><br><span class="line"><span class="built_in">string</span> fileText = File.ReadAllText(FilePath);</span><br><span class="line">List&lt;<span class="built_in">string</span>&gt; fileTextArr = File.ReadAllLines(FilePath).ToList();</span><br><span class="line"><span class="keyword">var</span> matches = Regex.Matches(fileText, Pattern);</span><br><span class="line">File.WriteAllText(FilePath, Regex.Replace(fileText, Pattern, result));</span><br><span class="line"></span><br><span class="line">Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;Environment.NewLine&#125;</span>æ–‡ä»¶è·¯å¾„:ã€<span class="subst">&#123;FilePath&#125;</span>ã€‘&quot;</span>);</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æ›¿æ¢ã€<span class="subst">&#123;matches.Count&#125;</span>ã€‘å¤„&quot;</span>);</span><br><span class="line">Console.ForegroundColor = ConsoleColor.Yellow;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (Match match <span class="keyword">in</span> matches)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> rowNum = fileTextArr.FindIndex(t =&gt; t.Contains(match.Value.Trim()));</span><br><span class="line">    <span class="keyword">if</span> (rowNum&gt;<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        fileTextArr[rowNum]=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Console.WriteLine(<span class="string">$&quot;åŸå€¼:ã€<span class="subst">&#123;match.Value.Replace(<span class="string">&quot;\r&quot;</span>, <span class="string">&quot;&quot;</span>)&#125;</span>ã€‘è¡Œå·:ã€<span class="subst">&#123;rowNum + <span class="number">1</span>&#125;</span>ã€‘&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Console.ForegroundColor = ConsoleColor.Green;</span><br><span class="line">Console.WriteLine(<span class="string">$&quot;æ–°å€¼:ã€<span class="subst">&#123;result&#125;</span>ã€‘&quot;</span>);</span><br><span class="line">Console.ForegroundColor = ConsoleColor.White;</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œç»“æœ<br><img src="/images/posts/aotubuild/20200102163249.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h1 id="ä½¿ç”¨-devenv-è¿›è¡Œç¼–è¯‘"><a href="#ä½¿ç”¨-devenv-è¿›è¡Œç¼–è¯‘" class="headerlink" title="ä½¿ç”¨ devenv è¿›è¡Œç¼–è¯‘"></a>ä½¿ç”¨ devenv è¿›è¡Œç¼–è¯‘</h1><p>VS å®‰è£…çš„æ˜¯ 2017ï¼Œdevenv æ­£å¸¸è·¯å¾„åº”è¯¥æ˜¯ [C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\Common7\IDE] ä¸‹ï¼Œç½‘ä¸Šä¸€å †åŠ¨æ€æŸ¥æ‰¾ devenv è·¯å¾„çš„æ–¹æ³•.æœ€åæ„Ÿè§‰é€šè¿‡æ³¨å†Œè¡¨æ–¹å¼æ¯”è¾ƒé è°±ï¼Œ<a href="https://www.cnblogs.com/lovecsharp094/p/8952327.html">å‚è€ƒè¿™ç¯‡</a><br><img src="/images/posts/aotubuild/20200102152424.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p>å…·ä½“å®ç°</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">DevenvOpt</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> æ˜¯å¦å®‰è£…VS</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">bool</span> IsFindDevenv &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> devenv è·¯å¾„</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DevenvExePath &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> devenv æ‰€åœ¨ç›®å½•è·¯å¾„</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> DevenvDirPath &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> ç‰ˆæœ¬</span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">int</span> Version &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DevenvOpt</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> path = FindDevenv();</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">string</span>.IsNullOrWhiteSpace(path))</span><br><span class="line">        &#123;</span><br><span class="line">            IsFindDevenv = <span class="literal">true</span>;</span><br><span class="line">            DevenvExePath = path;</span><br><span class="line">            DevenvDirPath = path.Replace(<span class="string">&quot;devenv.exe&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="built_in">string</span> <span class="title">FindDevenv</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> registryPath = <span class="string">@&quot;SOFTWARE\Wow6432Node\Microsoft\VisualStudio\SxS\VS7&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> localMachineRegistry = RegistryKey.OpenBaseKey(RegistryHive.LocalMachine, Environment.Is64BitOperatingSystem ? RegistryView.Registry64 : RegistryView.Registry32);</span><br><span class="line">        Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; vsPaths = ReadRegistryInfo(localMachineRegistry, registryPath);</span><br><span class="line">        <span class="built_in">string</span> highestVSdevenvPath = <span class="built_in">string</span>.Empty;</span><br><span class="line">        <span class="keyword">if</span> (vsPaths != <span class="literal">null</span> &amp;&amp; vsPaths.Any())</span><br><span class="line">        &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">var</span> tempVersion = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">foreach</span> (KeyValuePair&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; kvp <span class="keyword">in</span> vsPaths)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> devenvExePath = Path.Combine(kvp.Value, <span class="string">@&quot;Common7\IDE\devenv.exe&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span> (File.Exists(devenvExePath))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">var</span> currentVersion = Convert.ToInt32(kvp.Key.Split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]);</span><br><span class="line">                    <span class="keyword">if</span> (currentVersion &gt; tempVersion)</span><br><span class="line">                    &#123;</span><br><span class="line">                        Version = currentVersion;</span><br><span class="line">                        highestVSdevenvPath = devenvExePath;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> highestVSdevenvPath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt; <span class="title">ReadRegistryInfo</span>(<span class="params">RegistryKey registryKey, <span class="built_in">string</span> registryInfoPath</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (registryKey == <span class="literal">null</span> || <span class="built_in">string</span>.IsNullOrEmpty(registryInfoPath)) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            RegistryKey rsg = registryKey.OpenSubKey(registryInfoPath, <span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">if</span> (rsg != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">var</span> keyNameArray = rsg?.GetValueNames();</span><br><span class="line">                <span class="keyword">var</span> result = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;();</span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> name <span class="keyword">in</span> keyNameArray)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">string</span> keyValue = (<span class="built_in">string</span>)rsg.GetValue(name);</span><br><span class="line">                    result.Add(name, keyValue);</span><br><span class="line">                &#125;</span><br><span class="line">                rsg.Close();</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰¾åˆ°äº†è·¯å¾„åæ¥ä¸‹æ¥å°±æ˜¯ï¼Œå°†è·¯å¾„å†™å…¥ç¯å¢ƒå˜é‡(æˆ–è€…æ‰§è¡Œ devenv å…ˆè°ƒè½¬åˆ°ç›®å½•)ï¼Œè°ƒç”¨ CMD ç„¶åå»æ‰§è¡Œ devenv ç¨‹åºå»ç¼–è¯‘é¡¹ç›®æ“ä½œäº†ã€‚<br>å¯¹è°ƒç”¨ CMD ç®€å•å°è£…ä¸‹</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">CMD</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> <span class="built_in">string</span> CmdPath = <span class="string">@&quot;cmd.exe&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> æ‰§è¡Œcmdå‘½ä»¤ </span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name=&quot;cmd&quot;&gt;</span>æ‰§è¡Œçš„å‘½ä»¤<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CMD_RES <span class="title">RunCmd</span>(<span class="params"><span class="keyword">params</span> <span class="built_in">string</span>[] cmds</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            CMD_RES res = <span class="keyword">new</span> CMD_RES();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">using</span> (Process p = <span class="keyword">new</span> Process())</span><br><span class="line">            &#123;</span><br><span class="line">                p.StartInfo.FileName = CmdPath;</span><br><span class="line">                p.StartInfo.UseShellExecute = <span class="literal">false</span>;        </span><br><span class="line">                p.StartInfo.RedirectStandardInput = <span class="literal">true</span>;   </span><br><span class="line">                p.StartInfo.RedirectStandardOutput = <span class="literal">true</span>;  </span><br><span class="line">                p.StartInfo.RedirectStandardError = <span class="literal">true</span>;   </span><br><span class="line">                p.StartInfo.CreateNoWindow = <span class="literal">true</span>;          </span><br><span class="line">                <span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    p.Start();</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//å‘cmdçª—å£å†™å…¥å‘½ä»¤</span></span><br><span class="line">                    <span class="keyword">foreach</span> (<span class="built_in">string</span> cmd <span class="keyword">in</span> cmds) </span><br><span class="line">                        p.StandardInput.WriteLine(cmd);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//å…³é—­å†™å…¥æµ</span></span><br><span class="line">                    p.StandardInput.Close();</span><br><span class="line"></span><br><span class="line">                    <span class="comment">//è·å–cmdçª—å£çš„è¾“å‡ºä¿¡æ¯</span></span><br><span class="line">                    <span class="built_in">string</span> output = p.StandardOutput.ReadToEnd();</span><br><span class="line">                    <span class="built_in">string</span> error = p.StandardError.ReadToEnd();</span><br><span class="line">                    <span class="comment">//ç­‰å¾…ç¨‹åºæ‰§è¡Œå®Œé€€å‡ºè¿›ç¨‹</span></span><br><span class="line">                    p.WaitForExit();</span><br><span class="line">                    res.ToRes(output, error);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">catch</span> (System.Exception e)</span><br><span class="line">                &#123;</span><br><span class="line">                    System.Console.WriteLine(e.Message);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">finally</span></span><br><span class="line">                &#123;</span><br><span class="line">                    p.Close();</span><br><span class="line">                    p.Dispose();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">CMD_RES</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> çŠ¶æ€</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">bool</span> State &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125; = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> è¾“å‡ºä¿¡æ¯</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Text &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span></span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> é”™è¯¯ä¿¡æ¯</span></span><br><span class="line">        <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Error &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">ToRes</span>(<span class="params"><span class="built_in">string</span> output, <span class="built_in">string</span> error</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            State = <span class="built_in">string</span>.IsNullOrWhiteSpace(error);</span><br><span class="line">            Text = output;</span><br><span class="line">            Error = error;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>devenv å…·ä½“å‚æ•°å¯ä»¥å‚è€ƒ<a href="https://docs.microsoft.com/zh-CN/visualstudio/ide/reference/devenv-command-line-switches?view=vs-2017">å¾®è½¯å®˜ç½‘æ–‡æ¡£</a><br>ç¤ºä¾‹</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//DevenvDirPath devenv æ‰€åœ¨ç›®å½•</span></span><br><span class="line">CMD_RES res = CMD.RunCmd(<span class="string">&quot;@echo off &quot;</span>, <span class="string">$&quot;<span class="subst">&#123;DevenvDirPath.Substring(<span class="number">0</span>,<span class="number">1</span>)&#125;</span>:&quot;</span>,<span class="string">$&quot;cd <span class="subst">&#123;DevenvDirPath&#125;</span>&quot;</span>,<span class="string">$&quot;devenv é¡¹ç›®è·¯å¾„  /rebuild Release&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>devenv å›è¾“å‡ºï¼Œç„¶ååˆ¤æ–­æ˜¯å¦å…¨éƒ¨ç¼–è¯‘æˆåŠŸ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æˆåŠŸxä¸ª        å¤±è´¥xä¸ª        è·³è¿‡xä¸ª</span><br></pre></td></tr></table></figure>

<p>æ–‡ä»¶ç¼–è¯‘å¥½ä¹‹åï¼Œå°±æ˜¯å¯¹æ–‡ä»¶çš„æ‹·è´æ“ä½œäº†è¿™é‡Œå°±ä¸æè¿°äº†</p>
<p>æ•ˆæœå¦‚ä¸‹<br><img src="/images/posts/aotubuild/20200102175312.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>devenv</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯åŸºå»ºä¹‹å·¥å…·ç¯‡</title>
    <url>/api_convert/</url>
    <content><![CDATA[<p>éšç€å‰ç«¯å‘å±•çš„è¶Šæ¥è¶Šå·¥ç¨‹åŒ–ï¼Œè¶Šæ¥è¶Šç¹çå¤æ‚ï¼Œå‰ç«¯èƒ½åšçš„äº‹æƒ…è¶Šæ¥è¶Šå¤šï¼Œæœ€è¿‘å‡ å¹´ <code>å‰ç«¯åŸºå»º</code> ä¹Ÿæ˜¯è¶Šæ¥è¶Šç«çƒ­ã€‚ä½†æ˜¯å®é™…ä¸Šå¾ˆå¤šå…¬å¸å¹¶ä¸æ³¨é‡å‰ç«¯ï¼Œæ›´åˆ«è°ˆèƒ½ä¼šæœ‰äººæ¥åšåŸºå»ºã€‚å¯¹äºæ²¡æœ‰åŸºå»ºçš„å‰ç«¯ï¼Œæˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p>æˆ‘ä¸ªäººæ¨èå¯ä»¥ä»å·¥å…·ã€CLI å…¥æ‰‹ï¼Œå› ä¸ºè¿™äº›å¾€å¾€æ˜¯ç‹¬ç«‹ï¼Œä¸ä¼šåƒæ¨è§„èŒƒã€ææ•°æ®åŸ‹ç‚¹ã€æ—¥å¿—ä¸ŠæŠ¥ã€æ•´ BFF é‚£æ ·å¯¹å›¢é˜Ÿæˆ–è€…ç°æœ‰ä»£ç æœ‰å…¥ä¾µæ€§ã€‚å³ä¾¿åœ¨è‡ªå·±ç©ºé—²æ—¶é—´ä¹Ÿèƒ½å¼„ä¸€å¼„ï¼Œå¼„å¾—å¥½å¯ä»¥åœ¨å›¢é˜Ÿæ¨å¹¿ä½¿ç”¨ï¼Œå¼„å¾—ä¸å¥½ä¹Ÿæ— æ‰€è°“ï¼Œå¯ä»¥å½“ä½œç»ƒæ‰‹æå‡è‡ªå·±èƒ½åŠ›ã€‚</p>
<span id="more"></span>

<h2 id="ä»€ä¹ˆæ˜¯å‰ç«¯åŸºå»ºï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å‰ç«¯åŸºå»ºï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å‰ç«¯åŸºå»ºï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å‰ç«¯åŸºå»ºï¼Ÿ</h2><p><code>å‰ç«¯åŸºå»º</code> æŒ‡çš„æ˜¯ä¸šåŠ¡å›¢é˜Ÿå†…çš„å‰ç«¯å·¥ç¨‹å¸ˆæ‰§è¡Œçš„ä¸€äº›åŸºç¡€å»ºè®¾ï¼ŒåŒ…æ‹¬äº† å‰ç«¯è§„èŒƒæ–‡æ¡£ã€å‰ç«¯è„šæ‰‹æ¶ã€å‰ç«¯æ¨¡æ¿ã€å‰ç«¯ç»„ä»¶åº“ã€å‰ç«¯å·¥å…·åº“ã€å‰ç«¯ BFFã€å‰ç«¯ CI&#x2F;CD çš„æ„å»ºéƒ¨ç½²ã€å‰ç«¯æ•°æ®åŸ‹ç‚¹ ç­‰ç­‰ï¼›</p>
<p>å‰ç«¯åŸºå»ºçš„å¥½å¤„</p>
<ul>
<li>ä¸šåŠ¡å¤ç”¨ï¼›</li>
<li>æå‡ç ”å‘æ•ˆç‡ï¼›</li>
<li>è§„èŒƒç ”å‘æµç¨‹ï¼›</li>
<li>å›¢é˜ŸæŠ€æœ¯æå‡ï¼›</li>
<li>å¼€æºå»ºè®¾ï¼›</li>
</ul>
<h2 id="å–„ç”¨å·¥å…·è§£æ”¾åŒæ‰‹"><a href="#å–„ç”¨å·¥å…·è§£æ”¾åŒæ‰‹" class="headerlink" title="å–„ç”¨å·¥å…·è§£æ”¾åŒæ‰‹"></a>å–„ç”¨å·¥å…·è§£æ”¾åŒæ‰‹</h2><p>ä¸¾ä¾‹ï¼šæœ€è¿‘æ¥åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œä¸€å¼ ç®€å•æŠ¥è¡¨åŒ…å«å¢åˆ æ”¹æŸ¥ï¼Œç›¸ä¿¡æ¯ä¸ªå…¬å¸éƒ½æœ‰è‡ªå·±å°è£…å¥½çš„å¢åˆ æ”¹æŸ¥ç»„ä»¶æˆ–è€… hooksï¼Œç­‰æ¥å£å®šä¹‰å¥½ï¼Œç›´æ¥å†™ apiï¼Œé…å¥½è¡¨å•ï¼Œè¡¨æ ¼é…ç½®å®Œäº‹ã€‚ä½†åæ¥æ¥å£å‘ç”Ÿå˜åŠ¨ï¼Œæˆ–è€…æŸ¥è¯¢å˜åŠ¨ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æ‰‹åŠ¨å»è°ƒæ•´åŸæ¥ä»£ç ã€‚åˆæˆ–è€…åšå®Œè¿™ä¸ªååˆæ¥äº†ä¸ªåå‡ ä¸ªæŠ¥è¡¨éœ€æ±‚ï¼Œåˆå¾—éœ€è¦å°†ä¸Šé¢æ¥ä¸ªåå‡ éã€‚æœ‰äº›å…¬å¸ç”šè‡³è¿å°è£…éƒ½æ²¡æœ‰ï¼Œé¡¹ç›®é‡Œå…¨æ˜¯ CTRL V + Cï¼Œé‡å¤å·¥ä½œé‡æ›´æ˜¯é™¡å¢ã€‚</p>
<p>è¿™äº›é‡å¤æ€§æ“ä½œå®Œå…¨å¯ä»¥é€šè¿‡å·¥å…·è‡ªåŠ¨ç”Ÿæˆï¼Œæäº¤ä»£ç å‡†ç¡®æ€§ï¼Œä¹Ÿèƒ½è§£æ”¾è‡ªå·±åŒæ‰‹ï¼ˆæ‘¸ç‚¹ ğŸŸ ä¸é¦™å—ï¼‰ï¼Œæé«˜å›¢é˜Ÿæ•ˆç‡ã€‚</p>
<p>å·¥å…·èƒ½åšäº‹æƒ…ï¼Œåšçš„ä¸œè¥¿æœ‰å¾ˆå¤šï¼Œä¸ä»…ä»…åªæ˜¯ä»£ç ç”Ÿæˆè¿™äº›ï¼Œä¸€åˆ‡ä½ è§‰å¾—é‡å¤æ€§å·¥ä½œï¼Œéƒ½å¯ä»¥å°è¯•é€šè¿‡å·¥å…·æ¥æé«˜è‡ªå·±æ•ˆç‡ã€‚</p>
<ul>
<li>ä»£ç ç”Ÿæˆ</li>
<li>ä»£ç æ ¼å¼æ£€æµ‹</li>
<li>æ™ºèƒ½æç¤º</li>
<li>æµ‹è¯•è‡ªåŠ¨åŒ–</li>
<li>æ–‡æ¡£é›†æˆ</li>
<li>ä»£ç è°ƒè¯•</li>
<li>â€¦</li>
</ul>
<p>å·¥å…·å®ç°æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œè¿™å–å†³åœ¨å›¢é˜Ÿéœ€æ±‚</p>
<ul>
<li>cli</li>
<li>web ï¼ˆæ¯”å¦‚é€šè¿‡æ‹–æ‹‰æ‹½ç”Ÿæˆä»£ç ï¼‰</li>
<li>ç¼–è¾‘å™¨æ’ä»¶ ï¼ˆæ¯”å¦‚ vscode æ’ä»¶ï¼‰</li>
<li>â€¦</li>
</ul>
<h3 id="é‡å¤ä»£ç ç”Ÿæˆ"><a href="#é‡å¤ä»£ç ç”Ÿæˆ" class="headerlink" title="é‡å¤ä»£ç ç”Ÿæˆ"></a>é‡å¤ä»£ç ç”Ÿæˆ</h3><p>å°±ä»¥ä¸Šé¢ä¾‹å­ä¸ºä¾‹ï¼Œå°±å¯ä»¥ä½¿ç”¨å·¥å…·å»ç”Ÿæˆ æ¥å£çš„å®šä¹‰ã€è¡¨æ ¼é…ç½®ã€è¡¨å•é…ç½®ä»¥åŠç»„ä»¶ä½¿ç”¨ä»£ç ï¼Œä¸åŒéœ€æ±‚è¡¨å•ã€è¡¨æ ¼é‚£äº›éƒ½æ˜¯é«˜åº¦ç›¸ä¼¼çš„ï¼Œå¯ä»¥é€šè¿‡ä»£ç ç”Ÿæˆæ–¹å¼æ¥æå‡è‡ªå·±ç¼–ç æ•ˆç‡ã€‚</p>
<p>ä»æ¥å£æ–‡æ¡£åˆ°å¯ç”¨ä»£ç ï¼Œç”Ÿæˆçš„æ–¹å¼å¤§æ¦‚æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>æ¥å£æ–‡æ¡£ &#x3D;ã€‹ JSON Schema &#x3D;ã€‹ UI äº¤äº’ï¼ˆå¯çœç•¥ï¼‰&#x3D;ã€‹ æ ¹æ®æ¨¡æ¿ç”Ÿæˆ || æ ¹æ® AST ç”Ÿæˆ &#x3D;ã€‹ æ’å…¥åˆ°ä»£ç ä½ç½®</p>
<h5 id="ç”Ÿæˆ-JSON-Schema"><a href="#ç”Ÿæˆ-JSON-Schema" class="headerlink" title="ç”Ÿæˆ JSON Schema"></a>ç”Ÿæˆ JSON Schema</h5><p>ä¸ºäº†æ–¹ä¾¿åç»­ä»£ç ç”Ÿæˆï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆæ¥å£æ–‡æ¡£è½¬æ¢æˆä¸€ä¸ªæ ‡å‡†é€šç”¨æ ¼å¼ï¼Œè¿™æ ·ä¸ç®¡åç«¯æä¾›ä»€ä¹ˆæ ·æ ¼å¼ api æ–‡æ¡£æˆ–è€…ä¸ç®¡åç«¯ä½¿ç”¨ä»€ä¹ˆæ¡†æ¶å»ç”Ÿæˆ api æ–‡æ¡£æ—¶ï¼Œåªéœ€è¦å°†å¯¹åº”æ ¼å¼è½¬æ¢æˆæˆ‘ä»¬ JSON Schema æ ¼å¼å³å¯ã€‚</p>
<h5 id="UI-äº¤äº’"><a href="#UI-äº¤äº’" class="headerlink" title="UI äº¤äº’"></a>UI äº¤äº’</h5><p>UI äº¤äº’å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œæ¯”å¦‚ç”Ÿæˆ æ¥å£å®šä¹‰ã€ç±»å‹å®šä¹‰ å¹¶ä¸éœ€è¦äº¤äº’ï¼Œç›´æ¥ç”Ÿæˆå°±å¯ä»¥äº†ã€‚ä½†æ˜¯åƒè¡¨æ ¼ç”Ÿæˆã€è¡¨å•ç”Ÿæˆè¿™äº›æ˜¯éœ€è¦çš„ï¼Œå› ä¸ºæ¥å£è¿”å›å­—æ®µå¹¶ä¸ä¸€å®šå…¨æ˜¯éœ€è¦ç”Ÿæˆçš„ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ é€‚å½“äº¤äº’å®Œæˆè¿™ä¸€æ­¥éª¤ã€‚</p>
<h5 id="ä»£ç ç‰‡æ®µç”Ÿæˆ"><a href="#ä»£ç ç‰‡æ®µç”Ÿæˆ" class="headerlink" title="ä»£ç ç‰‡æ®µç”Ÿæˆ"></a>ä»£ç ç‰‡æ®µç”Ÿæˆ</h5><p>ä»£ç ç”Ÿæˆæ–¹å¼åˆ†ä¸¤ç§ <code>æ¨¡æ¿</code>ã€<code>AST</code> å»ç”Ÿæˆã€‚ä½¿ç”¨ <code>æ¨¡æ¿</code> æ¯”è¾ƒç®€å•ï¼Œä¹Ÿä¼šæ¯”è¾ƒç›´è§‚ï¼Œä½†æ˜¯ç¼ºä¹çµæ´»æ€§ï¼Œä½¿ç”¨ <code>AST</code> ä¼šæ›´ä¸ºçµæ´»ï¼Œä½†ä¹Ÿä¼šå¤æ‚çš„å¤šã€‚</p>
<h6 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h6><p>å¯¹äºä¸€äº›å›ºå®šä»£ç ç‰‡æ®µæ ¼å¼ï¼Œå¯ä»¥é€‰æ‹©é€šè¿‡æ¨¡æ¿å»ç”Ÿæˆï¼Œè€Œä¸å¿…ä½¿ç”¨ <code>AST</code> å¢åŠ ä»£ç ç”Ÿæˆå¤æ‚åº¦ã€‚</p>
<p>æ¯”å¦‚ä½ é¡¹ç›®ä¸­è¯·æ±‚æ–¹æ³•æ ¼å¼å¦‚ä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨æ¨¡æ¿å»ç”Ÿæˆï¼Œç±»ä¼¼è¿™æ · <code>const &#123;0&#125; = (par) =&gt; http(&quot;&#123;1&#125;&quot;, par, &quot;&#123;2&#125;&quot;);</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">apiFn</span> = (<span class="params">par</span>) =&gt; <span class="title function_">http</span>(<span class="string">&quot;/api/demo&quot;</span>, par, <span class="string">&quot;post&quot;</span>);</span><br></pre></td></tr></table></figure>

<h6 id="AST"><a href="#AST" class="headerlink" title="AST"></a>AST</h6><p>AST æ˜¯æŠ½è±¡è¯­æ³•æ ‘ (Abstract Syntax Tree) çš„ç®€ç§°ï¼Œå®ƒæ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºã€‚å®ƒä»¥æ ‘çŠ¶çš„å½¢å¼è¡¨ç°ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ç»“æ„ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚</p>
<p>å½“ä½ ç”Ÿæˆä»£ç éœ€è¦æ ¹æ®ä¸åŒæ¡ä»¶ç”Ÿæˆä¸åŒèŠ‚ç‚¹ï¼Œä¿®æ”¹ä¸å›ºå®šæ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ AST å»ç”Ÿæˆã€‚</p>
<p>AST ç”ŸæˆåŸç†ï¼Œç®€å•æ¥è¯´è¯´å°±æ˜¯å°†ä»£ç ç”Ÿæˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œå…¶ä¸­æ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹æè¿°çš„åº”å°±æ˜¯ä½ å®é™…ä»£ç ï¼Œæˆ‘ä»¬åªéœ€è¦æ ¹æ®éœ€æ±‚å»æ“ä½œå¯¹åº”èŠ‚ç‚¹ï¼Œç„¶åå†å°† AST è½¬ä¸ºä»£ç ã€‚</p>
<p>ä¸åŒå·¥å…·ç”Ÿæˆ AST æ˜¯ä¸ä¸€è‡´çš„ï¼Œå¯æ ¹æ®å®é™…éœ€æ±‚é€‰æ‹©ã€‚åœ¨çº¿æŸ¥çœ‹ AST ç»“æ„å·¥å…·ï¼Œå¯ä»¥è¯´å¾ˆç›´è§‚æ–¹ä¾¿<br><a href="https://astexplorer.net/">ast explorer</a><br><a href="https://ts-ast-viewer.com/">ts ast</a></p>
<h5 id="æ’å…¥ä»£ç ä½ç½®"><a href="#æ’å…¥ä»£ç ä½ç½®" class="headerlink" title="æ’å…¥ä»£ç ä½ç½®"></a>æ’å…¥ä»£ç ä½ç½®</h5><p>å°†ç”Ÿæˆä»£ç æ’å…¥åˆ°ç°æœ‰ä»£ç ä¸­ï¼Œå®ç°æ–¹å¼ä¹Ÿæœ‰å¤šç§ä¸åŒæ–¹å¼ï¼Œé€šè¿‡å¯¹äºç®€å•çš„ç»“æ„å¯ä»¥é€šè¿‡æ­£åˆ™åŒ¹é…å»æ›¿æ¢ï¼Œå¯¹äºå¤æ‚çš„ç»“æ„å¯ä»¥é€šè¿‡ AST æ–¹å¼å»ä¿®æ”¹æ’å…¥ï¼Œå¦‚æœä½ æ˜¯åŸºäºç¼–è¾‘å™¨æ’ä»¶å»åšçš„ï¼Œè¿˜å¯ä»¥é€šè¿‡è·å–ç¼–è¾‘å™¨å…‰æ ‡ä½ç½®ã€é€‰ä¸­ç­‰ç­‰æ“ä½œå°†ä»£ç æ’å…¥åˆ°å¯¹äºä½ç½®ã€‚</p>
<h3 id="æ›´æ–¹ä¾¿çš„æ–‡æ¡£æŸ¥é˜…æ–¹å¼"><a href="#æ›´æ–¹ä¾¿çš„æ–‡æ¡£æŸ¥é˜…æ–¹å¼" class="headerlink" title="æ›´æ–¹ä¾¿çš„æ–‡æ¡£æŸ¥é˜…æ–¹å¼"></a>æ›´æ–¹ä¾¿çš„æ–‡æ¡£æŸ¥é˜…æ–¹å¼</h3><p>å¾ˆå¤šå…¬å¸ä½¿ç”¨çš„éƒ½æ˜¯åƒ yapiã€swagger ç­‰é‚£äº›å¼€æºæ–‡æ¡£ç®¡ç†å¹³å°ï¼Œå¾ˆå¤šéƒ½æ˜¯ web åœ¨çº¿çš„ï¼Œå½“æ¥å£æ–‡æ¡£å­—æ®µå¾ˆå¤šæ—¶ï¼Œéœ€è¦å¹³å‡¡çš„æ¥å›åˆ‡æ¢æŸ¥é˜…ï¼Œè¿™æ ·ä¹Ÿæ˜¯æ¯”è¾ƒæµªè´¹æ—¶é—´çš„ã€‚å¯ä»¥é€šè¿‡ç¼–è¾‘å™¨æ’ä»¶å½¢å¼é›†æˆåˆ°æˆ‘ä»¬æ’ä»¶ä¸­ï¼Œè¿™æ ·å¯ä»¥æ›´æ–¹ä¾¿è‡ªå·±å¼€å‘ï¼Œä¹Ÿæœ‰å¾ˆå¤šæ—¶ä»¥åŠæœ‰ç°æˆæ’ä»¶å¯ä»¥ä½¿ç”¨çš„ï¼Œä½†æ˜¯åŠŸèƒ½ä¸Šå¹¶ä¸ä¸°å¯Œï¼Œæœ‰äº›ä»…ä»…åªèƒ½æŸ¥çœ‹ï¼Œè¿å¸¸è§ä»£ç éƒ½æ— æ³•ç”Ÿæˆã€‚</p>
<p>å°†æ¥å£æ–‡æ¡£é›†æˆåˆ°ç¼–è¾‘å™¨é‡Œèƒ½åšçš„äº‹æƒ…æœ‰å¾ˆå¤šï¼Œä»¥ vscode æ¥è¯´ï¼Œå¯ä»¥é€šè¿‡æ–‡æ¡£å¿«é€Ÿç”Ÿæˆæ¥å£å®šä¹‰ï¼Œè¿˜å¯ä»¥é€šè¿‡æ³¨å†Œè¯­è¨€æœåŠ¡ï¼Œæ¥è¯†åˆ«æ£€æµ‹æ¥å£å®šä¹‰æ­£ç¡®æ€§ï¼Œä¹Ÿå¯ä»¥åšçš„æ¥å£æ–‡æ¡£å‘ç”Ÿå˜æ›´ï¼Œåšåˆ°æ™ºèƒ½æç¤ºç„¶åå¿«é€Ÿè‡ªåŠ¨ä¿®æ”¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ¥å£æ–‡æ¡£å¿«é€Ÿèµ·ä¸ª mock æœåŠ¡ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨åœ¨é¡¹ç›®ä¸­æ·»åŠ  mock å®šä¹‰ç­‰ç­‰ã€‚</p>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><p>å¾ˆå¤šç¹ççš„äº‹æƒ…ï¼Œå…¶å®å¯ä»¥å°è¯•é€šè¿‡å·¥å…·ç®€åŒ–è¿™äº›æ“ä½œï¼Œæ²¡æœ‰åˆé€‚çš„å¯ä»¥å°è¯•è‡ªå·±é€ ä¸ªï¼Œæ—¢å¯ä»¥æå‡è‡ªå·±èƒ½åŠ›ï¼Œåˆèƒ½ç»™å›¢é˜Ÿåšä¸€ç‚¹è´¡çŒ®ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>å·¥å…·</tag>
        <tag>AST</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯æ•°ç»„è½¬æ ‘å½¢ç»“æ„</title>
    <url>/array_to_tree/</url>
    <content><![CDATA[<p>æ•°ç»„è½¬æ ‘å½¢ç»“æ„è¿™ç§æƒ…å†µè¿˜æ˜¯å¾ˆå¸¸è§çš„ï¼Œæœ‰æ—¶å€™åç«¯å°±åªç»™ä½ ä¸€ä¸ªæ•°ç»„ï¼Œéœ€è¦å‰ç«¯è‡ªå·±å¤„ç†ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¸€ä¸ªé€’å½’å°±æå®šäº†ï¼Œä½†æ˜¯æ•°æ®é‡å¾ˆå¤šçš„æ—¶å€™å°±æœ‰ç‚¹ hot ä¸ä½äº†ã€‚</p>
<span id="more"></span>
<p>ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> list = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;1&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;èŠ‚ç‚¹1&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;1_1&#x27;</span>, <span class="attr">parentId</span>: <span class="string">&#x27;1&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;èŠ‚ç‚¹1-1&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;1_1_1&#x27;</span>, <span class="attr">parentId</span>: <span class="string">&#x27;1_1&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;èŠ‚ç‚¹1-1-1&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;2&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;èŠ‚ç‚¹2&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="string">&#x27;2_1&#x27;</span>, <span class="attr">parentId</span>: <span class="string">&#x27;2&#x27;</span>, <span class="attr">name</span>: <span class="string">&#x27;èŠ‚ç‚¹2-1&#x27;</span> &#125;,</span><br><span class="line">  ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨é€’å½’å¤„ç†"><a href="#ä½¿ç”¨é€’å½’å¤„ç†" class="headerlink" title="ä½¿ç”¨é€’å½’å¤„ç†"></a>ä½¿ç”¨é€’å½’å¤„ç†</h2><p>éå†æŸ¥æ‰¾å½“å‰ parentId çš„å­çº§ï¼Œç„¶ååœ¨é€’å½’æŸ¥æ‰¾å­çº§çš„å­çº§ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">convertToTree</span> = (<span class="params">list = [], parentId</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> arr = []</span><br><span class="line">    list.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (item.<span class="property">parentId</span> === parentId) &#123;</span><br><span class="line">            arr.<span class="title function_">push</span>(&#123;</span><br><span class="line">                ...item,</span><br><span class="line">                <span class="attr">children</span>: <span class="title function_">convertToTree</span>(list, item.<span class="property">id</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">convertToTree</span>(list)</span><br></pre></td></tr></table></figure>
<p>åˆ†æä»£ç çœ‹åˆ°æ¯ä¸€æ¬¡ <strong>convertToTree</strong> è°ƒç”¨éƒ½æ˜¯å¯¹ list ä¸€æ¬¡éå†ï¼ŒåŠ ä¸Šç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œå¯ä»¥çœ‹å‡ºè¯¥å®ç°çš„æ—¶é—´å¤æ‚åº¦ä¸º **O(n^2+n)**ã€‚</p>
<h2 id="ä½¿ç”¨éé€’å½’å®ç°"><a href="#ä½¿ç”¨éé€’å½’å®ç°" class="headerlink" title="ä½¿ç”¨éé€’å½’å®ç°"></a>ä½¿ç”¨éé€’å½’å®ç°</h2><p>å¯ä»¥å·§å¦™çš„åº”ç”¨äº†å¯¹è±¡ä¿å­˜çš„æ˜¯å¼•ç”¨çš„ç‰¹ç‚¹ï¼Œå°†idä½œä¸ºkey åˆ›å»ºä¸€ä¸ª map å»å­˜å‚¨æ•°æ®ï¼Œç„¶åæ ¹æ® parentId å»æ‰¾å¯¹åº”çˆ¶çº§ï¼Œæ·»åŠ åˆ°å¯¹åº”çš„ children é‡Œé¢å»ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">convertToTree</span> = (<span class="params">list = []</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> res = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> itemMap = &#123;&#125;</span><br><span class="line">    list.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        itemMap[item.<span class="property">id</span>] = &#123; ...item, <span class="attr">children</span>: [] &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    list.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> treeItem = itemMap[item.<span class="property">id</span>]; <span class="comment">//è·å–å½“å‰é¡¹</span></span><br><span class="line">        <span class="keyword">const</span> pItem = itemMap[item.<span class="property">parentId</span>]; <span class="comment">// è·å–çˆ¶çº§</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pItem) &#123;</span><br><span class="line">            pItem.<span class="property">children</span>.<span class="title function_">push</span>(treeItem)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ²¡æœ‰çˆ¶çº§è¯´æ˜åœ¨é¡¶å±‚</span></span><br><span class="line">            res.<span class="title function_">push</span>(treeItem)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">convertToTree</span>(list)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªéœ€è¦å¾ªç¯ä¸¤æ¬¡ï¼Œå…¶æ—¶é—´å¤æ‚åº¦ä¸º **O(2n)**ï¼Œå› ä¸ºé¢å¤–å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡å­˜å‚¨æƒ³è¦çš„å†…å­˜æ¶ˆè€—ä¼šæœ‰ä¸€å®šå¢åŠ ã€‚</p>
<p>è¿˜å¯ä»¥å¯¹ä¸Šé¢è¿›ä¸€æ­¥è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå¾ªç¯é‡Œè§£å†³ï¼Œè¿™æ ·å…¶æ—¶é—´å¤æ‚åº¦ä¸º **O(n)**ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">convertToTree</span> = (<span class="params">list = []</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> res = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> itemMap = &#123;&#125;</span><br><span class="line">    list.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> id = item.<span class="property">id</span></span><br><span class="line">        <span class="keyword">let</span> pid = item.<span class="property">parentId</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!itemMap[id]) &#123;</span><br><span class="line">            itemMap[id] = &#123;</span><br><span class="line">                <span class="attr">children</span>: []</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        itemMap[id] = &#123;</span><br><span class="line">            ...item,</span><br><span class="line">            <span class="attr">children</span>: itemMap[id].<span class="property">children</span> </span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pid === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            res.<span class="title function_">push</span>(itemMap[id])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (!itemMap[pid]) &#123; <span class="comment">// æ²¡æœ‰çˆ¶çº§ å…ˆåˆ›å»ºä¸€ä¸ª</span></span><br><span class="line">                itemMap[pid] = &#123;</span><br><span class="line">                    <span class="attr">children</span>: []</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            itemMap[pid].<span class="property">children</span>.<span class="title function_">push</span>(itemMap[id])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">convertToTree</span>(list)</span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»ä¸Šé¢æ—¶é—´å¤æ‚åº¦æ¥çœ‹ï¼Œéšæ•°æ®é‡å¢å¤§çš„èµ°åŠ¿å¯ä»¥çœ‹å‡ºï¼Œå½“æ•°æ®è¶Šæ¥è¶Šå¤§æ—¶ï¼Œé€’å½’ç®—æ³•çš„è€—æ—¶å°†è¿œè¿œå¤§äºéé€’å½’ç®—æ³•ã€‚æœ‰æ—¶å€™è¿˜æ˜¯éœ€è¦é€‰æ‹©åˆé€‚çš„ç®—æ³•æ¥å¤„ç†æ•°æ®ï¼Œä¼šæ¯”ä½ ä¸€æ—¶å›¾ä¸ªæ–¹ä¾¿å†™çš„ç®—æ³•çš„æ€§èƒ½æœ‰è´¨çš„æå‡ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>åšäº†ä¸ªå£çº¸å°ç¨‹åºğŸ˜€</title>
    <url>/blgz/</url>
    <content><![CDATA[<p>å„ç§å£çº¸appï¼Œå£çº¸å°ç¨‹åºæ‰“å¼€å…¨æ˜¯å„ç§å¹¿å‘Šï¼Œå¤ªå½±å“ä½¿ç”¨ä½“éªŒï¼Œè‡ªå·±æ•´äº†ä¸ªå£çº¸å°ç¨‹åºï¼Œç®€å•æ— å¹¿å‘ŠğŸ¤£</p>
<p>é™„ä¸Šå°ç¨‹åºç ï¼š</p>
<p><img src="https://img.lkxin.cn/tu/2022/10/18/634e537320ee3.jpg" alt="xcx.jpg" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>å£äº†ä¸ªçº¸</em></p>
<span id="more"></span>]]></content>
      <categories>
        <category>åˆ›é€ ç±»</category>
      </categories>
      <tags>
        <tag>å°ç¨‹åº</tag>
      </tags>
  </entry>
  <entry>
    <title>åŸºäº CloudBase å®ç°é™æ€åšå®¢è¯„è®º ï¼ˆä¸€ï¼‰</title>
    <url>/cloudbase_comment/</url>
    <content><![CDATA[<p>ä½¿ç”¨ CloudBase ç»™é™æ€åšå®¢æ·»åŠ è¯„è®ºåŠŸèƒ½ã€‚</p>
<span id="more"></span>

<h2 id="ç”³è¯·-CloudBase"><a href="#ç”³è¯·-CloudBase" class="headerlink" title="ç”³è¯· CloudBase"></a>ç”³è¯· CloudBase</h2><p>æ–°å»ºCloudBaseç¯å¢ƒ</p>
<p><img src="/images/posts/cloudbase/20200615242451.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p>é€‰ä¸­åŒ…å¹´åŒ…æœˆï¼Œé€‰æ‹©åŸºç¡€ç‰ˆ1 (æˆ–è€…é€‰æ‹©æŒ‰é‡è®¡è´¹ï¼Œå¼€å¯å…è´¹é¢åº¦)</p>
<p><img src="/images/posts/cloudbase/20200615232440.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p>åœ¨å®‰å…¨é…ç½®-&gt;Webå®‰å…¨åŸŸå å°†è‡ªå·±å¾—åŸŸåæ·»åŠ è¿›å»</p>
<p><img src="/images/posts/cloudbase/20200615234334.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h2 id="è¯„è®ºå¤§è‡´æµç¨‹"><a href="#è¯„è®ºå¤§è‡´æµç¨‹" class="headerlink" title="è¯„è®ºå¤§è‡´æµç¨‹"></a>è¯„è®ºå¤§è‡´æµç¨‹</h2><p><img src="/images/posts/cloudbase/20200615221122.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;å”¯ä¸€ID&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;articleID&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ–‡ç« ID&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;nick&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ˜µç§°&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span><span class="string">&quot;é‚®ç®±&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span><span class="string">&quot;é“¾æ¥&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ—¶é—´&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span><span class="string">&quot;è¯„è®ºå†…å®¹&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;top&quot;</span><span class="punctuation">:</span><span class="string">&quot;ç½®é¡¶&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;childer&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;å”¯ä¸€ID&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;nick&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ˜µç§°&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span><span class="string">&quot;é‚®ç®±&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span><span class="string">&quot;é“¾æ¥&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ—¶é—´&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span><span class="string">&quot;è¯„è®ºå†…å®¹&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;at&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span> <span class="comment">//å›å¤</span></span><br><span class="line">                <span class="attr">&quot;nick&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ˜µç§°&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span><span class="string">&quot;é‚®ç®±&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span><span class="string">&quot;å”¯ä¸€ID&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;nick&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ˜µç§°&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span><span class="string">&quot;é‚®ç®±&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span><span class="string">&quot;é“¾æ¥&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ—¶é—´&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span><span class="string">&quot;è¯„è®ºå†…å®¹&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;at&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;nick&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ˜µç§°&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span><span class="string">&quot;é‚®ç®±&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>


<h2 id="CloudBase-å¼€å‘"><a href="#CloudBase-å¼€å‘" class="headerlink" title="CloudBase å¼€å‘"></a>CloudBase å¼€å‘</h2><p>åœ¨ VS Code  å®‰è£… tencentcloud.cloudbase-toolkit æ’ä»¶ï¼Œç›´æ¥åœ¨ VS Code ä¸Šå»åˆ›å»ºã€ç¼–å†™ã€éƒ¨ç½²ã€‚<a href="https://www.cloudbase.net/">å‚è€ƒåœ°å€</a><br>å¸¸ç”¨æ“ä½œã€‚<br><img src="/images/posts/cloudbase/20200616162909.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="åˆ›å»ºé›†åˆ"><a href="#åˆ›å»ºé›†åˆ" class="headerlink" title="åˆ›å»ºé›†åˆ"></a>åˆ›å»ºé›†åˆ</h3><p>åœ¨æ•°æ®åº“æ–°å¢ä¸¤ä¸ªé›†åˆ article,comments ã€‚<br><img src="/images/posts/cloudbase/20200616162356.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="äº‘å‡½æ•°"><a href="#äº‘å‡½æ•°" class="headerlink" title="äº‘å‡½æ•°"></a>äº‘å‡½æ•°</h3><p>ç›®å‰äº‘å‡½æ•°æ”¯æŒ Nodeï¼ŒPHPï¼ŒPython ä¸‰ç§ï¼Œæœ¬æ–‡ä½¿ç”¨ Node ä¸ºäº‘å‡½æ•°ç¯å¢ƒ</p>
<h4 id="è·å–æ–‡ç« ID"><a href="#è·å–æ–‡ç« ID" class="headerlink" title="è·å–æ–‡ç« ID"></a>è·å–æ–‡ç« ID</h4><p>æ–°å»ºä¸€ä¸ªäº‘å‡½æ•° GetArticleID,ä»£ç å¦‚ä¸‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> tcb = <span class="built_in">require</span>(<span class="string">&#x27;tcb-admin-node&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = tcb.<span class="title function_">init</span>(&#123; <span class="attr">env</span>: <span class="string">&#x27;ç¯å¢ƒID&#x27;</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> db = app.<span class="title function_">database</span>();</span><br><span class="line"><span class="keyword">const</span> articleDb = db.<span class="title function_">collection</span>(<span class="string">&#x27;article&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">main</span> = <span class="keyword">async</span> (event) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> &#123; hash, url &#125; = event;</span><br><span class="line">        <span class="comment">//æ ¹æ® hash è·å– article id</span></span><br><span class="line">        <span class="keyword">let</span> &#123; data &#125; = <span class="keyword">await</span> articleDb.<span class="title function_">field</span>(&#123; <span class="attr">_id</span>: <span class="number">1</span> &#125;).<span class="title function_">where</span>(&#123; hash &#125;).<span class="title function_">get</span>();</span><br><span class="line">        <span class="keyword">let</span> articleID = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (data.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//ä¸å­˜åœ¨  æ–°å¢ä¸€æ¡ article æ•°æ®</span></span><br><span class="line">            <span class="keyword">let</span> &#123; id &#125; = <span class="keyword">await</span> articleDb.<span class="title function_">add</span>(&#123; <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(), url, hash, &#125;)</span><br><span class="line">            articleID = id;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> &#123; _id &#125; = data[<span class="number">0</span>]</span><br><span class="line">            articleID = _id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">data</span>: articleID</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">success</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">data</span>: error</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="è·å–è¯„è®ºåˆ—è¡¨"><a href="#è·å–è¯„è®ºåˆ—è¡¨" class="headerlink" title="è·å–è¯„è®ºåˆ—è¡¨"></a>è·å–è¯„è®ºåˆ—è¡¨</h4><p>æ–°å»ºä¸€ä¸ªäº‘å‡½æ•° GetCommentsï¼Œä»£ç å¦‚ä¸‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> tcb = <span class="built_in">require</span>(<span class="string">&#x27;tcb-admin-node&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = tcb.<span class="title function_">init</span>(&#123; <span class="attr">env</span>:<span class="string">&quot;ç¯å¢ƒID&quot;</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> db = app.<span class="title function_">database</span>();</span><br><span class="line"><span class="keyword">const</span> _ = db.<span class="property">command</span>;</span><br><span class="line"><span class="keyword">const</span> $ = _.<span class="property">aggregate</span>;</span><br><span class="line"><span class="keyword">const</span> commentsDB = db.<span class="title function_">collection</span>(<span class="string">&#x27;comments&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">main</span> = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; pagesize, articleID = <span class="string">&#x27;&#x27;</span> &#125; = event;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">isNaN</span>(<span class="built_in">parseInt</span>(pagesize)) || pagesize &lt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> &#123; <span class="attr">data</span>: list &#125; = <span class="keyword">await</span> commentsDB</span><br><span class="line">        .<span class="title function_">aggregate</span>()</span><br><span class="line">        <span class="comment">//æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        .<span class="title function_">match</span>(&#123; articleID &#125;)</span><br><span class="line">        <span class="comment">//æ’åº</span></span><br><span class="line">        .<span class="title function_">sort</span>(&#123;</span><br><span class="line">            <span class="attr">top</span>: -<span class="number">1</span>,</span><br><span class="line">            <span class="attr">date</span>: -<span class="number">1</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">//åˆ†é¡µ</span></span><br><span class="line">        .<span class="title function_">skip</span>((pagesize - <span class="number">1</span>) * <span class="number">10</span>)</span><br><span class="line">        .<span class="title function_">limit</span>(<span class="number">10</span>)</span><br><span class="line">        <span class="comment">//æŒ‡å®šéœ€è¦æŸ¥è¯¢å­—æ®µ</span></span><br><span class="line">        .<span class="title function_">project</span>(&#123;</span><br><span class="line">            <span class="attr">_id</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">id</span>: <span class="string">&quot;$_id&quot;</span>,</span><br><span class="line">            <span class="attr">articleID</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">nick</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">link</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">date</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">content</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">top</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">childer</span>: &#123;</span><br><span class="line">                <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">nick</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">link</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">date</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">content</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">at</span>: &#123;</span><br><span class="line">                    <span class="attr">nick</span>: <span class="number">1</span>,</span><br><span class="line">                    <span class="attr">link</span>: <span class="number">1</span>,</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        .<span class="title function_">end</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="æ–°å¢ã€å›å¤"><a href="#æ–°å¢ã€å›å¤" class="headerlink" title="æ–°å¢ã€å›å¤"></a>æ–°å¢ã€å›å¤</h4><p>æ–°å»ºä¸€ä¸ªäº‘å‡½æ•° AddCommentï¼Œä»£ç å¦‚ä¸‹<br>ä½¿ç”¨ nodemailer æ¥å‘é€é‚®ä»¶é€šçŸ¥ï¼Œnodemailer <a href="https://nodemailer.com/about/">å‚è€ƒæ–‡æ¡£</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> tcb = <span class="built_in">require</span>(<span class="string">&#x27;tcb-admin-node&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> nodemailer = <span class="built_in">require</span>(<span class="string">&#x27;nodemailer&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> uuid = <span class="built_in">require</span>(<span class="string">&#x27;node-uuid&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> app = tcb.<span class="title function_">init</span>(&#123; <span class="attr">env</span>:<span class="string">&quot;ç¯å¢ƒID&quot;</span> &#125;);</span><br><span class="line"><span class="keyword">const</span> db = app.<span class="title function_">database</span>();</span><br><span class="line"><span class="keyword">const</span> _ = db.<span class="property">command</span>;</span><br><span class="line"><span class="keyword">const</span> $ = _.<span class="property">aggregate</span></span><br><span class="line"><span class="keyword">const</span> comments = db.<span class="title function_">collection</span>(<span class="string">&#x27;comments&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//é‚®ä»¶é…ç½®</span></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&#x27;smtp.qq.com&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">465</span>,</span><br><span class="line">    <span class="attr">secure</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">auth</span>: &#123;</span><br><span class="line">        <span class="attr">user</span>: <span class="string">&#x27;é‚®ç®±@xx.com&#x27;</span>,</span><br><span class="line">        <span class="attr">pass</span>: <span class="string">&#x27;å¯†ç æˆ–è€…æˆæƒç &#x27;</span> <span class="comment">//æ¨èä½¿ç”¨æˆæƒç </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> transporter = nodemailer.<span class="title function_">createTransport</span>(config);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">main</span> = <span class="keyword">async</span> (event, context) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; articleID = <span class="string">&#x27;&#x27;</span>, url = <span class="string">&#x27;&#x27;</span>,  nick = <span class="string">&#x27;Anonymous&#x27;</span>, email = <span class="string">&#x27;&#x27;</span>, link = <span class="string">&#x27;&#x27;</span>, content = <span class="string">&#x27;&#x27;</span>, at = <span class="literal">false</span>, istop = <span class="literal">true</span>, topID = <span class="string">&#x27;&#x27;</span>, userID = <span class="string">&#x27;&#x27;</span> &#125; = event;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (content == <span class="string">&#x27;&#x27;</span> || articleID == <span class="string">&#x27;&#x27;</span> || (!istop &amp;&amp; topID == <span class="string">&#x27;&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">false</span>, <span class="attr">data</span>: <span class="string">&#x27;æ•°æ®æ ¼å¼æœ‰è¯¯&#x27;</span> &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">let</span> par = &#123; userID, articleID, content, url, nick, email, link, at, istop, date &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (at) &#123;</span><br><span class="line">        par.<span class="property">id</span>= uuid.<span class="title function_">v1</span>().<span class="title function_">replace</span>(<span class="regexp">/\-/g</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        <span class="keyword">let</span> res = <span class="keyword">await</span> comments.<span class="title function_">where</span>(&#123; <span class="attr">_id</span>: topID &#125;).<span class="title function_">update</span>(&#123; <span class="attr">childer</span>: _.<span class="title function_">push</span>([par]) &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> _atemail = <span class="keyword">await</span> <span class="title function_">getEmailByID</span>(at.<span class="property">id</span>);</span><br><span class="line">        <span class="keyword">if</span> (!!_atemail &amp;&amp; _atemail != email) &#123;</span><br><span class="line">            <span class="title function_">sendemail</span>(_atemail, nick, content)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">success</span>: <span class="literal">true</span>, <span class="attr">data</span>: &#123; date &#125; &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> &#123; code = <span class="literal">false</span>, message, id &#125; = <span class="keyword">await</span> comments.<span class="title function_">add</span>(par)</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">success</span>: !code, <span class="attr">data</span>: !code ? &#123; id, date &#125; : message &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*æ ¹æ®å›å¤idè·å– å¯¹åº”äºº é‚®ç®±</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getEmailByID</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> &#123; data &#125; = <span class="keyword">await</span> comments.<span class="title function_">where</span>(&#123; <span class="attr">_id</span>: id &#125;).<span class="title function_">get</span>()</span><br><span class="line">    <span class="keyword">if</span> (data.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> &#123; data &#125; = <span class="keyword">await</span> comments</span><br><span class="line">            .<span class="title function_">aggregate</span>()</span><br><span class="line">            .<span class="title function_">match</span>(&#123; <span class="string">&#x27;childer.id&#x27;</span>: id &#125;)</span><br><span class="line">            .<span class="title function_">project</span>(&#123;</span><br><span class="line">                <span class="attr">_id</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">item</span>: $.<span class="title function_">filter</span>(&#123;</span><br><span class="line">                    <span class="attr">input</span>: <span class="string">&#x27;$childer&#x27;</span>,</span><br><span class="line">                    <span class="attr">as</span>: <span class="string">&#x27;item&#x27;</span>,</span><br><span class="line">                    <span class="attr">cond</span>: $.<span class="title function_">eq</span>([<span class="string">&#x27;$$item.id&#x27;</span>, id])</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">end</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data))</span><br><span class="line">        <span class="keyword">if</span> (data.<span class="property">length</span> &gt; <span class="number">0</span>) <span class="keyword">return</span> data[<span class="number">0</span>].<span class="property">item</span>[<span class="number">0</span>].<span class="property">email</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> data[<span class="number">0</span>].<span class="property">email</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * email æ”¶ä»¶äººé‚®ç®±</span></span><br><span class="line"><span class="comment"> * nick è¯„è®ºäººæ˜µç§°</span></span><br><span class="line"><span class="comment"> * content è¯„è®ºç±»å®¹</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">sendemail</span>(<span class="params">email, nick, content</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">`<span class="subst">$&#123;date.getFullYear()&#125;</span>å¹´<span class="subst">$&#123;date.getMonth() + <span class="number">1</span>&#125;</span>æœˆ<span class="subst">$&#123;date.getDate()&#125;</span>æ—¥ <span class="subst">$&#123;date.getHours()&#125;</span>æ—¶<span class="subst">$&#123;date.getMinutes()&#125;</span>åˆ†<span class="subst">$&#123;date.getSeconds()&#125;</span>ç§’`</span>;</span><br><span class="line">    <span class="keyword">let</span> mail = &#123;</span><br><span class="line">        <span class="attr">from</span>: <span class="string">&#x27;ç™½äº‘è‹ç‹— &lt;xxxxx@qq.com&gt;&#x27;</span>,</span><br><span class="line">        <span class="attr">subject</span>: <span class="string">&#x27;[ç™½äº‘è‹ç‹—][åšå®¢] æ”¶åˆ°æ–°çš„å›å¤&#x27;</span>,</span><br><span class="line">        <span class="attr">to</span>: email,</span><br><span class="line">        <span class="attr">html</span>: <span class="string">`</span></span><br><span class="line"><span class="string">        &lt;h2&gt;<span class="subst">$&#123;nick&#125;</span> <span class="subst">$&#123;str&#125;</span> å›å¤äº†æ‚¨&lt;h2&gt;</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;content&#125;</span></span></span><br><span class="line"><span class="string">        `</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> transporter.<span class="title function_">sendMail</span>(mail);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="web-ç«¯"><a href="#web-ç«¯" class="headerlink" title="web ç«¯"></a>web ç«¯</h2><p>å¯¹ tcb åšä¸€ä¸ªç®€å•å°è£…</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">tcbComment</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">env, hash</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!env) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;æœªè®¾ç½®CloudBaseç¯å¢ƒid:env&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!hash) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;æœªè®¾ç½®å½“å‰Commentçš„hashå€¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">env</span> = env;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">skip</span> = <span class="number">1</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">hash</span> = hash;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆå§‹åŒ–</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">_init</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> tcb = <span class="keyword">await</span> <span class="title class_">TcbLoader</span>()</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">app</span> = tcb.<span class="title function_">init</span>(&#123; <span class="attr">env</span>: <span class="variable language_">this</span>.<span class="property">env</span> &#125;);</span><br><span class="line">        <span class="keyword">let</span> auth = <span class="variable language_">this</span>.<span class="property">app</span>.<span class="title function_">auth</span>(&#123;</span><br><span class="line">            <span class="attr">persistence</span>: <span class="string">&quot;local&quot;</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">if</span> (!auth.<span class="title function_">hasLoginState</span>()) &#123;</span><br><span class="line">            <span class="keyword">await</span> auth.<span class="title function_">anonymousAuthProvider</span>().<span class="title function_">signIn</span>()</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">getArticleID</span>(<span class="variable language_">this</span>.<span class="property">hash</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getArticleID</span>(<span class="params">hash</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">app</span>.<span class="title function_">callFunction</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;getArticleID&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                hash,</span><br><span class="line">                <span class="attr">url</span>: location.<span class="property">pathname</span>,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">let</span> &#123; <span class="attr">result</span>: &#123; success, data &#125; &#125; = res;</span><br><span class="line">        <span class="keyword">if</span> (success) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">articleID</span> = data;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–è¯„è®ºåˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getComment</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">app</span>.<span class="title function_">callFunction</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;getComments&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="attr">pagesize</span>: <span class="variable language_">this</span>.<span class="property">skip</span>++,</span><br><span class="line">                <span class="attr">articleID</span>: <span class="variable language_">this</span>.<span class="property">articleID</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> res.<span class="property">result</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ–°å¢</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">addComment</span>(<span class="params">parm</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">app</span>.<span class="title function_">callFunction</span>(&#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;addComment&#x27;</span>,</span><br><span class="line">            <span class="attr">data</span>: &#123;</span><br><span class="line">                <span class="attr">articleID</span>: <span class="variable language_">this</span>.<span class="property">articleID</span>,</span><br><span class="line">                ...parm</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* åŠ è½½tcb-js-jdk</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">TcbLoader</span> = <span class="keyword">function</span> (<span class="params">v = <span class="string">&#x27;1.6.0&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">tcb</span>) &#123;</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="variable language_">window</span>.<span class="property">tcb</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">var</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>)</span><br><span class="line">            script.<span class="property">type</span> = <span class="string">&#x27;text/javascript&#x27;</span></span><br><span class="line">            script.<span class="property">async</span> = <span class="literal">true</span></span><br><span class="line">            script.<span class="property">src</span> = <span class="string">`//imgcache.qq.com/qcloud/tcbjs/<span class="subst">$&#123;v&#125;</span>/tcb.js`</span></span><br><span class="line">            script.<span class="property">onerror</span> = reject</span><br><span class="line">            script.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(<span class="variable language_">window</span>.<span class="property">tcb</span>)</span><br><span class="line">            <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(script)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>å¼„å®Œcloudbase äº‘å‡½æ•°ï¼Œå’Œå¯¹ web ç«¯ç®€å•ä½¿ç”¨å°è£…ï¼Œå‰©ä¸‹å¾—å°±æ˜¯é¡µé¢ä¸Šå¼„ä¸ªè¯„è®ºåˆ—è¡¨ç»„ä»¶å’Œè¯„è®ºç»„ä»¶äº†</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºé‡å†™è¯„è®ºæ’ä»¶è¿™ä»¶äº‹</title>
    <url>/cloudbase_comment_two/</url>
    <content><![CDATA[<p>å› ä¸ºä»¥å‰ä½¿ç”¨çš„è¯„è®ºæ’ä»¶å­˜åœ¨å¾ˆå¤š bug å’Œæ¼æ´ï¼Œä½†æ˜¯ä¹Ÿæ²¡å•¥äººç”¨ï¼Œä¸€ç›´æ²¡æœ‰å»ä¿®æ”¹ï¼Œæœ€è¿‘ç©ºé—²æ—¶é—´æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥å‡†å¤‡å¯¹ä¹‹å‰æ’ä»¶è¿›è¡Œé‡æ„ä¸€ç•ªã€‚åŸè¯„è®ºæ’ä»¶æ˜¯ä½¿ç”¨åŸç”Ÿ JS ç¼–å†™ WebComponents ç»„ä»¶ï¼Œæ„Ÿè§‰ç»“æ„ç»´æŠ¤èµ·æ¥æŒºè´¹åŠ›çš„(è‡ªå·±å¤ªèœ)ï¼Œå†³å®šä½¿ç”¨ Vue3 æ„å»º WebComponents ã€‚</p>
<span id="more"></span>

<h2 id="å·²æ”¯æŒåŠŸèƒ½"><a href="#å·²æ”¯æŒåŠŸèƒ½" class="headerlink" title="å·²æ”¯æŒåŠŸèƒ½"></a>å·²æ”¯æŒåŠŸèƒ½</h2><ul>
<li>æ”¯æŒå›å¤ </li>
<li>æ”¯æŒæ’å…¥è¡¨æƒ…ï¼ˆå¯ç¦ç”¨ï¼‰</li>
<li>æ”¯æŒ Ctrl + Enter å¿«æ·å›å¤</li>
<li>è¯„è®ºæ¡†å†…å®¹å®æ—¶ä¿å­˜è‰ç¨¿ï¼Œåˆ·æ–°ä¸ä¼šä¸¢å¤±</li>
<li>æ”¯æŒç§å¯†è¯„è®ºï¼ˆå¯ç¦ç”¨ï¼‰</li>
<li>éšç§ä¿¡æ¯å®‰å…¨ï¼ˆé€šè¿‡äº‘å‡½æ•°æ§åˆ¶æ•æ„Ÿå­—æ®µï¼ˆé‚®ç®±ã€IPã€ç¯å¢ƒé…ç½®ç­‰ï¼‰ä¸ä¼šæ³„éœ²ï¼‰</li>
<li>æ”¯æŒäººå·¥å®¡æ ¸æ¨¡å¼</li>
<li>é˜² XSS æ³¨å…¥</li>
<li>æ”¯æŒé™åˆ¶æ¯ä¸ª IP æ¯ 10 åˆ†é’Ÿæœ€å¤šå‘è¡¨å¤šå°‘æ¡è¯„è®º</li>
<li>æ”¯æŒé‚®ä»¶æé†’ï¼ˆè®¿å®¢å’Œåšä¸»ï¼‰, å¯æ‰©å±•ä¸‰æ–¹é€šçŸ¥æ–¹å¼</li>
<li>æ”¯æŒè‡ªå®šä¹‰â€œåšä¸»â€æ ‡è¯†æ–‡å­—</li>
<li>æ”¯æŒè‡ªå®šä¹‰é€šçŸ¥é‚®ä»¶æ¨¡æ¿</li>
<li>æ”¯æŒè‡ªå®šä¹‰ã€æ˜µç§°ã€‘ã€é‚®ç®±ã€‘ã€ç½‘å€ã€‘å¿…å¡« &#x2F; é€‰å¡«</li>
<li>æ”¯æŒè‡ªå®šä¹‰ä»£ç é«˜äº®ä¸»é¢˜</li>
<li>æ”¯æŒè‡ªå®šä¹‰é…ç½®ä¸»é¢˜ (ä½¿ç”¨csså˜é‡)</li>
<li>é€šè¿‡é‚®ç®±ç™»å½•å¿«æ·å›å¤ç®¡ç†</li>
<li>å†…åµŒå¼ç®¡ç†é¢æ¿ï¼Œé€šè¿‡é‚®ç®±ç™»å½•ï¼Œå¯æ–¹ä¾¿åœ°æŸ¥çœ‹è¯„è®ºã€å›å¤è¯„è®ºã€åˆ é™¤è¯„è®ºã€ä¿®æ”¹é…ç½®ã€ç«™ç‚¹ç»Ÿè®¡ä¿¡æ¯</li>
</ul>
<h2 id="è¸©å‘è®°å½•"><a href="#è¸©å‘è®°å½•" class="headerlink" title="è¸©å‘è®°å½•"></a>è¸©å‘è®°å½•</h2><h3 id="ç»„ä»¶æ ·å¼é—®é¢˜"><a href="#ç»„ä»¶æ ·å¼é—®é¢˜" class="headerlink" title="ç»„ä»¶æ ·å¼é—®é¢˜"></a>ç»„ä»¶æ ·å¼é—®é¢˜</h3><p>vue-loader åœ¨ customElement æ¨¡å¼ä¸‹ï¼Œå½“ä½¿ç”¨å­ç»„ä»¶æ—¶å€™ï¼Œå¹¶ä¸ä¼šå°†å­ç»„ä»¶æ ·å¼æ’å…¥åˆ° shadow-root é‡Œï¼Œé»˜è®¤åªæœ‰çˆ¶ç»„ä»¶çš„æ ·å¼ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å¤„ç†ä¸‹ã€‚<a href="https://www.imalun.com/vue_web_components">å‚è€ƒè¿™é‡Œ</a></p>
<h3 id="styleå’Œsvgé—®é¢˜"><a href="#styleå’Œsvgé—®é¢˜" class="headerlink" title="styleå’Œsvgé—®é¢˜"></a>styleå’Œsvgé—®é¢˜</h3><p>ç›´æ¥ä½¿ç”¨æ‰“åŒ…åéƒ½æ˜¯é»˜è®¤æ’å…¥åˆ° dom é‡Œçš„ï¼Œè€Œæ²¡æœ‰æ’å…¥åˆ° customElement éœ€è¦æˆ‘ä»¬å¯¹è¿™é‡Œæ’å…¥çš„æ•°æ®è¿›è¡Œä¸€äº›å¤„ç†ã€‚css å¯ä»¥é…åˆä½¿ç”¨ to-string-loader åœ¨æŒ‚è½½æ—¶å€™æ‰‹å·¥æ’å…¥ï¼Œsvg å¤„ç†æ–¹æ³•ä¹Ÿç±»ä¼¼è¿™æ ·ã€‚</p>
<h3 id="contenteditable-å…‰æ ‡é—®é¢˜"><a href="#contenteditable-å…‰æ ‡é—®é¢˜" class="headerlink" title="contenteditable å…‰æ ‡é—®é¢˜"></a>contenteditable å…‰æ ‡é—®é¢˜</h3><p>ä½¿ç”¨ contenteditable ä½œä¸ºè¾“å…¥æ¡†æ—¶ï¼Œå½“éœ€è¦æ’å…¥è¡¨æƒ…æˆ–è€…ç²˜è´´æ–‡æœ¬åˆ°å…‰æ ‡å¤„æ—¶å€™ï¼Œéœ€è¦å­˜å‚¨å…‰æ ‡ä¿¡æ¯ï¼Œä½†æ˜¯åœ¨ Can I Use ä¸Šçœ‹åˆ° ShadowRoot Api: getSelection çš„å…¼å®¹æ€§ï¼Œå¯ä»¥çœ‹åˆ°é™¤äº† chromium å…¶ä»–å‡ ä¹éƒ½æ˜¯ä¸æ”¯æŒçš„ã€‚</p>
<h3 id="å¼¹å‡ºå±‚é—®é¢˜"><a href="#å¼¹å‡ºå±‚é—®é¢˜" class="headerlink" title="å¼¹å‡ºå±‚é—®é¢˜"></a>å¼¹å‡ºå±‚é—®é¢˜</h3><p>å½“åœ¨ customElement é‡Œå®ç° Popover ç»„ä»¶ï¼Œç‚¹å‡»å…¶ä»–åŒºåŸŸéœ€è¦å…³é—­å¼¹å‡ºå±‚æ—¶å€™ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬éƒ½æ˜¯åˆ¤æ–­å½“å‰ç‚¹å‡»äº‹ä»¶è§¦å‘å¯¹è±¡ (target) æ˜¯ä¸æ˜¯æˆ‘ä»¬ Popover æœ¬èº«æ¥å†³å®šæˆ‘ä»¬æ˜¯å¦å…³é—­ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ç‚¹å‡»åœ¨ customElement ä¸Šæ—¶å€™ document äº‹ä»¶çš„ target æ˜¯è‡ªå®šä¹‰å…ƒç´ æœ¬èº«ï¼Œä¸ä¼šåˆ°è‡ªå®šä¹‰å…ƒç´ å†…éƒ¨å»ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ customElement å’Œ document éƒ½åšä¸€ä¸ªç›‘å¬ã€‚</p>
<h3 id="è·¨-customElement-æ•°æ®å…±äº«é—®é¢˜"><a href="#è·¨-customElement-æ•°æ®å…±äº«é—®é¢˜" class="headerlink" title="è·¨ customElement æ•°æ®å…±äº«é—®é¢˜"></a>è·¨ customElement æ•°æ®å…±äº«é—®é¢˜</h3><p>åœ¨è¯„è®ºæ’ä»¶é‡Œï¼Œcom-a(è¯„è®ºç»„ä»¶) å’Œ com-b(è¯„è®ºç®¡ç†ç»„ä»¶) æ˜¯ä½¿ç”¨çš„ä¸¤ä¸ª <strong>è‡ªå®šä¹‰å…ƒç´ </strong>ï¼Œä½†æˆ‘ä»¬åœ¨ com-a ç™»å½•åï¼Œåœ¨ä½¿ç”¨ com-b ä¹Ÿéœ€è¦æœ‰ç™»å½•çŠ¶æ€ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯èƒ½éœ€è¦å…±äº«ç™»å½•ä¿¡æ¯ã€‚</p>
<p>å¦‚æœæˆ‘ä»¬æ˜¯ç”¨ js å»ç¼–å†™ customElement å»å…±äº«æ•°æ®æ˜¯å¾ˆéº»çƒ¦çš„äº‹ï¼Œè¿˜å¥½åœ¨ vue3 è¿˜æ˜¯æ¯”è¾ƒå¥½è§£å†³çš„ï¼Œå¯ä»¥ä½¿ç”¨ <strong>reactive</strong> å»å®ç°ä¸€ä¸ªç®€æ˜“ store å»å…±äº«æ•°æ®ï¼Œå®ç°ä¸€ä¸ª customElement ä¿®æ”¹æ•°æ®å¤šä¸ªåœ°æ–¹åŒæ—¶ä¿®æ”¹ã€‚</p>
<p>ç¤ºä¾‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> store = &#123;</span><br><span class="line">    <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="comment">// ç”¨æˆ·</span></span><br><span class="line">        <span class="attr">user</span>: <span class="title function_">reactive</span>(&#123;</span><br><span class="line">            <span class="attr">data</span>: <span class="literal">null</span></span><br><span class="line">        &#125;),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>

<h3 id="ç»™-customElement-æ·»åŠ æ–¹æ³•"><a href="#ç»™-customElement-æ·»åŠ æ–¹æ³•" class="headerlink" title="ç»™ customElement æ·»åŠ æ–¹æ³•"></a>ç»™ customElement æ·»åŠ æ–¹æ³•</h3><p>vue3 æä¾› <strong>defineCustomElement</strong> æ˜¯æ²¡æœ‰å°†å¯ä»¥å°†å‡½æ•°æš´éœ²åˆ° customElement ä¸Šçš„ï¼Œåªèƒ½é€šè¿‡å…ƒç´ ä¸Šçš„ <strong>_instance</strong> (vueåˆ›å»º customElement åˆ›å»ºå®ä¾‹) å»è°ƒç”¨ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å¯¹ <strong>defineCustomElement</strong> åšä¸‹æ”¹é€ ã€‚<a href="https://www.imalun.com/vue_web_components">å‚è€ƒè¿™é‡Œ</a></p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>é‡æ„è¿‡ç¨‹ä¸­ï¼Œå‘ç°å‘è¿˜æ˜¯æŒºå¤šçš„ï¼Œè¿˜å¥½å¤§éƒ¨åˆ†è¿˜æ˜¯æœ‰è§£å†³æ–¹æ³•çš„ã€‚é‡å†™æœåŠ¡ç«¯æ—¶å€™ï¼Œå‘ç°è…¾è®¯äº‘äº‘å¼€å‘çš„æ•°æ®åº“æ–‡æ¡£è¿˜æ˜¯æŒºå‘çš„ï¼Œä¸€äº› MongDB æ“ä½œåœ¨é‡Œé¢ä¹Ÿæ²¡æœ‰ï¼Œè°ƒè¯•ä¹Ÿå¾ˆéº»çƒ¦ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>css å®ç°ç½‘é¡µç°åº¦</title>
    <url>/css_filter/</url>
    <content><![CDATA[<p>ä»Šå¤©ä¸ºè¡¨è¾¾å…¨å›½å„æ—äººæ°‘å¯¹æŠ—å‡»æ–°å† è‚ºç‚ç–«æƒ…æ–—äº‰ç‰ºç‰²çƒˆå£«å’Œé€ä¸–åŒèƒçš„æ·±åˆ‡å“€æ‚¼ï¼Œå„å¤§ç½‘ç«™ä¹Ÿçº·çº·å°†ç•Œé¢å¼„æˆé»‘ç™½ä»¥ç¤ºå“€æ‚¼ã€‚</p>
<span id="more"></span>
<p>å®ç°ç½‘é¡µé»‘ç™½åŠæ³•å…¶å®å¾ˆç®€å•ï¼Œåªéœ€è¦è®¾ç½® filter æ»¤é•œä¸º grayscale å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span>&#123;</span><br><span class="line">     <span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>); </span><br><span class="line">    -webkit-<span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">100%</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¸¸ç”¨å‡ ä¸ªå€¼<br>grayscale ï¼šå°†å›¾åƒè½¬æ¢ä¸ºç°åº¦å›¾åƒã€‚<br>blurï¼šå¯ä»¥å®ç°é«˜æ–¯æ¨¡ç³Šæ•ˆæœã€‚<br>Saturate ï¼šè®¾ç½®é¥±å’Œåº¦ã€‚<br>Invert : é¢œè‰²åè½¬ã€‚<br>Contrast  ï¼šè®¾ç½®å¯¹æ¯”åº¦ã€‚</p>
<style>
    html{
         filter: grayscale(100%); 
        -webkit-filter: grayscale(100%); 
        -moz-filter: grayscale(100%); 
        -ms-filter: grayscale(100%); 
        -o-filter: grayscale(100%); 
        -webkit-filter: grayscale(1);
    }
</style>]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>css å®ç°æ¢è‚¤å‡ ç§æ–¹å¼</title>
    <url>/css_theme/</url>
    <content><![CDATA[<p>è¯´èµ·æ¢è‚¤åŠŸèƒ½ï¼Œå‰ç«¯è‚¯å®šä¸é™Œç”Ÿï¼Œå…¶å®å°±æ˜¯é¢œè‰²å€¼çš„æ›´æ¢ï¼Œå®ç°æ–¹å¼æœ‰å¾ˆå¤šï¼Œä¹Ÿå„æœ‰ä¼˜ç¼ºç‚¹ã€‚</p>
<span id="more"></span>

<h2 id="ä¸€ã€å¯ä¾›é€‰æ‹©çš„æ¢è‚¤"><a href="#ä¸€ã€å¯ä¾›é€‰æ‹©çš„æ¢è‚¤" class="headerlink" title="ä¸€ã€å¯ä¾›é€‰æ‹©çš„æ¢è‚¤"></a>ä¸€ã€å¯ä¾›é€‰æ‹©çš„æ¢è‚¤</h2><p>å¯¹äºåªæä¾›å‡ ç§ä¸»é¢˜æ–¹æ¡ˆï¼Œè®©ç”¨æˆ·æ¥é€‰æ‹©çš„ï¼Œä¸€èˆ¬å°±ç®€å•ç²—æš´çš„å†™å¤šå¥—ä¸»é¢˜ã€‚</p>
<ul>
<li>ä¸€ä¸ªå…¨å±€ class æ§åˆ¶æ ·å¼åˆ‡æ¢ï¼Œç›´æ¥æ›´æ”¹å…¨å±€class</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&#x27;dark&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨jså»ä¿®æ”¹ link çš„ href</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">id</span>=<span class="string">&#x27;link_theme&#x27;</span>  <span class="attr">href</span>=<span class="string">&quot;skin.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;link_theme&#x27;</span>).<span class="property">href</span>=<span class="string">&#x27;skin-dark.css&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h2 id="äºŒã€åŠ¨æ€è‰²å€¼æ¢è‚¤çš„å®ç°"><a href="#äºŒã€åŠ¨æ€è‰²å€¼æ¢è‚¤çš„å®ç°" class="headerlink" title="äºŒã€åŠ¨æ€è‰²å€¼æ¢è‚¤çš„å®ç°"></a>äºŒã€åŠ¨æ€è‰²å€¼æ¢è‚¤çš„å®ç°</h2><ul>
<li>å…¨å±€æ›¿æ¢é¢œè‰²å€¼<br>å¯ä»¥å‚çœ‹ <a href="https://elementui.github.io/theme-preview/#/zh-CN">Element-UI</a> çš„æ¢è‚¤å®ç°ï¼Œå°±æ˜¯å…ˆæŠŠæ ·å¼ä¸­é¢œè‰²å…¨éƒ¨æ›¿æ¢ååœ¨å¡åˆ°&lt;style&gt;æ ‡ç­¾é‡Œé¢ã€‚</li>
<li>ä½¿ç”¨ less çš„ modifyVars åŠ¨æ€ä¿®æ”¹<br>modifyVars æ–¹æ³•æ˜¯æ˜¯åŸºäº less åœ¨æµè§ˆå™¨ä¸­çš„ç¼–è¯‘æ¥å®ç°ã€‚æ‰€ä»¥åœ¨å¼•å…¥ less æ–‡ä»¶çš„æ—¶å€™éœ€è¦é€šè¿‡ link æ–¹å¼å¼•å…¥ï¼Œç„¶ååŸºäº less.js ä¸­çš„æ–¹æ³•æ¥è¿›è¡Œä¿®æ”¹å˜é‡ã€‚</li>
</ul>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="comment">// styles.less</span></span><br><span class="line"><span class="variable">@color:</span> red;</span><br><span class="line"><span class="selector-class">.card</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">@color</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet/less&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;styles.less&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;//cdn.jsdelivr.net/npm/less&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span>&gt;</span></span><br><span class="line">        card</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;themeBtn&quot;</span>&gt;</span>æ›´æ”¹é¢œè‰²<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;themeBtn&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> color = <span class="string">&#x27;#&#x27;</span> + <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">256</span> * <span class="number">1000000000</span>).<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">6</span>)</span></span><br><span class="line"><span class="language-javascript">        less.<span class="title function_">modifyVars</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="string">&#x27;@color&#x27;</span>: color</span></span><br><span class="line"><span class="language-javascript">        &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`color: <span class="subst">$&#123;color&#125;</span>F`</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>css å˜é‡(var)</li>
</ul>
<p>css åŸç”Ÿå˜é‡ <a href="https://www.caniuse.com/#search=--var">å…¼å®¹æ€§</a>,å¤§éƒ¨åˆ†ä¸»æµæµè§ˆå™¨è¿˜æ˜¯æ”¯æŒçš„ï¼Œè€Œä¸”ä¸»è¦æ˜¯æ“ä½œèµ·æ¥å¤Ÿç®€ä¾¿ã€‚</p>
<p>å®šä¹‰å˜é‡</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">// åŠ ä¸Šå‰ç¼€ -- å°±å¯ä»¥äº† </span><br><span class="line"><span class="selector-pseudo">:root</span>&#123;</span><br><span class="line">    <span class="attr">--color</span>:red;</span><br><span class="line">&#125;</span><br><span class="line">//ä½¿ç”¨ å½“<span class="attr">--color</span> ä¸ç”Ÿæ•ˆçš„æ—¶å€™ä¼šä½¿ç”¨åé¢å‚æ•°æ›¿ä»£</span><br><span class="line"><span class="selector-tag">body</span>:&#123;</span><br><span class="line">    <span class="attribute">color</span>:<span class="built_in">var</span>(--color,<span class="number">#000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ js å»ä¿®æ”¹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·å–æ ¹</span></span><br><span class="line"><span class="keyword">let</span> root = <span class="variable language_">document</span>.<span class="property">documentElement</span>;</span><br><span class="line">root.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--color&#x27;</span>, <span class="string">&#x27;#f00&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="ä¸‰ã€æ€»ç»“"><a href="#ä¸‰ã€æ€»ç»“" class="headerlink" title="ä¸‰ã€æ€»ç»“"></a>ä¸‰ã€æ€»ç»“</h2><p>å¦‚æœéœ€è¦åŠ¨æ€æ›¿æ¢é¢œè‰²ä¸»é¢˜ï¼Œä½¿ç”¨ç¬¬äºŒç§æ¯”è¾ƒåˆé€‚ä¹Ÿæ–¹ä¾¿.å¦‚æœæ¯å¥—ä¸»é¢˜æœ‰å¾ˆå¤§å·®å¼‚æ€§ä¸ä»…ä»…åªæ˜¯é¢œè‰²çš„æ›¿æ¢ï¼Œç¬¬ä¸€ç§çš„æ–¹å¼å°±å¥½äº†å¾ˆå¤šï¼Œä½¿ç”¨ç¬¬äºŒç§å°±ä¸å¤ªåˆé€‚äº†.å¦‚æœéƒ½éœ€è¦æ»¡è¶³ä¹Ÿå¯ä»¥ä¸¤ç§ç›¸ç»“åˆä½¿ç”¨ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title>Electron çš„æ–­ç‚¹ç»­ä¸‹è½½</title>
    <url>/file_download/</url>
    <content><![CDATA[<p>æœ€è¿‘ç”¨ Electron åšäº†ä¸ªå£çº¸ç¨‹åºï¼Œéœ€è¦æ–­ç‚¹ç»­ä¸‹è½½ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹ã€‚<span id="more"></span></p>
<h2 id="HTTPæ–­ç‚¹ä¸‹è½½ç›¸å…³çš„æŠ¥æ–‡"><a href="#HTTPæ–­ç‚¹ä¸‹è½½ç›¸å…³çš„æŠ¥æ–‡" class="headerlink" title="HTTPæ–­ç‚¹ä¸‹è½½ç›¸å…³çš„æŠ¥æ–‡"></a>HTTPæ–­ç‚¹ä¸‹è½½ç›¸å…³çš„æŠ¥æ–‡</h2><ul>
<li>Accept-Ranges<br>å‘Šè¯‰å®¢æˆ·ç«¯æœåŠ¡å™¨æ˜¯å¦æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼ŒæœåŠ¡å™¨è¿”å›</li>
<li>Content-Range<br>åœ¨HTTPåè®®ä¸­ï¼Œå“åº”é¦–éƒ¨ Content-Range æ˜¾ç¤ºçš„æ˜¯ä¸€ä¸ªæ•°æ®ç‰‡æ®µåœ¨æ•´ä¸ªæ–‡ä»¶ä¸­çš„ä½ç½®ã€‚</li>
<li>ETag<br>èµ„æºæ ‡è¯† éå¿…é¡» æœåŠ¡å™¨è¿”å›</li>
<li>Last-Modified<br>èµ„æºæœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´ éå¿…é¡» æœåŠ¡å™¨è¿”å›<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å“åº”ç¤ºä¾‹ </span><br><span class="line">accept-ranges: bytes</span><br><span class="line">Content-Range: bytes 200-1000/67589 // è¿”å›æ–‡ä»¶ 200å­—èŠ‚åˆ°1000å­—èŠ‚ çš„æ•°æ®ï¼Œæ€»æ–‡ä»¶å¤§å°67589å­—èŠ‚</span><br><span class="line">etag: &quot;5f0dce96-48e&quot;</span><br><span class="line">last-modified: Tue, 14 Jul 2020 15:26:14 GMT</span><br></pre></td></tr></table></figure></li>
<li>Range<br>è¯·æ±‚å¤´è®¾ç½® Rangeï¼ŒæŒ‡å®šæœåŠ¡å™¨è¿”å›æŒ‡å®šåŒºåŸŸå†…å®¹ï¼Œå¦‚æœä¸è®¾ç½® Range ä¼šè¿”å›æ•´ä¸ªæ–‡ä»¶ã€‚æœåŠ¡å™¨ç‰‡æ®µè¿”å›çŠ¶æ€ç æ˜¯ 206ï¼Œè¯·æ±‚çš„èŒƒå›´å¦‚æœæ— æ•ˆçŠ¶æ€ç ä¼šæ˜¯ 416ï¼Œå…¨éƒ¨è¿”å›çŠ¶æ€ç æ˜¯ 200ã€‚<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//ç¤ºä¾‹ </span><br><span class="line">Range: bytes=0-499 è¡¨ç¤ºç¬¬ 0-499 å­—èŠ‚èŒƒå›´çš„å†…å®¹ </span><br><span class="line">Range: bytes=500-999 è¡¨ç¤ºç¬¬ 500-999 å­—èŠ‚èŒƒå›´çš„å†…å®¹ </span><br><span class="line">Range: bytes=-500 è¡¨ç¤ºæœ€å 500 å­—èŠ‚çš„å†…å®¹ </span><br><span class="line">Range: bytes=500- è¡¨ç¤ºä»ç¬¬ 500 å­—èŠ‚å¼€å§‹åˆ°æ–‡ä»¶ç»“æŸéƒ¨åˆ†çš„å†…å®¹ </span><br><span class="line">Range: bytes=0-0,-1 è¡¨ç¤ºç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªå­—èŠ‚ </span><br><span class="line">Range: bytes=500-600,601-999 åŒæ—¶æŒ‡å®šå‡ ä¸ªèŒƒå›´</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="Electron-æ–­ç‚¹ç»­ä¸‹è½½æ–¹å¼"><a href="#Electron-æ–­ç‚¹ç»­ä¸‹è½½æ–¹å¼" class="headerlink" title="Electron æ–­ç‚¹ç»­ä¸‹è½½æ–¹å¼"></a>Electron æ–­ç‚¹ç»­ä¸‹è½½æ–¹å¼</h2><ul>
<li>ä½¿ç”¨ Chromium çš„ä¸‹è½½åŠŸèƒ½ï¼Œåœ¨ä¸»è¿›ç¨‹é‡Œç›‘å¬ will-download äº‹ä»¶å»å¤„ç†</li>
<li>ä½¿ç”¨ Electron çš„netæ¨¡å—æˆ–è€… Node.js çš„ http&#x2F;https æ¨¡å—è‡ªå·±åˆ›å»ºè¯·æ±‚ï¼Œè®°å½•å·²ä¸‹è½½ä½ç½®</li>
</ul>
<h3 id="ä½¿ç”¨-Chromium-çš„ä¸‹è½½"><a href="#ä½¿ç”¨-Chromium-çš„ä¸‹è½½" class="headerlink" title="ä½¿ç”¨ Chromium çš„ä¸‹è½½"></a>ä½¿ç”¨ Chromium çš„ä¸‹è½½</h3><p>å¯ä»¥åœ¨æ¸²æŸ“è¿›ç¨‹ä¸­å’Œç½‘é¡µä¸€æ ·è¿›è¡Œè§¦å‘ä¸‹è½½ï¼ˆä¾‹å¦‚aæ ‡ç­¾ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨ä¸»è¿›ç¨‹ä¸­ä½¿ç”¨ BrowserWindow.webContents æˆ– session çš„ downloadURLè§¦å‘ä¸‹è½½ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç¤ºä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//ä½¿ç”¨çª—ä½“ åˆ›å»ºä¸‹è½½äº‹ä»¶å’Œç›‘å¬</span></span><br><span class="line"><span class="keyword">let</span> win = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>()</span><br><span class="line">win.<span class="property">webContents</span>.<span class="title function_">downloadURL</span>(url)</span><br><span class="line">win.<span class="property">webContents</span>.<span class="property">session</span>.<span class="title function_">on</span>(<span class="string">&#x27;will-download&#x27;</span>, <span class="function">(<span class="params">event,  downloadItem, webContents</span>) =&gt;</span> &#123;</span><br><span class="line"> event.<span class="title function_">preventDefault</span>()<span class="comment">//å¯ä»¥é˜»æ­¢ä¸‹è½½</span></span><br><span class="line"> <span class="comment">//downloadItem ä¸‹è½½é¡¹ç›®çš„ EventEmitter</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æˆ–è€… ä½¿ç”¨é»˜è®¤sessionå¯¹è±¡ã€‚</span></span><br><span class="line">session.<span class="property">defaultSession</span>.<span class="title function_">downloadURL</span>(url)</span><br><span class="line">session.<span class="property">defaultSession</span>.<span class="title function_">on</span>(<span class="string">&#x27;will-download&#x27;</span>, <span class="function">(<span class="params">event,  downloadItem, webContents</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ç„¶åå¯ä»¥ will-download äº‹ä»¶ä¸­çš„ downloadItem å®ä¾‹å»å­˜å‚¨ä¸‹è½½ä¿¡æ¯ã€‚ç­‰å¾…ç¨‹åºå†æ¬¡å¯åŠ¨æ—¶é€šè¿‡ session.createInterruptedDownload æ¢å¤ä¸Šä¸€æ¬¡çš„ä¸‹è½½<br>å¤§è‡´æµç¨‹ã€‚<br><img src="/images/posts/onewallhaven/down.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ä¸€ä¸ªç®€æ˜“ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">let</span> cacheItem = &#123;&#125;</span><br><span class="line">session.<span class="property">defaultSession</span>.<span class="title function_">on</span>(<span class="string">&#x27;will-download&#x27;</span>, <span class="function">(<span class="params">e, item</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> url = item.<span class="title function_">getURL</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–æ–‡ä»¶çš„æ€»å¤§å°</span></span><br><span class="line">    <span class="keyword">const</span> totalBytes = item.<span class="title function_">getTotalBytes</span>();</span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸‹è½½è·¯å¾„</span></span><br><span class="line">    <span class="keyword">const</span> filePath = path.<span class="title function_">join</span>(app.<span class="title function_">getPath</span>(<span class="string">&quot;downloads&quot;</span>), item.<span class="title function_">getFilename</span>());</span><br><span class="line">    item.<span class="title function_">setSavePath</span>(filePath);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//Â ç¼“å­˜downitem å°†è¿™äº›ä¿¡æ¯ä¿å­˜ä¸‹æ¥ï¼Œ</span></span><br><span class="line">    cacheItem.<span class="property">path</span> = item.<span class="title function_">getSavePath</span>();<span class="comment">//å›¾ç‰‡åœ°å€</span></span><br><span class="line">    cacheItem.<span class="property">eTag</span> = item.<span class="title function_">getETag</span>();<span class="comment">//èµ„æºæ ‡è¯†</span></span><br><span class="line">    cacheItem.<span class="property">urlChain</span> = item.<span class="title function_">getURLChain</span>();<span class="comment">//åœ°å€</span></span><br><span class="line">    cacheItem.<span class="property">length</span> = totalBytes<span class="comment">//èµ„æºå¤§å°</span></span><br><span class="line">    cacheItem.<span class="property">lastModified</span> = item.<span class="title function_">getLastModifiedTime</span>()<span class="comment">//èµ„æºæœ€åä¸€æ¬¡æ›´æ–°çš„æ—¶é—´</span></span><br><span class="line">    cacheItem.<span class="property">startTime</span> = item.<span class="title function_">getStartTime</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> lastBytes = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç›‘å¬ä¸‹è½½è¿‡ç¨‹ï¼Œè®¡ç®—å¹¶è®¾ç½®è¿›åº¦æ¡è¿›åº¦</span></span><br><span class="line">    item.<span class="title function_">on</span>(<span class="string">&#x27;updated&#x27;</span>, <span class="function">(<span class="params">event, state</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (state === <span class="string">&#x27;interrupted&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä¸‹è½½å·²ç»ä¸­æ–­ï¼Œå¯ä»¥æ¢å¤&#x27;</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (state === <span class="string">&#x27;progressing&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (item.<span class="title function_">isPaused</span>()) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æš‚åœä¸‹è½½&#x27;</span>)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">let</span> offset = item.<span class="title function_">getReceivedBytes</span>();</span><br><span class="line">                cacheItem.<span class="property">speedBytes</span> = offset - lastBytes;<span class="comment">//ä¸‹è½½é€Ÿåº¦</span></span><br><span class="line">                cacheItem.<span class="property">offset</span> = offset<span class="comment">//å·²ç»ä¸‹è½½</span></span><br><span class="line">                lastBytes = offset</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä¸‹è½½ä¸­&#x27;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    item.<span class="title function_">once</span>(<span class="string">&#x27;done&#x27;</span>, <span class="function">(<span class="params">event, state</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (state === <span class="string">&#x27;interrupted&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä¸‹è½½å·²ç»ä¸­æ–­ï¼Œæ— æ³•æ¢å¤&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (state === <span class="string">&#x27;cancelle&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä¸‹è½½å–æ¶ˆ&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä¸‹è½½å®Œæˆ&#x27;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ˜¯å¦å¯æ¢å¤ä¸‹è½½</span></span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">canResume</span>) &#123;</span><br><span class="line">        item.<span class="title function_">resume</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//ç¨‹åºå…³é—­æ—¶å°† cacheItem å­˜å‚¨ä¸‹è½½</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ===&gt; ç¨‹åº å†æ¬¡æ‰“å¼€æ—¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†ä¸Šé¢å­˜å‚¨cacheItemä¿¡æ¯è¯»å–å‡ºæ¥ æ¢å¤ä¸‹è½½</span></span><br><span class="line">session.<span class="property">defaultSession</span>.<span class="title function_">createInterruptedDownload</span>(&#123;</span><br><span class="line">    path, </span><br><span class="line">    urlChain, </span><br><span class="line">    offset, <span class="comment">// ä¸‹è½½æ–­ç‚¹å¼€å§‹ä½ç½®</span></span><br><span class="line">    length, </span><br><span class="line">    lastModified, <span class="comment">//</span></span><br><span class="line">    eTag, <span class="comment">// </span></span><br><span class="line">    startTime</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„ä¸€ä¸ªåœ°æ–¹æ˜¯ï¼ŒElectron ä¼šåœ¨ç¨‹åºé€€å‡ºæ—¶å€™åˆ é™¤æˆ‘ä»¬ä¸‹è½½ä¸€èˆ¬çš„æ–‡ä»¶ï¼Œæˆ‘ç›®å‰å¤„ç†æ–¹æ¡ˆæ˜¯åœ¨ ç¨‹åºé€€å‡ºæ—¶ï¼Œå°†æ‰€æœ‰è¿˜æ²¡æœ‰ä¸‹è½½å®Œæˆæ–‡ä»¶å¤åˆ¶ä¸€ä»½ï¼Œç­‰ä¸‹æ¬¡ç»§ç»­ä¸‹è½½æ—¶å€™è¿˜åŸå›å»ã€‚</p>
<p>ç›¸å…³çš„æ–‡æ¡£åœ°å€ <a href="https://www.electronjs.org/docs/api/browser-window">BrowserWindow</a>  ,<a href="https://www.electronjs.org/docs/api/session">Session</a> , <a href="https://www.electronjs.org/docs/api/web-contents">webContents</a>, <a href="https://www.electronjs.org/docs/api/download-item">DownloadItem</a></p>
<h3 id="åˆ›å»ºè¯·æ±‚å®ç°ç»­ä¸‹è½½"><a href="#åˆ›å»ºè¯·æ±‚å®ç°ç»­ä¸‹è½½" class="headerlink" title="åˆ›å»ºè¯·æ±‚å®ç°ç»­ä¸‹è½½"></a>åˆ›å»ºè¯·æ±‚å®ç°ç»­ä¸‹è½½</h3><p>å¤§è‡´ä¸Šå’Œä¸Šé¢æ˜¯å·®ä¸å¤šçš„ï¼Œè®°å½•å·²ä¸‹è½½æ–‡ä»¶ä¿¡æ¯ï¼Œå†æ¬¡è¯·æ±‚æ—¶å€™è®¾ç½®ä»æŒ‡å®šä½ç½®å¼€å§‹è¯·æ±‚æ•°æ®ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>electron</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutter ä¸­çš„åŠ¨ç”»</title>
    <url>/flutter_animation/</url>
    <content><![CDATA[<p>Flutter ä¸­åŠ¨ç”»çš„åˆ›å»ºæœ‰å¾ˆå¤šç§ï¼Œ éœ€è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚é€‰æ‹©ä¸åŒçš„åŠ¨ç”»ã€‚å¦‚æœåªæ˜¯ç®€å•çš„å¸ƒå±€ç­‰çš„åŠ¨ç”»ç›´æ¥ä½¿ç”¨æœ€ç®€å•çš„éšå¼åŠ¨ç”»å°±å¯ä»¥äº†ï¼Œå› ä¸ºéšå¼åŠ¨ç”»æ˜¯ç”±æ¡†æ¶æ§åˆ¶çš„ï¼Œæ‰€ä»¥ä»…ä»…åªéœ€è¦æ›´æ”¹å˜éœ€è¦å˜åŒ–å±æ€§å°±å¯ä»¥äº†ã€‚å¦‚æœä½ æƒ³è‡ªå·±æ§åˆ¶åŠ¨ç”»çš„å˜æ¢åˆ™éœ€è¦ä½¿ç”¨æ˜¾ç¤ºåŠ¨ç”»ï¼Œå¦‚æœéœ€è¦æ§åˆ¶ä¸€äº›åˆ—åŠ¨ç”»ç»„åˆæ—¶ä½¿ç”¨äº¤ç»‡åŠ¨ç”»å»æ§åˆ¶ã€‚å¦‚æœå†…ç½®çš„æ»¡è¶³ä¸äº†éœ€æ±‚çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥ç»“åˆç”»å¸ƒè‡ªç»˜åŠ¨ç”»ã€‚</p>
<span id="more"></span>

<h2 id="åŠ¨ç”»åŸºç¡€"><a href="#åŠ¨ç”»åŸºç¡€" class="headerlink" title="åŠ¨ç”»åŸºç¡€"></a>åŠ¨ç”»åŸºç¡€</h2><p>Flutter åŠ¨ç”»å’Œå…¶ä»–å¹³å°åŠ¨ç”»åŸç†ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯åœ¨å¿«é€Ÿæ›´æ”¹ UI å®ç°åŠ¨ç”»æ•ˆæœã€‚åœ¨ä¸€ä¸ª Flutter åŠ¨ç”»ä¸­ä¸»è¦åŒ…å« Animationï¼ˆåŠ¨ç”»ï¼‰ã€AnimationControllerï¼ˆæ§åˆ¶å™¨ï¼‰ã€Curveï¼ˆé€Ÿåº¦æ›²çº¿ï¼‰ã€Animatableï¼ˆåŠ¨ç”»å–å€¼èŒƒå›´ï¼‰ã€Listeners ï¼ˆç›‘å¬äº‹ä»¶ï¼‰ã€Tickerï¼ˆå¸§ï¼‰ã€‚</p>
<ul>
<li>Animation  ä¸€ä¸ªæŠ½è±¡ç±»æ˜¯ Flutter åŠ¨ç”»çš„æ ¸å¿ƒç±»ï¼Œä¸»ç”¨äºä¿å­˜åŠ¨ç”»å½“å‰æ’å€¼çš„å’ŒçŠ¶æ€ï¼Œåœ¨åŠ¨ç”»è¿è¡Œæ—¶ä¼šæŒç»­ç”Ÿæˆä»‹äºä¸¤ä¸ªå€¼ä¹‹é—´çš„æ’å…¥å€¼ã€‚ä¾‹å¦‚å½“å®½ä» 100 å˜æˆ 200ï¼Œä¼šåœ¨åŠ¨ç”»ç¬¬ä¸€å¸§åˆ°æœ€åä¸€å¸§éƒ½ä¼šç”Ÿæˆ 100-200 åŒºé—´çš„ä¸€ä¸ªå€¼ï¼Œå¦‚æœé€Ÿåº¦æ˜¯åŒ€é€Ÿçš„ï¼Œè¿™ä¸ªå€¼å°±æ˜¯åŒ€é€Ÿå¢åŠ åˆ° 200ã€‚</li>
<li>AnimationController  ç”¨æ¥æ§åˆ¶åŠ¨ç”»çš„çŠ¶æ€å¯åŠ¨ã€æš‚åœã€åå‘è¿è¡Œç­‰ï¼Œ æ˜¯ Animation çš„ä¸€ä¸ªå­ç±»</li>
<li>Curve  ç”¨æ¥å®šä¹‰åŠ¨ç”»è¿åŠ¨çš„æ˜¯åŒ€é€Ÿè¿åŠ¨è¿˜æ˜¯åŒ€åŠ é€Ÿç­‰ï¼Œå’Œ css ä¸­ animation-timing-function ç±»ä¼¼</li>
<li>Animatable ç”¨äºè¡¨æ˜åŠ¨ç”»å€¼èŒƒå›´å€¼ã€‚å¯ä»¥é€šè¿‡è°ƒç”¨ animate æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª Animationï¼Œå¸¸è§çš„ Tween ç³»åˆ—çš„ç±»éƒ½æ˜¯å¯¹ä»–çš„å®ç°</li>
<li>Listener ç›‘å¬åŠ¨ç”»çŠ¶æ€çš„å˜åŒ–</li>
<li>Ticker å¸§å›è°ƒï¼Œåœ¨åŠ¨ç”»æ‰§è¡Œæ—¶å€™æ¯ä¸€å¸§éƒ½ä¼šè°ƒç”¨å…¶å›è°ƒï¼Œç±»ä¼¼ä¸ js ä¸­çš„ requestAnimationFrame</li>
</ul>
<h3 id="åŠ¨ç”»ç»„æˆç»“æ„"><a href="#åŠ¨ç”»ç»„æˆç»“æ„" class="headerlink" title="åŠ¨ç”»ç»„æˆç»“æ„"></a>åŠ¨ç”»ç»„æˆç»“æ„</h3><p><img src="/images/posts/flutter_animation/gxt.png" alt="ç»“æ„å›¾" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="åŠ¨ç”»é€‰æ‹©"><a href="#åŠ¨ç”»é€‰æ‹©" class="headerlink" title="åŠ¨ç”»é€‰æ‹©"></a>åŠ¨ç”»é€‰æ‹©</h3><p><img src="/images/posts/flutter_animation/lct.png" alt="æµç¨‹å›¾" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<!-- Flutter ä¼šç”¨ AnimationController æ§åˆ¶æ‰§è¡ŒçŠ¶æ€ï¼Œæ‰§è¡Œçš„æ—¶å€™ä¼šæ ¹æ® Animatableï¼ŒCurve åœ¨æ¯ä¸€å¸§éƒ½ç”Ÿæˆå¯¹åº”çš„ä¸­é—´æ’å€¼ï¼Œæ’å€¼ä¼šä¿å­˜åœ¨ Animation ä¸­ï¼Œæˆ‘ä»¬ Animation çš„æ’å€¼æˆ‘ä»¬å°±å¯ä»¥æ›´æ–°æ¯ä¸€å¸§çš„ç”»é¢ï¼Œå½¢æˆåŠ¨ç”»ï¼ˆAnimationï¼‰ã€‚ä¸ç®¡æ˜¯éšå¼è¿˜æ˜¯æ˜¾ç¤ºåŠ¨ç”»éƒ½æ˜¯è¿™æ ·æ¥å¤„ç†åŠ¨ç”»çš„ã€‚ -->

<h2 id="éšå¼åŠ¨ç”»"><a href="#éšå¼åŠ¨ç”»" class="headerlink" title="éšå¼åŠ¨ç”»"></a>éšå¼åŠ¨ç”»</h2><p>éšå¼åŠ¨ç”»ç®€å•æ¥è¯´å°±æ˜¯æˆ‘ä»¬åªéœ€è¦ä¿®æ”¹å¯¹åº”çš„å±æ€§ï¼ŒFlutter å°±æ˜¯è‡ªå·±å¸®æˆ‘ä»¬è¿‡æ¸¡åŠ¨ç”»ï¼Œå’Œ css ä¸­è¿‡æ¸¡æœ‰ç‚¹ç±»ä¼¼ï¼Œå½“æˆ‘ä»¬è®¾ç½®å transition ååªéœ€è¦æ›´æ”¹å¯¹åº”çš„ css å±æ€§å°±ä¼šè‡ªåŠ¨è¿‡æ¸¡åˆ°æ–°çš„å€¼ã€‚Flutter å†…ç½®äº†ä¸€äº›å¸¸ç”¨çš„éšå¼åŠ¨ç”»ï¼Œå¯ä»¥çœ‹åˆ°æºç é‡Œéƒ½æ˜¯å¯¹ ImplicitlyAnimatedWidget çš„å®ç°ï¼Œå¦‚æœéœ€è¦æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±å®ç° ImplicitlyAnimatedWidget æ¥è‡ªå®šä¹‰éšå¼åŠ¨ç”»ã€‚ </p>
<h3 id="å†…ç½®éšå¼åŠ¨ç”»"><a href="#å†…ç½®éšå¼åŠ¨ç”»" class="headerlink" title="å†…ç½®éšå¼åŠ¨ç”»"></a>å†…ç½®éšå¼åŠ¨ç”»</h3><p>çœ‹ä¸ªä½¿ç”¨ä¾‹å­</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é¦–å…ˆæˆ‘ä»¬åœ¨ä¸€ä¸ªStatefulWidgetå®šä¹‰ ä¸€ä¸ªheightå’Œcolor</span></span><br><span class="line"><span class="built_in">double</span> heihgt = <span class="number">100</span>;</span><br><span class="line">Color color = Colors.yellow[<span class="number">800</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨build æ€åŠ ä¸€ä¸ªéšå¼åŠ¨ç”»ç»„å»º AnimatedContainerï¼Œéœ€è¦ä¸ªDurationï¼ˆåŠ¨ç”»æ‰§è¡Œæ—¶é—´ï¼‰ï¼Œå…¶ä»–çš„å‚æ•°å’ŒContainerçš„åŸºæœ¬ä¸€è‡´</span></span><br><span class="line">AnimatedContainer(</span><br><span class="line">    duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">500</span>), </span><br><span class="line">    height: heihgt, <span class="comment">// ä½¿ç”¨æˆ‘ä»¬å®šä¹‰å¥½çš„å€¼</span></span><br><span class="line">    color: color,</span><br><span class="line">    margin: EdgeInsets.all(<span class="number">8</span>),</span><br><span class="line">    child: Center(</span><br><span class="line">        child: Text(<span class="string">&#x27;AnimatedContainer&#x27;</span>,</span><br><span class="line">            style: TextStyle(color: Colors.white, fontSize: <span class="number">20</span>),</span><br><span class="line">        ),</span><br><span class="line">    ),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åœ¨éœ€è¦æ‰§è¡ŒåŠ¨ç”»æ—¶å€™æˆ‘ä»¬ä¿®æ”¹ height å’Œ color å€¼,å°±ä¼šçœ‹åˆ° ä¸Šè¾¹çš„ç»„å»ºä¼šä¸€è¾¹å˜é«˜è¾¹è¿‡æ¸¡åˆ°è“è‰²ä¸Š</span></span><br><span class="line">setState(() &#123;</span><br><span class="line">    heihgt = <span class="number">200</span>;</span><br><span class="line">    color = Colors.blue;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åœ¨ Flutter å†…ç½®çš„éšå¼åŠ¨ç”»ç»„ä»¶ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯ AnimatedXxxxxx ç±»ä¼¼çš„ï¼Œåé¢çš„ Xxxxxx éƒ½èƒ½æ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶ã€‚å†…ç½®çš„æœ‰ä¸‹é¢è¿™äº› AnimatedContainerã€AnimatedPaddingã€AnimatedAlignã€AnimatedPositionedã€AnimatedOpacityã€SliverAnimatedOpacityã€AnimatedDefaultTextStyleã€AnimatedPhysicalModelã€‚è¿™äº›éšå¼åŠ¨ç”»çš„ä½¿ç”¨å’Œå…¶ Xxxxxx å¯¹åº”çš„å±æ€§åŸºæœ¬ä¸€è‡´ï¼Œåªéœ€è¦é¢å¤–çš„æŒ‡å®š duration å°±å¯ä»¥äº†ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä¸ºåŠ¨ç”»æŒ‡å®šåŠ¨ç”»æ›²çº¿ curveã€‚</p>
<h3 id="è‡ªå®šä¹‰éšå¼åŠ¨ç”»"><a href="#è‡ªå®šä¹‰éšå¼åŠ¨ç”»" class="headerlink" title="è‡ªå®šä¹‰éšå¼åŠ¨ç”»"></a>è‡ªå®šä¹‰éšå¼åŠ¨ç”»</h3><p>å½“è¿™å†…ç½®çš„æ»¡è¶³ä¸äº†ä½ çš„æ—¶å€™ï¼Œä½ ä¹Ÿå¯ä»¥å»å®ç°ä¸€ä¸ªéšå¼åŠ¨ç”»ï¼Œåªéœ€è¦å®ç°æŠ½è±¡ç±» ImplicitlyAnimatedWidgetã€‚å®ç°è‡ªå®šä¹‰éšå¼åŠ¨ç”»ä»…éœ€è¦é‡å†™ build å’Œ forEachTween å°±å¯ä»¥ç®€å•å®ç°äº†ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç›´æ¥ç»§æ‰¿ImplicitlyAnimatedWidget </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnimatedDemo</span> <span class="keyword">extends</span> <span class="title">ImplicitlyAnimatedWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> Color color;</span><br><span class="line">  <span class="keyword">final</span> Widget child;</span><br><span class="line">  <span class="keyword">final</span> <span class="built_in">double</span> height;</span><br><span class="line"></span><br><span class="line">  AnimatedDemo(&#123;</span><br><span class="line">    <span class="keyword">this</span>.color,</span><br><span class="line">    <span class="keyword">this</span>.height,</span><br><span class="line">    Curve curve = Curves.linear,</span><br><span class="line">    <span class="keyword">this</span>.child,</span><br><span class="line">    <span class="meta">@required</span> <span class="built_in">Duration</span> duration,</span><br><span class="line">  &#125;) : <span class="keyword">super</span>(curve: curve, duration: duration);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _AnimatedDemo createState() =&gt; _AnimatedDemo();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å› ä¸ºImplicitlyAnimatedWidgetæ˜¯ç»§æ‰¿ StatefulWidget çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦ç»§æ‰¿ä»–çš„çŠ¶æ€ç±» ï¼ˆAnimatedWidgetBaseState ç»§æ‰¿è‡ª ImplicitlyAnimatedWidgetStateï¼‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_AnimatedDemo</span> <span class="keyword">extends</span> <span class="title">AnimatedWidgetBaseState</span>&lt;<span class="title">AnimatedDemo</span>&gt; </span>&#123;</span><br><span class="line">  ColorTween _color;</span><br><span class="line">  Tween&lt;<span class="built_in">double</span>&gt; _height;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// åœ¨åŠ¨ç”»æ‰§è¡Œæ—¶å€™ä¼šæ¯ä¸€å¸§éƒ½è°ƒç”¨ build</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Container(</span><br><span class="line">      color: _color.evaluate(animation), <span class="comment">//ä½¿ç”¨evaluateå¯ä»¥è·å–Tweenå½“å‰å¸§çš„çŠ¶æ€å€¼</span></span><br><span class="line">      height: _height.evaluate(animation),</span><br><span class="line">      child: widget.child,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//é¦–æ¬¡buildå’Œæ›´æ–°æ—¶å€™ä¼šè°ƒç”¨ï¼Œåœ¨è¿™é‡Œè®¾ç½®åŠ¨ç”»éœ€è¦çš„Tweençš„å¼€å§‹å€¼å’Œç»“æŸå€¼</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> forEachTween(visitor) &#123;</span><br><span class="line">    <span class="comment">//visitor æœ‰ä¸‰ä¸ªå‚æ•°ï¼ˆå½“å‰çš„tweenï¼ŒåŠ¨ç”»ç»ˆæ­¢çŠ¶æ€ï¼Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼ˆå°†ç¬¬ä¸€æ¬¡ç»™å®šçš„å€¼è®¾ç½®ä¸ºTweençš„å¼€å§‹å€¼ï¼‰ï¼‰</span></span><br><span class="line">    _color = visitor(_color, widget.color, (value) =&gt; ColorTween(begin: value));<span class="comment">// è¿™é‡Œvalue==é¦–æ¬¡widget.colorçš„å€¼</span></span><br><span class="line">    _height = visitor(_height, widget.height, (value) =&gt; Tween&lt;<span class="built_in">double</span>&gt;(begin: value));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å»çœ‹ ImplicitlyAnimatedWidget æ˜¯å¦‚ä½•æ§åˆ¶åŠ¨ç”»çš„ï¼Œåœ¨ ImplicitlyAnimatedWidgetState ä¸­ä¼šçœ‹åˆ°å…¶å®é‡Œé¢å®šä¹‰äº† AnimationController æ§åˆ¶åŠ¨ç”»ã€‚ç„¶åå¯ä»¥çœ‹åˆ° didUpdateWidget é’©å­å‡½æ•°ä¸­è°ƒç”¨äº†  _controller.forward() æ‰§è¡ŒåŠ¨ç”»ï¼Œå½“çˆ¶ Widget è°ƒç”¨ setState æ—¶å€™å°±ä¼šè§¦å‘è¿™ä¸ªé’©å­å‡½æ•°çš„è°ƒç”¨ã€‚</p>
<h2 id="æ˜¾ç¤ºåŠ¨ç”»"><a href="#æ˜¾ç¤ºåŠ¨ç”»" class="headerlink" title="æ˜¾ç¤ºåŠ¨ç”»"></a>æ˜¾ç¤ºåŠ¨ç”»</h2><p>æœ‰æ—¶å€™æœ‰äº›åŠ¨ç”»éœ€è¦ä»¬è‡ªå·±å»æ§åˆ¶åŠ¨ç”»çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯äº¤ç»™æ¡†æ¶å»å¤„ç†ï¼Œè¿™æ—¶å°±éœ€è¦æˆ‘ä»¬è‡ªå·±å»å®šä¹‰å‰é¢ç®€ä»‹é‡Œæåˆ°çš„é‚£å‡ ä¸ªåŠ¨ç”»è¦ç´ äº†ã€‚</p>
<h3 id="å†…ç½®æ˜¾ç¤ºåŠ¨ç”»"><a href="#å†…ç½®æ˜¾ç¤ºåŠ¨ç”»" class="headerlink" title="å†…ç½®æ˜¾ç¤ºåŠ¨ç”»"></a>å†…ç½®æ˜¾ç¤ºåŠ¨ç”»</h3><p>åœ¨ Flutter ä¸­å†…ç½®çš„æ˜¾ç¤ºåŠ¨ç”»å¤§éƒ¨åˆ†éƒ½æ˜¯ XxxxxxTransition åç§°çš„ï¼Œæˆ‘ä»¬çœ‹ä¸ªå†…ç½®æ˜¾ç¤ºåŠ¨ç”»ä½¿ç”¨ä¾‹å­ï¼ŒRotationTransition ç»„ä»¶éœ€è¦ä¸€ä¸ª turnsï¼ˆAnimation&lt;double&gt;ï¼‰å‚æ•°,æˆ‘ä»¬å¯ä»¥ç»™å®ƒä¸ªAnimationController</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// RotationTransition å‚æ•°</span></span><br><span class="line">RotationTransition(</span><br><span class="line">   turns: Animation&lt;<span class="built_in">double</span>&gt;,</span><br><span class="line">   child: ChildWidget(),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// AnimationController å‚æ•°</span></span><br><span class="line">AnimationController(</span><br><span class="line">  <span class="built_in">double?</span> value, <span class="comment">// åˆå§‹å€¼</span></span><br><span class="line">  <span class="keyword">this</span>.duration, <span class="comment">//åŠ¨ç”»æ—¶é—´</span></span><br><span class="line">  <span class="keyword">this</span>.reverseDuration, <span class="comment">// åå‘åŠ¨ç”»æ‰§è¡Œçš„æ—¶é—´</span></span><br><span class="line">  <span class="keyword">this</span>.debugLabel, </span><br><span class="line">  <span class="keyword">this</span>.lowerBound = <span class="number">0.0</span>, <span class="comment">//åŠ¨ç”»å¼€å§‹å€¼</span></span><br><span class="line">  <span class="keyword">this</span>.upperBound = <span class="number">1.0</span>, <span class="comment">//åŠ¨ç”»ç»“æŸå€¼</span></span><br><span class="line">  <span class="keyword">this</span>.animationBehavior = AnimationBehavior.normal,</span><br><span class="line">  <span class="keyword">required</span> TickerProvider vsync, <span class="comment">//å‚ç›´åŒæ­¥ï¼Œéœ€è¦ä¸€ä¸ª Ticker ,Flutter ç»™æˆ‘ä»¬æä¾›äº†</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ RotationTransitionï¼Œå¯ä»¥çœ‹åˆ°ä¸€ä¸ªçº¢è“æ¸å˜è‰²æ–¹å—æ—‹è½¬ä¸€å‘¨ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RotationTransitionDemo</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _RotationTransitionDemoState createState() =&gt; _RotationTransitionDemoState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_RotationTransitionDemoState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">RotationTransitionDemo</span>&gt; <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  AnimationController _controller;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    <span class="comment">// è®¾ç½®åŠ¨ç”»æ—¶é—´ä¸º1ç§’</span></span><br><span class="line">    _controller = AnimationController(duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">1000</span>), vsync: <span class="keyword">this</span>)</span><br><span class="line">    ..addListener(() &#123; <span class="comment">// ç›‘å¬åŠ¨ç”»çš„çŠ¶æ€å€¼å‘ç”Ÿå˜åŒ–</span></span><br><span class="line">        <span class="built_in">print</span>(_controller.value);</span><br><span class="line">    &#125;)</span><br><span class="line">    ..addStatusListener((status) &#123; <span class="comment">//ç›‘å¬åŠ¨ç”»çŠ¶æ€</span></span><br><span class="line">        <span class="comment">// dismissed åŠ¨ç”»åœ¨èµ·å§‹ç‚¹åœæ­¢</span></span><br><span class="line">        <span class="comment">// forward åŠ¨ç”»æ­£åœ¨æ­£å‘æ‰§è¡Œ</span></span><br><span class="line">        <span class="comment">// reverse åŠ¨ç”»æ­£åœ¨åå‘æ‰§è¡Œ</span></span><br><span class="line">        <span class="comment">// completed åŠ¨ç”»åœ¨ç»ˆç‚¹åœæ­¢</span></span><br><span class="line">        <span class="built_in">print</span>(status);</span><br><span class="line">    &#125;)</span><br><span class="line">    ..forward(); <span class="comment">// æ‰§è¡ŒåŠ¨ç”»</span></span><br><span class="line">    <span class="comment">// å¸¸ç”¨æ–¹æ³•</span></span><br><span class="line">    <span class="comment">// forward() // æ­£å‘æ‰§è¡ŒåŠ¨ç”»</span></span><br><span class="line">    <span class="comment">// reverse() åå‘æ‰§è¡ŒåŠ¨ç”»</span></span><br><span class="line">    <span class="comment">// repeat() é‡å¤æ‰§è¡Œ å¯ä»¥ä¼ ä¸ªå‚æ•° æ˜¯å¦ä¼šåå‘è¿åŠ¨</span></span><br><span class="line">    <span class="comment">// stop() åœæ­¢åŠ¨ç”»</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _controller.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> Scaffold(</span><br><span class="line">      appBar: AppBar(</span><br><span class="line">        title: Text(<span class="string">&#x27;RotationTransition&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      body: Center(</span><br><span class="line">        child: RotationTransition(</span><br><span class="line">          turns: _controller, <span class="comment">// è®¾ç½® Animation</span></span><br><span class="line">          child: Container(</span><br><span class="line">            height: <span class="number">300</span>,</span><br><span class="line">            width: <span class="number">300</span>,</span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">              gradient: LinearGradient(colors: [Colors.red, Colors.blue]),</span><br><span class="line">            ),</span><br><span class="line">          ),</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ§åˆ¶å™¨è¡¥é—´å’Œæ›²çº¿"><a href="#æ§åˆ¶å™¨è¡¥é—´å’Œæ›²çº¿" class="headerlink" title="æ§åˆ¶å™¨è¡¥é—´å’Œæ›²çº¿"></a>æ§åˆ¶å™¨è¡¥é—´å’Œæ›²çº¿</h3><p>åœ¨æ§åˆ¶å™¨ä¸­æˆ‘ä»¬å¯ä»¥çœ‹çš„åŠ¨ç”»å¼€å§‹å€¼å’Œç»“æŸå€¼é»˜è®¤æ˜¯ 0.0 åˆ° 1.0ï¼Œè€Œä¸”æ˜¯ double ç±»å‹çš„ã€‚è€Œå®é™…åŠ¨ç”»ä¸­ä¸å¯èƒ½åªæ˜¯ double ç±»å‹çš„ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±ä½¿ç”¨ Animatable æ¥æŒ‡å®šè¡¥é—´èŒƒå›´å€¼ã€‚<br>ä¿®æ”¹ä¸€ä¸‹ä¸Šé¢çš„ä»£ç </p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é€šè¿‡æ§åˆ¶å™¨çš„driveæ–¹æ³•æ·»åŠ </span></span><br><span class="line"> _controller = AnimationController(duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">1000</span>),vsync: <span class="keyword">this</span>)</span><br><span class="line">  ..drive(Tween(begin: <span class="number">1</span>, end: <span class="number">4</span>)) <span class="comment">//ä½¿ç”¨Tweenï¼ˆAnimatableçš„å­ç±»ï¼‰æŒ‡å®šè¡¥é—´èŒƒå›´</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æˆ‘ä¹Ÿä¹Ÿå¯ä»¥æ˜¯ä½¿ç”¨Animatableçš„animateæ–¹æ³•æ·»åŠ åˆ°æ§åˆ¶å™¨</span></span><br><span class="line">Tween(begin: <span class="number">1</span>, end: <span class="number">4</span>).animate(_controller);</span><br><span class="line"><span class="comment">// è¿™æ ·å†™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ chain() å åŠ å¤šä¸ª Tween</span></span><br><span class="line">Tween(begin: <span class="number">1</span>, end: <span class="number">4</span>)</span><br><span class="line">.chain(CurveTween(curve: Curves.ease)) <span class="comment">//å åŠ ä¸ªæ›²çº¿</span></span><br><span class="line">.animate(_controller);</span><br></pre></td></tr></table></figure>
<p>Flutter å·²ç»å†…ç½®å¸®æˆ‘ä»¬å®ç°äº†å¾ˆå¤š Animatableï¼ŒColorTweenã€SizeTweenã€IntTweenã€StepTween ç­‰ç­‰ã€‚</p>
<h3 id="è‡ªå®šä¹‰æ˜¾ç¤ºåŠ¨ç”»"><a href="#è‡ªå®šä¹‰æ˜¾ç¤ºåŠ¨ç”»" class="headerlink" title="è‡ªå®šä¹‰æ˜¾ç¤ºåŠ¨ç”»"></a>è‡ªå®šä¹‰æ˜¾ç¤ºåŠ¨ç”»</h3><p>æŸ¥çœ‹ RotationTransition çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒæ˜¯å¯¹çš„æŠ½è±¡ç±» AnimatedWidget çš„å®ç°ï¼Œå½“å†…ç½®çš„æ»¡è¶³ä¸äº†æˆ‘ä»¬çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥è‡ªå·±å®ç° AnimatedWidget è‡ªå®šä¹‰æ˜¾ç¤ºåŠ¨ç”»ã€‚å…ˆæ¥çœ‹çœ‹ AnimatedWidget é‡Œé¢éƒ½æœ‰äº›å•¥ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åªæ‘˜å–ä¸»è¦çš„éƒ¨åˆ†</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AnimatedWidget</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> AnimatedWidget(&#123; Key key,<span class="meta">@required</span> <span class="keyword">this</span>.listenable,  &#125;) : <span class="keyword">assert</span>(listenable != <span class="keyword">null</span>), <span class="keyword">super</span>(key: key);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _AnimatedState createState() =&gt; _AnimatedState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_AnimatedState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">AnimatedWidget</span>&gt; </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    widget.listenable.addListener(_handleChange);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _handleChange() &#123;</span><br><span class="line">    setState(() &#123;</span><br><span class="line">      <span class="comment">// æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ˜¾ç¤ºåŠ¨ç”»æ˜¯é€šè¿‡æ§åˆ¶å™¨ç›‘å¬æ’å€¼æ›´æ”¹ setState è¿›è¡Œé‡ç»˜ã€‚</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥æˆ‘è‡ªå·±ç»§æ‰¿ AnimatedWidget å®ç°ä¸€ä¸ªè‡ªå®šä¹‰æ˜¾ç¤ºåŠ¨ç”»</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç»§æ‰¿ AnimatedWidget</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OpacityAnimatedWidget</span> <span class="keyword">extends</span> <span class="title">AnimatedWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">final</span> Widget child;</span><br><span class="line">  Animation&lt;Color&gt; colorAnimation;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// AnimatedWidget éœ€è¦å¯ä¼ é€’ä¸€ä¸ª listenable è¿›å»ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ é€’ä¸ª AnimationController</span></span><br><span class="line">  OpacityAnimatedWidget(listenable, &#123;<span class="keyword">this</span>.colorAnimation, <span class="keyword">this</span>.child&#125;) : <span class="keyword">super</span>(listenable: listenable);</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    Animation&lt;<span class="built_in">double</span>&gt; animation = listenable;</span><br><span class="line">    <span class="keyword">return</span> Opacity(</span><br><span class="line">      opacity: animation.value,</span><br><span class="line">      child: Container(</span><br><span class="line">        color: colorAnimation.value,</span><br><span class="line">        child: child,</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ éœ€è¦åœ¨çŠ¶æ€ç±»ä¸Š æ··å…¥ä¸€ä¸ª SingleTickerProviderStateMixin</span></span><br><span class="line">AnimationController _controller = AnimationController(duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">1000</span>), vsync: <span class="keyword">this</span>); </span><br><span class="line"></span><br><span class="line">OpacityAnimatedWidget(</span><br><span class="line">  Tween(begin: <span class="number">1.0</span>, end: <span class="number">.8</span>).animate(_controller),</span><br><span class="line">  colorAnimation: ColorTween(begin: Colors.red, end: Colors.blue).animate(_controller),</span><br><span class="line">  child: Container(</span><br><span class="line">    height: <span class="number">300</span>,</span><br><span class="line">    width: <span class="number">300</span>,</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>Flutter å†…éƒ¨è¿˜æä¾›äº†ä¸€ä¸ª AnimatedBuilder å¸®åŠ©æˆ‘ä»¬ç®€åŒ–è‡ªå®šä¹‰åŠ¨ç”»ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åªéœ€è¦ä¸‰ä¸ªä¸‰å‚æ•°</span></span><br><span class="line">AnimatedBuilder( </span><br><span class="line">  animation, <span class="comment">// ä¸€ä¸ªlistenable</span></span><br><span class="line">  child,<span class="comment">// ä¼ å…¥ä¸ªå­ç»„ä»¶ï¼Œéå¿…å¡«</span></span><br><span class="line">  builder,<span class="comment">// (BuildContext context, Widget child)&#123;&#125;  è¿™é‡Œçš„ç¬¬äºŒä¸ªå‚æ•° child ï¼Œå°±æ˜¯ä¸Šé¢ä¼ å…¥çš„ child</span></span><br><span class="line">  <span class="comment">// è¿™ä¹ˆåšçš„å¥½å¤„å°±æ˜¯ï¼ŒåŠ¨ç”»æ‰§è¡Œçš„æ—¶å€™åªä¼šæ‰§è¡Œ builder ,å¦‚æœä¸€ä¸ªåŠ¨ç”»åªæ˜¯åŒ…è£¹å±‚éœ€è¦æ‰§è¡ŒåŠ¨ç”»ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥æŠŠåŒ…è£¹çš„å­ç»„ä»¶ æ”¾åˆ°å¤–é¢ä¼ è¿›å»</span></span><br><span class="line">  <span class="comment">// è¿™æ ·å°±æ¯æ¬¡åªéœ€è¦ æ‰§è¡Œ builder è€Œæ–¹æ³•ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ é€’è¿›æ¥çš„å¼•ç”¨ï¼Œæ‰€ä»¥å¯ä»¥é¿å…æ¯æ¬¡éƒ½æ›´æ–°ï¼Œå‡å°‘å¼€é”€</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="äº¤ç»‡åŠ¨ç”»"><a href="#äº¤ç»‡åŠ¨ç”»" class="headerlink" title="äº¤ç»‡åŠ¨ç”»"></a>äº¤ç»‡åŠ¨ç”»</h3><p>å®˜æ–¹æ˜¯è¿™ä¹ˆä»‹ç»çš„ï¼šäº¤ç»‡åŠ¨ç”»æ˜¯ä¸€ä¸ªç®€å•çš„æ¦‚å¿µï¼šè§†è§‰å˜åŒ–æ˜¯éšç€ä¸€ç³»åˆ—çš„åŠ¨ä½œå‘ç”Ÿï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æ€§çš„åŠ¨ä½œã€‚åŠ¨ç”»å¯èƒ½æ˜¯çº¯ç²¹é¡ºåºçš„ï¼Œä¸€ä¸ªæ”¹å˜éšç€ä¸€ä¸ªæ”¹å˜å‘ç”Ÿï¼ŒåŠ¨ç”»ä¹Ÿå¯èƒ½æ˜¯éƒ¨åˆ†æˆ–è€…å…¨éƒ¨é‡å çš„ã€‚åŠ¨ç”»ä¹Ÿå¯èƒ½æœ‰é—´éš™ï¼Œæ²¡æœ‰å˜åŒ–å‘ç”Ÿã€‚</p>
<p>ç®€å•ç‚¹è¯´å°±æ˜¯ä¸€ä¸ªåŠ¨ç”»å¯ä»¥åˆ†å‰²æˆå¾ˆå¤šç‰‡æ®µï¼Œæ¯ä¸ªç‰‡æ®µéƒ½æœ‰ä¸åŒçš„ Tweenï¼Œçœ‹ä¸ªä½¿ç”¨ç¤ºä¾‹</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StaggeredAnimationDemo</span> <span class="keyword">extends</span> <span class="title">StatefulWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  _StaggeredAnimationDemoState createState() =&gt; _StaggeredAnimationDemoState();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_StaggeredAnimationDemoState</span> <span class="keyword">extends</span> <span class="title">State</span>&lt;<span class="title">StaggeredAnimationDemo</span>&gt; <span class="title">with</span> <span class="title">SingleTickerProviderStateMixin</span> </span>&#123;</span><br><span class="line">  AnimationController _controller;</span><br><span class="line">  Animation&lt;<span class="built_in">double</span>&gt; _height;</span><br><span class="line">  Animation&lt;Color&gt; _color;</span><br><span class="line">  Animation&lt;<span class="built_in">double</span>&gt; _borderRadius;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> initState() &#123;</span><br><span class="line">    <span class="keyword">super</span>.initState();</span><br><span class="line">    _controller = AnimationController(duration: <span class="built_in">Duration</span>(milliseconds: <span class="number">5000</span>), vsync: <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">    _height = Tween(begin: <span class="number">50.0</span>, end: <span class="number">300.0</span>).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: _controller,</span><br><span class="line">        curve: Interval(<span class="number">0</span>, <span class="number">0.15</span>), <span class="comment">// Interval èŒƒå›´å¿…é¡»æ˜¯0-1 æŒ‡å®šTweenåœ¨å“ªä¸€æ®µæ—¶é—´æ‰§è¡Œ</span></span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    _color = ColorTween(begin: Colors.red, end: Colors.blue).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: _controller,</span><br><span class="line">        curve: Interval(<span class="number">0.1</span>, <span class="number">0.2</span>),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    _borderRadius = Tween(begin: <span class="number">10.0</span>, end: <span class="number">150.0</span>).animate(</span><br><span class="line">      CurvedAnimation(</span><br><span class="line">        parent: _controller,</span><br><span class="line">        curve: Interval(<span class="number">0.1</span>, <span class="number">0.25</span>),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    _controller.forward();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> dispose() &#123;</span><br><span class="line">    _controller.dispose();</span><br><span class="line">    <span class="keyword">super</span>.dispose();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> BasiceAppLayout(</span><br><span class="line">      title: <span class="string">&#x27;äº¤ç»‡åŠ¨ç”»&#x27;</span>,</span><br><span class="line">      body: Center(</span><br><span class="line">        child: AnimatedBuilder(</span><br><span class="line">          animation: _controller,</span><br><span class="line">          builder: (context, child) &#123;</span><br><span class="line">            <span class="keyword">return</span> Container(</span><br><span class="line">              height: _height.value,</span><br><span class="line">              width: _height.value,</span><br><span class="line">              decoration: BoxDecoration(</span><br><span class="line">                color: _color.value,</span><br><span class="line">                borderRadius: BorderRadius.circular(_borderRadius.value),</span><br><span class="line">              ),</span><br><span class="line">            );</span><br><span class="line">          &#125;,</span><br><span class="line">        ),</span><br><span class="line">      ),</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="HeroåŠ¨ç”»"><a href="#HeroåŠ¨ç”»" class="headerlink" title="HeroåŠ¨ç”»"></a>HeroåŠ¨ç”»</h2><p>Flutter å«å®ƒä¸»åŠ¨ç”»ï¼Œç”¨äºä¸åŒé¡µé¢ä¹‹é—´åˆ‡æ¢æ—¶å€™åŠ¨ç”»ï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªå•†å“åˆ—è¡¨ï¼Œç‚¹å‡»åè·³åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢æŸ¥çœ‹åŸå›¾ï¼Œå°±å¯ä»¥è¿™ä¸ªåŠ¨ç”»ã€‚ä½¿ç”¨ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨ä¸åŒé¡µé¢ä½¿ç”¨ Hero åŒ…è£¹éœ€è¦åŠ¨ç”»ç»„ä»¶ï¼Œä¸¤ä¸ªé¡µé¢çš„ tag éœ€è¦ç”šè‡³æˆä¸€ç›´ï¼Œä½†æ˜¯åŒä¸€ä¸ªé¡µé¢éœ€è¦ä¿æŒå”¯ä¸€ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">Hero(</span><br><span class="line">  tag: <span class="string">&quot;avatar&quot;</span>, <span class="comment">//å”¯ä¸€æ ‡è®°ï¼Œå‰åä¸¤ä¸ªè·¯ç”±é¡µHeroçš„tagå¿…é¡»ç›¸åŒ</span></span><br><span class="line">  child: ChildWidget(),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<!-- ## è‡ªç»˜åŠ¨ç”» -->]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutter å¸¸ç”¨å°éƒ¨ä»¶(ä¸€)</title>
    <url>/flutter_basic_widget/</url>
    <content><![CDATA[<p>Flutter ä¸­æ‰€æœ‰çš„UIç•Œé¢éƒ½æ˜¯widgetæ„å»ºçš„ã€‚widgetç”¨æ¥æè¿°å…ƒç´ é…ç½®æ•°æ®,ç„¶åä¼šè¢«æ¸²æŸ“æˆå¯¹åº”UIç•Œé¢ã€‚ å½“widgetçš„çŠ¶æ€ä¿®æ”¹æ—¶, å®ƒä¼šé‡æ–°æ¸²æŸ“UIã€‚</p>
<span id="more"></span>

<h2 id="widget"><a href="#widget" class="headerlink" title="widget"></a>widget</h2><p>Flutter å®˜ç½‘å¯¹ widget æè¿°</p>
<blockquote>
<p>Flutterä»Reactä¸­å¸å–çµæ„Ÿï¼Œé€šè¿‡ç°ä»£åŒ–æ¡†æ¶åˆ›å»ºå‡ºç²¾ç¾çš„ç»„ä»¶ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯ç”¨widgetæ¥æ„å»ºä½ çš„UIç•Œé¢ã€‚ Widgetæè¿°äº†åœ¨å½“å‰çš„é…ç½®å’ŒçŠ¶æ€ä¸‹è§†å›¾æ‰€åº”è¯¥å‘ˆç°çš„æ ·å­ã€‚å½“widgetçš„çŠ¶æ€æ”¹å˜æ—¶ï¼Œå®ƒä¼šé‡æ–°æ„å»ºå…¶æè¿°ï¼ˆå±•ç¤ºçš„ UIï¼‰ï¼Œæ¡†æ¶åˆ™ä¼šå¯¹æ¯”å‰åå˜åŒ–çš„ä¸åŒï¼Œä»¥ç¡®å®šåº•å±‚æ¸²æŸ“æ ‘ä»ä¸€ä¸ªçŠ¶æ€è½¬æ¢åˆ°ä¸‹ä¸€ä¸ªçŠ¶æ€æ‰€éœ€çš„æœ€å°æ›´æ”¹ã€‚</p>
</blockquote>
<p>ä¸€ä¸ªæ–°çš„ç»„ä»¶é€šå¸¸æ˜¯ç»§æ‰¿ StatelessWidget æˆ– StatefulWidget</p>
<ul>
<li>StatelessWidget æ˜¯çŠ¶æ€ä¸å¯å˜çš„ widgetï¼Œ å…¶ä¸­çš„å±•ç¤ºå†…å®¹ä¸ä¼šéšç€æ•°æ®çš„å˜åŒ–è€Œå˜åŒ–ï¼ˆéå“åº”å¼ï¼‰ã€‚</li>
<li>StatefulWidget å¯ä»¥è¿›è¡ŒçŠ¶æ€ç®¡ç†ï¼Œ æ•°æ®æ›´æ–°ï¼Œ é¡µé¢ä¸­çš„å†…å®¹å¯ä»¥éšä¹‹å˜åŒ–ï¼ˆå“åº”å¼ï¼‰ã€‚</li>
</ul>
<p>ä½¿ç”¨ StatefulWidget æ—¶å€™ï¼Œ å¯¹çŠ¶æ€è¿›è¡Œæ›´æ”¹æ—¶å€™ï¼Œ ä¼šè§¦å‘ build æ–¹æ³•å¯¹ç»„ä»¶è¿›è¡Œé‡ç»˜ï¼Œ ä¹Ÿä¼šè¿åŒå­ç»„ä»¶çš„ä¸€èµ·è§¦å‘ã€‚å½“ä¸€ä¸ªç»„ä»¶æ•°æ®ä¸­é€”ä¸éœ€è¦æ›´æ”¹çš„æ—¶å€™ï¼Œå°½å¯èƒ½çš„ä½¿ç”¨ StatelessWidgetï¼Œ å¯¹æ€§èƒ½æœ‰è¾ƒå¥½æå‡ã€‚æˆ–è€…å°†éœ€è¦æ›´æ–°éƒ¨åˆ†å°½å¯èƒ½æ‹†åˆ†æˆå­èŠ‚ç‚¹ã€‚</p>
<h2 id="åŸºç¡€-widget"><a href="#åŸºç¡€-widget" class="headerlink" title="åŸºç¡€ widget"></a>åŸºç¡€ widget</h2><h3 id="Text"><a href="#Text" class="headerlink" title="Text"></a>Text</h3><p>Textä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œç”¨äºæ˜¾ç¤ºç®€å•æ ·å¼æ–‡æœ¬ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">Text(</span><br><span class="line">   <span class="string">&#x27;è¦æ˜¾ç¤ºæ–‡æœ¬&#x27;</span>, </span><br><span class="line">   <span class="comment">//style è®¾ç½®æ–‡æœ¬æ ·å¼</span></span><br><span class="line">   style: TextStyle(</span><br><span class="line">       color: Colors.blue,</span><br><span class="line">       fontSize: <span class="number">18.0</span>,</span><br><span class="line">       height: <span class="number">1.2</span>,  </span><br><span class="line">   ),</span><br><span class="line">   <span class="comment">//textAlign è®¾ç½®å¯¹é½æ–¹å¼</span></span><br><span class="line">   <span class="comment">//maxLines æœ€å¤§è¡Œæ•°</span></span><br><span class="line">   <span class="comment">//overflow è¶…å‡ºæ˜¾ç¤ºæ–¹å¼</span></span><br><span class="line">   <span class="comment">//softWrap è®¾ç½®æ¢è¡Œ</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨è‡ªå®šä¹‰å­—ä½“</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å®šä¹‰å¥½è‡ªå®šä¹‰å­—ä½“æ–‡ä»¶ pubspec.yaml</span></span><br><span class="line"><span class="attr">flutter:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">family:</span> <span class="string">Mango</span></span><br><span class="line">    <span class="attr">fonts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">asset:</span> <span class="string">asset/fonts/Mango-Regular-2.otf</span></span><br></pre></td></tr></table></figure>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨å­—ä½“</span></span><br><span class="line">Text(</span><br><span class="line">    <span class="string">&#x27;è‡ªå®šä¹‰å­—ä½“ hello Flutter&#x27;</span>,</span><br><span class="line">    style: TextStyle(fontFamily: <span class="string">&#x27;Mango&#x27;</span>, color: Colors.white),</span><br><span class="line">    textAlign: TextAlign.center,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>æœ‰æ—¶æˆ‘ä»¬è¿˜ä¼šéœ€è¦ä¸€æ®µæ–‡æœ¬ä¸­ï¼Œå¯èƒ½éœ€è¦ä¸åŒçš„å­—ä½“æ ·å¼ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ Text.rich æˆ–è€… RichText</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">Text.rich(</span><br><span class="line">    TextSpan(</span><br><span class="line">        style: TextStyle(fontSize: <span class="number">18</span>, color: Colors.white),</span><br><span class="line">        children: &lt;TextSpan&gt;[</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; å¤©ä¸Š&#x27;</span>),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; ç™½ç‰äº¬&#x27;</span>,style: TextStyle(fontWeight: FontWeight.bold,color: Colors.red,fontSize: <span class="number">20</span>,)),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; ï¼Œ&#x27;</span>),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; åäºŒæ¥¼äº”åŸã€‚&#x27;</span>),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27;ä»™äºº &#x27;</span>, style: TextStyle(fontWeight: FontWeight.bold, color: Colors.red, fontSize: <span class="number">20</span>)),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27;æŠšæˆ‘é¡¶ï¼Œç»“å‘å—é•¿ç”Ÿã€‚&#x27;</span>),</span><br><span class="line">        ],</span><br><span class="line">    )</span><br><span class="line">)</span><br><span class="line"><span class="comment">// æˆ–è€… ä¸¤ä¸ªæ•ˆæœæ˜¯ä¸€æ ·çš„ éƒ½æ˜¯éœ€è¦ä¸€ä¸ª InlineSpan ç±»å‹, maxLines,overflowç­‰è¿™äº›å¯ä»¥åœ¨å¤–å±‚è®¾ç½®, å•ç‹¬æ ·å¼åœ¨TextSpançš„styleè®¾ç½®</span></span><br><span class="line">RichText(</span><br><span class="line">    text: TextSpan(</span><br><span class="line">        style: TextStyle(fontSize: <span class="number">18</span>, color: Colors.white),</span><br><span class="line">        children: &lt;TextSpan&gt;[</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; å¤©ä¸Š&#x27;</span>),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; ç™½ç‰äº¬&#x27;</span>,style: TextStyle(fontWeight: FontWeight.bold,color: Colors.red,fontSize: <span class="number">20</span>,)),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; ï¼Œ&#x27;</span>),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27; åäºŒæ¥¼äº”åŸã€‚&#x27;</span>),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27;ä»™äºº &#x27;</span>, style: TextStyle(fontWeight: FontWeight.bold, color: Colors.red, fontSize: <span class="number">20</span>)),</span><br><span class="line">            TextSpan(text: <span class="string">&#x27;æŠšæˆ‘é¡¶ï¼Œç»“å‘å—é•¿ç”Ÿã€‚&#x27;</span>),</span><br><span class="line">        ],</span><br><span class="line">    ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h3><p>Flutter å†…ç½®äº†å¾ˆå¤šæŒ‰é’®ï¼ŒMaterial ä¸­å¤§è‡´åˆ†ä¸º RawMaterialButton å’Œ IconButton ä¸¤ç±»</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// RawMaterialButton å¸¸è§çš„æœ‰ RaisedButton / FlatButton / OutlineButton /FlatButton</span></span><br><span class="line">RawMaterialButton(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.onPressed,</span><br><span class="line">    <span class="keyword">this</span>.onHighlightChanged,            <span class="comment">// é«˜äº®å˜åŒ–çš„å›è°ƒ</span></span><br><span class="line">    <span class="keyword">this</span>.textStyle,                     <span class="comment">// æ–‡å­—å±æ€§</span></span><br><span class="line">    <span class="keyword">this</span>.fillColor,                     <span class="comment">// å¡«å……é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.highlightColor,                <span class="comment">// èƒŒæ™¯é«˜äº®é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.splashColor,                   <span class="comment">// æ°´æ³¢çº¹é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.elevation = <span class="number">2.0</span>,               <span class="comment">// é˜´å½±</span></span><br><span class="line">    <span class="keyword">this</span>.highlightElevation = <span class="number">8.0</span>,      <span class="comment">// é«˜äº®æ—¶é˜´å½±</span></span><br><span class="line">    <span class="keyword">this</span>.disabledElevation = <span class="number">0.0</span>,       <span class="comment">// ä¸å¯ç‚¹å‡»æ—¶é˜´å½±</span></span><br><span class="line">    <span class="keyword">this</span>.padding = EdgeInsets.zero,     <span class="comment">// å†…å®¹å‘¨å›´è¾¹è·</span></span><br><span class="line">    <span class="keyword">this</span>.constraints = <span class="keyword">const</span> BoxConstraints(minWidth: <span class="number">88.0</span>, minHeight: <span class="number">36.0</span>),   <span class="comment">// é»˜è®¤æŒ‰é’®å°ºå¯¸</span></span><br><span class="line">    <span class="keyword">this</span>.shape = <span class="keyword">const</span> RoundedRectangleBorder(),    <span class="comment">// å½¢çŠ¶æ ·å¼</span></span><br><span class="line">    <span class="keyword">this</span>.animationDuration = kThemeChangeDuration,  <span class="comment">// åŠ¨ç”»æ•ˆæœæŒç»­æ—¶é•¿</span></span><br><span class="line">    <span class="keyword">this</span>.clipBehavior = Clip.none,                  <span class="comment">// æŠ—é”¯é½¿å‰ªåˆ‡æ•ˆæœ</span></span><br><span class="line">    MaterialTapTargetSize materialTapTargetSize,    <span class="comment">// ç‚¹å‡»ç›®æ ‡çš„æœ€å°å°ºå¯¸</span></span><br><span class="line">    <span class="keyword">this</span>.child,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//IconButtonç±»å‹çš„æŒ‰é’®</span></span><br><span class="line"><span class="comment">// IconButton å¸¸è§çš„æœ‰ BackButton(è¿”å›ä¸Šä¸€ä¸ªé¡µé¢)/CloseButton(å…³é—­å½“å‰é¡µé¢)</span></span><br><span class="line">IconButton(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.iconSize = <span class="number">24.0</span>,   <span class="comment">// å›¾æ ‡å¤§å°</span></span><br><span class="line">    <span class="keyword">this</span>.padding = <span class="keyword">const</span> EdgeInsets.all(<span class="number">8.0</span>),   <span class="comment">// å›¾æ ‡å‘¨å›´é—´è·</span></span><br><span class="line">    <span class="keyword">this</span>.alignment = Alignment.center,          <span class="comment">// å›¾æ ‡ä½ç½®</span></span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.icon,    <span class="comment">// å›¾æ ‡èµ„æº</span></span><br><span class="line">    <span class="keyword">this</span>.color,             <span class="comment">// å›¾æ ‡é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.highlightColor,    <span class="comment">// ç‚¹å‡»é«˜äº®é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.splashColor,       <span class="comment">// æ°´æ³¢çº¹é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.disabledColor,     <span class="comment">// ä¸å¯ç‚¹å‡»æ—¶é«˜äº®é¢œè‰²</span></span><br><span class="line">    <span class="meta">@required</span> <span class="keyword">this</span>.onPressed,</span><br><span class="line">    <span class="keyword">this</span>.tooltip            <span class="comment">// é•¿æŒ‰æç¤º</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…¶ä»–æŒ‰é’®</span></span><br><span class="line"><span class="comment">//FloatingActionButton æ‚¬æµ®</span></span><br><span class="line"><span class="comment">//TextButton æ–‡æœ¬æŒ‰é’®</span></span><br><span class="line"><span class="comment">//CupertinoButton iOSé£æ ¼æŒ‰é’®</span></span><br></pre></td></tr></table></figure>

<h3 id="Image"><a href="#Image" class="headerlink" title="Image"></a>Image</h3><p>Image æ—¥å¸¸å¼€å‘ä¸­çš„ä½¿ç”¨é¢‘ç‡ä¹Ÿéå¸¸é«˜ï¼ŒImage å¯ä»¥åŠ è½½æœ¬åœ°ï¼Œç½‘ç»œï¼Œç¼“å­˜çš„å›¾ç‰‡ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æœ¬åœ°åŠ è½½å›¾ç‰‡ éœ€è¦åœ¨ pubspec.yaml æ·»åŠ å›¾ç‰‡èµ„æº</span></span><br><span class="line">Image(</span><br><span class="line">    image: AssetImage(<span class="string">&#x27;asset/images/demo.png&#x27;</span>), <span class="comment">//æœ¬åœ°å›¾ç‰‡</span></span><br><span class="line">    <span class="comment">// åœ¨çº¿å›¾ç‰‡</span></span><br><span class="line">    <span class="comment">// image: NetworkImage(&#x27;https://dev-file.iviewui.com/ttkIjNPlVDuv4lUTvRX8GIlM2QqSe0jg/middle&#x27;),</span></span><br><span class="line">    height: <span class="number">100.0</span>,</span><br><span class="line">    width: <span class="number">100.0</span>,</span><br><span class="line">    fit: BoxFit.fill, <span class="comment">// å¡«å……æ–¹å¼å’ŒWebä¸Šå·®ä¸å¤š</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">// Image ä¹Ÿæä¾›äº† Image.asset å’Œ Image.network æ„é€ å‡½æ•°çš„å¿«æ·æ–¹å¼</span></span><br></pre></td></tr></table></figure>
<h3 id="Icon"><a href="#Icon" class="headerlink" title="Icon"></a>Icon</h3><p>ä½¿ç”¨å†…ç½®å›¾æ ‡ï¼ŒFlutter å†…ç½®æä¾›äº†ä¸€å¥— material-icon å›¾æ ‡</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">//éœ€è¦ä¸€ä¸ªIconDataç±»å‹å›¾æ ‡æ•°æ®</span></span><br><span class="line">Icon(</span><br><span class="line">    Icons.thirteen_mp, <span class="comment">//material-icon éƒ½å®šä¹‰åœ¨ Icons ç±»ä¸­</span></span><br><span class="line">    size: <span class="number">30</span>,</span><br><span class="line">    color: Colors.black,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨è‡ªå®šä¹‰å›¾æ ‡</p>
<ul>
<li>ä¸‹è½½å¥½å›¾æ ‡æ–‡ä»¶</li>
<li>åŠ å…¥åœ¨é¡¹ç›®ä¸­</li>
<li>åœ¨pubspec.yamlä¸­å¼•å…¥å­—ä½“æ–‡ä»¶ttf(ä¸åŒç‰ˆæœ¬çš„flutterå¯èƒ½æœ‰å·®å¼‚)<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment">#pubspec.yaml</span></span><br><span class="line"><span class="attr">flutter:</span></span><br><span class="line"> <span class="attr">fonts:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">family:</span> <span class="string">IconFont</span></span><br><span class="line">    <span class="attr">fonts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">asset:</span> <span class="string">asset/fonts/iconfont.ttf</span></span><br></pre></td></tr></table></figure></li>
<li>ç¼–å†™è‡ªå®šä¹‰ IconData ç±»å‹<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">//IconFont:æ˜¯å¼•å…¥æ—¶å€™è®¾ç½®å­—ä½“åç§°,0xe611 ä¸ºå¯¹åº”å›¾æ ‡çš„Unicode</span></span><br><span class="line">IconData li = IconData(<span class="number">0xe611</span>, fontFamily: <span class="string">&#x27;IconFont&#x27;</span>) <span class="comment">// è®¾ç½®è‡ªå®šä¹‰IconData</span></span><br><span class="line">Icon(</span><br><span class="line">    li,</span><br><span class="line">    size: <span class="number">30</span>,</span><br><span class="line">    color: Colors.black,</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="AppBar"><a href="#AppBar" class="headerlink" title="AppBar"></a>AppBar</h3><p>AppBar æ˜¯ä¸€ä¸ªé¡¶ç«¯å¯¼èˆªæ  </p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"> AppBar(&#123;</span><br><span class="line">    <span class="keyword">this</span>.leading, <span class="comment">//å·¦ä¾§æŒ‰é’® å¯ä»¥è‡ªå®šä¹‰,åœ¨å…¶ä»–é¡µæ—¶å€™ å›æ˜¾ç¤ºè¿”å›æŒ‰é’®</span></span><br><span class="line">    <span class="keyword">this</span>.automaticallyImplyLeading = <span class="keyword">true</span>,<span class="comment">//leadingä¸ºnullï¼Œæ˜¯å¦è‡ªåŠ¨å®ç°é»˜è®¤çš„leadingæŒ‰é’®</span></span><br><span class="line">    <span class="keyword">this</span>.title, <span class="comment">// æ ‡é¢˜,æ˜¯ä¸€ä¸ªWidget</span></span><br><span class="line">    <span class="keyword">this</span>.actions, <span class="comment">//  ä¸€ä¸ªWidgetåˆ—è¡¨,æ˜¾ç¤ºåœ¨å³ä¾§,</span></span><br><span class="line">    <span class="keyword">this</span>.flexibleSpace,<span class="comment">//æ˜¾ç¤ºåœ¨ AppBar ä¸‹æ–¹çš„æ§ä»¶ï¼Œé«˜åº¦å’Œ AppBar é«˜åº¦ä¸€æ · å¯æ˜¯å®šåˆ¶äº›ç‰¹æ®Šæ•ˆæœ</span></span><br><span class="line">    <span class="keyword">this</span>.bottom,<span class="comment">// ä¸€ä¸ªPreferredSizeWidget,å¯ä»¥ç”¨æ¥æ”¾TabBar</span></span><br><span class="line">    <span class="keyword">this</span>.elevation,<span class="comment">//æ§ä»¶çš„ z åæ ‡é¡ºåº ä¸º0å¯ä»¥éšè—é˜´å½±</span></span><br><span class="line">    <span class="keyword">this</span>.shadowColor,<span class="comment">// é˜´å½±é¢œè‰²</span></span><br><span class="line">    <span class="keyword">this</span>.shape,</span><br><span class="line">    <span class="keyword">this</span>.backgroundColor, <span class="comment">// èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="keyword">this</span>.brightness, <span class="comment">//è®¾ç½®çŠ¶æ€æ é¢œè‰² light:æ–‡å­—æ˜¯é»‘è‰² dark:æ–‡å­—æ˜¯ç™½è‰²</span></span><br><span class="line">    <span class="keyword">this</span>.iconTheme,<span class="comment">//</span></span><br><span class="line">    <span class="keyword">this</span>.actionsIconTheme,</span><br><span class="line">    <span class="keyword">this</span>.textTheme, <span class="comment">//æ–‡å­—æ ·å¼</span></span><br><span class="line">    <span class="keyword">this</span>.primary = <span class="keyword">true</span>, <span class="comment">//ä¸ºfalseæ—¶å€™ä¼šåœ¨å±å¹•é¡¶éƒ¨,ä¸ä¿ç•™çŠ¶æ€æ </span></span><br><span class="line">    <span class="keyword">this</span>.centerTitle, <span class="comment">//æ ‡é¢˜æ˜¯å¦å±…ä¸­æ˜¾ç¤º</span></span><br><span class="line">    <span class="keyword">this</span>.excludeHeaderSemantics = <span class="keyword">false</span>,</span><br><span class="line">    <span class="keyword">this</span>.titleSpacing = NavigationToolbar.kMiddleSpacing, <span class="comment">//æ°´å¹³æ ‡é¢˜é—´è·</span></span><br><span class="line">    <span class="keyword">this</span>.toolbarOpacity = <span class="number">1.0</span>,<span class="comment">//é€æ˜åº¦</span></span><br><span class="line">    <span class="keyword">this</span>.bottomOpacity = <span class="number">1.0</span>,<span class="comment">//é€æ˜åº¦</span></span><br><span class="line">    <span class="keyword">this</span>.toolbarHeight, <span class="comment">//é«˜åº¦</span></span><br><span class="line">    <span class="keyword">this</span>.leadingWidth,<span class="comment">// å·¦ä¾§æŒ‰é’®å®½åº¦</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç¤ºä¾‹</span></span><br><span class="line">AppBar(</span><br><span class="line">    automaticallyImplyLeading: <span class="keyword">false</span>,</span><br><span class="line">    title: Text(<span class="string">&quot;å»æ‰é˜´å½±å’Œå·¦ä¾§é»˜è®¤æŒ‰é’®&quot;</span>),</span><br><span class="line">    elevation: <span class="number">0.0</span>,</span><br><span class="line">    actions: [</span><br><span class="line">        IconButton(</span><br><span class="line">            icon: Icon(Icons.search, color: Colors.white),</span><br><span class="line">            onPressed: <span class="keyword">null</span>,</span><br><span class="line">        ),</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹AppBar+TabBar</span></span><br><span class="line">DefaultTabController(</span><br><span class="line">    length: <span class="number">2</span>,</span><br><span class="line">    child: Scaffold(</span><br><span class="line">        appBar: AppBar(</span><br><span class="line">                automaticallyImplyLeading: <span class="keyword">false</span>,</span><br><span class="line">                title: Text(<span class="string">&quot;AppBar+TabBar&quot;</span>),</span><br><span class="line">                centerTitle: <span class="keyword">true</span>,</span><br><span class="line">                elevation: <span class="number">0.0</span>,</span><br><span class="line">                bottom: TabBar(</span><br><span class="line">                    unselectedLabelColor: Colors.white60,</span><br><span class="line">                    indicatorColor: Colors.white,</span><br><span class="line">                    indicatorSize: TabBarIndicatorSize.label,</span><br><span class="line">                    indicatorWeight: <span class="number">2.0</span>,</span><br><span class="line">                    tabs: &lt;Widget&gt;[</span><br><span class="line">                        Tab(text: <span class="string">&#x27;tab1&#x27;</span>),</span><br><span class="line">                        Tab(text: <span class="string">&#x27;tab2&#x27;</span>),</span><br><span class="line">                    ],</span><br><span class="line">                ),</span><br><span class="line">            ),</span><br><span class="line">        body: TabBarView(</span><br><span class="line">            children: [</span><br><span class="line">                Container(</span><br><span class="line">                    color: Colors.black12,</span><br><span class="line">                    child: Center(child: Text(<span class="string">&#x27;tab1&#x27;</span>)),</span><br><span class="line">                ),</span><br><span class="line">                Container(</span><br><span class="line">                    color: Colors.yellow[<span class="number">50</span>],</span><br><span class="line">                    child: Center(child: Text(<span class="string">&#x27;tab2&#x27;</span>)),</span><br><span class="line">                ),</span><br><span class="line">            ],</span><br><span class="line">        ),</span><br><span class="line">    ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<!-- ### Tabs -->

<h2 id="å¸ƒå±€ç±»-widget"><a href="#å¸ƒå±€ç±»-widget" class="headerlink" title="å¸ƒå±€ç±» widget"></a>å¸ƒå±€ç±» widget</h2><p>å¸¸ç”¨å¸ƒå±€ widget æœ‰ Rowã€Columnã€Flexã€Warpã€Flowã€Stackã€Positioned ç­‰ã€‚</p>
<h3 id="å¼¹æ€§å¸ƒå±€"><a href="#å¼¹æ€§å¸ƒå±€" class="headerlink" title="å¼¹æ€§å¸ƒå±€"></a>å¼¹æ€§å¸ƒå±€</h3><p>Flutter ä½¿ç”¨çš„ Flex æ¨¡å‹åŸºæœ¬ä¸Šè·Ÿ CSS ç±»ä¼¼ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Row</span></span><br><span class="line">Row(</span><br><span class="line">    <span class="comment">// ä¸»è½´å¯¹é½æ–¹å¼(æ°´å¹³æ–¹å‘)</span></span><br><span class="line">    mainAxisAlignment: MainAxisAlignment.spaceBetween,</span><br><span class="line">    <span class="comment">//CrossAxisAlignment è´Ÿè½´(å‚ç›´æ–¹å‘)</span></span><br><span class="line">    children: [</span><br><span class="line">        Text(<span class="string">&quot; Row1 &quot;</span>),</span><br><span class="line">        Text(<span class="string">&quot; Row2 &quot;</span>),</span><br><span class="line">        <span class="comment">// å ç”¨å‰©ä½™ç©ºé—´</span></span><br><span class="line">        Expanded(</span><br><span class="line">            flex: <span class="number">1</span>, <span class="comment">// è®¾ç½®å æ¯”</span></span><br><span class="line">            child: Text(<span class="string">&quot; Row3 &quot;</span>),</span><br><span class="line">        ),</span><br><span class="line">        Expanded(</span><br><span class="line">            flex: <span class="number">2</span>,</span><br><span class="line">            child: Text(<span class="string">&quot; Row4 &quot;</span>),</span><br><span class="line">        ),</span><br><span class="line">    ],</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//Column</span></span><br><span class="line">Column(</span><br><span class="line">    <span class="comment">// ä¸»è½´å¯¹é½æ–¹å¼(å‚ç›´æ–¹å‘)</span></span><br><span class="line">    mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">     <span class="comment">//CrossAxisAlignment è´Ÿè½´(æ°´å¹³æ–¹å‘)</span></span><br><span class="line">    children: <span class="built_in">List</span>.generate(<span class="number">3</span>, (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> Container(</span><br><span class="line">            margin: EdgeInsets.symmetric(vertical: <span class="number">8</span>),</span><br><span class="line">            height: <span class="number">50</span>,</span><br><span class="line">            color: Colors.black12,</span><br><span class="line">            child: Center(</span><br><span class="line">                child: Text(<span class="string">&#x27;Column&#x27;</span>),</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;).toList(),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//Flex ä¸ Column,Row ä½¿ç”¨æ–¹å¼ç±»ä¼¼</span></span><br><span class="line"> Flex(</span><br><span class="line">    <span class="comment">//è®¾ç½®æ–¹å‘ æ°´å¹³å’Œå‚ç›´</span></span><br><span class="line">    direction: Axis.vertical,</span><br><span class="line">    mainAxisAlignment: MainAxisAlignment.spaceEvenly,</span><br><span class="line">    children: <span class="built_in">List</span>.generate(<span class="number">3</span>, (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> Container(</span><br><span class="line">            margin: EdgeInsets.symmetric(vertical: <span class="number">8</span>),</span><br><span class="line">            height: <span class="number">50</span>,</span><br><span class="line">            color: Colors.black12,</span><br><span class="line">            child: Center(</span><br><span class="line">            child: Text(<span class="string">&#x27;vertical&#x27;</span>),</span><br><span class="line">            ),</span><br><span class="line">        );</span><br><span class="line">    &#125;).toList(),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="æµå¼å¸ƒå±€"><a href="#æµå¼å¸ƒå±€" class="headerlink" title="æµå¼å¸ƒå±€"></a>æµå¼å¸ƒå±€</h3><p>åœ¨ä»‹ç» Row å’Œ Colum æ—¶ï¼Œå¦‚æœå­ widget è¶…å‡ºå±å¹•èŒƒå›´ï¼Œ åˆ™ä¼šæŠ¥æº¢å‡ºé”™è¯¯ï¼Œ å¹¶ä¸ä¼šè‡ªåŠ¨æ¢è¡Œã€‚Flutter ä¸­æä¾›äº† Wrap å’Œ Flow æ¥æ”¯æŒæº¢å‡ºéƒ¨åˆ†åä¼šè‡ªåŠ¨æŠ˜è¡Œã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// Wrap çš„ç¤ºä¾‹</span></span><br><span class="line">Wrap(</span><br><span class="line">    spacing: <span class="number">8.0</span>, <span class="comment">// ä¸»è½´(æ°´å¹³)æ–¹å‘é—´è·</span></span><br><span class="line">    runSpacing: <span class="number">4.0</span>, <span class="comment">// çºµè½´ï¼ˆå‚ç›´ï¼‰æ–¹å‘é—´è·</span></span><br><span class="line">    alignment: WrapAlignment.center, <span class="comment">//æ²¿ä¸»è½´æ–¹å‘å±…ä¸­</span></span><br><span class="line">    <span class="comment">//runAlignment çºµè½´æ–¹å‘çš„å¯¹é½æ–¹å¼</span></span><br><span class="line">    children: <span class="built_in">List</span>.generate(<span class="number">12</span>, (e) &#123;</span><br><span class="line">        <span class="keyword">return</span> Container(</span><br><span class="line">            decoration: BoxDecoration(</span><br><span class="line">                color: Color(<span class="number">0xff38acfa</span>),</span><br><span class="line">                borderRadius: BorderRadius.circular(<span class="number">5</span>),</span><br><span class="line">            ),</span><br><span class="line">            padding: EdgeInsets.symmetric(horizontal: <span class="number">10</span>, vertical: <span class="number">5</span>),</span><br><span class="line">            child: Text(<span class="string">&#x27;tag<span class="subst">$e</span>&#x27;</span>, style: TextStyle(color: Colors.white)),</span><br><span class="line">        );</span><br><span class="line">    &#125;).toList(),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>Flow å¸ƒå±€éœ€è¦ä¸€ä¸ª FlowDelegate ç±»å‹çš„ delegate å¯¹è±¡ï¼Œ ä½†æ˜¯ Flutter æ²¡æœ‰ç°æˆå®ç°çš„ç±»ï¼Œ éœ€è¦æˆ‘ä»¬è‡ªå·±å®ç°ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">//ç»§æ‰¿FlowDelegate   åªéœ€è¦å®ç°paintChildren å’Œ shouldRepaint</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestFlowDelegate</span> <span class="keyword">extends</span> <span class="title">FlowDelegate</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”¨æ¥ç»˜åˆ¶å­ç»„ä»¶</span></span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="keyword">void</span> paintChildren(FlowPaintingContext context) &#123;</span><br><span class="line">    <span class="comment">//FlowPaintingContext ç»˜åˆ¶ä¸Šä¸‹æ–‡ä¿¡æ¯</span></span><br><span class="line">    <span class="comment">// size çˆ¶ç»„ä»¶å¤§å°</span></span><br><span class="line">    <span class="comment">// childCount å­ç»„ä»¶ä¸ªæ•°</span></span><br><span class="line">    <span class="comment">// getChildSize è·å–å­ç»„ä»¶å¤§å°</span></span><br><span class="line">    <span class="comment">// paintChild ç»˜åˆ¶å­ç»„ä»¶</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; context.childCount; i++) &#123;</span><br><span class="line">      <span class="comment">//paintChild ä¸‰ä¸ªå‚æ•° ä¸€ä¸ªæŒ‡å®šç¬¬å‡ ä¸ªå­ç»„ä»¶ ä¸€ä¸ªè¡¨ç¤ºä½ç½®ä¿¡æ¯ ä¸€ä¸ªæ˜¯é€æ˜åº¦</span></span><br><span class="line">      context.paintChild(i, transform: Matrix4.translationValues(i * <span class="number">20.0</span>, i * <span class="number">20.0</span>, <span class="number">0.0</span>), opacity: <span class="number">0.6</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    </span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  <span class="built_in">bool</span> shouldRepaint(FlowDelegate oldDelegate) &#123;</span><br><span class="line">    <span class="keyword">return</span> oldDelegate != <span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Flow(</span><br><span class="line">  delegate: TestFlowDelegate(),</span><br><span class="line">  children: <span class="built_in">List</span>.generate(<span class="number">9</span>, (index) &#123;</span><br><span class="line">      <span class="keyword">return</span> Container(width: <span class="number">80.0</span>, height: <span class="number">80.0</span>, color: Colors.red[index * <span class="number">100</span>]);</span><br><span class="line">  &#125;).toList(),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="å å±‚å¸ƒå±€"><a href="#å å±‚å¸ƒå±€" class="headerlink" title="å å±‚å¸ƒå±€"></a>å å±‚å¸ƒå±€</h3><p>Stack ç»“åˆ Positioned è¿›è¡Œå å±‚å¸ƒå±€ï¼Œå’Œ css ä¸­çš„ç»å¯¹å®šä½ç±»ä¼¼ã€‚Positioned ç»„ä»¶é€šè¿‡ leftï¼Œtop ï¼Œrightï¼Œbottom å››ä¸ªæ–¹å‘ä¸Šçš„å±æ€§å€¼æ¥å†³å®šå…¶åœ¨ Stack ä¸­çš„ä½ç½®ã€‚</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">Stack(</span><br><span class="line">    children: &lt;Widget&gt;[</span><br><span class="line">        Container(</span><br><span class="line">            child: Text(<span class="string">&quot;Stack&quot;</span>, style: TextStyle(color: Colors.white),</span><br><span class="line">            color: Colors.red,</span><br><span class="line">        ),</span><br><span class="line">        Positioned(</span><br><span class="line">            left: <span class="number">18.0</span>,</span><br><span class="line">            top: <span class="number">80</span>,</span><br><span class="line">            child: Text(<span class="string">&quot;I am Jack&quot;</span>),</span><br><span class="line">        ),</span><br><span class="line">        Positioned(</span><br><span class="line">            right: <span class="number">36.0</span>,</span><br><span class="line">            bottom: <span class="number">200</span>,</span><br><span class="line">            child: Text(<span class="string">&quot;Your friend&quot;</span>),</span><br><span class="line">        )</span><br><span class="line">    ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<h3 id="å¯¹é½å’Œç›¸å¯¹å®šä½"><a href="#å¯¹é½å’Œç›¸å¯¹å®šä½" class="headerlink" title="å¯¹é½å’Œç›¸å¯¹å®šä½"></a>å¯¹é½å’Œç›¸å¯¹å®šä½</h3><p>Align ç»„ä»¶å¯ä»¥è°ƒæ•´å­ç»„ä»¶ä½ç½®ï¼ŒåŒè¿‡ä¸€ä¸ª AlignmentGeometry ç±»å‹çš„å€¼ï¼Œè¡¨ç¤ºå­ç»„ä»¶åœ¨çˆ¶ç»„ä»¶ä¸­çš„èµ·å§‹ä½</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">Container(</span><br><span class="line">  height: <span class="number">120.0</span>,</span><br><span class="line">  width: <span class="number">120.0</span>,</span><br><span class="line">  color: Colors.blue[<span class="number">50</span>],</span><br><span class="line">  child: Align(</span><br><span class="line">    alignment: Alignment.topRight, <span class="comment">//Alignment ä¸€ä¸ªAlignmentGeometryçš„å®ç°ç±»</span></span><br><span class="line">    child: Text(<span class="string">&#x27;topRight&#x27;</span>),</span><br><span class="line">  ),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Alignment å¯¹åº”åæ ‡ç³»,</span><br><span class="line">topRightå¯¹åº”ç€(-1,-1),ä¸­å¿ƒåæ ‡centerå°±æ˜¯(0,0),</span><br><span class="line"></span><br><span class="line">  -1,-1        1,-1</span><br><span class="line">    -------------</span><br><span class="line">    |           |</span><br><span class="line">    |           |</span><br><span class="line">    |    0,0    |</span><br><span class="line">    |           |</span><br><span class="line">    |           |</span><br><span class="line">    -------------</span><br><span class="line">  -1,1          1,1</span><br><span class="line"></span><br><span class="line">è‡ªå®šä¹‰æ—¶å€™å¯¹åº”å…¬å¼  x,y å°±æ˜¯ä¸Šé¢å¯¹åº”åæ ‡å€¼,  childWidth childHeight å®¹å™¨å®½é«˜</span><br><span class="line">(Alignment.x*childWidth/2+childWidth/2, Alignment.y*childHeight/2+childHeight/2)</span><br><span class="line"></span><br><span class="line">Alignment(2,0.0) =&gt;  180,60</span><br></pre></td></tr></table></figure>

<h2 id="å®¹å™¨ç±»å‹"><a href="#å®¹å™¨ç±»å‹" class="headerlink" title="å®¹å™¨ç±»å‹"></a>å®¹å™¨ç±»å‹</h2><h3 id="Container"><a href="#Container" class="headerlink" title="Container"></a>Container</h3><p>Container æ˜¯ä¸€ä¸ªç»„åˆç±»å®¹å™¨çš„ç»„è£…çš„å¤šåŠŸèƒ½å®¹å™¨ã€‚äº†è§£ä¸€ä¸ª Container å…¶ä»–ä¹Ÿå°±å¾ˆæ¸…æ¥šäº†</p>
<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line">Container(&#123;</span><br><span class="line">    Key key,</span><br><span class="line">    <span class="keyword">this</span>.alignment, <span class="comment">//å¯¹é½æ–¹å¼  =&gt;å¯¹åº” Align</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.padding, <span class="comment">// å†…é—´è·ï¼Œæ˜¯ä¸ª EdgeInsetsGeometry æŠ½è±¡ç±»  =&gt;å¯¹åº”  Padding </span></span><br><span class="line">    <span class="comment">// FLutter æä¾›äº†æ˜¯ä¸ª EdgeInsetsGeometry å®ç°ç±» EdgeInsetsï¼Œæä¾›äº†ä¸‹é¢å››ä¸ªæ–¹æ³•</span></span><br><span class="line">    <span class="comment">// fromLTRB(double leftï¼Œ double topï¼Œdouble rightï¼Œ double bottom)ï¼šåˆ†åˆ«æŒ‡å®šå››ä¸ªæ–¹å‘çš„å¡«å……ã€‚</span></span><br><span class="line">    <span class="comment">// all(double value) : æ‰€æœ‰æ–¹å‘å‡ä½¿ç”¨ç›¸åŒæ•°å€¼çš„å¡«å……ã€‚</span></span><br><span class="line">    <span class="comment">// only(&#123;leftï¼Œ topï¼Œ right ï¼Œbottom &#125;)ï¼šå¯ä»¥è®¾ç½®å…·ä½“æŸä¸ªæ–¹å‘çš„å¡«å……(å¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªæ–¹å‘)ã€‚</span></span><br><span class="line">    <span class="comment">// symmetric(&#123; verticalï¼Œ horizontal &#125;)ï¼šç”¨äºè®¾ç½®å¯¹ç§°æ–¹å‘çš„å¡«å……ï¼Œvertical æŒ‡ top å’Œ bottomï¼Œhorizontal æŒ‡ left å’Œ rightã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.color, <span class="comment">//èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="keyword">this</span>.decoration,  <span class="comment">// èƒŒæ™¯è£…é¥°ï¼Œè®¾ç½®äº†decorationï¼Œå¤–é¢çš„colorå±æ€§å°†ä¸å¯ç”¨ï¼Œéœ€è¦åœ¨decorationå†…è®¾ç½®   =&gt;å¯¹åº”  DecoratedBox</span></span><br><span class="line">    <span class="keyword">this</span>.foregroundDecoration,<span class="comment">// å‰æ™¯è£…é¥°</span></span><br><span class="line">    <span class="comment">// DecoratedBox æä¾›çš„æ ·å¼å±æ€§</span></span><br><span class="line">    <span class="comment">// color, //èƒŒæ™¯é¢œè‰²</span></span><br><span class="line">    <span class="comment">// image,//èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line">    <span class="comment">// border, //è¾¹æ¡†</span></span><br><span class="line">    <span class="comment">// borderRadius, //åœ†è§’</span></span><br><span class="line">    <span class="comment">// boxShadow, //é˜´å½±,å¯ä»¥æŒ‡å®šå¤šä¸ª</span></span><br><span class="line">    <span class="comment">// gradient, //æ¸å˜</span></span><br><span class="line">    <span class="comment">// backgroundBlendMode, //èƒŒæ™¯æ··åˆæ¨¡å¼</span></span><br><span class="line">    <span class="comment">// shape //å½¢çŠ¶</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="built_in">double</span> width, <span class="comment">// å®½åº¦</span></span><br><span class="line">    <span class="built_in">double</span> height,<span class="comment">// é«˜åº¦</span></span><br><span class="line">    BoxConstraints constraints, <span class="comment">//è®¾ç½®é™åˆ¶ =&gt;å¯¹åº”  ConstrainedBoxï¼Œä¸å…¶ç›¸åçš„æ˜¯ UnconstrainedBox(å–æ¶ˆé™åˆ¶)</span></span><br><span class="line">    <span class="comment">// ConstrainedBox æä¾›å±æ€§ éƒ½æ˜¯doubleç±»å‹</span></span><br><span class="line">    <span class="comment">// minWidth //æœ€å°å®½åº¦</span></span><br><span class="line">    <span class="comment">// maxWidth //æœ€å¤§å®½åº¦</span></span><br><span class="line">    <span class="comment">// minHeight//æœ€å°é«˜åº¦</span></span><br><span class="line">    <span class="comment">// maxHeight//æœ€å¤§é«˜åº¦</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.margin, <span class="comment">// å¤–é—´è· å’Œpadding ä½¿ç”¨æ–¹å¼ä¸€æ ·</span></span><br><span class="line">    <span class="keyword">this</span>.transform, <span class="comment">//å˜å½¢ éœ€è¦ä¸€ä¸ªMatrix4ç±»,å…·ä½“å¯ä»¥çœ‹Matrix4æºç ,æä¾›äº†å¾ˆå¤šä¸åŒå˜å½¢æ„é€ æ–¹æ³• =&gt;å¯¹åº” Transform </span></span><br><span class="line">    <span class="keyword">this</span>.child,</span><br><span class="line">    <span class="keyword">this</span>.clipBehavior = Clip.none,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="å…¶ä»–å®¹å™¨ç±»"><a href="#å…¶ä»–å®¹å™¨ç±»" class="headerlink" title="å…¶ä»–å®¹å™¨ç±»"></a>å…¶ä»–å®¹å™¨ç±»</h3><ul>
<li>SizedBox å›ºå®šå®½é«˜</li>
<li>AspectRatio å®½é«˜æ¯”</li>
<li>UnconstrainedBox å–æ¶ˆé™åˆ¶</li>
</ul>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
      </tags>
  </entry>
  <entry>
    <title>æ‰“é€ è‡ªå·±çš„Vueç»„ä»¶æ–‡æ¡£ç”Ÿæˆå·¥å…·</title>
    <url>/generate_vue_docs/</url>
    <content><![CDATA[<p>ç¨‹åºå‘˜æœ€è®¨åŒçš„ä¸¤ä»¶äº‹æƒ…ï¼Œç¬¬ä¸€ç§æ˜¯å†™æ–‡æ¡£ï¼Œå¦ä¸€ç§æ˜¯åˆ«äººæ²¡æœ‰å†™æ–‡æ¡£ã€‚æœ‰æ²¡æœ‰ç›´æ¥æ ¹æ® vue ç»„ä»¶ç”Ÿæˆæ–‡æ¡£çš„å‘¢ï¼Ÿå½“ç„¶æ˜¯æœ‰çš„çš„ã€‚ä½†ç¬¬ä¸‰æ–¹ä½¿ç”¨èµ·æ¥ä¸ä¸€å®šèƒ½å’Œç°æœ‰é¡¹ç›®ç»“åˆä½¿ç”¨ï¼Œå¾€å¾€éœ€è¦é¢å¤–çš„æ³¨é‡Šç”¨æ¥æ ‡è®°æå–ä¿¡æ¯ã€‚<span id="more"></span><br>ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„ä¸€äº›æ¯”è¾ƒå¸¸è§é—®é¢˜</p>
<ul>
<li>æ–‡æ¡£æå–ä¿¡æ¯ä¸å…¨é¢ï¼Œå¯èƒ½æœ‰äº›ä¿¡æ¯ä½ éœ€è¦æå–ä½†æ˜¯å®ƒåˆä¸æ”¯æŒã€‚è¿™ç§æƒ…å†µä¸‹å°±åªèƒ½ä¿®æ”¹ä¸‰æ–¹çš„æ’ä»¶æºç äº†ã€‚</li>
<li>éœ€è¦é¢ä¸ºçš„æ³¨é‡Šä¿¡æ¯æ¥æ ‡è®°ï¼Œä¾‹å¦‚ <strong>vuese</strong> éœ€è¦ç»™æ–¹æ³• æ‰“ <strong>@vuese</strong>ã€**@arg** ç­‰æ ‡è®°æ¥æä¾›æ–¹æ³•ä¿¡æ¯ã€‚</li>
</ul>
<p>ä¿—è¯è¯´è‡ªå·±åŠ¨æ‰‹ä¸°è¡£è¶³é£Ÿï¼Œæ‰“é€ è‡ªå·±çš„ vue æ–‡æ¡£ç”Ÿæˆå·¥å…·ä¸è‡ªå·±é¡¹ç›®ç»“åˆä½¿ç”¨ã€‚ä¸€ä¸ªç»„ä»¶æ–‡æ¡£å¤§è‡´éœ€è¦æä¾› <strong>ç»„ä»¶åç§°å’Œæè¿°(name)<strong>ã€</strong>ç»„ä»¶å±æ€§(props)<strong>ã€</strong>ç»„ä»¶æ–¹æ³•(methods)<strong>ã€</strong>ç»„ä»¶äº‹ä»¶(event)<strong>ã€</strong>æ’æ§½(slot)</strong> è¿™å‡ ä¸ªéƒ¨åˆ†ï¼Œä»¥åŠè¿˜éœ€è¦è¿™ä¸ªå‡ ä¸ªéƒ¨åˆ†çš„æ³¨é‡Šç»„æˆç”Ÿæˆæè¿°ä¿¡æ¯ã€‚æ¥ä¸‹æ¥ä¸€æ­¥æ­¥å®ç°å¯¹ç€å‡ ä¸ªéƒ¨åˆ†çš„æå–å®ç°ã€‚</p>
<h2 id="è§£æ-vue-æ–‡ä»¶"><a href="#è§£æ-vue-æ–‡ä»¶" class="headerlink" title="è§£æ.vue æ–‡ä»¶"></a>è§£æ.vue æ–‡ä»¶</h2><p>ä¸€èˆ¬ä¸€ä¸ª .vue æ–‡ä»¶åˆ†ä¸‰ä¸ªéƒ¨åˆ† <strong>template</strong>ã€<strong>script</strong>ã€<strong>style</strong>ã€<strong>style</strong>éƒ¨åˆ†çš„å†…å®¹æˆ‘ä»¬ä¸éœ€è¦ï¼Œæˆ‘ä»¬éœ€è¦åˆ†åˆ«æå–å‡º <strong>template</strong> å’Œ <strong>script</strong> å†…å®¹ã€‚Vueå®˜æ–¹å¼€å‘äº† <strong>Vue-template-compiler</strong> åº“ä¸“é—¨ç”¨äº Vue è§£æï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒæ¥è§£ææå– .vue æ–‡ä»¶ï¼Œ <strong>Vue-template-compiler</strong>  æä¾›äº†ä¸€ä¸ª <strong>parseComponent</strong> æ–¹æ³•å¯ä»¥å¯¹åŸå§‹çš„ Vue æ–‡ä»¶è¿›è¡Œå¤„ç†ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> compiler = <span class="built_in">require</span>(<span class="string">&#x27;vue-template-compiler&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> result = compiler.<span class="title function_">parseComponent</span>(vueStr, [options])</span><br><span class="line"></span><br><span class="line"><span class="comment">// parseComponent è¿”å›  templateã€scriptã€styleå†…å®¹ï¼Œ</span></span><br><span class="line"><span class="keyword">export</span> interface <span class="title class_">SFCDescriptor</span> &#123;</span><br><span class="line">  <span class="attr">template</span>: <span class="title class_">SFCBlock</span> | <span class="literal">undefined</span>;</span><br><span class="line">  <span class="attr">script</span>: <span class="title class_">SFCBlock</span> | <span class="literal">undefined</span>;</span><br><span class="line">  <span class="attr">styles</span>: <span class="title class_">SFCBlock</span>[];</span><br><span class="line">  <span class="attr">customBlocks</span>: <span class="title class_">SFCBlock</span>[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°å„ä¸ªéƒ¨åˆ†æ–‡æœ¬åï¼Œè¿˜éœ€è¦å°†å®ƒè½¬æˆ ast(æŠ½è±¡è¯­æ³•æ ‘)ï¼Œ<strong>template</strong> éƒ¨åˆ†å†…å®¹å¯ä»¥ç›´æ¥ä½¿ç”¨ <strong>Vue-template-compiler</strong> æä¾›çš„ <strong>compile</strong> æ–¹æ³•ç›´æ¥ç”Ÿæˆastï¼Œ <strong>script</strong>éƒ¨åˆ†éœ€è¦å€ŸåŠ©å…¶ä»–çš„ç”Ÿæˆ astäº†ï¼Œè¿™é‡Œä½¿ç”¨ <strong>babel</strong> çš„æ¨¡å—æ¥å¤„ç† js æ–‡æœ¬ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> compiler = <span class="built_in">require</span>(<span class="string">&#x27;vue-template-compiler&#x27;</span>)</span><br><span class="line"><span class="comment">//vueStr .vue æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="keyword">const</span> vue = compiler.<span class="title function_">parseComponent</span>(vueStr)</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿæˆhtmléƒ¨åˆ†çš„ ast </span></span><br><span class="line"><span class="keyword">let</span> template = compiler.<span class="title function_">compile</span>(vue.<span class="property">template</span>.<span class="property">content</span>, &#123;</span><br><span class="line">    <span class="attr">preserveWhitespace</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">comments</span>: <span class="literal">true</span> <span class="comment">// ç”Ÿæˆæ³¨é‡Šä¿¡æ¯</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <strong>@babel&#x2F;parser</strong>ï¼ˆBabelè§£æå™¨,æ˜¯Babelä¸­ä½¿ç”¨çš„JavaScriptè§£æå™¨ï¼‰æ¥å¤„ç† js æ–‡æœ¬å†…å®¹ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> parse = <span class="built_in">require</span>(<span class="string">&#x27;@babel/parser&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç”Ÿæˆjséƒ¨åˆ†çš„ ast</span></span><br><span class="line"><span class="keyword">let</span> jsAst = parse.<span class="title function_">parse</span>(vue.<span class="property">script</span>.<span class="property">content</span>, &#123;</span><br><span class="line">    <span class="attr">allowImportExportEverywhere</span>: <span class="literal">true</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="æå–æ–‡æ¡£ä¿¡æ¯"><a href="#æå–æ–‡æ¡£ä¿¡æ¯" class="headerlink" title="æå–æ–‡æ¡£ä¿¡æ¯"></a>æå–æ–‡æ¡£ä¿¡æ¯</h2><p>é€šè¿‡ä¸Šä¸€æ­¥çš„æ–‡ä»¶è§£æå·¥ä½œï¼Œæˆ‘ä»¬æˆåŠŸè·å–åˆ°äº† Vue çš„æ¨¡æ¿ ast å’Œ script ä¸­çš„ js çš„ astï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬å°±å¯ä»¥ä»ä¸­è·å–æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯äº†ã€‚è¿™é‡Œéœ€è¦ä½¿ç”¨åˆ° <strong>@babel&#x2F;traverse</strong> è¿™ä¸ªå·¥å…·ï¼Œç”¨æ¥éå† js ast çš„èŠ‚ç‚¹å·¥å…·ã€‚å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ <a href="https://astexplorer.net/">ast</a> çš„ç”Ÿæˆå†…å®¹ï¼Œæ–¹ä¾¿æŸ¥çœ‹å„ç§èŠ‚ç‚¹ä¿¡æ¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> traverse = <span class="built_in">require</span>(<span class="string">&#x27;@babel/traverse&#x27;</span>);</span><br><span class="line">traverse.<span class="title function_">default</span>(jsAst, &#123;</span><br><span class="line">  <span class="title function_">enter</span>(<span class="params">path</span>)&#123; <span class="comment">// å¼€å§‹</span></span><br><span class="line"></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// æ”¯æŒè‡ªå®šä¹‰èŠ‚ç‚¹ æ¯”å¦‚å½“èŠ‚ç‚¹ç±»å‹ ä¸º ExportDefaultDeclaration æ—¶æ‰è¿™ä¸ªæ–¹æ³•</span></span><br><span class="line">  <span class="title class_">ExportDefaultDeclaration</span>()&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="æå–ç»„ä»¶åç§°ã€æè¿°ã€propsã€methodsã€model"><a href="#æå–ç»„ä»¶åç§°ã€æè¿°ã€propsã€methodsã€model" class="headerlink" title="æå–ç»„ä»¶åç§°ã€æè¿°ã€propsã€methodsã€model"></a>æå–ç»„ä»¶åç§°ã€æè¿°ã€propsã€methodsã€model</h3><p><strong>export default</strong> ç”Ÿæˆçš„å¯¹åº”èŠ‚ç‚¹ç±»å‹æ˜¯ ExportDefaultDeclarationï¼Œ<strong>declaration</strong> å±æ€§å°±æ˜¯å¯¹åº”çš„ç»„ä»¶çš„ options äº†ï¼Œéå† declaration çš„å±æ€§å¯ä»¥è·å–åˆ° <strong>name</strong>ã€<strong>props</strong>ã€<strong>methods</strong>ã€<strong>model</strong> ç­‰èŠ‚ç‚¹ä¿¡æ¯ã€‚</p>
<p><img src="/images/posts/vue_docs/pic_1627612369570.png" alt="ast" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>AST</em></p>
<p>ç¤ºä¾‹ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> componentInfo = &#123;&#125;</span><br><span class="line">traverse.<span class="title function_">default</span>(jsAst, &#123;</span><br><span class="line">  <span class="title class_">ExportDefaultDeclaration</span>(path)&#123;</span><br><span class="line">    path.<span class="property">node</span>.<span class="property">declaration</span>.<span class="property">properties</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (item.<span class="property">key</span>.<span class="property">name</span>) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;props&#x27;</span>:</span><br><span class="line">                componentInfo.<span class="property">props</span> = <span class="title function_">extractProps</span>(item) <span class="comment">// æå– props</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;methods&#x27;</span>:</span><br><span class="line">                componentInfo.<span class="property">methods</span> = <span class="title function_">extractMethods</span>(item)  <span class="comment">// æå– methods</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;name&#x27;</span>:</span><br><span class="line">                componentInfo.<span class="property">name</span> = item.<span class="property">value</span>.<span class="property">value</span> <span class="comment">// è·å–ç»„ä»¶åç§°</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;model&#x27;</span>:</span><br><span class="line">                componentInfo.<span class="property">model</span> = <span class="title function_">extractModel</span>(item)  <span class="comment">// æå– model</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="attr">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="æå–æè¿°"><a href="#æå–æè¿°" class="headerlink" title="æå–æè¿°"></a>æå–æè¿°</h4><p>js ä¸­æ³¨é‡Šåˆ†ä¸ºå•è¡Œå’Œå¤šè¡Œä¸¤ç§ï¼Œç”Ÿæˆ ast ä¹Ÿä¼šç”Ÿæˆä¸åŒç±»å‹çš„ï¼Œå¯ä»¥çœ‹ä¸‹é¢ä¾‹å­ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/** </span></span><br><span class="line"><span class="comment"> * å¤šè¡Œå¤‡æ³¨</span></span><br><span class="line"><span class="comment"> * ç”¨æ¥ä¸Šä¼ æ–‡æ¡£ä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// å•è¡Œå¤‡æ³¨</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ç»“å°¾æ³¨é‡Š</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ä¼š CommentBlockã€ CommentLine ä¸¤ç§ç±»å‹çš„èŠ‚ç‚¹ï¼Œè¿˜æœ‰å¤´éƒ¨çš„ä¼šæ”¾åœ¨ leadingComments é‡Œï¼Œåº•éƒ¨çš„æ³¨é‡Šåœ¨ trailingComments é‡Œã€‚</p>
<p><img src="/images/posts/vue_docs/pic_1627613208799.png" alt="ast" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>AST</em></p>
<p>ä¸€èˆ¬ä¼šæŠŠç»„ä»¶æè¿°æ³¨é‡Šæ”¾åœ¨ <strong>export default</strong>  ä¸Šé¢ï¼Œç®€å•æå–æ³¨é‡Šä¿¡æ¯</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ExportDefaultDeclaration æ’å…¥å¦‚ä¸‹ä»£ç  </span></span><br><span class="line"><span class="keyword">if</span> (path.<span class="property">node</span>.<span class="property">leadingComments</span>) &#123;</span><br><span class="line">    componentInfo.<span class="property">desc</span> = path.<span class="property">node</span>.<span class="property">leadingComments</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (item.<span class="property">type</span> === <span class="string">&#x27;CommentLine&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> item.<span class="property">value</span>.<span class="title function_">trim</span>()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> item.<span class="property">value</span>.<span class="title function_">split</span>(<span class="string">&#x27;\n&#x27;</span>).<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="title function_">replace</span>(<span class="regexp">/[\s\*]/g</span>, <span class="string">&#x27;&#x27;</span>)).<span class="title function_">filter</span>(<span class="title class_">Boolean</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).<span class="title function_">toString</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æå–-methods"><a href="#æå–-methods" class="headerlink" title="æå– methods"></a>æå– methods</h4><p>å› ä¸º <strong>methods</strong> ä¸­çš„æ³¨é‡Šéœ€è¦é¢å¤–æè¿° å‡ºå‚ã€å…¥å‚ç­‰ä¿¡æ¯éœ€è¦é¢å¤–å¤„ç†ï¼Œjsdoc æ³¨é‡Šè§„èŒƒä½¿ç”¨è¿˜æ˜¯æ¯”è¾ƒå¤§ä¼—çš„ï¼Œè¿™é‡Œæ ¹æ®éœ€è¦è‡ªå·±å®šä¹‰æå–è§„åˆ™ï¼Œè¿˜éœ€è¦æå– <strong>async</strong> ç”¨æ¥æ ‡è¯†æ˜¯å¦æ˜¯å¼‚æ­¥å‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–¹æ³•æè¿°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Bool</span>&#125; type å‚æ•°æè¿°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> è¿”å›å€¼æè¿°</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>

<h4 id="æå–-props"><a href="#æå–-props" class="headerlink" title="æå– props"></a>æå– props</h4><p>props çš„æå–éœ€è¦åŒºåˆ†ä¸‹é¢å‡ ç§æƒ…å†µï¼Œdefault å’Œ validator è¿˜æ˜¯æå–è¿˜æ˜¯æœ‰ç‚¹éº»çƒ¦çš„ï¼Œvalidator æ ¡éªŒè¿˜å¯ä»¥é€šè¿‡æ³¨é‡Šç®€å•æè¿°æ¥æå–ï¼Œä½†æ˜¯ default å°±ä¸å¥½å¤„ç†äº†ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">propA</span>: <span class="title class_">Number</span>, <span class="comment">// åªæœ‰ç±»å‹</span></span><br><span class="line">    <span class="attr">propB</span>: [<span class="title class_">String</span>, <span class="title class_">Number</span>], <span class="comment">// åªæœ‰ç±»å‹ä½†æ˜¯æ”¯æŒå¤šç§</span></span><br><span class="line">    <span class="attr">propC</span>: &#123; </span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">      <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">propD</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">      <span class="attr">default</span>: <span class="number">100</span> <span class="comment">// å¸¦æœ‰é»˜è®¤å€¼ </span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">propE</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Object</span>,</span><br><span class="line">      <span class="keyword">default</span> () &#123; <span class="comment">// é»˜è®¤å€¼ éœ€è¦å‡½æ•°è¿”å›</span></span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&#x27;hello&#x27;</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">propF</span>: &#123;</span><br><span class="line">      <span class="attr">default</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="comment">// é»˜è®¤å€¼ éœ€è¦å‡½æ•°è¿”å› å’Œä¸Šé¢çš„ default çš„ ast èŠ‚ç‚¹ç±»å‹æ˜¯ä¸åŒçš„</span></span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">&#x27;hello&#x27;</span> &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="attr">validator</span>: <span class="keyword">function</span> (<span class="params">value</span>) &#123; <span class="comment">// æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">return</span> [<span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;warning&#x27;</span>, <span class="string">&#x27;danger&#x27;</span>].<span class="title function_">indexOf</span>(value) !== -<span class="number">1</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘è¿™é‡Œå¯¹ default å¤„ç†æ˜¯å€ŸåŠ© <strong>@babel&#x2F;generator</strong> å°† default è½¬æ¢ä»£ç ï¼Œ é€šè¿‡ eval è½¬æˆå‡½æ•°è°ƒç”¨è¿”å›ä¼šé»˜è®¤å€¼ã€‚types æ˜¯ <strong>@babel&#x2F;types</strong> æ¨¡å—ï¼Œç”¨æ¥åˆ¤æ–­èŠ‚ç‚¹ç±»å‹çš„ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·å–Propsé»˜è®¤å€¼</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDefaultVal</span> (node) &#123;</span><br><span class="line">    <span class="keyword">if</span> (types.<span class="title function_">isRegExpLiteral</span>(node) || types.<span class="title function_">isBooleanLiteral</span>(node) || types.<span class="title function_">isNumericLiteral</span>(node) || types.<span class="title function_">isStringLiteral</span>(node)) &#123;</span><br><span class="line">        <span class="keyword">return</span> node.<span class="property">value</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (types.<span class="title function_">isFunctionExpression</span>(node) || types.<span class="title function_">isArrowFunctionExpression</span>(node) || types.<span class="title function_">isObjectMethod</span>(node)) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> code = generate.<span class="title function_">default</span>(types.<span class="title function_">isObjectMethod</span>(node) ? node.<span class="property">body</span> : node).<span class="property">code</span></span><br><span class="line">            <span class="keyword">let</span> fun = <span class="built_in">eval</span>(**<span class="number">0</span>,$&#123;types.<span class="title function_">isObjectMethod</span>(node) ? <span class="string">&#x27;function ()&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125; $&#123;code&#125;**)</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title function_">fun</span>())</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æå–-model"><a href="#æå–-model" class="headerlink" title="æå– model"></a>æå– model</h4><p>è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œç›´æ¥è·å–å°±å¯ä»¥äº†ã€‚</p>
<h3 id="æå–ç»„ä»¶Events"><a href="#æå–ç»„ä»¶Events" class="headerlink" title="æå–ç»„ä»¶Events"></a>æå–ç»„ä»¶Events</h3><p>ç»„ä»¶çš„äº‹ä»¶æ²¡æ³•ç›´æ¥è·å–åˆ°å¯¹åº”èŠ‚ç‚¹ï¼Œåªèƒ½é€šè¿‡ <strong>$emit()</strong> æ–¹æ³•æ¥å®šä½äº‹ä»¶ä½ç½®ï¼Œåœ¨ <strong>traverse</strong> ä¸­å¯ä»¥ä½¿ç”¨ <strong>MemberExpress</strong>(å¤æ‚ç±»å‹èŠ‚ç‚¹)ï¼Œç„¶åé€šè¿‡èŠ‚ç‚¹ä¸Šçš„å±æ€§åæ˜¯å¦æ˜¯ <strong>$emit</strong> åˆ¤æ–­æ˜¯å¦æ˜¯äº‹ä»¶ã€‚</p>
<p><img src="/images/posts/vue_docs/pic_1627615451450.png" alt="$emit" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>äº‹ä»¶ç”Ÿæˆçš„AST</em></p>
<p>å¯ä»¥çœ‹åˆ°äº‹ä»¶åç§°åœ¨ <strong>MemberExpress</strong> çˆ¶çº§ä¸Šçš„ <strong>arguments</strong> é‡Œï¼Œè€Œå¤‡æ³¨åˆ™åœ¨æ›´ä¸Šä¸€å±‚çš„é‡Œã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">extractEvents</span> = (<span class="params">path</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯äº‹ä»¶åç§°</span></span><br><span class="line">    <span class="keyword">const</span> eventName = path.<span class="property">parent</span>.<span class="property">arguments</span>[<span class="number">0</span>]; </span><br><span class="line">    <span class="keyword">let</span> comments = path.<span class="property">parentPath</span>.<span class="property">parent</span>.<span class="property">leadingComments</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">name</span>: eventName.<span class="property">value</span>,</span><br><span class="line">        <span class="attr">desc</span>: comments ? comments.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">value</span>.<span class="title function_">trim</span>()).<span class="title function_">toString</span>() : <span class="string">&#x27;â€”â€”&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">MemberExpression</span> (path) &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯ä¸æ˜¯event</span></span><br><span class="line">    <span class="keyword">if</span> (path.<span class="property">node</span>.<span class="property">property</span>.<span class="property">name</span> === <span class="string">&#x27;$emit&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> event = <span class="title function_">extractEvents</span>(path)</span><br><span class="line">        !componentInfo.<span class="property">events</span> &amp;&amp; (componentInfo.<span class="property">events</span> = &#123;&#125;);</span><br><span class="line">        <span class="keyword">if</span> (componentInfo.<span class="property">events</span>[event.<span class="property">name</span>]) &#123;</span><br><span class="line">            componentInfo.<span class="property">events</span>[event.<span class="property">name</span>].<span class="property">desc</span> = event.<span class="property">desc</span> ? event.<span class="property">desc</span> : componentInfo.<span class="property">events</span>[event.<span class="property">name</span>].<span class="property">desc</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            componentInfo.<span class="property">events</span>[event.<span class="property">name</span>] = event</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æˆåŠŸè·å–åˆ° Events åï¼Œé‚£ä¹ˆç»“åˆ Eventsã€Propsã€Modelï¼Œå°±å¯ä»¥è¿›ä¸€æ­¥çš„åˆ¤æ–­å±æ€§æ˜¯å¦æ”¯æŒ <strong>.sync</strong> å’Œ <strong>v-model</strong>ã€‚</p>
<h3 id="æå–ç»„ä»¶Slots"><a href="#æå–ç»„ä»¶Slots" class="headerlink" title="æå–ç»„ä»¶Slots"></a>æå–ç»„ä»¶Slots</h3><p>é¦–å…ˆéœ€è¦å†™ä¸€ä¸ªå¯¹ Vue æ¨¡æ¿çš„ ast éå†çš„å‡½æ•°ï¼Œ<strong>Vue-template-compiler</strong> æ²¡æœ‰æä¾›ç±»ä¼¼äº <strong>@babel&#x2F;traverse</strong> ç”¨æ¥ éå† ast çš„ã€‚</p>
<p>ç®€å•å®ç°ä¸ªéå†æ¨¡æ¿æŠ½è±¡æ ‘å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">traverserTemplateAst</span> = (<span class="params">ast, visitor = &#123;&#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">traverseArray</span> (array, parent) &#123;</span><br><span class="line">        array.<span class="title function_">forEach</span>(<span class="function"><span class="params">child</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">traverseNode</span>(child, parent);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">traverseNode</span> (node, parent) &#123;</span><br><span class="line">        visitor.<span class="property">enter</span> &amp;&amp; visitor.<span class="title function_">enter</span>(node, parent);</span><br><span class="line">        visitor[node.<span class="property">tag</span>] &amp;&amp; visitor[node.<span class="property">tag</span>](node, parent);</span><br><span class="line">        node.<span class="property">children</span> &amp;&amp; <span class="title function_">traverseArray</span>(node.<span class="property">children</span>, node);</span><br><span class="line">        visitor.<span class="property">exit</span> &amp;&amp; visitor.<span class="title function_">exit</span>(node, parent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">traverseNode</span>(ast, <span class="literal">null</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Vue æ¨¡æ¿çš„ ast çš„ç»“æ„è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼Œæ²¡æœ‰ js ast é‚£ä¹ˆå¤šçš„ç±»å‹ï¼Œåªéœ€è¦åŒºåˆ†ä¸åŒ tag å°±å¯ä»¥äº†ã€‚æ³¨é‡Šä¼šå•ç‹¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ‰€ä»¥åœ¨æŸ¥æ‰¾ slot èŠ‚ç‚¹æ—¶å€™ï¼Œè¿˜éœ€è¦å»æ‰¾å®ƒä¸Šä¸€ä¸ªç›¸é‚»èŠ‚ç‚¹ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯æ³¨é‡Šã€‚</p>
<p><img src="/images/posts/vue_docs/pic_1627623837793.png" alt="slot" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">traverserTemplateAst</span>(template.<span class="property">ast</span>, &#123;</span><br><span class="line">    slot (node, parent) &#123;</span><br><span class="line">        !componentInfo.<span class="property">slots</span> &amp;&amp; (componentInfo.<span class="property">slots</span> = &#123;&#125;)</span><br><span class="line">        <span class="comment">// è·å–èŠ‚ç‚¹ä½ç½®</span></span><br><span class="line">        <span class="keyword">let</span> index = parent.<span class="property">children</span>.<span class="title function_">findIndex</span>(<span class="function"><span class="params">item</span> =&gt;</span> item === node)</span><br><span class="line">        <span class="keyword">let</span> desc = <span class="string">&#x27;æ— æè¿°&#x27;</span>, name = <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (index &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> tag = parent.<span class="property">children</span>[index - <span class="number">1</span>]</span><br><span class="line">            <span class="comment">// isComment åˆ¤æ–­æ˜¯å¦æ˜¯ æ³¨é‡Š</span></span><br><span class="line">            <span class="keyword">if</span> (tag.<span class="property">isComment</span>) &#123;</span><br><span class="line">                desc = tag.<span class="property">text</span>.<span class="title function_">trim</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node.<span class="property">slotName</span>) name = node.<span class="property">attrsMap</span>.<span class="property">name</span></span><br><span class="line">        componentInfo.<span class="property">slots</span>[name] = &#123;</span><br><span class="line">            name,</span><br><span class="line">            desc</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>åˆ°è¿™é‡Œç®€å•çš„å®ç°äº†è‡ªåŠ¨åŒ–ç”Ÿæˆ Vue ç»„ä»¶ä¿¡æ¯äº†ï¼Œå½“ç„¶è¿˜æœ‰å‡ ç§æƒ…å†µè¿˜æ²¡æœ‰è€ƒè™‘è¿›å»ï¼Œä¾‹å¦‚äº‹ä»¶ <strong>$emit</strong> åœ¨ <strong>template</strong> ä¸­ï¼Œ<strong>slot</strong> åœ¨ <strong>render</strong> å‡½æ•°ä¸­æ—¶å€™çš„æƒ…ï¼Œä¸è¿‡æå–è¿™éƒ¨åˆ†å®ç°ä¹Ÿæ˜¯å¤§åŒå°å¼‚çš„äº†ã€‚å¯ä»¥åœ¨ <a href="//github.com/MaLuns/generate-vue-docs">è¿™é‡ŒæŸ¥çœ‹</a> æœ¬æ–‡æºç ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>git ä¸­çš„ stash</title>
    <url>/git_stash/</url>
    <content><![CDATA[<p>å½“ä½  åˆ†æ”¯1 ä¸Šä¿®æ”¹äº†ä¸œè¥¿ï¼Œä½ å‘ç°ä¿®æ”¹é”™äº†åˆ†æ”¯ï¼Œä½ æƒ³å°† åˆ†æ”¯1 ä¸Šçš„ä¿®æ”¹ç§»åˆ° åˆ†æ”¯2 çš„æ—¶å€™ä¼š.äº¦æˆ–è€…ä½ ä¸€åˆ†æ”¯1ä¸Šä¿®æ”¹äº†ä¸€åŠï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦åˆ‡çš„å…¶ä»–åˆ†æ”¯æ”¹å…¶ä»–çš„æ—¶å€™.è¿™ä¸ªæ—¶å€™ stash å°±æ’ä¸Šç”¨åœºäº†ï¼Œstash å‘½ä»¤å¯ç”¨äºä¸´æ—¶ä¿å­˜å’Œå›å¤ä¿®æ”¹ï¼Œå¯è·¨åˆ†æ”¯ã€‚</p>
<span id="more"></span>

<ul>
<li><p>git stash [save message]</p>
<p>  ä¿å­˜ï¼Œsaveä¸ºå¯é€‰é¡¹ï¼Œmessageä¸ºæœ¬æ¬¡ä¿å­˜çš„æ³¨é‡Š</p>
</li>
<li><p>git stash list</p>
<p>  æ‰€æœ‰ä¿å­˜çš„è®°å½•åˆ—è¡¨</p>
</li>
<li><p>git stash pop stash@{num}</p>
<p>  æ¢å¤ï¼Œnumæ˜¯å¯é€‰é¡¹ï¼Œé€šè¿‡git stash listå¯æŸ¥çœ‹å…·ä½“å€¼ã€‚åªèƒ½æ¢å¤ä¸€æ¬¡</p>
</li>
<li><p>git stash apply stash@{num}</p>
<p>  æ¢å¤ï¼Œnumæ˜¯å¯é€‰é¡¹ï¼Œé€šè¿‡git stash listå¯æŸ¥çœ‹å…·ä½“å€¼ã€‚å¯å›å¤å¤šæ¬¡</p>
</li>
<li><p>git stash drop stash@{num}</p>
<p>  åˆ é™¤æŸä¸ªä¿å­˜ï¼Œnumæ˜¯å¯é€‰é¡¹ï¼Œé€šè¿‡git stash listå¯æŸ¥çœ‹å…·ä½“å€¼</p>
</li>
<li><p>git stash clear</p>
<p>  åˆ é™¤æ‰€æœ‰ä¿å­˜</p>
</li>
</ul>
<p>æ›´å¤šç”¨æ³•<a href="//git-scm.com/book/zh/v2/Git-%E5%B7%A5%E5%85%B7-%E8%B4%AE%E8%97%8F%E4%B8%8E%E6%B8%85%E7%90%86">å‚è€ƒ</a>è¿™é‡Œ</p>
<p>ä½¿ç”¨ä¾‹å­<br><img src="/images/posts/git_stash/20200824154456.jpg" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p><img src="/images/posts/git_stash/20200824154701.jpg" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>åˆ©ç”¨ GitHub Actions + Github Pages å®ç°åšå®¢è‡ªåŠ¨éƒ¨ç½²</title>
    <url>/github_action/</url>
    <content><![CDATA[<p>çœ‹çœ‹å®˜æ–¹å¯¹GitHub Actionsçš„ä»‹ç»: GitHub Actions å¸®åŠ©æ‚¨è‡ªåŠ¨å®Œæˆè½¯ä»¶å¼€å‘å‘¨æœŸå†…çš„ä»»åŠ¡ã€‚ GitHub Actions æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œæ„å‘³ç€æ‚¨å¯ä»¥åœ¨æŒ‡å®šäº‹ä»¶å‘ç”Ÿåè¿è¡Œä¸€ç³»åˆ—å‘½ä»¤ã€‚ ä¾‹å¦‚ï¼Œæ¯æ¬¡æœ‰äººä¸ºä»“åº“åˆ›å»ºæ‹‰å–è¯·æ±‚æ—¶ï¼Œæ‚¨éƒ½å¯ä»¥è‡ªåŠ¨è¿è¡Œå‘½ä»¤æ¥æ‰§è¡Œè½¯ä»¶æµ‹è¯•è„šæœ¬ã€‚</p>
<p>ç®€å•çš„è¯´å°±æ˜¯ï¼ŒGitHub æŠŠæŒç»­é›†æˆç³»åˆ—æ“ä½œæ­¥éª¤å«åš actionsã€‚æ¯”å¦‚æŠ“å–ä»£ç ã€è¿è¡Œæµ‹è¯•ã€ç™»å½•è¿œç¨‹æœåŠ¡å™¨ï¼Œå‘å¸ƒåˆ°ç¬¬ä¸‰æ–¹æœåŠ¡ç­‰ç­‰ã€‚å¯ä»¥çœ‹çœ‹å®˜æ–¹çš„ä»‹ç»ï¼Œå¯¹<a href="https://docs.github.com/cn/actions/learn-github-actions/introduction-to-github-actions">GitHub Actions</a>å¿«é€Ÿäº†è§£</p>
<span id="more"></span>

<h2 id="Hexo-é…ç½®"><a href="#Hexo-é…ç½®" class="headerlink" title="Hexo é…ç½®"></a>Hexo é…ç½®</h2><p>Hexo æ­å»ºä½¿ç”¨å¯ä»¥å»å‚çœ‹<a href="https://hexo.io/zh-cn/index.html">hexo æ–‡æ¡£</a>ã€‚</p>
<p>Github Pages æ”¯æŒä¸¤ç§æ¨¡å¼</p>
<ul>
<li>User or organization site: æ–°å»ºä¸€ä¸ª username.github.io çš„ä»“åº“ï¼Œæ¯ä¸ªç”¨æˆ·åªèƒ½å»ºç«‹ä¸€ä¸ªã€‚</li>
<li>Project site: åœ¨å¯¹åº”ä»“åº“ Setting &#x3D;&gt; pages è¿›è¡Œé…ç½®ï¼Œå¦‚æœæœ‰å¤šä¸ªéœ€è¦é…ç½®ç‹¬ç«‹åŸŸåã€‚</li>
</ul>
<p>Github Pages çš„é…ç½®å¯ä»¥<a href="https://pages.github.com/">å‚çœ‹è¿™é‡Œ</a></p>
<p>æˆ‘è¿™é‡Œæ˜¯ä½¿ç”¨ Project site çš„æ­å»º Hexo ç«™ç‚¹çš„ã€‚ä¿®æ”¹ <strong>_config.yml</strong> ä¸‹çš„ deploy æ¨é€ä»“åº“åœ°å€ï¼Œå°†å…¶æ¨é€åˆ° MalBlog&#x2F;gh-pages åˆ†æ”¯ä¸Šå»ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">&#x27;git&#x27;</span></span><br><span class="line">  <span class="attr">repository:</span> </span><br><span class="line">    <span class="attr">github:</span> <span class="string">git@github.com:MaLuns/MalBlog.gitï¼Œgh-pages</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æœ¬åœ°æ‰§è¡Œ <strong>hexo generate</strong> å’Œ <strong>hexo deploy</strong> ç¡®ä¿èƒ½æ­£å¸¸ç”Ÿæˆå’Œå‘å¸ƒã€‚</p>
<h2 id="GitHub-Actions"><a href="#GitHub-Actions" class="headerlink" title="GitHub Actions"></a>GitHub Actions</h2><p>æˆ‘ä»¬å¸Œæœ›å½“æˆ‘ä»¬æŠŠåšå®¢æºç æ¨é€åˆ°å¯¹åº”çš„ä»“åº“åï¼ŒGitHub Actions è‡ªåŠ¨å¸®æˆ‘ä»¬æ‰§è¡Œ <strong>hexo generate</strong>ã€<strong>hexo deploy</strong> çš„ç”Ÿæˆå’Œå‘å¸ƒæ“ä½œï¼Œå®Œæˆåšå®¢çš„è‡ªåŠ¨éƒ¨ç½²ã€‚é¦–å…ˆåœ¨ é¡¹ç›®æ ¹ç›®å½•çš„ .github&#x2F;workflows ä¸‹ æ–°å»ºä¸€ä¸ª main.ymlï¼Œæ¯ä¸€ä¸ª .yml æ–‡ä»¶å°±æ˜¯ä¸€ä¸ª Action ï¼Œ ä¸€ä¸ª Action  ç›¸å½“äºä¸€ä¸ªå·¥ä½œæµ workflowï¼Œä¸€ä¸ªå·¥ä½œæµå¯ä»¥æœ‰å¤šä¸ªä»»åŠ¡ jobï¼Œæ¯ä¸ªä»»åŠ¡å¯ä»¥åˆ†ä¸ºå‡ æ­¥ stepã€‚</p>
<p>ç¬¬ä¸€æ­¥ æˆ‘ä»¬é…ç½®å·¥ä½œæµè§¦å‘çš„æ—¶æœº</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># å·¥ä½œæµåç§°</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Hexo</span> <span class="string">Deploy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å·¥ä½œæµè§¦å‘é…ç½®</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="comment"># å½“masteråˆ†æ”¯æœ‰pushäº‹ä»¶æ—¶ è§¦å‘å·¥ä½œæµ</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">master</span> ]</span><br><span class="line">  <span class="attr">pull_request:</span></span><br><span class="line">    <span class="attr">branches:</span> [ <span class="string">master</span> ]</span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥ é…ç½®å·¥ä½œæµä¸­çš„ job</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">jons:</span></span><br><span class="line">    <span class="comment"># job1</span></span><br><span class="line">    <span class="attr">blog-cicd:</span></span><br><span class="line">        <span class="comment"># ä»»åŠ¡åç§°</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">Hexo</span> <span class="string">blog</span> <span class="string">build</span> <span class="string">&amp;</span> <span class="string">deploy</span></span><br><span class="line">        <span class="comment"># è®¾ç½®ä»»åŠ¡æ‰§è¡Œç¯å¢ƒ</span></span><br><span class="line">        <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span> <span class="comment"># ä½¿ç”¨æœ€æ–°çš„ Ubuntu ç³»ç»Ÿä½œä¸ºç¼–è¯‘éƒ¨ç½²çš„ç¯å¢ƒ</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># jon2 è¿™é‡Œå¯ä»¥é…ç½®å¤šä¸ªjob</span></span><br><span class="line">    <span class="attr">job2:</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸‰æ­¥ å®ç°ä»»åŠ¡æ­¥éª¤ï¼Œ å®ç°è‡ªåŠ¨éƒ¨ç½²å¤§è‡´éœ€è¦å¦‚ä¸‹æ­¥éª¤<br>æ‹‰å–åšå®¢æºç &#x3D;&gt; å®‰è£… Hexo éœ€è¦ç¯å¢ƒ &#x3D;&gt; å®‰è£…æºç ä¾èµ– &#x3D;&gt; æ„å»ºåšå®¢æºç  &#x3D;&gt; æ¨é€æ„å»ºäº§ç‰© </p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">jons:</span></span><br><span class="line">    <span class="attr">blog-cicd:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">Hexo</span> <span class="string">blog</span> <span class="string">build</span> <span class="string">&amp;</span> <span class="string">deploy</span></span><br><span class="line">        <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="comment"># ä½¿ç”¨ checkout@2 æ’ä»¶æ‹‰å–ä»£ç </span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">codes</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span> </span><br><span class="line">      <span class="attr">with:</span> </span><br><span class="line">        <span class="attr">submodules:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä½¿ç”¨ setup-node@v1 è®¾ç½® node.js ç¯å¢ƒ</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Setup</span> <span class="string">node</span></span><br><span class="line">      <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">      <span class="attr">with:</span></span><br><span class="line">        <span class="attr">node-version:</span> <span class="string">&#x27;12.x&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®‰è£… Hexo ä¾èµ–</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">hexo</span> <span class="string">dependencies</span></span><br><span class="line">      <span class="attr">env:</span></span><br><span class="line">        <span class="comment">#è®¾ç½®ç¯å¢ƒå˜é‡ ä»“åº“ç§é’¥ï¼Œ ç”¨æ¥åœ¨æ„å»ºå®Œæˆå æ¨é€åˆ°ä»“åº“</span></span><br><span class="line">        <span class="attr">ACTION_DEPLOY_KEY:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HEXO_DEPLOY_PRI</span> <span class="string">&#125;&#125;</span></span><br><span class="line">      <span class="comment"># è®¾ç½® ssh ç§é’¥ï¼Œ ä¸‹è½½ hexo-cli è„šæ‰‹æ¶åŠç›¸å…³å®‰è£…åŒ…ï¼Œ </span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        mkdir -p ~/.ssh/</span></span><br><span class="line"><span class="string">        echo &quot;$ACTION_DEPLOY_KEY&quot; &gt; ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">        chmod 600 ~/.ssh/id_rsa</span></span><br><span class="line"><span class="string">        ssh-keyscan github.com &gt;&gt; ~/.ssh/known_hosts</span></span><br><span class="line"><span class="string">        git config --global user.email &quot;userEmail&quot;</span></span><br><span class="line"><span class="string">        git config --global user.name &quot;userName&quot;</span></span><br><span class="line"><span class="string">        npm install -g hexo-cli</span></span><br><span class="line"><span class="string">        npm install</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="comment"># æ„å»ºåšå®¢æºç  å¹¶ æ¨é€æ¨é€æ„å»ºäº§ç‰©</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">files</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        hexo clean</span></span><br><span class="line"><span class="string">        hexo generate</span></span><br><span class="line"><span class="string">        hexo deploy</span></span><br></pre></td></tr></table></figure>
<p>Github æ¯ä¸ªä»“åº“éƒ½æ˜¯å¯ä»¥è®¾ç½® <code>Deploy keys</code> çš„ï¼Œ ç”¨æ¥å¯ä»¥æ“ä½œå•ä¸ªä»“åº“çš„ã€‚æˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ª <code>SSH Key</code> ï¼Œå°†å…¬é’¥æ·»åŠ åˆ° Setting &#x3D;&gt; Deploy é‡Œï¼Œ å°†ç§é’¥ Setting &#x3D;&gt; Secrets &#x3D;&gt; Actions é‡Œã€‚è¿™æ ·å°±å¯ä»¥åœ¨ å·¥ä½œæµä¸­ <strong></strong> è·å–åˆ° <code>Secrets</code> é…ç½®å˜é‡ã€‚æˆ‘è¿™é‡Œä½¿ç”¨åç§°æ˜¯ <code>HEXO_DEPLOY_PRI</code> ã€‚</p>
<h2 id="Git-submodule"><a href="#Git-submodule" class="headerlink" title="Git submodule"></a>Git submodule</h2><p>æœ‰æ—¶å€™ä½¿ç”¨äº†ä¸‰æ–¹ä¸»é¢˜ï¼Œéœ€è¦æ›´æ–°æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¸Œæœ›èƒ½å¤Ÿè‡ªåŠ¨æ›´æ–°ä¸Šå»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>Git submodule</code> æ¥ç®¡ç†ä¸»é¢˜ã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git submodule add &lt;ä¸»é¢˜ä»“åº“åœ°å€&gt; &lt;ä¸»é¢˜å­˜æ”¾è·¯å¾„&gt;</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹å·¥ä½œæµé…ç½®ï¼Œåœ¨æ„å»ºå‰å…ˆæ‹‰å–å­æ¨¡å—ä¸­çš„ä¸»é¢˜</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æœ€å¼€å§‹ git submodule update --recursive --remote å»æ‹‰å–ï¼Œå‘ç°ä¸€ç›´æ›´æ–°ä¸åˆ°æœ€æ–°çš„</span></span><br><span class="line"><span class="comment"># ç„¶åä½¿ç”¨ git pull æ‹‰å–å‘ç°æœ‰æ—¶å€™ä¼šå‡ºç°å†²çª... å…·ä½“åŸå› æ²¡æ‰¾åˆ°ï¼Œ æ‰€æœ‰å°±åˆç”¨åˆ é™¤ä¸»é¢˜æ–‡ä»¶ï¼Œé‡æ–° git clone æ‹‰å–æ–¹æ³•</span></span><br><span class="line"><span class="comment"># è¿˜æ˜¯å¯¹å­æ¨¡å—ä¸å¤Ÿäº†è§£</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">         cd ./themes/</span></span><br><span class="line"><span class="string"></span>        <span class="string">rm</span> <span class="string">-r</span> <span class="string">hexo-theme-text</span></span><br><span class="line">        <span class="string">git</span> <span class="string">clone</span> <span class="string">https://github.com/MaLuns/hexo-theme-text.git</span></span><br><span class="line">        <span class="string">cd</span> <span class="string">../../</span></span><br><span class="line">        <span class="string">hexo</span> <span class="string">clean</span></span><br><span class="line">        <span class="string">hexo</span> <span class="string">generate</span></span><br><span class="line">        <span class="string">hexo</span> <span class="string">deploy</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åæ¥å‘ç° git chekout ä¹Ÿå¯ä»¥ç›´æ¥ç”¨</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Generate</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        cd ./themes/hexo-theme-text</span></span><br><span class="line"><span class="string">        git checkout -q master</span></span><br><span class="line"><span class="string">        cd ../../</span></span><br><span class="line"><span class="string">        hexo clean</span></span><br><span class="line"><span class="string">        hexo generate</span></span><br><span class="line"><span class="string">        hexo deploy</span></span><br></pre></td></tr></table></figure>

<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>è¿™æ ·åŸºæœ¬ä¸Šå°±å®ç°äº† Hexo çš„è‡ªåŠ¨éƒ¨ç½²å’Œä¸»é¢˜è‡ªåŠ¨æ›´æ–°äº†ï¼Œ åŠ ä¸Šä½¿ç”¨ <a href="https://github.dev/">github.dev</a> å°±èƒ½å®ç°åªéœ€è¦ä¸€ä¸ªæµè§ˆå™¨å°±èƒ½éšæ—¶éšåœ°çš„å†™äº†ï¼Œ ä¸åœ¨éœ€è¦æœ¬åœ°é…ç½®æ­å»ºç¯å¢ƒå•¦ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello Word</title>
    <url>/helloword/</url>
    <content><![CDATA[<p>æ¬¢è¿ä½¿ç”¨Hexoã€‚è¿™æ˜¯ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„æ¼”ç¤ºæ–‡ç« ã€‚ç¼–è¾‘æˆ–è€…åˆ é™¤å®ƒï¼Œ  ç„¶åå¼€å§‹æ‚¨çš„åšå®¢ï¼</p>
]]></content>
      <categories>
        <category>åˆ›ä½œç±»</category>
      </categories>
      <tags>
        <tag>hello world</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo-theme-async æ–‡æ¡£ä¸Šçº¿äº†ğŸ¤£</title>
    <url>/hexo-theme-async/</url>
    <content><![CDATA[<p><img src="https://hexo-theme-async.imalun.com/imgs/demo2.png" alt="demo" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>é¢„è§ˆå›¾</em></p>
<p>æ—¶éš”å‡ ä¸ªæœˆï¼Œæ‹–æ‹–æ‹‰æ‹‰çš„ç»ˆäºæ•´ç†å¥½äº†ä¸€ä»½ä½¿ç”¨æŒ‡å—ã€‚ä¸‹æ¬¡ç»ˆäºå¯ä»¥ç”©ä¸ªæ–‡æ¡£è¿æ¥äº†ğŸ¤£ï¼Œå†ä¹Ÿä¸ç”¨ä¸€ä¸ªä¸ªè§£é‡Šäº†ã€‚</p>
<span id="more"></span>
<h3 id="æ„Ÿæ…¨"><a href="#æ„Ÿæ…¨" class="headerlink" title="æ„Ÿæ…¨"></a>æ„Ÿæ…¨</h3><ul>
<li><p>éšéšä¾¿ä¾¿åšçš„ä¸€ä¸ªä¸»é¢˜ï¼Œæ²¡æƒ³åˆ°ä¼šæœ‰äººä½¿ç”¨ã€‚ğŸ¤£å› ä¸ºæ²¡æœ‰æ–‡æ¡£ï¼Œæ—¶ä¸æ—¶æœ‰äººä¼šæ¥é—®æ€ä¹ˆä½¿ç”¨ï¼Œæ— å¥ˆåªæœ‰ä¸€ä¸ªä¸ªé‚®ä»¶å›å¤å‘ŠçŸ¥ã€‚ä½“ä¼šåˆ°å¼€æºä¸æ˜“ï¼Œç»´æŠ¤æ›´ä¸æ˜“ğŸ¤£ï¼ˆåœ¨æ­¤å¯¹æ›¾ç»ä½¿ç”¨è¿‡çš„å¼€æºåº“è¡¨ç¤ºæ„Ÿè°¢ï¼‰ã€‚</p>
</li>
<li><p>ä»¥å‰ä¸»é¢˜åŠ è½½é€Ÿåº¦å®åœ¨ä¸å’‹æ»´ğŸ¤£ï¼Œè¿™æ¬¡é¡ºä¾¿å¯¹ä¸»é¢˜åšäº†ä¸€äº›ä¼˜åŒ–ï¼Œç§»é™¤å¯¹ Jq ä¾èµ–ï¼Œæ”¹ä¸ºåŸç”Ÿ JavaScriptã€é‡‡ç”¨ CDN æ–¹å¼åŠ è½½ä¸‰æ–¹æ’ä»¶èµ„æºã€åŠ¨æ€åŠ è½½æ’ä»¶æ–¹å¼æé«˜ç›¸åº”é€Ÿåº¦ã€‚</p>
</li>
</ul>
<p>æœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å‚è€ƒæ–‡æ¡£ä½¿ç”¨ï¼Œé™„èµ ä¸€ä»½è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£ğŸ¤£ã€‚<a href="https://hexo-theme-async.imalun.com/">https://hexo-theme-async.imalun.com</a></p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo-theme-text ä½¿ç”¨è¯´æ˜</title>
    <url>/hexo_theme_text/</url>
    <content><![CDATA[<p>è¿™ä¸ªä¸»é¢˜è¯ç”Ÿçš„åŸå› ä¸»è¦æ˜¯å› ä¸ºé—²çš„ï¼Œæ‰€ä»¥å°±è‡ªå·±åŠ¨æ‰‹å†™äº†è¿™ä¸ªç›¸å¯¹æ¯”è¾ƒæ¸…çˆ½é£æ ¼çš„ä¸»é¢˜ã€‚</p>
<span id="more"></span>

<h2 id="ä¸»é¢˜å®‰è£…"><a href="#ä¸»é¢˜å®‰è£…" class="headerlink" title="ä¸»é¢˜å®‰è£…"></a>ä¸»é¢˜å®‰è£…</h2><p>è¿›å…¥ä¸»é¢˜ç›®å½•åï¼Œå…‹éš†æ­¤ä»“åº“</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd themes</span><br><span class="line">git clone https://github.com/MaLuns/hexo-theme-text</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ <strong>_config.yml</strong> é…ç½®</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">theme:</span> <span class="string">hexo-theme-text</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tab_replace:</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="ä¸»é¢˜é…ç½®æ–‡ä»¶"><a href="#ä¸»é¢˜é…ç½®æ–‡ä»¶" class="headerlink" title="ä¸»é¢˜é…ç½®æ–‡ä»¶"></a>ä¸»é¢˜é…ç½®æ–‡ä»¶</h2><p>ä¸»é¢˜çš„åŠŸèƒ½æ¯”è¾ƒç®€çº¦ï¼Œæ‰€ä»¥é…ç½®æ–‡ä»¶ä¹Ÿä¸æ˜¯å¾ˆå¤šã€‚å¦‚æœéœ€è¦ä½¿ç”¨æ–‡ç« å­—æ•°ç»Ÿè®¡å’Œ rss éœ€è¦å®‰è£…ä¸‹é¢ä¸¤ä¸ªæ’ä»¶ <strong>hexo-generator-feed</strong>ã€<strong>hexo-wordcount</strong>ã€‚</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ç«™ç‚¹ä¿¡æ¯ </span></span><br><span class="line"><span class="attr">user:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">ç™½äº‘è‹ç‹—</span> <span class="comment">#åšä¸»åç§°</span></span><br><span class="line">  <span class="attr">domain:</span> <span class="string">https://www.imalun.com</span> <span class="comment">#ç«™ç‚¹åŸŸå</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">https://www.imalun.com/images/avatar.jpg</span> <span class="comment">#ç«™ç‚¹å¤´åƒ</span></span><br><span class="line">  <span class="attr">desc:</span> <span class="string">é†’ï¼Œäº¦åœ¨äººé—´ï¼›æ¢¦ï¼Œäº¦åœ¨äººé—´ã€‚</span> <span class="comment">#ç«™ç‚¹æè¿°</span></span><br><span class="line">  <span class="attr">birthDay:</span> <span class="number">11</span><span class="string">/19/2019</span> <span class="number">17</span><span class="string">:00:00</span> <span class="comment">#è®¡æ—¶å¼€å§‹æ—¶é—´</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç«™ç‚¹å›¾æ ‡å’Œæ ‡é¢˜åˆ‡æ¢ä¿¡æ¯</span></span><br><span class="line"><span class="attr">favicon:</span></span><br><span class="line">  <span class="attr">visibilitychange:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">narmal:</span> <span class="string">/images/favicon.png</span> <span class="comment">#æ¿€æ´»æ ‡ç­¾å›¾æ ‡</span></span><br><span class="line">  <span class="attr">hidden:</span> <span class="string">/images/failure.png</span> <span class="comment">#æœªæ¿€æ´»æ ‡ç­¾å›¾æ ‡</span></span><br><span class="line">  <span class="attr">show_text:</span> <span class="string">(/â‰§â–½â‰¦/)å’¦ï¼åˆå¥½äº†ï¼</span> <span class="comment">#æ¿€æ´»æ ‡ç­¾æ ‡é¢˜</span></span><br><span class="line">  <span class="attr">hide_text:</span> <span class="string">(â—â€”â—)å–”å“Ÿï¼Œå´©æºƒå•¦ï¼</span> <span class="comment">#æœªæ¿€æ´»æ ‡ç­¾æ ‡é¢˜</span></span><br><span class="line">  <span class="attr">apple_touch_icon:</span> <span class="string">/images/apple-touch-icon-next.png</span></span><br><span class="line">  <span class="attr">safari_pinned_tab:</span> <span class="string">/images/logo.svg</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–‡ç« ç»Ÿè®¡</span></span><br><span class="line"><span class="attr">post_wordcount:</span></span><br><span class="line">  <span class="attr">wordcount:</span> <span class="literal">true</span> <span class="comment"># å•ç¯‡ å­—æ•°ç»Ÿè®¡</span></span><br><span class="line">  <span class="attr">min2read:</span> <span class="literal">true</span> <span class="comment"># å•ç¯‡ é˜…è¯»æ—¶é•¿</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¼€å¯ Service Worker </span></span><br><span class="line"><span class="attr">sw:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¼€å¯æ–‡ç« ç›®å½•</span></span><br><span class="line"><span class="attr">isToc:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">canonical:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># rss</span></span><br><span class="line"><span class="attr">rss:</span> <span class="string">atom.xml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¡¶éƒ¨èœå•é…ç½®</span></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="attr">nav:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">ç™½äº‘è‹ç‹—</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">/</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">ARCHIVES</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">/archives</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">LINKS</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">/links</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">COMMENTS</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">/comment</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">ABOUT</span></span><br><span class="line">      <span class="attr">url:</span> <span class="string">/about</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å¼€å¯ Service Worker ç¼“å­˜ï¼Œå¹¶ä¸”æƒ³ä½¿ç”¨ <strong>PWA</strong> æ—¶éœ€è¦è‡ªè¡Œæ·»åŠ  <strong>manifest.json</strong> æ–‡ä»¶ï¼Œé…ç½®ç«™ç‚¹è¢«å®‰è£…çš„å›¾æ ‡ç­‰ä¿¡æ¯ã€‚<a href="https://developer.mozilla.org/zh-CN/docs/Web/Progressive_web_apps">äº†è§£æ›´å¤šPWAä¿¡æ¯</a></p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æˆ‘çš„ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç™½äº‘è‹ç‹—&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;short_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç™½äº‘è‹ç‹—&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;icons&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/logo-192x192.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;192x192&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;src&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/logo-256x256.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sizes&quot;</span><span class="punctuation">:</span> <span class="string">&quot;256x256&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/png&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;theme_color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#fff&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;background_color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#fff&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;display&quot;</span><span class="punctuation">:</span> <span class="string">&quot;standalone&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;start_url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>


<h2 id="ä¿®æ”¹ä¸»é¢˜é…è‰²"><a href="#ä¿®æ”¹ä¸»é¢˜é…è‰²" class="headerlink" title="ä¿®æ”¹ä¸»é¢˜é…è‰²"></a>ä¿®æ”¹ä¸»é¢˜é…è‰²</h2><p>å¦‚æœä½ éœ€è¦ä¿®æ”¹ä¸»é¢˜è‰²ï¼Œä½ åªéœ€è¦æ‰¾åˆ° <strong>source&#x2F;css&#x2F;var.less</strong> æ–‡ä»¶ï¼Œæ‰€æœ‰çš„ä¸»é¢˜é…è‰²éƒ½åœ¨è¿™é‡Œäº†ï¼Œ <strong>.dark</strong> ä¸‹æ˜¯æš—é»‘æ¨¡å¼ä¸‹çš„é¢œè‰²ã€‚</p>
<figure class="highlight less"><table><tr><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attr">--transitionTime</span>   : .35s ease; <span class="comment">// è¿‡æ¸¡æ—¶é—´</span></span><br><span class="line">    <span class="attr">--hColor</span>           : #000; <span class="comment">// ä¸»è¦å­—ä½“è‰²</span></span><br><span class="line">    <span class="attr">--metaColor</span>        : #5c5c5c; <span class="comment">// æ¬¡è¦ä¿¡æ¯é¢œè‰²</span></span><br><span class="line">    <span class="attr">--bodyBgColor</span>      : #f2f3f0; <span class="comment">// ä¸»é¢˜èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="attr">--headBgColor</span>      : #fff; <span class="comment">// å¤´éƒ¨èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="attr">--markHeadBgColor</span>  : #eee; <span class="comment">// åŠ¨ç”»åˆ‡æ¢é®ç½©è‰²</span></span><br><span class="line">    <span class="attr">--markBgColor</span>      : #252525; <span class="comment">// åŠ¨ç”»åˆ‡æ¢é®ç½©è‰²</span></span><br><span class="line">    <span class="attr">--commentColor</span>     : #525f7f; <span class="comment">// è¯„è®ºç»„å»ºä¸»é¢˜è‰²</span></span><br><span class="line">    <span class="attr">--dashedBorderColor</span>: #c5c5c5; <span class="comment">// åˆ†å‰²è¾¹æ¡†è‰²</span></span><br><span class="line">    <span class="attr">--postLinkColor</span>    : #bb996d; <span class="comment">// æ–‡ç« ä¸­è¶…é“¾æ¥</span></span><br><span class="line">    <span class="attr">--nprogressColor</span>   : #bb996d; <span class="comment">// åŠ è½½è¿›åº¦æ¡è‰²</span></span><br><span class="line">    <span class="attr">--linkItemBgColor</span>  : #f9f9f9; <span class="comment">// å‹é“¾èƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="attr">--linkItemBgColor2</span> : #fff; <span class="comment">// å‹é“¾hoverèƒŒæ™¯è‰²</span></span><br><span class="line">    <span class="attr">--ngBarBgColor</span>     : #ca8b58; <span class="comment">// åŠ è½½è¿›åº¦æ¡é¢œè‰²</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">&amp;</span><span class="selector-class">.dark</span> &#123;</span><br><span class="line">        <span class="attr">--hColor</span>         : #f2f3f0;</span><br><span class="line">        <span class="attr">--metaColor</span>      : #e6e6e6;</span><br><span class="line">        <span class="attr">--bodyBgColor</span>    : #252525;</span><br><span class="line">        <span class="attr">--headBgColor</span>    : #1d1d1d;</span><br><span class="line">        <span class="attr">--markHeadBgColor</span>: #353535;</span><br><span class="line">        <span class="attr">--markBgColor</span>    : #f2f3f0;</span><br><span class="line">        <span class="attr">--commentColor</span>   : #becae7; </span><br><span class="line">        <span class="attr">--nprogressColor</span> : #fff3e5;</span><br><span class="line">        <span class="attr">--linkItemBgColor</span>  : #353535; </span><br><span class="line">        <span class="attr">--linkItemBgColor2</span> : #000; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¤šè¯­è¨€é…ç½®"><a href="#å¤šè¯­è¨€é…ç½®" class="headerlink" title="å¤šè¯­è¨€é…ç½®"></a>å¤šè¯­è¨€é…ç½®</h2><p>åœ¨ languages æ–‡ä»¶å¤¹é‡Œé»˜è®¤åªæœ‰ä¸€ä¸ª <strong>zh-cn.yml</strong> ä¸­æ–‡æ–‡ä»¶é…ç½®ï¼Œå¦‚æœéœ€è¦å…¶ä»–è¯­è¨€éœ€è¦è‡ªè¡Œæ·»åŠ å³å¯ã€‚</p>
<h2 id="è¯„è®ºç³»ç»Ÿ"><a href="#è¯„è®ºç³»ç»Ÿ" class="headerlink" title="è¯„è®ºç³»ç»Ÿ"></a>è¯„è®ºç³»ç»Ÿ</h2><p>æœ¬äººé»˜è®¤æ˜¯ä½¿ç”¨è…¾è®¯çš„äº‘å¼€å‘çš„è¯„è®ºç³»ç»Ÿï¼Œæ‰€ä»¥ä¸»é¢˜é»˜è®¤æ˜¯æ²¡è¯„è®ºç³»ç»Ÿçš„ã€‚ä¸è¿‡ä½ å¯ä»¥é›†æˆå…¶ä»–çš„ç¬¬ä¸‰æ–¹è¯„è®ºæ’ä»¶ï¼Œä½ åªéœ€è¦åœ¨ <strong>themes&#x2F;hexo-theme-text&#x2F;layout&#x2F;components&#x2F;comment.ejs</strong> é‡Œæ·»åŠ ç¬¬ä¸‰æ–¹è¯„è®ºæ’ä»¶ä»£ç ï¼Œ**_config.yml** æ·»åŠ å¯¹åº”çš„é…ç½®ï¼Œä½ å°±å¯ä»¥åœ¨ä½ çš„åšå®¢é‡Œä½¿ç”¨è¯„è®ºå•¦ã€‚</p>
<h2 id="å†™åœ¨æœ€å"><a href="#å†™åœ¨æœ€å" class="headerlink" title="å†™åœ¨æœ€å"></a>å†™åœ¨æœ€å</h2><p>æœ¬é¡¹ç›®é‡‡ç”¨ MIT å¼€æºè®¸å¯è¯ï¼Œæ¬¢è¿å¤§å®¶è´¡çŒ®ï¼Œä½ å¯ä»¥éšæ„æ‰“å¼€ä¸€ä¸ª issue æ¥è¿›è¡Œæé—®ï¼Œæœ‰ä»»ä½•æ”¹è¿›æƒ³æ³•éƒ½å¯ä»¥è¿›è¡Œ forkï¼Œç­‰å¾…æ‚¨çš„ Pull Requestã€‚</p>
]]></content>
      <categories>
        <category>åˆ›ä½œç±»</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScriptä¸­çš„ [[prototype]]ã€prototypeã€__proto__ å…³ç³»</title>
    <url>/js_prototype/</url>
    <content><![CDATA[<p>è¯´åˆ° prototypeã€__proto__ é¦–å…ˆå°±å¾—å»ç†è§£ JavaScript è¯­è¨€çš„ç»§æ‰¿æœºåˆ¶ã€‚åœ¨å…¸å‹çš„é¢å‘å¯¹è±¡çš„è¯­è¨€ä¸­ï¼Œå¦‚C#ï¼Œéƒ½å­˜åœ¨ç±»ï¼ˆclassï¼‰çš„æ¦‚å¿µï¼Œ ç±»å°±æ˜¯å¯¹è±¡çš„æ¨¡æ¿ï¼Œå¯¹è±¡å°±æ˜¯ç±»çš„å®ä¾‹ã€‚C# ä¸­çš„ ç»§æ‰¿å…è®¸æˆ‘ä»¬æ ¹æ®ä¸€ä¸ªç±»æ¥å®šä¹‰å¦ä¸€ä¸ªç±»ï¼Œè¿™ä½¿å¾—åˆ›å»ºå’Œç»´æŠ¤åº”ç”¨ç¨‹åºå˜å¾—æ›´å®¹æ˜“ã€‚åŒæ—¶ä¹Ÿæœ‰åˆ©äºé‡ç”¨ä»£ç å’ŒèŠ‚çœå¼€å‘æ—¶é—´ã€‚åœ¨ JavaScript æ˜¯ä¸å­˜åœ¨ ç±» å’Œ å­ç±» æ¦‚å¿µçš„ï¼Œå…¨é åŸå‹é“¾çš„æ¨¡å¼æ¥å®ç°ç»§æ‰¿ (åé¢å‡º class åœ¨è¿™åŸºç¡€ä¸Šçš„è¯­æ³•ç³–)ã€‚</p>
<span id="more"></span>

<p>è¿™é‡Œä¸¾ä¸€ä¸ªç®€å• C# ç±»å’Œç»§æ‰¿ä¾‹å­ï¼Œä¸€ç±» Peopleï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª Say æ–¹æ³•ã€‚å¦å¤–ä¸¤ä¸ªç±» Man å’Œ Woman éƒ½ç»§æ‰¿ People è¿™ä¸ªç±»ï¼Œè¿™æ ·è¿™ä¸¤ä¸ªå­ç±»éƒ½æ‹¥æœ‰äº†çˆ¶ç±»çš„ Say æ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„ç»§æ‰¿ã€‚</p>
<figure class="highlight c#"><table><tr><td class="code"><pre><span class="line"><span class="comment">//C# Code</span></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ConsoleApp</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Man man = <span class="keyword">new</span> Man();</span><br><span class="line">            man.Work();</span><br><span class="line">            man.Say(<span class="string">&quot;ç´¯æ­»çˆ·äº†&quot;</span>);</span><br><span class="line"></span><br><span class="line">            Woman woman = <span class="keyword">new</span> Woman();</span><br><span class="line">            woman.Shop();</span><br><span class="line">            woman.Say(<span class="string">&quot;èŠ±é’±çœŸçˆ½&quot;</span>);</span><br><span class="line"></span><br><span class="line">            Console.Read();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">People</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">People</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Say</span>(<span class="params"><span class="built_in">string</span> text</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(text);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Man</span> : <span class="title">People</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Work</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;å·¥ä½œå·¥ä½œ.....èµšé’±èµšé’±...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title">Woman</span> : <span class="title">People</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Shop</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;ä¹°ä¹°ä¹°.....&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="prototype-çš„ç”±æ¥"><a href="#prototype-çš„ç”±æ¥" class="headerlink" title="prototype çš„ç”±æ¥"></a>prototype çš„ç”±æ¥</h1><p>å½“åˆ JavaScript ä¹‹çˆ¶åœ¨å¼€å‘ JavaScript çš„æ—¶å€™ï¼Œè§‰å¾—æ²¡æœ‰å¿…è¦åšçš„å¾ˆå¤æ‚ï¼Œåªéœ€è¦åšäº›ç®€å•æ“ä½œå°±å¯ä»¥äº†ï¼Œæ‰€ä»¥æ²¡æœ‰å¼•å…¥ç±»çš„æ¦‚å¿µã€‚<br>åœ¨ JavaScript ä¸­ä¹Ÿæ˜¯é€šè¿‡ new ç”Ÿæˆä¸€ä¸ªå¯¹è±¡å®ä¾‹çš„ï¼Œä¾‹å¦‚åœ¨ C# ä¸­ç”Ÿæˆä¸€ä¸ªå¯¹è±¡å®ä¾‹ä¼šè¿™æ ·å†™ new People()ï¼Œä¼šè°ƒç”¨ç±»çš„æ„é€ å‡½æ•°ã€‚åœ¨ JavaScript ç®€åŒ–äº†è¿™ä¸ªæ“ä½œï¼Œnew åé¢è·Ÿçš„ä¸æ˜¯ç±»ï¼Œè€Œæ˜¯æ„é€ å‡½æ•°ã€‚<br>ç”¨ JavaScript æ¥å®ç°ä¸Šé¢ C# ä¾‹å­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> people = &#123;</span><br><span class="line">    <span class="title class_">Say</span>:<span class="keyword">function</span>(<span class="params">text</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(text)</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Man</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">Work</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å·¥ä½œå·¥ä½œ.....èµšé’±èµšé’±...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">Say</span>=people.<span class="property">Say</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Woman</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">Shop</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¹°ä¹°ä¹°.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">Say</span>=people.<span class="property">Say</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> man = <span class="keyword">new</span> <span class="title class_">Man</span>();</span><br><span class="line">man.<span class="title class_">Work</span>();</span><br><span class="line">man.<span class="title class_">Say</span>(<span class="string">&quot;ç´¯æ­»çˆ·äº†&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> woman = <span class="keyword">new</span> <span class="title class_">Woman</span>();</span><br><span class="line">woman.<span class="title class_">Shop</span>();</span><br><span class="line">woman.<span class="title class_">Say</span>(<span class="string">&quot;èŠ±é’±çœŸçˆ½&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ç”¨æ„é€ å‡½æ•°ç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼Œæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œé‚£å°±æ˜¯æ— æ³•å…±äº«å±æ€§å’Œæ–¹æ³•ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">people.<span class="property">Say</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;...&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">man.<span class="title class_">Say</span>(<span class="string">&quot;ç´¯æ­»çˆ·äº†&quot;</span>); <span class="comment">//ç´¯æ­»çˆ·äº†</span></span><br><span class="line">woman.<span class="title class_">Say</span>(<span class="string">&quot;èŠ±é’±çœŸçˆ½&quot;</span>);<span class="comment">//èŠ±é’±çœŸçˆ½</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> man2=<span class="keyword">new</span> <span class="title class_">Man</span>();</span><br><span class="line">man2.<span class="title class_">Say</span>();<span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">man.<span class="property">Say</span>=<span class="literal">null</span>;</span><br><span class="line">woman.<span class="title class_">Say</span>(<span class="string">&quot;èŠ±é’±çœŸçˆ½&quot;</span>);<span class="comment">//èŠ±é’±çœŸçˆ½</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™é‡Œå³ä½¿ä¿®æ”¹äº† people.Say ä¹Ÿä¸ä¼šå¯¹ä»¥ç”Ÿæˆå®ä¾‹æœ‰å½±å“,ä¿®æ”¹ä¸€ä¸ªä¹Ÿä¸ä¼šå¯¹å¦ä¸€ä¸ªæœ‰å½±å“,æ¯ä¸ªå®ä¾‹éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„</span></span><br></pre></td></tr></table></figure>

<p>æ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œéƒ½æœ‰è‡ªå·±çš„å±æ€§å’Œæ–¹æ³•çš„å‰¯æœ¬ã€‚è¿™ä¸ä»…æ— æ³•åšåˆ°æ•°æ®å…±äº«ï¼Œä¹Ÿæ˜¯æå¤§çš„èµ„æºæµªè´¹ã€‚äºæ˜¯ JavaScript ä¹‹çˆ¶ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å°±åœ¨æ„é€ å‡½æ•°åŠ å…¥äº†ä¸ª prototype å±æ€§ã€‚è¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡(å¸¸ç§° åŸå‹å¯¹è±¡)ï¼ŒæŠŠä¸€äº›å…¬ç”¨çš„å±æ€§å’Œæ–¹æ³•éƒ½æ”¾åœ¨è¿™ä¸ªå¯¹è±¡é‡Œï¼Œä¸€äº›æ˜¯ç§æœ‰çš„å°±æ”¾åœ¨æ„é€ å‡½æ•°é‡Œã€‚</p>
<p>å®ä¾‹å¯¹è±¡è¢«åˆ›å»ºæ—¶å€™ï¼Œä¼šè‡ªåŠ¨å¼•ç”¨åŸå‹å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™æ ·å®ä¾‹å¯¹è±¡å±æ€§å°±åˆ†ä¸ºä¸¤ç§äº†ï¼Œä¸€ç§æ˜¯æ„é€ å‡½æ•°é‡Œç§æœ‰è‡ªå·±çš„ï¼Œå¦ä¸€ç§åˆ™æ˜¯æ¥ç€å¼•ç”¨ åŸå‹å¯¹è±¡ã€‚ä¸€æ—¦åŸå‹å¯¹è±¡å±æ€§å’Œæ–¹æ³•ä¿®æ”¹åï¼Œå®ä¾‹çš„å¯¹è±¡ä¹Ÿä¼šè·Ÿç€å˜åŒ–ã€‚åŸå‹å¯¹è±¡ ä¸ä»…å…±äº«äº†æ•°æ®ï¼Œä¹Ÿå‡å°‘äº†å¯¹èµ„æºçš„å ç”¨ã€‚</p>
<p>é‚£ä¹ˆç”¨ JS æ¥å®ç°ä¸Šé¢ C# ä¾‹å­å°±å¯ä»¥è¿™æ ·å†™</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> people = &#123;</span><br><span class="line">    <span class="title class_">Say</span>:<span class="keyword">function</span>(<span class="params">text</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(text)</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Man</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">Work</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;å·¥ä½œå·¥ä½œ.....èµšé’±èµšé’±...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Man</span>.<span class="property"><span class="keyword">prototype</span></span> = people;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Woman</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">Shop</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ä¹°ä¹°ä¹°.....&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Woman</span>.<span class="property"><span class="keyword">prototype</span></span> = people;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> man = <span class="keyword">new</span> <span class="title class_">Man</span>();</span><br><span class="line">man.<span class="title class_">Work</span>();</span><br><span class="line">man.<span class="title class_">Say</span>(<span class="string">&quot;ç´¯æ­»çˆ·äº†&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> woman = <span class="keyword">new</span> <span class="title class_">Woman</span>();</span><br><span class="line">woman.<span class="title class_">Shop</span>();</span><br><span class="line">woman.<span class="title class_">Say</span>(<span class="string">&quot;èŠ±é’±çœŸçˆ½&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿™ä¸ªæ—¶å€™åŠ å…¥ä¸ª people åœ¨åŠ å…¥ä¸ª eat æ–¹æ³•, man å’Œ woman å®ä¾‹å¯¹è±¡ä¹Ÿæ˜¯å¯ä»¥ä½¿ç”¨çš„</span></span><br><span class="line">people.<span class="property">Eat</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;åƒåƒåƒ.....&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">man.<span class="title class_">Eat</span>();</span><br><span class="line">woman.<span class="title class_">Eat</span>();</span><br></pre></td></tr></table></figure>

<h1 id="prototype-å’Œ-proto-å’Œ-prototype-å…³ç³»"><a href="#prototype-å’Œ-proto-å’Œ-prototype-å…³ç³»" class="headerlink" title="prototype å’Œ __proto__ å’Œ  [[prototype]] å…³ç³»"></a>prototype å’Œ __proto__ å’Œ  [[prototype]] å…³ç³»</h1><p>JavaScript ä¸­ä»»æ„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå†…ç½®å±æ€§[[prototype]]ï¼Œåœ¨ ES5 ä¹‹å‰æ²¡æœ‰æ ‡å‡†çš„æ–¹æ³•è®¿é—®è¿™ä¸ªå†…ç½®å±æ€§ï¼Œä½†æ˜¯å¤§å¤šæ•°æµè§ˆå™¨éƒ½æ”¯æŒé€šè¿‡ __proto__ æ¥è®¿é—®,</p>
<p>prototype å’Œ __proto__ å…³ç³»</p>
<p><img src="/e83bca5f1d1e6bf359d1f75727968c11_720w.jpg" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<blockquote>
<p>JavaScript åªæœ‰ä¸€ç§ç»“æ„ï¼šå¯¹è±¡ã€‚æ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆ object ï¼‰éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆç§°ä¹‹ä¸º __proto__ ï¼‰æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆ prototype ï¼‰ã€‚è¯¥åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„åŸå‹å¯¹è±¡( __proto__ ) ï¼Œå±‚å±‚å‘ä¸Šç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸º nullã€‚æ ¹æ®å®šä¹‰ï¼Œnull æ²¡æœ‰åŸå‹ï¼Œå¹¶ä½œä¸ºè¿™ä¸ªåŸå‹é“¾ä¸­çš„æœ€åä¸€ä¸ªç¯èŠ‚ã€‚å‡ ä¹æ‰€æœ‰ JavaScript ä¸­çš„å¯¹è±¡éƒ½æ˜¯ä½äºåŸå‹é“¾é¡¶ç«¯çš„ Object çš„å®ä¾‹ã€‚</p>
</blockquote>
<p>çœ‹æ–‡å­—å¯èƒ½ä¼šæœ‰ç‚¹è’™,ç”¨ä¸Šé¢ä¾‹å­æ¥ä¸¾ä¾‹è¯´æ˜ä¸‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> people = &#123;</span><br><span class="line">    <span class="title class_">Say</span>:<span class="keyword">function</span>(<span class="params">text</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(text)</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Man</span>(<span class="params"></span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Man</span>.<span class="property"><span class="keyword">prototype</span></span> = people;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> man = <span class="keyword">new</span> <span class="title class_">Man</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* man æ˜¯æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡æ˜¯  Man.prototyp</span></span><br><span class="line"><span class="comment">   æ‰€ä»¥ man.__proto__ === Man.prototype */</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(man.<span class="property">__proto__</span> === <span class="title class_">Man</span>.<span class="property"><span class="keyword">prototype</span></span> &amp;&amp; man.<span class="property">__proto__</span>  === people) <span class="comment">//true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* Man æ„é€ å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡,ä¹Ÿæœ‰è‡ªå·±çš„ __proto__ å±æ€§</span></span><br><span class="line"><span class="comment">  è€Œå‡½æ•° Man æ˜¯ç”± Function æ„é€ çš„ */</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Man</span>.<span class="property">__proto__</span> === <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Function å¯¹è±¡ä¹Ÿæœ‰è‡ªå·±çš„ __proto__ å±æ€§</span></span><br><span class="line"><span class="comment">   Function æ˜¯ç”± Functionè‡ªå·±å®ä¾‹æ¥çš„ */</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Function</span>.<span class="property">__proto__</span> === <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Object å’Œ  Function åŒç†*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property">__proto__</span> === <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property">__proto__</span> === <span class="title class_">Function</span>.<span class="property">__proto__</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Function çš„ åŸå‹å¯¹è±¡ ä¹Ÿæœ‰è‡ªå·±çš„ __proto__</span></span><br><span class="line"><span class="comment">   Function çš„ åŸå‹å¯¹è±¡ æ˜¯ç”± Object æ¥çš„*/</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Object çš„ åŸå‹å¯¹è±¡ åœ¨æœ€é¡¶å±‚ æ‰€ä»¥ä»–çš„ __proto__ ä¸º null */</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">__proto__</span> === <span class="literal">null</span>)</span><br></pre></td></tr></table></figure>


]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue2.x å“åº”å¼éƒ¨åˆ†æºç é˜…è¯»è®°å½•</title>
    <url>/js_vue/</url>
    <content><![CDATA[<p>ä¹‹å‰ä¹Ÿç”¨äº†ä¸€æ®µæ—¶é—´ Vueï¼Œå¯¹å…¶ç”¨æ³•ä¹Ÿè¾ƒä¸ºç†Ÿç»ƒäº†ï¼Œä½†æ˜¯å¯¹å„ç§ç”¨æ³•å’Œå„ç§ api ä½¿ç”¨éƒ½æ˜¯åªçŸ¥å…¶ç„¶è€Œä¸çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚æœ€è¿‘åˆ©ç”¨ç©ºé—²æ—¶é—´å°è¯•çš„å»çœ‹çœ‹ Vue çš„æºç ï¼Œä»¥ä¾¿æ›´äº†è§£å…¶å…·ä½“åŸç†å®ç°ï¼Œè·Ÿç€å­¦ä¹ å­¦ä¹ ã€‚</p>
<span id="more"></span>

<!-- ä¹‹å‰ä¸€ç›´å¯¹ Vueåˆå‡ ä¸ªå›°æƒ‘

- ä¼ çš„ data è¿›å»çš„ æ€ä¹ˆå°± å˜å¾— this.xxx å¯ä»¥è®¿é—®åˆ°äº†
- å¦‚ä½•å®ç°æ•°æ®åŠ«æŒï¼Œç›‘å¬æ•°æ®çš„è¯»å†™æ“ä½œ ï¼Ÿ
- å¦‚ä½•å®ç°ä¾èµ–ç¼“å­˜ ï¼Ÿ -->

<h2 id="Proxy-å¯¹-data-ä»£ç†"><a href="#Proxy-å¯¹-data-ä»£ç†" class="headerlink" title="Proxy å¯¹ data ä»£ç†"></a>Proxy å¯¹ data ä»£ç†</h2><p>ä¼ çš„ data è¿›å»çš„ä¸ºä»€ä¹ˆå¯ä»¥ç”¨ this.xxx è®¿é—®ï¼Œè€Œä¸éœ€è¦ this.data.xxx å‘¢?</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// vue\src\core\instance\state.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sharedPropertyDefinition = &#123;</span><br><span class="line">  <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">get</span>: noop,</span><br><span class="line">  <span class="attr">set</span>: noop</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">proxy</span> (<span class="attr">target</span>: <span class="title class_">Object</span>, <span class="attr">sourceKey</span>: string, <span class="attr">key</span>: string) &#123;</span><br><span class="line">  sharedPropertyDefinition.<span class="property">get</span> = <span class="keyword">function</span> <span class="title function_">proxyGetter</span> () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>[sourceKey][key]</span><br><span class="line">  &#125;</span><br><span class="line">  sharedPropertyDefinition.<span class="property">set</span> = <span class="keyword">function</span> <span class="title function_">proxySetter</span> (val) &#123;</span><br><span class="line">    <span class="variable language_">this</span>[sourceKey][key] = val</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(target, key, sharedPropertyDefinition)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initData</span> (<span class="attr">vm</span>: <span class="title class_">Component</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> data = vm.<span class="property">$options</span>.<span class="property">data</span></span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="keyword">const</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(data)</span><br><span class="line">  <span class="comment">//...</span></span><br><span class="line">  <span class="keyword">let</span> i = keys.<span class="property">length</span></span><br><span class="line">  <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">    <span class="keyword">const</span> key = keys[i]</span><br><span class="line">    <span class="comment">//....</span></span><br><span class="line">     <span class="title function_">proxy</span>(vm, <span class="string">`_data`</span>, key)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">observe</span>(data, <span class="literal">true</span> <span class="comment">/* asRootData */</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆç®€å•çš„ï¼Œå°† data ä¸­å¾— key éå†ä¸€éï¼Œç„¶åå…¨éƒ¨æ–°å¢åˆ°å®ä¾‹ä¸Šå»ï¼Œå½“æˆ‘ä»¬è®¿é—®ä¿®æ”¹ this.xxx å¾—æ—¶å€™ï¼Œéƒ½æ˜¯åœ¨è®¿é—®ä¿®æ”¹ this._data.xxx</p>
<h2 id="observer-æ¨¡å—"><a href="#observer-æ¨¡å—" class="headerlink" title="observer æ¨¡å—"></a>observer æ¨¡å—</h2><blockquote>
<p>æ¨¡å—æºç è·¯å¾„ vue\src\core\observer</p>
</blockquote>
<p>observer æ¨¡å—å¯ä»¥è¯´æ˜¯ Vue å“åº”å¼å¾—æ ¸å¿ƒäº†ï¼Œobserver æ¨¡å—ä¸»è¦æ˜¯ Observerã€Depã€Watcherè¿™ä¸‰ä¸ªéƒ¨åˆ†äº†</p>
<ul>
<li><strong>Observer</strong> è§‚å¯Ÿè€…ï¼Œå¯¹æ•°æ®è¿›è¡Œè§‚å¯Ÿå’Œä¾èµ–æ”¶é›†ç­‰</li>
<li><strong>Dep</strong> æ˜¯ Observer å’Œ Watcher å¾—ä¸€ä¸ªæ¡¥æ¢ï¼ŒObserver å¯¹æ•°æ®è¿›è¡Œå“åº”å¼å¤„ç†æ—¶å€™ï¼Œä¼šç»™æ¯ä¸ªå±æ€§ç”Ÿæˆä¸€ä¸ª Dep å¯¹è±¡ï¼Œç„¶åé€šè¿‡è°ƒç”¨ dep.depend() ï¼Œå¦‚æœå½“å‰å­˜åœ¨ Watcher å°†å½“å‰ Dep åŠ å…¥åˆ° Watcher ä¸­,ç„¶ååœ¨å°† Watcher æ·»åŠ åˆ°å½“å‰ Dep ä¸­</li>
<li><strong>Watcher</strong> è®¢é˜…è€…ï¼Œæ•°æ®å˜åŒ–ä¼šæ”¶åˆ°é€šçŸ¥ï¼Œç„¶åè¿›è¡Œç›¸å…³æ“ä½œï¼Œä¾‹å¦‚è§†å›¾æ›´æ–°ç­‰</li>
</ul>
<p>å…³ç³»å¦‚ä¸‹ </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">      -------get æ”¶é›†ä¾èµ–--------   ----------- è®¢é˜… -------------</span><br><span class="line">      |                         |  |                            |</span><br><span class="line">      |                         V  |                            |</span><br><span class="line">------------                ------------                  -------------</span><br><span class="line">| Obserser | ----  set ----&gt;|    Dep   |------- é€šçŸ¥ ----&gt;|  Watcher  |</span><br><span class="line">------------                ------------                  -------------</span><br><span class="line">                                                                |</span><br><span class="line">                                                              update</span><br><span class="line">                                                                |</span><br><span class="line">                                                          -------------</span><br><span class="line">                                                          |   View    |</span><br><span class="line">                                                          -------------</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="1-Observer"><a href="#1-Observer" class="headerlink" title="1.Observer"></a>1.Observer</h3><p>initData() æ–¹æ³•è°ƒç”¨äº†  observe(data, true &#x2F;* asRootData *&#x2F;) å…ˆæ¥çœ‹ä¸‹è¿™ä¸ªæ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å¯¹ value è¿›è¡Œè§‚å¯Ÿå¤„ç†</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">observe</span> (<span class="attr">value</span>: any, <span class="attr">asRootData</span>: ?boolean): <span class="title class_">Observer</span> | <span class="keyword">void</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//åˆ¤æ–­å¤„ç† value å¿…é¡»æ˜¯å¯¹è±¡ å¹¶ä¸”ä¸èƒ½æ˜¯ VNode</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_">isObject</span>(value) || value <span class="keyword">instanceof</span> <span class="title class_">VNode</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="attr">ob</span>: <span class="title class_">Observer</span> | <span class="keyword">void</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_">hasOwn</span>(value, <span class="string">&#x27;__ob__&#x27;</span>) &amp;&amp; value.<span class="property">__ob__</span> <span class="keyword">instanceof</span> <span class="title class_">Observer</span>) &#123;</span><br><span class="line">    ob = value.<span class="property">__ob__</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (</span><br><span class="line">    shouldObserve &amp;&amp;</span><br><span class="line">    !<span class="title function_">isServerRendering</span>() &amp;&amp;</span><br><span class="line">    (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value) || <span class="title function_">isPlainObject</span>(value)) &amp;&amp;</span><br><span class="line">    <span class="title class_">Object</span>.<span class="title function_">isExtensible</span>(value) &amp;&amp;</span><br><span class="line">    !value.<span class="property">_isVue</span></span><br><span class="line">  ) &#123;</span><br><span class="line">    ob = <span class="keyword">new</span> <span class="title class_">Observer</span>(value)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (asRootData &amp;&amp; ob) &#123;</span><br><span class="line">    ob.<span class="property">vmCount</span>++</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ob</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¦‚æœ data.__ob__ å·²ç»å­˜åœ¨ç›´æ¥è¿”å›ï¼Œå¦åˆ™ new ä¸€ä¸ªæ–°çš„ Observer å®ä¾‹ï¼Œä¸‹é¢æ˜¯ Observer ç±»ä»£ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">Observer</span> &#123;</span><br><span class="line">  <span class="attr">value</span>: any;</span><br><span class="line">  <span class="attr">dep</span>: <span class="title class_">Dep</span>;</span><br><span class="line">  <span class="attr">vmCount</span>: number; <span class="comment">// number of vms that have this object as root $data</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span> (<span class="attr">value</span>: any) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = value</span><br><span class="line">    <span class="comment">// è¿™ä¸ªdep åœ¨ value çš„å±æ€§æ–°å¢ åˆ é™¤æ—¶å€™ä¼šç”¨åˆ°</span></span><br><span class="line">    <span class="comment">//value å¦‚æœæ˜¯æ•°ç»„ ä¹Ÿæ˜¯é€šè¿‡ è¿™é‡Œçš„è¿›è¡Œ ä¾èµ–æ”¶é›†æ›´æ–°çš„</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dep</span> = <span class="keyword">new</span> <span class="title class_">Dep</span>() </span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">vmCount</span> = <span class="number">0</span></span><br><span class="line">    <span class="title function_">def</span>(value, <span class="string">&#x27;__ob__&#x27;</span>, <span class="variable language_">this</span>)</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//è¿™é‡Œæ˜¯å¯¹æ•°ç»„åŸå‹å¯¹è±¡ æ‹¦æˆª å¤„ç†</span></span><br><span class="line">      <span class="keyword">if</span> (hasProto) &#123;</span><br><span class="line">        <span class="title function_">protoAugment</span>(value, arrayMethods)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_">copyAugment</span>(value, arrayMethods, arrayKeys)</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">observeArray</span>(value)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">walk</span>(value)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  walk (<span class="attr">obj</span>: <span class="title class_">Object</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> keys = <span class="title class_">Object</span>.<span class="title function_">keys</span>(obj)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; keys.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      <span class="title function_">defineReactive</span>(obj, keys[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  observeArray (<span class="attr">items</span>: <span class="title class_">Array</span>&lt;any&gt;) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, l = items.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">      <span class="title function_">observe</span>(items[i])</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨æ„é€ å‡½æ•°ä¸­ï¼Œä¼šç»™ valueï¼ˆdataï¼‰å¢åŠ  __ob__  (å½“å‰ Observerå®ä¾‹ ) å±æ€§ã€‚å¦‚æœ value æ˜¯æ•°ç»„ï¼Œä¼šè°ƒç”¨ observeArray å¯¹æ•°ç»„è¿›è¡Œéå†ï¼Œåœ¨è°ƒç”¨ observe æ–¹æ³•å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œè§‚å¯Ÿã€‚å¦‚æœæ˜¯å¯¹è±¡ï¼Œè°ƒç”¨ walk éå† value å»è°ƒç”¨ defineReactive å»ä¿®æ”¹å±æ€§çš„ get&#x2F;setã€‚ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//defineReactive å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">defineReactive</span> (</span><br><span class="line">  <span class="attr">obj</span>: <span class="title class_">Object</span>,</span><br><span class="line">  <span class="attr">key</span>: string, <span class="comment">//éå†çš„key</span></span><br><span class="line">  <span class="attr">val</span>: any,</span><br><span class="line">  customSetter?: ?<span class="title class_">Function</span>,</span><br><span class="line">  shallow?: boolean</span><br><span class="line">) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> dep = <span class="keyword">new</span> <span class="title class_">Dep</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> property = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptor</span>(obj, key)</span><br><span class="line">  <span class="keyword">if</span> (property &amp;&amp; property.<span class="property">configurable</span> === <span class="literal">false</span>)  <span class="keyword">return</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="comment">// cater for pre-defined getter/setters</span></span><br><span class="line">  <span class="keyword">const</span> getter = property &amp;&amp; property.<span class="property">get</span></span><br><span class="line">  <span class="keyword">const</span> setter = property &amp;&amp; property.<span class="property">set</span></span><br><span class="line">  <span class="keyword">if</span> ((!getter || setter) &amp;&amp; <span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">2</span>) &#123;</span><br><span class="line">    val = obj[key]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//å¦‚æœ key çš„å€¼æ˜¯ å¯¹è±¡ çš„è¯ï¼Œå¯¹å…¶ value ä¹Ÿä¼šè¿›è¡Œå“åº”å¤„ç†</span></span><br><span class="line">  <span class="keyword">let</span> childOb = !shallow &amp;&amp; <span class="title function_">observe</span>(val)</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¸ºå½“å‰ key æ·»åŠ get/set</span></span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, key, &#123;</span><br><span class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span> <span class="title function_">reactiveGetter</span> () &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.<span class="title function_">call</span>(obj) : val</span><br><span class="line">      </span><br><span class="line">      <span class="keyword">if</span> (<span class="title class_">Dep</span>.<span class="property">target</span>) &#123;</span><br><span class="line"></span><br><span class="line">        dep.<span class="title function_">depend</span>() <span class="comment">//å¯¹å½“å‰å±æ€§ è¿›è¡Œä¾èµ–æ”¶é›†</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (childOb) &#123;</span><br><span class="line">          <span class="comment">//å¦‚æœå±æ€§å€¼æ˜¯ å¯¹è±¡ ï¼Œåˆ™å¯¹å±æ€§å€¼æœ¬èº«è¿›è¡Œä¾èµ–æ”¶é›†</span></span><br><span class="line">          childOb.<span class="property">dep</span>.<span class="title function_">depend</span>()</span><br><span class="line">          <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(value)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœå€¼æ˜¯æ•°ç»„ å¯¹æ•°ç»„çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œä¾èµ–æ”¶é›†</span></span><br><span class="line">            <span class="title function_">dependArray</span>(value)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> value</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">set</span>: <span class="keyword">function</span> <span class="title function_">reactiveSetter</span> (newVal) &#123;</span><br><span class="line">      <span class="keyword">const</span> value = getter ? getter.<span class="title function_">call</span>(obj) : val</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (newVal === value || (newVal !== newVal &amp;&amp; value !== value)) &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (getter &amp;&amp; !setter) <span class="keyword">return</span></span><br><span class="line">      <span class="keyword">if</span> (setter) &#123;</span><br><span class="line">        setter.<span class="title function_">call</span>(obj, newVal)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        val = newVal</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">//å¯¹æ–°å€¼ è¿›è¡Œè§‚å¯Ÿå¤„ç†</span></span><br><span class="line">      childOb = !shallow &amp;&amp; <span class="title function_">observe</span>(newVal)</span><br><span class="line">      <span class="comment">//é€šçŸ¥ Watcher</span></span><br><span class="line">      dep.<span class="title function_">notify</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dependArray</span> (<span class="attr">value</span>: <span class="title class_">Array</span>&lt;any&gt;) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> e, i = <span class="number">0</span>, l = value.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">    e = value[i]</span><br><span class="line">    e &amp;&amp; e.<span class="property">__ob__</span> &amp;&amp; e.<span class="property">__ob__</span>.<span class="property">dep</span>.<span class="title function_">depend</span>()</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Array</span>.<span class="title function_">isArray</span>(e)) &#123;</span><br><span class="line">      <span class="title function_">dependArray</span>(e)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æœ‰ä¸¤ä¸ªåœ°æ–¹æœ‰å­˜åœ¨ Dep</p>
<ul>
<li>ä¸€ä¸ªæ˜¯Observer ç±» å±æ€§ä¸Šæœ‰ä¸ª Dep ,è¿™é‡Œä¸»è¦æ˜¯å¯¹æ•°ç»„ï¼ˆæ•°ç»„æ²¡æœ‰ get&#x2F;set ä¸èƒ½åƒå¯¹è±¡å±æ€§é‚£æ ·ï¼‰å’Œå¯¹è±¡æœ¬èº«è¿›è¡Œä¾èµ–æ”¶é›†å’Œé€šçŸ¥<br><img src="/20200312225611.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br><img src="/20200312225648.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></li>
<li>ä¸€ä¸ªæ˜¯å¯¹å±æ€§ get&#x2F;set å¤„ç†æ—¶å€™çš„ Dep ,è¿™ä¸ªä¸»è¦æ˜¯å¯¹è±¡çš„å±æ€§è¿›è¡Œä¾èµ–æ”¶é›†å’Œé€šçŸ¥</li>
</ul>
<h3 id="2-Dep"><a href="#2-Dep" class="headerlink" title="2.Dep"></a>2.Dep</h3><p>Dep æ˜¯ Observer ä¸ Watcher æ¡¥æ¢ï¼Œä¹Ÿå¯ä»¥è®¤ä¸º Dep æ˜¯æœåŠ¡äº Observer çš„è®¢é˜…ç³»ç»Ÿã€‚Watcher è®¢é˜…æŸä¸ª Observer çš„ Depï¼Œå½“ Observer è§‚å¯Ÿçš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé€šè¿‡ Dep é€šçŸ¥å„ä¸ªå·²ç»è®¢é˜…çš„ Watcherã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">Dep</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="attr">target</span>: ?<span class="title class_">Watcher</span>;</span><br><span class="line">  <span class="attr">id</span>: number;</span><br><span class="line">  <span class="attr">subs</span>: <span class="title class_">Array</span>&lt;<span class="title class_">Watcher</span>&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span> () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">id</span> = uid++</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">subs</span> = [] <span class="comment">//Watcherå®ä¾‹</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ¥æ”¶çš„å‚æ•°ä¸ºWatcherå®ä¾‹ï¼Œå¹¶æŠŠWatcherå®ä¾‹å­˜å…¥è®°å½•ä¾èµ–çš„æ•°ç»„ä¸­</span></span><br><span class="line">  addSub (<span class="attr">sub</span>: <span class="title class_">Watcher</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">push</span>(sub)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¸addSubå¯¹åº”ï¼Œä½œç”¨æ˜¯å°†Watcherå®ä¾‹ä»è®°å½•ä¾èµ–çš„æ•°ç»„ä¸­ç§»é™¤</span></span><br><span class="line">  removeSub (<span class="attr">sub</span>: <span class="title class_">Watcher</span>) &#123;</span><br><span class="line">    <span class="title function_">remove</span>(<span class="variable language_">this</span>.<span class="property">subs</span>, sub)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//ä¾èµ–æ”¶é›†</span></span><br><span class="line">  depend () &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">Dep</span>.<span class="property">target</span>) &#123; <span class="comment">//å­˜æ”¾å½“å‰Watherå®ä¾‹</span></span><br><span class="line">      <span class="comment">//å°†å½“å‰ Dep å­˜æ”¾åˆ° Watcherï¼ˆè§‚å¯Ÿè€…ï¼‰ ä¸­çš„ä¾èµ–ä¸­</span></span><br><span class="line">      <span class="title class_">Dep</span>.<span class="property">target</span>.<span class="title function_">addDep</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//é€šçŸ¥ä¾èµ–æ•°ç»„ä¸­æ‰€æœ‰çš„watcherè¿›è¡Œæ›´æ–°æ“ä½œ</span></span><br><span class="line">  notify () &#123;</span><br><span class="line">    <span class="keyword">const</span> subs = <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">slice</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, l = subs.<span class="property">length</span>; i &lt; l; i++) &#123;</span><br><span class="line">      subs[i].<span class="title function_">update</span>()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Dep</span>.<span class="property">target</span> = <span class="literal">null</span></span><br><span class="line"><span class="keyword">const</span> targetStack = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">pushTarget</span> (<span class="attr">target</span>: ?<span class="title class_">Watcher</span>) &#123;</span><br><span class="line">  targetStack.<span class="title function_">push</span>(target)</span><br><span class="line">  <span class="title class_">Dep</span>.<span class="property">target</span> = target</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">popTarget</span> () &#123;</span><br><span class="line">  targetStack.<span class="title function_">pop</span>()</span><br><span class="line">  <span class="title class_">Dep</span>.<span class="property">target</span> = targetStack[targetStack.<span class="property">length</span> - <span class="number">1</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="3-Watcher"><a href="#3-Watcher" class="headerlink" title="3.Watcher"></a>3.Watcher</h3><p>å…ˆçœ‹ Watcher çš„æ„é€ å‡½æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">constructor</span>(<span class="params"> </span></span><br><span class="line"><span class="params">    vm: Component,</span></span><br><span class="line"><span class="params">    expOrFn: string | <span class="built_in">Function</span>,</span></span><br><span class="line"><span class="params">    cb: <span class="built_in">Function</span>,</span></span><br><span class="line"><span class="params">    options?: ?<span class="built_in">Object</span>,</span></span><br><span class="line"><span class="params">    isRenderWatcher?: boolean</span>)</span><br><span class="line">&#123;</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> expOrFn === <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">getter</span> = expOrFn</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">getter</span> = <span class="title function_">parsePath</span>(expOrFn)</span><br><span class="line">      <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">getter</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">getter</span> = noop</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = <span class="variable language_">this</span>.<span class="property">lazy</span></span><br><span class="line">      ? <span class="literal">undefined</span></span><br><span class="line">      : <span class="variable language_">this</span>.<span class="title function_">get</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>expOrFnï¼Œå¯¹äºåˆå§‹åŒ–ç”¨æ¥æ¸²æŸ“è§†å›¾çš„ watcher æ¥è¯´ï¼Œå°±æ˜¯ render æ–¹æ³•ï¼Œå¯¹äº computed æ¥è¯´å°±æ˜¯è¡¨è¾¾å¼ï¼Œå¯¹äº watch æ‰æ˜¯ keyï¼Œè€Œ getter æ–¹æ³•æ˜¯ç”¨æ¥å– value çš„ã€‚æœ€åè°ƒç”¨äº† get()æ–¹æ³•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">get () &#123;</span><br><span class="line">    <span class="comment">//å°†Dep.targetè®¾ç½®ä¸ºå½“å‰watcherå®ä¾‹</span></span><br><span class="line">    <span class="title function_">pushTarget</span>(<span class="variable language_">this</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> value</span><br><span class="line">    <span class="keyword">const</span> vm = <span class="variable language_">this</span>.<span class="property">vm</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// æ‰§è¡Œä¸€æ¬¡get æ”¶é›†ä¾èµ–</span></span><br><span class="line">      value = <span class="variable language_">this</span>.<span class="property">getter</span>.<span class="title function_">call</span>(vm, vm) </span><br><span class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">user</span>) &#123;</span><br><span class="line">        <span class="title function_">handleError</span>(e, vm, <span class="string">`getter for watcher &quot;<span class="subst">$&#123;<span class="variable language_">this</span>.expression&#125;</span>&quot;`</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">throw</span> e</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">deep</span>) &#123;</span><br><span class="line">        <span class="title function_">traverse</span>(value)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title function_">popTarget</span>()</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">cleanupDeps</span>() <span class="comment">//æ¸…æ¥šä¾èµ–</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å‡å¦‚å½“å‰ Watcher å®ä¾‹ä¸­ getter æ˜¯ renderï¼Œå½“ render é‡åˆ°æ¨¡æ¿ä¸­çš„  è¡¨è¾¾å¼çš„æ—¶å€™ï¼Œå°±æ˜¯å»è¯»å– data.xxxï¼Œè¿™ä¸ªæ—¶å€™å°±è§¦å‘ data.xxx çš„ get æ–¹æ³•ï¼Œè¿™ä¸ªæ—¶å€™ get ä¸­ä¼šæ‰§è¡Œ Dep.depend(),è€Œæ­¤æ—¶ Dep.target å°±æ˜¯å½“å‰ watcher ï¼Œç„¶åè°ƒç”¨ watcher.addDep()ã€‚ä¹Ÿå°±å°† data.xxx ä¸ å½“å‰ watcher å…³è”èµ·æ¥äº†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//watcher çš„å…¶ä»–æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¥æ”¶å‚æ•°dep(Depå®ä¾‹)ï¼Œè®©å½“å‰watcherè®¢é˜…dep</span></span><br><span class="line">addDep (<span class="attr">dep</span>: <span class="title class_">Dep</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> id = dep.<span class="property">id</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">newDepIds</span>.<span class="title function_">has</span>(id)) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">newDepIds</span>.<span class="title function_">add</span>(id)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">newDeps</span>.<span class="title function_">push</span>(dep)</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">depIds</span>.<span class="title function_">has</span>(id)) &#123;</span><br><span class="line">      <span class="comment">//å°†watcherå®ä¾‹ ä¹Ÿæ·»åŠ åˆ° Depå®ä¾‹ä¸­</span></span><br><span class="line">      dep.<span class="title function_">addSub</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ¸…æ¥šå¯¹depçš„è®¢é˜…ä¿¡æ¯</span></span><br><span class="line">cleanupDeps () &#123;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç«‹åˆ»è¿è¡Œwatcheræˆ–è€…å°†watcheråŠ å…¥é˜Ÿåˆ—ä¸­</span></span><br><span class="line">update () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">lazy</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">dirty</span> = <span class="literal">true</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">sync</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">run</span>()</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">queueWatcher</span>(<span class="variable language_">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¿è¡Œwatcherï¼Œè°ƒç”¨this.get()æ±‚å€¼ï¼Œç„¶åè§¦å‘å›è°ƒ</span></span><br><span class="line">run () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">active</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> value = <span class="variable language_">this</span>.<span class="title function_">get</span>()</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      value !== <span class="variable language_">this</span>.<span class="property">value</span> || <span class="title function_">isObject</span>(value) || <span class="variable language_">this</span>.<span class="property">deep</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="keyword">const</span> oldValue = <span class="variable language_">this</span>.<span class="property">value</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">value</span> = value</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">user</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">cb</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>.<span class="property">vm</span>, value, oldValue)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">          <span class="title function_">handleError</span>(e, <span class="variable language_">this</span>.<span class="property">vm</span>, <span class="string">`callback for watcher &quot;<span class="subst">$&#123;<span class="variable language_">this</span>.expression&#125;</span>&quot;`</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">cb</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>.<span class="property">vm</span>, value, oldValue)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è°ƒç”¨this.get()æ±‚å€¼</span></span><br><span class="line">evaluate () &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">value</span> = <span class="variable language_">this</span>.<span class="title function_">get</span>()</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">dirty</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éå†this.depsï¼Œè®©å½“å‰watcherå®ä¾‹è®¢é˜…æ‰€æœ‰dep</span></span><br><span class="line">depend () &#123;</span><br><span class="line">  <span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">deps</span>.<span class="property">length</span></span><br><span class="line">  <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">deps</span>[i].<span class="title function_">depend</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å»é™¤å½“å‰watcherå®ä¾‹æ‰€æœ‰çš„è®¢é˜…</span></span><br><span class="line">teardown () &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">active</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">vm</span>.<span class="property">_isBeingDestroyed</span>) &#123;</span><br><span class="line">      <span class="title function_">remove</span>(<span class="variable language_">this</span>.<span class="property">vm</span>.<span class="property">_watchers</span>, <span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> i = <span class="variable language_">this</span>.<span class="property">deps</span>.<span class="property">length</span></span><br><span class="line">    <span class="keyword">while</span> (i--) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">deps</span>[i].<span class="title function_">removeSub</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">active</span> = <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±å…¥ç†è§£ JavaScript äº‹ä»¶ï¼ˆ ç¬¬1ç«  ï¼‰</title>
    <url>/jsasync/</url>
    <content><![CDATA[<p>äº‹ä»¶ï¼äº‹ä»¶åˆ°åº•æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼ŸJavaScrip tå‡ºç°äº†å¤šä¹…ï¼Œå¯¹ JavaScript å¼‚æ­¥äº‹ä»¶æ¨¡å‹å°±è¿·æƒ˜äº†å¤šä¹…ã€‚è¿·æƒ˜å¯¼è‡´ bugï¼Œbug å¯¼è‡´æ„¤æ€’ï¼Œç„¶åå°¤è¾¾å¤§å¸ˆå°±ä¼šæ•™æˆ‘ä»¬å¦‚ä½•å¦‚ä½•â€¦â€¦ä¸è¿‡æœ¬è´¨ä¸Šï¼Œä»æ¦‚å¿µä¸Šçœ‹ï¼ŒJavaScriptäº‹ä»¶æ¨¡å‹æ—¢ä¼˜é›…åˆå®ç”¨ã€‚ä¸€æ—¦å¤§å®¶æ¥å—äº†è¿™ç§è¯­è¨€çš„å•çº¿ç¨‹è®¾è®¡ï¼Œå°±ä¼šè§‰å¾— JavaScript äº‹ä»¶æ¨¡å‹æ›´åƒæ˜¯ä¸€ç§åŠŸèƒ½ï¼Œè€Œä¸æ˜¯ä¸€ç§å±€é™ã€‚å®ƒæ„å‘³ç€æˆ‘ä»¬çš„ä»£ç æ˜¯ä¸å¯ä¸­æ–­çš„ï¼Œä¹Ÿæ„å‘³ç€è°ƒåº¦çš„äº‹ä»¶ä¼šæ•´æ•´é½é½æ’å¥½é˜Ÿï¼Œæœ‰æ¡ä¸ç´Šåœ°è¿è¡Œã€‚æœ¬ç« å°†ä»‹ç»JavaScriptçš„å¼‚æ­¥æœºåˆ¶ï¼Œå¹¶ç ´é™¤ä¸€äº›å¸¸è§çš„è¯¯è§£ã€‚æˆ‘ä»¬ä¼šçœ‹åˆ°setTimeout çœŸæ­£åšäº†äº›ä»€ä¹ˆã€‚æ¥ç€ä¼šè®¨è®ºå›è°ƒä¸­æŠ›å‡ºé”™è¯¯çš„å¤„ç†ã€‚æœ€åä¼šå¥ å®šæœ¬ä¹¦çš„ä¸»æ—¨ï¼šä¸ºäº†æ¸…æ™°å’Œå¯ç»´æŠ¤æ€§ï¼ŒåŠªåŠ›ç»„ç»‡å¼‚æ­¥ä»£ç ã€‚<br> <span id="more"></span></p>
<h2 id="äº‹ä»¶çš„è°ƒåº¦"><a href="#äº‹ä»¶çš„è°ƒåº¦" class="headerlink" title="äº‹ä»¶çš„è°ƒåº¦"></a>äº‹ä»¶çš„è°ƒåº¦</h2><p>å¦‚æœæƒ³è®© JavaScript ä¸­çš„æŸæ®µä»£ç å°†æ¥å†è¿è¡Œï¼Œå¯ä»¥å°†å®ƒæ”¾åœ¨å›è°ƒä¸­ã€‚å›è°ƒå°±æ˜¯ä¸€ç§æ™®é€šå‡½æ•°ï¼Œåªä¸è¿‡å®ƒæ˜¯ä¼ ç»™åƒ setTimeout è¿™æ ·çš„å‡½æ•°ï¼Œæˆ–è€…ç»‘å®šä¸ºåƒ document.onready è¿™æ ·çš„å±æ€§ã€‚è¿è¡Œå›è°ƒæ—¶ï¼Œæˆ‘ä»¬ç§°å·²è§¦å‘æŸäº‹ä»¶ï¼ˆè­¬å¦‚å»¶æ—¶ç»“æŸæˆ–é¡µé¢åŠ è½½å®Œæ¯•ï¼‰ã€‚å½“ç„¶ï¼Œå¯æ€•çš„æ€»æ˜¯é‚£äº›ç»†èŠ‚ï¼Œå“ªæ€•æ˜¯åƒ setTimeout è¿™æ ·çœ‹èµ·æ¥å¾ˆç®€å•çš„ä¸œè¥¿ã€‚å¯¹ setTimeout çš„æè¿°é€šå¸¸åƒè¿™æ ·ï¼š</p>
<blockquote>
<p>ç»™å®šä¸€ä¸ªå›è°ƒåŠnæ¯«ç§’çš„å»¶è¿Ÿï¼ŒsetTimeoutå°±ä¼šåœ¨næ¯«ç§’åè¿è¡Œè¯¥å›è°ƒã€‚</p>
</blockquote>
<p>ä½†æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬å°†åœ¨è¿™ä¸€èŠ‚ä¹ƒè‡³è¿™ä¸€ç« é‡Œçœ‹åˆ°çš„ï¼Œä»¥ä¸Šæè¿°å­˜åœ¨ä¸¥é‡ç¼ºé™·ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¥æè¿°åªèƒ½ç®—æ¥è¿‘æ­£ç¡®ï¼Œè€Œåœ¨å…¶ä»–æƒ…å†µä¸‹åˆ™å®Œå…¨æ˜¯è°¬è¯¯ã€‚è¦æƒ³çœŸæ­£ç†è§£ setTimeoutï¼Œå¿…é¡»å…ˆå¤§ä½“ç†è§£ JavaScript äº‹ä»¶æ¨¡å‹ã€‚</p>
<h3 id="ç°åœ¨è¿˜æ˜¯å°†æ¥è¿è¡Œ"><a href="#ç°åœ¨è¿˜æ˜¯å°†æ¥è¿è¡Œ" class="headerlink" title="ç°åœ¨è¿˜æ˜¯å°†æ¥è¿è¡Œ"></a>ç°åœ¨è¿˜æ˜¯å°†æ¥è¿è¡Œ</h3><p>åœ¨æ¢ç©¶setTimeoutä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚è¯¥æƒ…å½¢å¸¸å¸¸ä¼šè¿·æƒ‘JavaScriptæ–°æ‰‹ï¼Œç‰¹åˆ«æ˜¯é‚£äº›åˆšåˆšä»Javaå’ŒRubyç­‰å¤šçº¿ç¨‹è¯­è¨€è¿ç§»è¿‡æ¥çš„æ–°æ‰‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++) &#123;   </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(i); </span><br><span class="line">    &#125;, <span class="number">0</span>); </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>4 4 4 </p>
<p>å¤§å¤šæ•°åˆšæ¥è§¦JavaScriptè¯­è¨€çš„äººéƒ½ä¼šè®¤ä¸ºä»¥ä¸Šå¾ªç¯ä¼šè¾“å‡º1ï¼Œ2ï¼Œ3ï¼Œæˆ–è€…é‡å¤è¾“å‡ºè¿™3ä¸ªæ•°å­—ï¼Œå› ä¸ºè¿™é‡Œçš„3æ¬¡å»¶æ—¶éƒ½æŠ¢ç€è¦ç¬¬ä¸€ä¸ªè§¦å‘ï¼ˆæ¯æ¬¡æš‚åœéƒ½è°ƒåº¦ä¸º0æ¯«ç§’ååˆ°æ—¶ï¼‰ã€‚</p>
<p>è¦ç†è§£ä¸ºä»€ä¹ˆè¾“å‡ºæ˜¯4ï¼Œ4ï¼Œ4ï¼Œéœ€è¦çŸ¥é“ä»¥ä¸‹3ä»¶äº‹ã€‚</p>
<blockquote>
<p>1: è¿™é‡Œåªæœ‰ä¸€ä¸ªåä¸ºiçš„å˜é‡ï¼Œå…¶ä½œç”¨åŸŸç”±å£°æ˜è¯­å¥var iå®šä¹‰ï¼ˆè¯¥å£°æ˜è¯­å¥åœ¨ä¸ç»æ„é—´è®©içš„ä½œç”¨åŸŸä¸æ˜¯å¾ªç¯å†…éƒ¨ï¼Œè€Œæ˜¯æ‰©æ•£è‡³è•´å«å¾ªç¯çš„é‚£ä¸ªæœ€å†…ä¾§å‡½æ•°ï¼‰ã€‚<br>2: å¾ªç¯ç»“æŸåï¼Œi&#x3D;&#x3D;&#x3D;4ä¸€ç›´é€’å¢ï¼Œç›´åˆ°ä¸å†æ»¡è¶³æ¡ä»¶i&lt;&#x3D;3ä¸ºæ­¢ã€‚<br>3: JavaScriptäº‹ä»¶å¤„ç†å™¨åœ¨çº¿ç¨‹ç©ºé—²ä¹‹å‰ä¸ä¼šè¿è¡Œã€‚</p>
</blockquote>
<p>å‰ä¸¤æ¡è¿˜å±äºJavaScript 101çš„èŒƒç•´ï¼Œä½†ç¬¬ä¸‰ä¸ªæ›´åƒæ˜¯ä¸€ä¸ªâ€œæƒŠå–œâ€ã€‚ä¸€å¼€å§‹ä½¿ç”¨JavaScriptçš„æ—¶å€™ï¼Œæˆ‘ä¹Ÿä¸å¤ªç›¸ä¿¡ä¼šè¿™æ ·ã€‚Javaä»¤æˆ‘æ‹…å¿ƒè‡ªå·±çš„ä»£ç éšæ—¶ä¼šè¢«ä¸­æ–­ã€‚ä¸Šç™¾ä¸‡ç§æ½œåœ¨çš„è¾¹ç•Œæƒ…å†µè®©æˆ‘ç„¦è™‘ä¸‡åˆ†ï¼Œæˆ‘ä¸€ç›´åœ¨æƒ³ï¼šâ€œè¦æ˜¯åœ¨è¿™ä¸¤è¡Œä»£ç ä¹‹é—´å‘ç”Ÿäº†ä»€ä¹ˆç¨€å¥‡å¤æ€ªçš„äº‹ï¼Œä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿâ€ç„¶åï¼Œç»ˆäºæœ‰ä¸€å¤©ï¼Œæˆ‘å†ä¹Ÿæ²¡æœ‰è¿™æ ·çš„æ‹…å¿ƒäº†â€¦â€¦</p>
<h3 id="çº¿ç¨‹çš„é˜»å¡"><a href="#çº¿ç¨‹çš„é˜»å¡" class="headerlink" title="çº¿ç¨‹çš„é˜»å¡"></a>çº¿ç¨‹çš„é˜»å¡</h3><p>ä¸‹é¢è¿™æ®µä»£ç æ‰“ç ´äº†æˆ‘å¯¹JavaScriptäº‹ä»¶çš„æˆè§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EventModel/loopBlockingTimeout.js </span></span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">Date</span>; </span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">     <span class="keyword">var</span> end = <span class="keyword">new</span> <span class="title class_">Date</span>;  </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Time elapsed:&#x27;</span>, end - start, <span class="string">&#x27;ms&#x27;</span>);</span><br><span class="line">&#125;, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (<span class="keyword">new</span> <span class="title class_">Date</span> - start &lt; <span class="number">1000</span>) &#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>æŒ‰ç…§å¤šçº¿ç¨‹çš„æ€ç»´å®šåŠ¿ï¼Œæˆ‘ä¼šé¢„è®¡500æ¯«ç§’åè®¡æ—¶å‡½æ•°å°±ä¼šè¿è¡Œã€‚ä¸è¿‡è¿™è¦æ±‚ä¸­æ–­æ¬²æŒç»­æ•´æ•´ä¸€ç§’é’Ÿçš„å¾ªç¯ã€‚å¦‚æœè¿è¡Œä»£ç ï¼Œä¼šå¾—åˆ°ç±»ä¼¼è¿™æ ·çš„ç»“æœï¼š</p>
<p>Time elapsed: 1002ms</p>
<p>å¤§å®¶å¾—åˆ°çš„æ•°å­—å¯èƒ½ä¼šç¨æœ‰ä¸åŒï¼Œè¿™æ˜¯å› ä¸ºsetTimeoutå’ŒsetIn- tervalä¸€æ ·ï¼Œ  å…¶è®¡æ—¶ç²¾åº¦è¦æ¯”æˆ‘ä»¬çš„æœŸæœ›å€¼å·®å¾ˆå¤šï¼ˆè¯·å‚é˜…1.2.2èŠ‚ï¼‰ã€‚ä¸è¿‡ï¼Œè¿™ä¸ªæ•°å­—è‚¯å®šè‡³å°‘æ˜¯1000ï¼Œå› ä¸ºsetTimeoutå›è°ƒåœ¨whileå¾ªç¯ç»“æŸè¿è¡Œä¹‹å‰ä¸å¯èƒ½è¢«è§¦å‘ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¦‚æœsetTimeoutæ²¡æœ‰ä½¿ç”¨å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œé‚£å®ƒåˆ°åº•åœ¨åšä»€ä¹ˆå‘¢ï¼Ÿ</p>
<h3 id="é˜Ÿåˆ—"><a href="#é˜Ÿåˆ—" class="headerlink" title="é˜Ÿåˆ—"></a>é˜Ÿåˆ—</h3><p>è°ƒç”¨setTimeoutçš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªå»¶æ—¶äº‹ä»¶æ’å…¥é˜Ÿåˆ—ã€‚ç„¶åsetTimeoutè°ƒç”¨ä¹‹åçš„é‚£è¡Œä»£ç è¿è¡Œï¼Œæ¥ç€æ˜¯å†ä¸‹ä¸€è¡Œä»£ç ï¼Œç›´åˆ°å†ä¹Ÿæ²¡æœ‰ä»»ä½•ä»£ç ã€‚è¿™æ—¶JavaScriptè™šæ‹Ÿæœºæ‰ä¼šé—®ï¼šâ€œé˜Ÿåˆ—é‡Œéƒ½æœ‰è°å•Šï¼Ÿâ€</p>
<p>å¦‚æœé˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸€ä¸ªäº‹ä»¶é€‚åˆäºâ€œè§¦å‘â€ï¼ˆå°±åƒ1000æ¯«ç§’ä¹‹å‰è®¾å®šå¥½çš„é‚£ä¸ªä¸ºæœŸ500æ¯«ç§’çš„å»¶æ—¶äº‹ä»¶ï¼‰ï¼Œåˆ™è™šæ‹Ÿæœºä¼šæŒ‘é€‰ä¸€ä¸ªäº‹ä»¶ï¼Œå¹¶è°ƒç”¨æ­¤äº‹ä»¶çš„å¤„ç†å™¨ï¼ˆè­¬å¦‚ä¼ ç»™setTimeoutçš„é‚£ä¸ªå‡½æ•°ï¼‰ã€‚äº‹ä»¶å¤„ç†å™¨è¿”å›åï¼Œæˆ‘ä»¬åˆå›åˆ°é˜Ÿåˆ—å¤„ã€‚</p>
<p>è¾“å…¥äº‹ä»¶çš„å·¥ä½œæ–¹å¼å®Œå…¨ä¸€æ ·ï¼šç”¨æˆ·å•å‡»ä¸€ä¸ªå·²é™„åŠ æœ‰å•å‡»äº‹ä»¶å¤„ç†å™¨çš„DOMï¼ˆDocument Object Modelï¼Œæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰å…ƒç´ æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªå•å‡»äº‹ä»¶æ’å…¥é˜Ÿåˆ—ã€‚ä½†æ˜¯ï¼Œè¯¥å•å‡»äº‹ä»¶å¤„ç†å™¨è¦ç­‰åˆ°å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ä»£ç å‡å·²ç»“æŸåï¼ˆå¯èƒ½è¿˜è¦ç­‰å…¶ä»–æ­¤å‰å·²æ’é˜Ÿçš„äº‹ä»¶ä¹Ÿä¾æ¬¡ç»“æŸï¼‰æ‰ä¼šæ‰§è¡Œã€‚å› æ­¤ï¼Œä½¿ç”¨JavaScriptçš„é‚£äº›ç½‘é¡µä¸€ä¸å°å¿ƒå°±ä¼šå˜å¾—æ¯«æ— ååº”ã€‚ä½ å¯èƒ½å¬è¿‡äº‹ä»¶å¾ªç¯è¿™ä¸ªæœ¯è¯­ï¼Œå®ƒæ˜¯ç”¨äºæè¿°é˜Ÿåˆ—å·¥ä½œæ–¹å¼çš„ã€‚æ‰€è°“äº‹ä»¶å¾ªç¯ï¼Œå°±åƒä»£ç ä»ä¸€ä¸ªå¾ªç¯ä¸­ä¸æ–­å–å‡ºè€Œè¿è¡Œä¸€æ ·ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="title function_">runYourScript</span>();</span><br><span class="line"><span class="keyword">while</span> (atLeastOneEventIsQueued) &#123; </span><br><span class="line">       <span class="title function_">fireNextQueuedEvent</span>(); </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>è¿™éšå«ç€ä¸€ä¸ªæ„æ€ï¼Œå³è§¦å‘çš„æ¯ä¸ªäº‹ä»¶éƒ½ä¼šä½äºå †æ ˆè½¨è¿¹çš„åº•éƒ¨ã€‚å…³äºè¿™ä¸€ç‚¹ï¼Œ1.4èŠ‚ä¼šè¿›ä¸€æ­¥é˜è¿°ã€‚</p>
<p>äº‹ä»¶çš„æ˜“è°ƒåº¦æ€§æ˜¯JavaScriptè¯­è¨€æœ€å¤§çš„ç‰¹è‰²ä¹‹ä¸€ã€‚åƒsetTimeoutè¿™æ ·çš„å¼‚æ­¥å‡½æ•°åªæ˜¯ç®€å•åœ°åšå»¶è¿Ÿæ‰§è¡Œï¼Œè€Œä¸æ˜¯å­µåŒ–æ–°çš„çº¿ç¨‹ã€‚JavaScriptä»£ç æ°¸è¿œä¸ä¼šè¢«ä¸­æ–­ï¼Œè¿™æ˜¯å› ä¸ºä»£ç åœ¨è¿è¡ŒæœŸé—´åªéœ€è¦æ’é˜Ÿäº‹ä»¶å³å¯ï¼Œè€Œè¿™äº›äº‹ä»¶åœ¨ä»£ç è¿è¡Œç»“æŸä¹‹å‰ä¸ä¼šè¢«è§¦å‘ã€‚</p>
<p>ä¸‹ä¸€èŠ‚å°†æ›´ç»†è‡´åœ°è€ƒæŸ¥å¼‚æ­¥JavaScriptä»£ç çš„æ„é€ å—ã€‚</p>
<h2 id="å¼‚æ­¥å‡½æ•°çš„ç±»å‹"><a href="#å¼‚æ­¥å‡½æ•°çš„ç±»å‹" class="headerlink" title="å¼‚æ­¥å‡½æ•°çš„ç±»å‹"></a>å¼‚æ­¥å‡½æ•°çš„ç±»å‹</h2><p>æ¯ä¸€ç§JavaScriptç¯å¢ƒéƒ½æœ‰è‡ªå·±çš„å¼‚æ­¥å‡½æ•°é›†ã€‚æœ‰äº›å‡½æ•°ï¼Œå¦‚setTimeoutå’ŒsetIntervalï¼Œæ˜¯å„ç§JavaScriptç¯å¢ƒæ™®ééƒ½æœ‰çš„ã€‚å¦ä¸€äº›å‡½æ•°åˆ™ä¸“å±äºæŸäº›æµè§ˆå™¨æˆ–æŸå‡ ç§æœåŠ¡å™¨ç«¯æ¡†æ¶ã€‚JavaScriptç¯å¢ƒæä¾›çš„å¼‚æ­¥å‡½æ•°é€šå¸¸å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼šI&#x2F;Oå‡½æ•°å’Œè®¡æ—¶å‡½æ•°ã€‚å¦‚æœæƒ³åœ¨åº”ç”¨ä¸­å®šä¹‰å¤æ‚çš„å¼‚æ­¥è¡Œä¸ºï¼Œå°±è¦ä½¿ç”¨è¿™ä¸¤ç±»å¼‚æ­¥å‡½æ•°ä½œä¸ºåŸºæœ¬çš„æ„é€ å—ã€‚</p>
<h3 id="å¼‚æ­¥çš„I-x2F-Oå‡½æ•°"><a href="#å¼‚æ­¥çš„I-x2F-Oå‡½æ•°" class="headerlink" title="å¼‚æ­¥çš„I&#x2F;Oå‡½æ•°"></a>å¼‚æ­¥çš„I&#x2F;Oå‡½æ•°</h3><p>åˆ›é€ Node.jsï¼Œå¹¶ä¸æ˜¯ä¸ºäº†äººä»¬èƒ½åœ¨æœåŠ¡å™¨ä¸Šè¿è¡ŒJavaScriptï¼Œä»…ä»…æ˜¯å› ä¸ºRyan Dahlæƒ³è¦ä¸€ä¸ªå»ºç«‹åœ¨æŸé«˜çº§è¯­è¨€ä¹‹ä¸Šçš„äº‹ä»¶é©±åŠ¨å‹æœåŠ¡å™¨æ¡†æ¶ã€‚JavaScriptç¢°å·§å°±æ˜¯é€‚åˆå¹²è¿™ä¸ªçš„è¯­è¨€ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºJavaScriptè¯­è¨€å¯ä»¥å®Œç¾åœ°å®ç°éé˜»å¡å¼I&#x2F;Oã€‚</p>
<p>åœ¨å…¶ä»–è¯­è¨€ä¸­ï¼Œä¸€ä¸å°å¿ƒå°±ä¼šâ€œé˜»å¡â€åº”ç”¨ï¼ˆé€šå¸¸æ˜¯è¿è¡Œå¾ªç¯ï¼‰ç›´åˆ°å®ŒæˆI&#x2F;Oè¯·æ±‚ä¸ºæ­¢ã€‚è€Œåœ¨JavaScriptä¸­ï¼Œè¿™ç§é˜»å¡æ–¹å¼å‡ ä¹æ²¦ä¸ºæ— ç¨½ä¹‹è°ˆã€‚ç±»ä¼¼å¦‚ä¸‹çš„å¾ªç¯å°†æ°¸è¿œè¿è¡Œä¸‹å»ï¼Œä¸å¯èƒ½åœä¸‹æ¥ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ajaxRequest = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>; </span><br><span class="line">ajaxRequest.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, url); </span><br><span class="line">ajaxRequest.<span class="title function_">send</span>(<span class="literal">null</span>); </span><br><span class="line"><span class="keyword">while</span> (ajaxRequest.<span class="property">readyState</span> === <span class="title class_">XMLHttpRequest</span>.<span class="property">UNSENT</span>) &#123;  </span><br><span class="line">     <span class="comment">// readyStateåœ¨å¾ªç¯è¿”å›ä¹‹å‰ä¸ä¼šæœ‰æ›´æ”¹ã€‚</span></span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<p>ç›¸åï¼Œæˆ‘ä»¬éœ€è¦é™„åŠ ä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ï¼Œéšå³è¿”å›äº‹ä»¶é˜Ÿåˆ—ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> ajaxRequest = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>; </span><br><span class="line">ajaxRequest.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, url);</span><br><span class="line">ajaxRequest.<span class="title function_">send</span>(<span class="literal">null</span>); </span><br><span class="line">ajaxRequest.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;  </span><br><span class="line">    <span class="comment">// ... </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯è¿™ä¹ˆå›äº‹ã€‚ä¸è®ºæ˜¯åœ¨ç­‰å¾…ç”¨æˆ·çš„æŒ‰é”®è¡Œä¸ºï¼Œè¿˜æ˜¯åœ¨ç­‰å¾…è¿œç¨‹æœåŠ¡å™¨çš„æ‰¹é‡æ•°æ®ï¼Œæ‰€éœ€è¦åšçš„å°±æ˜¯å®šä¹‰ä¸€ä¸ªå›è°ƒï¼Œé™¤éJavaScriptç¯å¢ƒæä¾›çš„æŸä¸ªåŒæ­¥I&#x2F;Oå‡½æ•°å·²ç»æ›¿æˆ‘ä»¬å®Œæˆäº†é˜»å¡ã€‚</p>
<p>åœ¨æµè§ˆå™¨ç«¯ï¼ŒAjaxæ–¹æ³•æœ‰ä¸€ä¸ªå¯è®¾ç½®ä¸ºfalseçš„asyncé€‰é¡¹ï¼ˆä½†æ°¸è¿œã€æ°¸è¿œåˆ«è¿™ä¹ˆåšï¼‰ï¼Œè¿™ä¼šæŒ‚èµ·æ•´ä¸ªæµè§ˆå™¨çª—æ ¼ç›´åˆ°æ”¶åˆ°åº”ç­”ä¸ºæ­¢ã€‚åœ¨Node.jsä¸­ï¼ŒåŒæ­¥çš„APIæ–¹æ³•åœ¨åç§°ä¸Šä¼šæœ‰æ˜ç¡®çš„æ ‡ç¤ºï¼Œè­¬å¦‚fs.readFileSyncã€‚ç¼–å†™çŸ­å°çš„è„šæœ¬æ—¶ï¼Œè¿™äº›åŒæ­¥æ–¹æ³•ä¼šå¾ˆæ–¹ä¾¿ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‰€ç¼–å†™çš„åº”ç”¨éœ€è¦å¤„ç†å¹¶è¡Œçš„å¤šä¸ªè¯·æ±‚æˆ–å¤šé¡¹æ“ä½œï¼Œåˆ™åº”è¯¥é¿å…ä½¿ç”¨å®ƒä»¬ã€‚å¯åœ¨ä»Šå¤©ï¼Œè¿˜æœ‰å“ªä¸ªåº”ç”¨ä¸æ˜¯è¿™æ ·çš„å‘¢ï¼Ÿ</p>
<p>æœ‰äº›I&#x2F;Oå‡½æ•°æ—¢æœ‰åŒæ­¥æ•ˆåº”ï¼Œä¹Ÿæœ‰å¼‚æ­¥æ•ˆåº”ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨ç°ä»£æµè§ˆå™¨ä¸­æ“çºµDOMå¯¹è±¡æ—¶ï¼Œä»è„šæœ¬è§’åº¦çœ‹ï¼Œæ›´æ”¹æ˜¯å³æ—¶ç”Ÿæ•ˆçš„ï¼Œä½†ä»è§†æ•ˆè§’åº¦çœ‹ï¼Œåœ¨è¿”å›äº‹ä»¶é˜Ÿåˆ—ä¹‹å‰ä¸ä¼šæ¸²æŸ“è¿™äº›DOMå¯¹è±¡æ›´æ”¹ã€‚è¿™å¯ä»¥é˜²æ­¢DOMå¯¹è±¡è¢«æ¸²æŸ“æˆä¸ä¸€è‡´çš„çŠ¶æ€ã€‚</p>
<blockquote>
<p>console.logæ˜¯å¼‚æ­¥çš„å—ï¼Ÿ</p>
</blockquote>
<p>WebKitçš„console.logç”±äºè¡¨ç°å‡ºå¼‚æ­¥è¡Œä¸ºè€Œè®©å¾ˆå¤šå¼€å‘è€…æƒŠè¯§ä¸å·²ã€‚åœ¨Chromeæˆ–Safariä¸­ï¼Œä»¥ä¸‹è¿™æ®µä»£ç ä¼šåœ¨æ§åˆ¶å°è®°å½•{foo:bar}ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;&#125;;    </span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj);    </span><br><span class="line">obj.<span class="property">foo</span> = <span class="string">&#x27;bar&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>æ€ä¹ˆä¼šè¿™æ ·ï¼ŸWe b K i tçš„console.logå¹¶æ²¡æœ‰ç«‹å³æ‹æ‘„å¯¹è±¡å¿«ç…§ï¼Œç›¸åï¼Œå®ƒåªå­˜å‚¨äº†ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ï¼Œç„¶ååœ¨ä»£ç è¿”å›äº‹ä»¶é˜Ÿåˆ—æ—¶æ‰å»æ‹æ‘„å¿«ç…§ã€‚Nodeçš„console.logæ˜¯å¦ä¸€å›äº‹ï¼Œå®ƒæ˜¯ä¸¥æ ¼åŒæ­¥çš„ï¼Œå› æ­¤åŒæ ·çš„ä»£ç è¾“å‡ºçš„å´ä¸º{}ã€‚</p>
<p>JavaScripté‡‡ç”¨äº†éé˜»å¡å¼I&#x2F;Oï¼Œè¿™å¯¹æ–°æ‰‹æ¥è¯´æ˜¯æœ€å¤§çš„ä¸€ä¸ªéšœç¢ï¼Œä½†è¿™åŒæ ·ä¹Ÿæ˜¯è¯¥è¯­è¨€çš„æ ¸å¿ƒä¼˜åŠ¿ä¹‹ä¸€ã€‚æœ‰äº†éé˜»å¡å¼I&#x2F;Oï¼Œå°±èƒ½è‡ªç„¶è€Œç„¶åœ°å†™å‡ºé«˜æ•ˆçš„åŸºäºäº‹ä»¶çš„ä»£ç ã€‚</p>
<h3 id="å¼‚æ­¥çš„è®¡æ—¶å‡½æ•°"><a href="#å¼‚æ­¥çš„è®¡æ—¶å‡½æ•°" class="headerlink" title="å¼‚æ­¥çš„è®¡æ—¶å‡½æ•°"></a>å¼‚æ­¥çš„è®¡æ—¶å‡½æ•°</h3><p>æˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œå¼‚æ­¥å‡½æ•°éå¸¸é€‚åˆç”¨äºI&#x2F;Oæ“ä½œï¼Œä½†æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬ä»…ä»…æ˜¯å› ä¸ºéœ€è¦å¼‚æ­¥è€Œæƒ³è¦å¼‚æ­¥æ€§ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æƒ³è®©ä¸€ä¸ªå‡½æ•°åœ¨å°†æ¥æŸä¸ªæ—¶åˆ»å†è¿è¡Œâ€”â€”è¿™æ ·çš„å‡½æ•°å¯èƒ½æ˜¯ä¸ºäº†ä½œåŠ¨ç”»æˆ–æ¨¡æ‹Ÿã€‚åŸºäºæ—¶é—´çš„äº‹ä»¶æ¶‰åŠä¸¤ä¸ªè‘—åçš„å‡½æ•°ï¼Œå³setTimeoutä¸setIntervalã€‚é—æ†¾çš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªè‘—åçš„è®¡æ—¶å™¨å‡½æ•°éƒ½æœ‰è‡ªå·±çš„ä¸€äº›ç¼ºé™·ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨1.1.2èŠ‚ä¸­çœ‹åˆ°çš„ï¼Œå…¶ä¸­æœ‰ä¸ªç¼ºé™·æ˜¯æ— æ³•å¼¥è¡¥çš„ï¼šå½“åŒä¸€ä¸ªJavaScriptè¿›ç¨‹æ­£è¿è¡Œç€ä»£ç æ—¶ï¼Œä»»ä½•JavaScriptè®¡æ—¶å‡½æ•°éƒ½æ— æ³•ä½¿å…¶ä»–ä»£ç è¿è¡Œèµ·æ¥ã€‚ä½†æ˜¯ï¼Œå³ä¾¿å®¹å¿äº†è¿™ä¸€å±€é™æ€§ï¼ŒsetTimeoutåŠsetIntervalçš„ä¸ç¡®å®šæ€§ä¹Ÿä¼šä»¤äººçŠ¯æ€µã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fireCount = <span class="number">0</span>; </span><br><span class="line"><span class="keyword">var</span> start = <span class="keyword">new</span> <span class="title class_">Date</span>; </span><br><span class="line"><span class="keyword">var</span> timer = <span class="built_in">setInterval</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">     <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Date</span>-start &gt; <span class="number">1000</span>) &#123; </span><br><span class="line">            <span class="built_in">clearInterval</span>(timer);     </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(fireCount);   </span><br><span class="line">            <span class="keyword">return</span>;   </span><br><span class="line">    &#125;   </span><br><span class="line">    fireCount++; </span><br><span class="line">&#125;, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½¿ç”¨setIntervalè°ƒåº¦äº‹ä»¶ä¸”å»¶è¿Ÿè®¾å®šä¸º0æ¯«ç§’ï¼Œåˆ™ä¼šå°½å¯èƒ½é¢‘ç¹åœ°è¿è¡Œæ­¤äº‹ä»¶ï¼Œå¯¹å—ï¼Ÿé‚£ä¹ˆï¼Œåœ¨è¿è¡Œäºé«˜é€Ÿè‹±ç‰¹å°”i7å¤„ç†å™¨ä¹‹ä¸Šçš„ç°ä»£æµè§ˆå™¨ä¸­ï¼Œæ­¤äº‹ä»¶çš„è§¦å‘é¢‘ç‡åˆ°åº•å¦‚ä½•å‘¢ï¼Ÿ</p>
<p>å¤§çº¦ä¸º200æ¬¡&#x2F;ç§’ã€‚è¿™æ˜¯Chromeã€Safariå’ŒFirefoxç­‰æµè§ˆå™¨çš„å¹³å‡å€¼ã€‚åœ¨Nodeç¯å¢ƒä¸‹ï¼Œæ­¤äº‹ä»¶çš„è§¦å‘é¢‘ç‡å¤§çº¦èƒ½è¾¾åˆ°1000æ¬¡&#x2F;ç§’ã€‚ï¼ˆè‹¥ä½¿ç”¨setTimeoutæ¥è°ƒåº¦äº‹ä»¶ï¼Œé‡å¤è¿™äº›å®éªŒä¹Ÿä¼šå¾—åˆ°ç±»ä¼¼çš„ç»“æœã€‚ï¼‰ä½œä¸ºå¯¹æ¯”ï¼Œå¦‚æœå°†setIntervalæ›¿æ¢æˆç®€å•çš„whileå¾ªç¯ï¼Œåˆ™åœ¨Chromeä¸­æ­¤äº‹ä»¶çš„è§¦å‘é¢‘ç‡å°†è¾¾åˆ°400ä¸‡æ¬¡&#x2F;ç§’ï¼Œè€Œåœ¨Nodeä¸­ä¼šè¾¾åˆ°500ä¸‡æ¬¡&#x2F;ç§’</p>
<p>è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿæœ€åæˆ‘ä»¬å‘ç°ï¼ŒsetTimeoutå’ŒsetIntervalå°±æ˜¯æƒ³è®¾è®¡æˆæ…¢ååçš„ï¼äº‹å®ä¸Šï¼ŒHTMLè§„èŒƒï¼ˆè¿™æ˜¯æ‰€æœ‰ä¸»è¦æµè§ˆå™¨éƒ½éµå®ˆçš„è§„èŒƒï¼‰æ¨è¡Œçš„å»¶æ—¶&#x2F;æ—¶éš”çš„æœ€å°å€¼å°±æ˜¯4æ¯«ç§’ï¼</p>
<p>é‚£ä¹ˆï¼Œå¦‚æœéœ€è¦æ›´ç»†ç²’åº¦çš„è®¡æ—¶ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæœ‰äº›è¿è¡Œæ—¶ç¯å¢ƒæä¾›äº†å¤‡é€‰æ–¹æ¡ˆã€‚</p>
<blockquote>
<p>1: åœ¨Nodeä¸­ï¼Œprocess.nextTickå…è®¸å°†äº‹ä»¶è°ƒåº¦æˆå°½å¯èƒ½å¿«åœ°è§¦å‘ã€‚å¯¹äºç¬”è€…çš„ç³»ç»Ÿï¼Œprocess.nextTickäº‹ä»¶çš„è§¦å‘é¢‘ç‡å¯ä»¥è¶…è¿‡10ä¸‡æ¬¡&#x2F;ç§’ã€‚<br>2: ä¸€äº›ç°ä»£æµè§ˆå™¨ï¼ˆå«IE9+ï¼‰å¸¦æœ‰ä¸€ä¸ªrequestAnimationFrameå‡½æ•°ã€‚æ­¤å‡½æ•°æœ‰ä¸¤ä¸ªç›®æ ‡ï¼šä¸€æ–¹é¢ï¼Œå®ƒå…è®¸ä»¥60+å¸§&#x2F;ç§’çš„é€Ÿåº¦è¿è¡ŒJavaScriptåŠ¨ç”»ï¼›å¦ä¸€æ–¹é¢ï¼Œå®ƒåˆé¿å…åå°é€‰é¡¹å¡è¿è¡Œè¿™äº›åŠ¨ç”»ï¼Œä»è€ŒèŠ‚çº¦CPUå‘¨æœŸã€‚åœ¨æœ€æ–°ç‰ˆçš„Chromeæµè§ˆå™¨ä¸­ï¼Œç”šè‡³èƒ½å®ç°äºšæ¯«ç§’çº§çš„ç²¾åº¦</p>
</blockquote>
<p>å°½ç®¡è¿™äº›è®¡æ—¶å‡½æ•°æ˜¯å¼‚æ­¥JavaScriptæ··é¥­åƒçš„å®¶ä¼™ä»€å„¿ï¼Œä½†æ°¸è¿œä¸è¦å¿˜è®°ï¼ŒsetTimeoutå’ŒsetIntervalå°±æ˜¯äº›ä¸ç²¾ç¡®çš„è®¡æ—¶å·¥å…·ã€‚åœ¨Nodeä¸­ï¼Œå¦‚æœåªæ˜¯æƒ³äº§ç”Ÿä¸€ä¸ªçŸ­æ—¶å»¶è¿Ÿï¼Œè¯·ä½¿ç”¨process.nextTickã€‚åœ¨æµè§ˆå™¨ç«¯ï¼Œè¯·å°è¯•ä½¿ç”¨å«ç‰‡æŠ€æœ¯ï¼ˆshimï¼‰â‘¢ï¼šåœ¨æ”¯æŒrequestAnimationFrameçš„æµè§ˆå™¨ä¸­ï¼Œæ¨èä½¿ç”¨requestAnimationFrameï¼›åœ¨ä¸æ”¯æŒrequestAnimationFrameçš„æµè§ˆå™¨ä¸­ï¼Œåˆ™é€€è€Œä½¿ç”¨setTimeoutã€‚</p>
<p>åˆ°è¿™é‡Œï¼Œå…³äºJavaScriptåŸºæœ¬å¼‚æ­¥å‡½æ•°çš„ç®€è¦æ¦‚è§ˆå°±ç»“æŸäº†ã€‚ä½†æ€æ ·æ‰èƒ½çŸ¥é“ä¸€ä¸ªå‡½æ•°åˆ°åº•ä½•æ—¶å¼‚æ­¥å‘¢ï¼Ÿä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åœ¨äº²è‡ªç¼–å†™å¼‚æ­¥å‡½æ•°çš„åŒæ—¶å†æ€è€ƒè¿™ä¸ªé—®é¢˜</p>
<h2 id="å¼‚æ­¥å‡½æ•°çš„ç¼–å†™"><a href="#å¼‚æ­¥å‡½æ•°çš„ç¼–å†™" class="headerlink" title="å¼‚æ­¥å‡½æ•°çš„ç¼–å†™"></a>å¼‚æ­¥å‡½æ•°çš„ç¼–å†™</h2><p>JavaScriptä¸­çš„æ¯ä¸ªå¼‚æ­¥å‡½æ•°éƒ½æ„å»ºåœ¨å…¶ä»–æŸä¸ªæˆ–æŸäº›å¼‚æ­¥å‡½æ•°ä¹‹ä¸Šã€‚å‡¡æ˜¯å¼‚æ­¥å‡½æ•°ï¼Œä»ä¸Šåˆ°ä¸‹ï¼ˆä¸€ç›´åˆ°åŸç”Ÿä»£ç ï¼‰éƒ½æ˜¯å¼‚æ­¥çš„ï¼</p>
<p>åä¹‹äº¦ç„¶ï¼šä»»ä½•å‡½æ•°åªè¦ä½¿ç”¨äº†å¼‚æ­¥çš„å‡½æ•°ï¼Œå°±å¿…é¡»ä»¥å¼‚æ­¥çš„æ–¹å¼ç»™å‡ºå…¶æ“ä½œç»“æœã€‚æ­£å¦‚æˆ‘ä»¬åœ¨1.1.2èŠ‚å­¦åˆ°çš„ï¼ŒJavaScriptå¹¶æ²¡æœ‰æä¾›ä¸€ç§æœºåˆ¶ä»¥é˜»æ­¢å‡½æ•°åœ¨å…¶å¼‚æ­¥æ“ä½œç»“æŸä¹‹å‰è¿”å›ã€‚äº‹å®ä¸Šï¼Œé™¤éå‡½æ•°è¿”å›ï¼Œå¦åˆ™ä¸ä¼šè§¦å‘ä»»ä½•å¼‚æ­¥äº‹ä»¶ã€‚</p>
<p>æœ¬èŠ‚å°†è€ƒå¯Ÿå¼‚æ­¥å‡½æ•°è®¾è®¡çš„ä¸€äº›å¸¸è§æ¨¡å¼ã€‚æˆ‘ä»¬å°†çœ‹åˆ°æœ‰äº›å‡½æ•°å¦‚åå¤æ— å¸¸çš„å°äººï¼Œéå¾—ç­‰åˆ°ç‰¹å®šæ—¶å€™æ‰ä¸‹å†³å¿ƒæˆä¸ºå¼‚æ­¥çš„ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å…ˆæ¥ç²¾ç¡®åœ°å®šä¹‰å¼‚æ­¥å‡½æ•°ã€‚</p>
<h3 id="ä½•æ—¶ç§°å‡½æ•°ä¸ºå¼‚æ­¥çš„"><a href="#ä½•æ—¶ç§°å‡½æ•°ä¸ºå¼‚æ­¥çš„" class="headerlink" title="ä½•æ—¶ç§°å‡½æ•°ä¸ºå¼‚æ­¥çš„"></a>ä½•æ—¶ç§°å‡½æ•°ä¸ºå¼‚æ­¥çš„</h3><p>å¼‚æ­¥å‡½æ•°è¿™ä¸ªæœ¯è¯­æœ‰ç‚¹åä¸å‰¯å®ï¼šè°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œç¨‹åºåªåœ¨è¯¥å‡½æ•°è¿”å›ä¹‹åæ‰èƒ½ç»§ç»­ã€‚JavaScriptå†™æ‰‹å¦‚æœç§°ä¸€ä¸ªå‡½æ•°ä¸ºâ€œå¼‚æ­¥çš„â€ï¼Œå…¶æ„æ€æ˜¯è¿™ä¸ªå‡½æ•°ä¼šå¯¼è‡´å°†æ¥å†è¿è¡Œå¦ä¸€ä¸ªå‡½æ•°ï¼Œåè€…å–è‡ªäºäº‹ä»¶é˜Ÿåˆ—ï¼ˆè‹¥åé¢è¿™ä¸ªå‡½æ•°æ˜¯ä½œä¸ºå‚æ•°ä¼ é€’ç»™å‰è€…çš„ï¼Œåˆ™ç§°å…¶ä¸ºå›è°ƒå‡½æ•°ï¼Œç®€ç§°ä¸ºå›è°ƒï¼‰  ã€‚äºæ˜¯ï¼Œä¸€ä¸ªå–ç”¨å›è°ƒçš„å¼‚æ­¥å‡½æ•°æ°¸è¿œéƒ½èƒ½é€šè¿‡ä»¥ä¸‹æµ‹è¯•</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> functionHasReturned = <span class="literal">false</span>; </span><br><span class="line"><span class="title function_">asyncFunction</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;  </span><br><span class="line">     <span class="variable language_">console</span>.<span class="title function_">assert</span>(functionHasReturned); </span><br><span class="line">&#125;); </span><br><span class="line">functionHasReturned = <span class="literal">true</span>;</span><br></pre></td></tr></table></figure>

<p>å¼‚æ­¥å‡½æ•°è¿˜æ¶‰åŠå¦ä¸€ä¸ªæœ¯è¯­ï¼Œå³éé˜»å¡ã€‚éé˜»å¡è¿™ä¸ªè¯å¼ºè°ƒäº†å¼‚æ­¥å‡½æ•°çš„é«˜é€Ÿåº¦ï¼šå¼‚æ­¥MySQLæ•°æ®åº“é©±åŠ¨ç¨‹åºåšä¸€ä¸ªæŸ¥è¯¢å¯èƒ½è¦èŠ±ä¸Šä¸€å°æ—¶ï¼Œä½†è´Ÿè´£å‘é€æŸ¥è¯¢è¯·æ±‚çš„é‚£ä¸ªå‡½æ•°å´èƒ½ä»¥å¾®ç§’çº§é€Ÿåº¦è¿”å›ã€‚è¿™å¯¹äºé‚£äº›éœ€è¦å¿«é€Ÿå¤„ç†æµ·é‡è¯·æ±‚çš„ç½‘ç«™æœåŠ¡å™¨æ¥è¯´ï¼Œç»å¯¹æ˜¯ä¸ªç¦éŸ³ã€‚</p>
<p>é€šå¸¸ï¼Œé‚£äº›å–ç”¨å›è°ƒçš„å‡½æ•°éƒ½ä¼šå°†å…¶ä½œä¸ºè‡ªå·±çš„æœ€åä¸€ä¸ªå‚æ•°ã€‚ï¼ˆå¯æƒœçš„æ˜¯ï¼Œè€èµ„æ ¼çš„setTimeoutå’ŒsetIntervaléƒ½æ˜¯è¿™ä¸€çº¦å®šçš„ç‰¹ä¾‹ã€‚ï¼‰ä¸è¿‡ï¼Œæœ‰äº›å¼‚æ­¥å‡½æ•°ä¹Ÿä¼šé—´æ¥å–ç”¨å›è°ƒï¼Œå®ƒä»¬ä¼šè¿”å›Promiseå¯¹è±¡æˆ–ä½¿ç”¨PubSubæ¨¡å¼ã€‚æœ¬ä¹¦ç¨åå°±ä¼šä»‹ç»è¿™äº›å¼‚æ­¥è®¾è®¡æ¨¡å¼ã€‚</p>
<p>é—æ†¾çš„æ˜¯ï¼Œè¦æƒ³ç¡®è®¤æŸä¸ªå‡½æ•°å¼‚æ­¥ä¸å¦ï¼Œå”¯ä¸€çš„æ–¹æ³•å°±æ˜¯å®¡æŸ¥å…¶æºä»£ç ã€‚æœ‰äº›åŒæ­¥å‡½æ•°å´æ‹¥æœ‰çœ‹èµ·æ¥åƒæ˜¯å¼‚æ­¥çš„APIï¼Œè¿™æˆ–è€…æ˜¯å› ä¸ºå®ƒä»¬å°†æ¥å¯èƒ½ä¼šå˜æˆå¼‚æ­¥çš„ï¼Œåˆæˆ–è€…æ˜¯å› ä¸ºå›è°ƒè¿™ç§å½¢å¼èƒ½æ–¹ä¾¿åœ°è¿”å›å¤šä¸ªå‚æ•°ã€‚ä¸€æ—¦å­˜ç–‘ï¼Œè¯·åˆ«æŒ‡æœ›å‡½æ•°å°±æ˜¯å¼‚æ­¥çš„ã€‚</p>
<h3 id="é—´æˆ–å¼‚æ­¥çš„å‡½æ•°"><a href="#é—´æˆ–å¼‚æ­¥çš„å‡½æ•°" class="headerlink" title="é—´æˆ–å¼‚æ­¥çš„å‡½æ•°"></a>é—´æˆ–å¼‚æ­¥çš„å‡½æ•°</h3><p>æœ‰äº›å‡½æ•°æŸäº›æ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼Œä½†å…¶ä»–æ—¶å€™å´ä¸ç„¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒjQueryçš„åŒåå‡½æ•°ï¼ˆé€šå¸¸è®°ä½œ$ï¼‰å¯ç”¨äºå»¶è¿Ÿå‡½æ•°ç›´è‡³DOMå·²ç»ç»“æŸåŠ è½½ã€‚ä½†æ˜¯ï¼Œè‹¥DOMæ—©å·²ç»“æŸäº†åŠ è½½ï¼Œåˆ™ä¸å­˜åœ¨ä»»ä½•å»¶è¿Ÿï¼Œ$çš„å›è°ƒå°†ä¼šç«‹å³è§¦å‘ã€‚</p>
<p>ä¸æ³¨æ„çš„è¯ï¼Œè¿™ç§è¡Œä¸ºçš„ä¸å¯é¢„çŸ¥æ€§ä¼šå¸¦æ¥å¾ˆå¤šéº»çƒ¦ã€‚æˆ‘æ›¾ç»çœ‹åˆ°ä¹ŸçŠ¯è¿‡è¿™æ ·ä¸€ä¸ªé”™è¯¯ï¼Œå³å‡å®š$ä¼šåœ¨å·²åŠ è½½æœ¬é¡µé¢å…¶ä»–è„šæœ¬ä¹‹åå†è¿è¡Œä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// application.js </span></span><br><span class="line">$(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    utils.<span class="title function_">log</span>(<span class="string">&#x27;Ready&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// utils.js </span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">utils</span> = &#123;</span><br><span class="line">    <span class="attr">log</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">console</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="property">log</span>.<span class="title function_">apply</span>(<span class="variable language_">console</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">&lt;script src ï¼&quot;application.js&quot; &gt;&lt;/script &gt;</span><br><span class="line">&lt;script src ï¼&quot;util.js&quot; &gt;&lt;/script &gt;</span><br></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç è¿è¡Œå¾—å¾ˆå¥½ï¼Œä½†å‰ææ˜¯æµè§ˆå™¨å¹¶æœªä»ç¼“å­˜ä¸­åŠ è½½é¡µé¢ï¼ˆè¿™ä¼šå¯¼è‡´DOMæ—©åœ¨è„šæœ¬è¿è¡Œä¹‹å‰å°±å·²åŠ è½½å°±ç»ªï¼‰ã€‚å¦‚æœå‡ºç°è¿™ç§æƒ…å†µï¼Œä¼ é€’ç»™$çš„å›è°ƒå°±ä¼šåœ¨è®¾ç½®utils.logä¹‹å‰è¿è¡Œï¼Œä»è€Œå¯¼è‡´ä¸€ä¸ªé”™è¯¯ã€‚ï¼ˆä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œåº”è¯¥é‡‡ç”¨ä¸€ç§æ›´ç°ä»£çš„ç®¡ç†å®¢æˆ·ç«¯ä¾èµ–æ€§çš„æ–¹æ³•ã€‚è¯·å‚é˜…ç¬¬6ç« ã€‚ï¼‰</p>
<p>ä¸‹é¢æ¥çœ‹å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<h3 id="ç¼“å­˜å‹å¼‚æ­¥å‡½æ•°"><a href="#ç¼“å­˜å‹å¼‚æ­¥å‡½æ•°" class="headerlink" title="ç¼“å­˜å‹å¼‚æ­¥å‡½æ•°"></a>ç¼“å­˜å‹å¼‚æ­¥å‡½æ•°</h3><p>é—´æˆ–å¼‚æ­¥çš„å‡½æ•°æœ‰ä¸€ä¸ªå¸¸è§å˜ç§æ˜¯å¯ç¼“å­˜ç»“æœçš„å¼‚æ­¥è¯·æ±‚ç±»å‡½æ•°ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æ­£åœ¨ç¼–å†™ä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„è®¡ç®—å™¨ï¼Œå®ƒä½¿ç”¨äº†ç½‘é¡µWo r k e rå¯¹è±¡ä»¥å•ç‹¬å¼€ä¸€ä¸ªçº¿ç¨‹æ¥è¿›è¡Œè®¡ç®—ã€‚ï¼ˆç¬¬5ç« å°†ä»‹ç»ç½‘é¡µWorkerå¯¹è±¡çš„APIã€‚ï¼‰ä¸»è„šæœ¬çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> calculationCache = &#123;&#125;,</span><br><span class="line">    calculationCallbacks = &#123;&#125;,</span><br><span class="line">    mathWorker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;calculator.js&#x27;</span>);</span><br><span class="line"></span><br><span class="line">mathWorker.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123; </span><br><span class="line">    <span class="keyword">var</span> message = e.<span class="property">data</span>;   </span><br><span class="line">    calculationCache[message.<span class="property">formula</span>] = message.<span class="property">result</span>;   </span><br><span class="line">    calculationCallbacks[message.<span class="property">formula</span>](message.<span class="property">result</span>); </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">runCalculation</span>(<span class="params">formula, callback</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span> (formula <span class="keyword">in</span> calculationCache) &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">callback</span>(calculationCache[formula]);   </span><br><span class="line">    &#125;;  </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (formula <span class="keyword">in</span> calculationCallbacks) &#123;  </span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;       </span><br><span class="line">            <span class="title function_">runCalculation</span>(formula, callback);    </span><br><span class="line">        &#125;, <span class="number">0</span>);   </span><br><span class="line">    &#125;;   </span><br><span class="line"></span><br><span class="line">    mathWorker.<span class="title function_">postMessage</span>(formula);   </span><br><span class="line">    calculationCallbacks[formula] = callback; </span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œï¼Œå½“ç»“æœå·²ç»ç¼“å­˜æ—¶ï¼ŒrunCalculationå‡½æ•°æ˜¯åŒæ­¥çš„ï¼Œå¦åˆ™å°±æ˜¯å¼‚æ­¥çš„ã€‚<br>å­˜åœ¨3ç§å¯èƒ½çš„æƒ…æ™¯ã€‚</p>
<p>1: å…¬å¼å·²ç»è®¡ç®—å®Œæˆï¼Œäºæ˜¯ç»“æœä½äºcalculationCacheä¸­ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒrunCalculationæ˜¯åŒæ­¥çš„ã€‚<br>2: å…¬å¼å·²ç»å‘é€ç»™Workerå¯¹è±¡ï¼Œä½†å°šæœªæ”¶åˆ°ç»“æœã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒrunCalculationè®¾å®šäº†ä¸€ä¸ªå»¶æ—¶ä»¥ä¾¿å†æ¬¡è°ƒç”¨è‡ªèº«ï¼›é‡å¤è¿™ä¸€è¿‡ç¨‹ç›´åˆ°ç»“æœä½äºcalculationCacheä¸­ä¸ºæ­¢ã€‚<br>3: å…¬å¼å°šæœªå‘é€ç»™Workerå¯¹è±¡ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå°†ä¼šä»Workerå¯¹è±¡çš„â€™messageâ€™äº‹ä»¶ç›‘å¬å™¨æ¿€æ´»å›è°ƒã€‚</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨ç¬¬2ç§å’Œç¬¬3ç§æƒ…æ™¯ä¸­ï¼Œæˆ‘ä»¬æŒ‰ç…§ä¸¤ç§ä¸åŒçš„æ–¹å¼æ¥ç­‰å¾…ä»»åŠ¡çš„å®Œæˆã€‚è¿™ä¸ªä¾‹å­å†™æˆè¿™æ ·ï¼Œå°±æ˜¯ä¸ºäº†æ¼”ç¤ºä¾æ®å“ªå‡ ç§å¸¸è§æ–¹å¼æ¥ç­‰å¾…æŸäº›ä¸œè¥¿å‘ç”Ÿæ”¹å˜ï¼ˆå¦‚ç¼“å­˜å‹è®¡ç®—å…¬å¼çš„å€¼ï¼‰ã€‚æ˜¯ä¸æ˜¯åº”è¯¥å€¾å‘äºå…¶ä¸­æŸç§æ–¹å¼å‘¢ï¼Ÿæˆ‘ä»¬æ¥ç€å¾€ä¸‹çœ‹ã€‚</p>
<h3 id="å¼‚æ­¥é€’å½’ä¸å›è°ƒå­˜å‚¨"><a href="#å¼‚æ­¥é€’å½’ä¸å›è°ƒå­˜å‚¨" class="headerlink" title="å¼‚æ­¥é€’å½’ä¸å›è°ƒå­˜å‚¨"></a>å¼‚æ­¥é€’å½’ä¸å›è°ƒå­˜å‚¨</h3><p>åœ¨runCalculationå‡½æ•°ä¸­ï¼Œä¸ºäº†ç­‰å¾…Workerå¯¹è±¡å®Œæˆè‡ªå·±çš„å·¥ä½œï¼Œæˆ–è€…é€šè¿‡å»¶æ—¶è€Œé‡å¤ç›¸åŒçš„å‡½æ•°è°ƒç”¨ï¼ˆå³å¼‚æ­¥é€’å½’ï¼‰ï¼Œæˆ–è€…ç®€å•åœ°å­˜å‚¨å›è°ƒç»“æœã€‚</p>
<p>å“ªç§æ–¹å¼æ›´å¥½å‘¢ï¼Ÿä¹ä¸€çœ‹ï¼Œåªä½¿ç”¨å¼‚æ­¥é€’å½’æ˜¯æœ€ç®€å•çš„ï¼Œå› ä¸ºè¿™é‡Œä¸å†éœ€è¦calculationCallbackså¯¹è±¡ã€‚å‡ºäºè¿™ä¸ªç›®çš„ï¼ŒJavaScriptæ–°æ‰‹å¸¸å¸¸ä¼šä½¿ç”¨setTimeoutï¼Œå› ä¸ºå®ƒå¾ˆåƒçº¿ç¨‹å‹è¯­è¨€çš„é£æ ¼ã€‚æ­¤ç¨‹åºçš„Javaç‰ˆæœ¬å¯èƒ½ä¼šæœ‰è¿™æ ·ä¸€ä¸ªå¾ªç¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (!calculationCache.<span class="title function_">get</span>(formula)) &#123;</span><br><span class="line">     <span class="title class_">Thread</span>.<span class="title function_">sleep</span>(<span class="number">0</span>); </span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œå»¶æ—¶å¹¶ä¸æ˜¯å…è´¹çš„åˆé¤ã€‚å¤§é‡å»¶æ—¶çš„è¯ï¼Œä¼šé€ æˆå·¨å¤§çš„è®¡ç®—è·è½½ã€‚å¼‚æ­¥é€’å½’æœ‰ä¸€ç‚¹å¾ˆå¯æ€•ï¼Œå³åœ¨ç­‰å¾…ä»»åŠ¡å®ŒæˆæœŸé—´ï¼Œå¯è§¦å‘ä¹‹å»¶æ—¶çš„æ¬¡æ•°æ˜¯ä¸å—é™çš„ï¼æ­¤å¤–ï¼Œå¼‚æ­¥é€’å½’è¿˜æ¯«æ— å¿…è¦åœ°å¤æ‚åŒ–äº†åº”ç”¨ç¨‹åºçš„äº‹ä»¶ç»“æ„ã€‚åŸºäºè¿™äº›åŸå› ï¼Œåº”å°†å¼‚æ­¥é€’å½’è§†ä½œä¸€ç§â€œåæ¨¡å¼â€çš„æ–¹å¼ã€‚</p>
<p>åœ¨è¿™ä¸ªè®¡ç®—å™¨ä¾‹å­ä¸­ï¼Œä¸ºäº†é¿å…å¼‚æ­¥é€’å½’ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªå…¬å¼å­˜å‚¨ä¸€ä¸ªå›è°ƒæ•°ç»„ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> calculationCache = &#123;&#125;,     </span><br><span class="line">    calculationCallbacks = &#123;&#125;,     </span><br><span class="line">    mathWorker = <span class="keyword">new</span> <span class="title class_">Worker</span>(<span class="string">&#x27;calculator.js&#x27;</span>); </span><br><span class="line"></span><br><span class="line">mathWorker.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span>(<span class="params">e</span>) &#123; </span><br><span class="line">    <span class="keyword">var</span> message = e.<span class="property">data</span>;   </span><br><span class="line">    calculationCache[message.<span class="property">formula</span>] = message.<span class="property">result</span>;   </span><br><span class="line">    calculationCallbacks[message.<span class="property">formula</span>].<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">callback</span>) &#123;     </span><br><span class="line">        <span class="title function_">callback</span>(message.<span class="property">result</span>);   </span><br><span class="line">    &#125;); </span><br><span class="line">&#125;); </span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">runCalculation</span>(<span class="params">formula, callback</span>) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (formula <span class="keyword">in</span> calculationCache) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="title function_">callback</span>(calculationCache[formula]);   </span><br><span class="line">    &#125;; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (formula <span class="keyword">in</span> calculationCallbacks) &#123; </span><br><span class="line">        <span class="keyword">return</span> calculationCallbacks[formula].<span class="title function_">push</span>(callback);   </span><br><span class="line">    &#125;;   </span><br><span class="line"></span><br><span class="line">    mathWorker.<span class="title function_">postMessage</span>(formula);   </span><br><span class="line">    calculationCallbacks[formula] = [callback]; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰äº†å»¶æ—¶ï¼Œæˆ‘ä»¬çš„ä»£ç è¦ç›´è§‚å¾—å¤šï¼Œä¹Ÿé«˜æ•ˆå¾—å¤šã€‚</p>
<p>æ€»çš„æ¥è¯´ï¼Œè¯·é¿å…å¼‚æ­¥é€’å½’ã€‚ä»…å½“æ‰€é‡‡ç”¨çš„åº“æä¾›äº†å¼‚æ­¥åŠŸèƒ½ä½†æ²¡æœ‰æä¾›ä»»ä½•å½¢å¼çš„å›è°ƒæœºåˆ¶æ—¶ï¼Œå¼‚æ­¥é€’å½’æ‰æœ‰å¿…è¦ã€‚å¦‚æœçœŸçš„é‡åˆ°è¿™ç§æƒ…å†µï¼Œè¦åšçš„ç¬¬ä¸€ä»¶äº‹åº”è¯¥æ˜¯ä¸ºè¯¥åº“å†™ä¸€ä¸ªè¡¥ä¸ã€‚æˆ–è€…ï¼Œå¹²è„†æ‰¾ä¸€ä¸ªæ›´å¥½çš„åº“ã€‚</p>
<h3 id="è¿”å€¼ä¸å›è°ƒçš„æ··æ­"><a href="#è¿”å€¼ä¸å›è°ƒçš„æ··æ­" class="headerlink" title="è¿”å€¼ä¸å›è°ƒçš„æ··æ­"></a>è¿”å€¼ä¸å›è°ƒçš„æ··æ­</h3><p>åœ¨ä»¥ä¸Šä¸¤ç§runCalculationå®ç°ä¸­ï¼Œæœ‰æ—¶ä¼šç”¨åˆ°è¿”å€¼æŠ€æœ¯ã€‚è¿™æ˜¯å‡ºäºç®€æ´çš„ç›®çš„è€Œéšæ„ä½œå‡ºçš„é€‰æ‹©ã€‚ä¸‹é¢è¿™è¡Œä»£ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="title function_">callback</span>(calculationCache[formula]);  </span><br></pre></td></tr></table></figure>

<p>å¾ˆå®¹æ˜“å³å¯æ”¹å†™æˆ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">callback</span>(calculationCache[formula]); </span><br><span class="line"><span class="keyword">return</span>; </span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯å› ä¸ºå¹¶æ²¡æœ‰æ‰“ç®—ä½¿ç”¨è¿™ä¸ªè¿”å€¼ã€‚è¿™æ˜¯JavaScriptçš„ä¸€ç§æ™®éåšæ³•ï¼Œè€Œä¸”é€šå¸¸æ— å®³ã€‚</p>
<p>ä¸è¿‡ï¼Œæœ‰äº›å‡½æ•°æ—¢è¿”å›æœ‰ç”¨çš„å€¼ï¼Œåˆè¦å–ç”¨å›è°ƒã€‚è¿™ç±»æƒ…å†µä¸‹ï¼Œåˆ‡è®°å›è°ƒæœ‰å¯èƒ½è¢«åŒæ­¥è°ƒç”¨ï¼ˆè¿”å€¼ä¹‹å‰ï¼‰ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å¼‚æ­¥è°ƒç”¨ï¼ˆè¿”å€¼ä¹‹åï¼‰ã€‚æ°¸è¿œä¸è¦å®šä¹‰ä¸€ä¸ªæ½œåœ¨åŒæ­¥è€Œè¿”å€¼å´æœ‰å¯èƒ½ç”¨äºå›è°ƒçš„å‡½æ•°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢è¿™ä¸ªè´Ÿè´£æ‰“å¼€WebSocketè¿æ¥ä»¥è¿è‡³ç»™å®šæœåŠ¡å™¨çš„å‡½æ•°ï¼ˆä½¿ç”¨ç¼“å­˜æŠ€æœ¯ä»¥ç¡®ä¿æ¯ä¸ªæœåŠ¡å™¨åªæœ‰ä¸€ä¸ªè¿æ¥ï¼‰å°±è¿åäº†ä¸Šè¿°è§„åˆ™ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> webSocketCache = &#123;&#125;; </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">openWebSocket</span>(<span class="params">serverAddress, callback</span>) &#123; </span><br><span class="line">    <span class="keyword">var</span> socket; </span><br><span class="line">    <span class="keyword">if</span> (serverAddress <span class="keyword">in</span> webSocketCache) &#123;     </span><br><span class="line">        socket = webSocketCache[serverAddress]; </span><br><span class="line">        <span class="keyword">if</span> (socket.<span class="property">readyState</span> === <span class="title class_">WebSocket</span>.<span class="property">OPEN</span>) &#123;       </span><br><span class="line">            <span class="title function_">callback</span>();     </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;       </span><br><span class="line">            socket.<span class="property">onopen</span> = _.<span class="title function_">compose</span>(callback, socket.<span class="property">onopen</span>);    </span><br><span class="line">        &#125;;   </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;     </span><br><span class="line">        socket = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(serverAddress);     </span><br><span class="line">        webSocketCache[serverAddress] = socket;</span><br><span class="line">        socket.<span class="property">onopen</span> = callback;   </span><br><span class="line">    &#125;;  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> socket; </span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<p>ï¼ˆè¿™æ®µä»£ç ä¾èµ–äºUnderscore.jsåº“ã€‚_.composeå®šä¹‰çš„è¿™ä¸ªæ–°å‡½æ•°æ—¢è¿è¡Œäº†callbackï¼Œåˆè¿è¡Œäº†åˆå§‹çš„socket.onopenå›è°ƒã€‚ï¼‰è¿™æ®µä»£ç çš„é—®é¢˜åœ¨äºï¼Œå¦‚æœå¥—æ¥å­—å·²ç»ç¼“å­˜ä¸”æ‰“å¼€ï¼Œåˆ™ä¼šåœ¨å‡½æ•°è¿”å€¼ä¹‹å‰å°±è¿è¡Œå›è°ƒï¼Œè¿™ä¼šä½¿ä»¥ä¸‹ä»£ç å´©æºƒã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> socket = <span class="title function_">openWebSocket</span>(url, <span class="keyword">function</span>(<span class="params"></span>) &#123;   </span><br><span class="line">    socket.<span class="title function_">send</span>(<span class="string">&#x27;Hello, server!&#x27;</span>); </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>æ€ä¹ˆè§£å†³å‘¢ï¼Ÿå°†å›è°ƒå°è£…åœ¨setTimeoutä¸­å³å¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (socket.<span class="property">readyState</span> === <span class="title class_">WebSocket</span>.<span class="property">OPEN</span>) &#123;   </span><br><span class="line">    <span class="built_in">setTimeout</span>(callback, <span class="number">0</span>);</span><br><span class="line"> &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">     <span class="comment">// ... </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä½¿ç”¨å»¶æ—¶ä¼šè®©äººæ„Ÿè§‰æ˜¯åœ¨ä¸œæ‹¼è¥¿å‡‘ï¼Œä½†è¿™æ€»æ¯”APIè‡ªç›¸çŸ›ç›¾è¦å¥½å¾—å¤šã€‚</p>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€äº›ç¼–å†™å¼‚æ­¥å‡½æ•°çš„æœ€ä½³å®è·µã€‚è¯·å‹¿ä¾èµ–é‚£äº›çœ‹ä¼¼å§‹ç»ˆå¼‚æ­¥çš„å‡½æ•°ï¼Œé™¤éå·²ç»é˜…è¯»å…¶æºä»£ç ã€‚è¯·é¿å…ä½¿ç”¨è®¡æ—¶å™¨æ–¹æ³•æ¥ç­‰å¾…æŸä¸ªä¼šå˜åŒ–çš„ä¸œè¥¿ã€‚å¦‚æœåŒä¸€ä¸ªå‡½æ•°æ—¢è¿”å€¼åˆè¿è¡Œå›è°ƒï¼Œåˆ™è¯·ç¡®ä¿å›è°ƒåœ¨è¿”å€¼ä¹‹åæ‰è¿è¡Œã€‚</p>
<p>ä¸€æ¬¡æ¶ˆåŒ–è¿™äº›ä¿¡æ¯ç¡®å®å¤ªå¤šäº†ä¸€ç‚¹ï¼Œä¸è¿‡ï¼Œç¼–å†™å¥½çš„å¼‚æ­¥å‡½æ•°ç¡®å®æ˜¯å†™å‡ºä¼˜ç§€JavaScriptä»£ç çš„å…³é”®æ‰€åœ¨ã€‚</p>
<h2 id="å¼‚æ­¥é”™è¯¯çš„å¤„ç†"><a href="#å¼‚æ­¥é”™è¯¯çš„å¤„ç†" class="headerlink" title="å¼‚æ­¥é”™è¯¯çš„å¤„ç†"></a>å¼‚æ­¥é”™è¯¯çš„å¤„ç†</h2><p>åƒå¾ˆå¤šæ—¶é«¦çš„è¯­è¨€ä¸€æ ·ï¼ŒJavaScriptä¹Ÿå…è®¸æŠ›å‡ºå¼‚å¸¸ï¼Œéšåå†ç”¨ä¸€ä¸ªtry&#x2F;catchè¯­å¥å—æ•è·ã€‚å¦‚æœæŠ›å‡ºçš„å¼‚å¸¸æœªè¢«æ•è·ï¼Œå¤§å¤šæ•°JavaScriptç¯å¢ƒéƒ½ä¼šæä¾›ä¸€ä¸ªæœ‰ç”¨çš„å †æ ˆè½¨è¿¹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢è¿™æ®µä»£ç ç”±äºâ€™{â€˜ä¸ºæ— æ•ˆJSONå¯¹è±¡è€ŒæŠ›å‡ºå¼‚å¸¸ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EventModel/stackTrace.js </span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">JSONToObject</span>(<span class="params">jsonStr</span>) &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">parse</span>(jsonStr);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">var</span> obj = <span class="title class_">JSON</span>ToObject(<span class="string">&#x27;&#123;&#x27;</span>);  </span><br><span class="line"></span><br><span class="line"><span class="title class_">SyntaxError</span>: <span class="title class_">Unexpected</span> end <span class="keyword">of</span> input     </span><br><span class="line">    at <span class="title class_">Object</span>.<span class="property">parse</span> (native)     </span><br><span class="line">    at <span class="title class_">JSON</span>ToObject (<span class="regexp">/AsyncJS/</span>stackTrace.<span class="property">js</span>:<span class="number">2</span>:<span class="number">15</span>)     </span><br><span class="line">    at <span class="title class_">Object</span>.&lt;anonymous&gt; (<span class="regexp">/AsyncJS/</span>stackTrace.<span class="property">js</span>:<span class="number">4</span>:<span class="number">11</span>) </span><br></pre></td></tr></table></figure>

<p>å †æ ˆè½¨è¿¹ä¸ä»…å‘Šè¯‰æˆ‘ä»¬å“ªé‡ŒæŠ›å‡ºäº†é”™è¯¯ï¼Œè€Œä¸”è¯´æ˜äº†æœ€åˆå‡ºé”™çš„åœ°æ–¹ï¼šç¬¬4è¡Œä»£ç ã€‚é—æ†¾çš„æ˜¯ï¼Œè‡ªé¡¶å‘ä¸‹åœ°è·Ÿè¸ªå¼‚æ­¥é”™è¯¯èµ·æºå¹¶ä¸éƒ½è¿™ä¹ˆç›´æˆªäº†å½“ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ä¸ºä»€ä¹ˆthrowå¾ˆå°‘ç”¨ä½œå›è°ƒå†…é”™è¯¯å¤„ç†çš„æ­£ç¡®å·¥å…·ï¼Œè¿˜ä¼šäº†è§£å¦‚ä½•è®¾è®¡å¼‚æ­¥APIä»¥ç»•å¼€è¿™ä¸€å±€é™ã€‚</p>
<h3 id="å›è°ƒå†…æŠ›å‡ºçš„é”™è¯¯"><a href="#å›è°ƒå†…æŠ›å‡ºçš„é”™è¯¯" class="headerlink" title="å›è°ƒå†…æŠ›å‡ºçš„é”™è¯¯"></a>å›è°ƒå†…æŠ›å‡ºçš„é”™è¯¯</h3><p>å¦‚æœä»å¼‚æ­¥å›è°ƒä¸­æŠ›å‡ºé”™è¯¯ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹ï¼Ÿè®©æˆ‘ä»¬å…ˆæ¥åšä¸ªæµ‹è¯•ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EventModel/nestedErrors.js </span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">A</span>(<span class="params"></span>) &#123;   </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">B</span>(<span class="params"></span>) &#123; </span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="keyword">function</span> <span class="title function_">C</span>(<span class="params"></span>) &#123; </span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Something terrible has happened!&#x27;</span>);     </span><br><span class="line">        &#125;, <span class="number">0</span>);   </span><br><span class="line">    &#125;, <span class="number">0</span>); </span><br><span class="line">&#125;, <span class="number">0</span>); </span><br></pre></td></tr></table></figure>

<p>ä¸Šè¿°åº”ç”¨çš„ç»“æœæ˜¯ä¸€æ¡æå…¶ç®€çŸ­çš„å †æ ˆè½¨è¿¹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Error: Something terrible has happened!     </span><br><span class="line">    at Timer.C (/AsyncJS/nestedErrors.js:4:13) </span><br></pre></td></tr></table></figure>

<p>ç­‰ç­‰ï¼ŒAå’ŒBå‘ç”Ÿäº†ä»€ä¹ˆäº‹ï¼Ÿä¸ºä»€ä¹ˆå®ƒä»¬æ²¡æœ‰å‡ºç°åœ¨å †æ ˆè½¨è¿¹ä¸­ï¼Ÿè¿™æ˜¯å› ä¸ºè¿è¡ŒCçš„æ—¶å€™ï¼ŒAå’ŒBå¹¶ä¸åœ¨å†…å­˜å †æ ˆé‡Œã€‚è¿™3ä¸ªå‡½æ•°éƒ½æ˜¯ä»äº‹ä»¶é˜Ÿåˆ—ç›´æ¥è¿è¡Œçš„ã€‚</p>
<p>åŸºäºåŒæ ·çš„ç†ç”±ï¼Œåˆ©ç”¨try&#x2F;catchè¯­å¥å—å¹¶ä¸èƒ½æ•è·ä»å¼‚æ­¥å›è°ƒä¸­æŠ›å‡ºçš„é”™è¯¯ã€‚ä¸‹é¢è¿›è¡Œæ¼”ç¤ºã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;   </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">         <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Catch me if you can!&#x27;</span>);   </span><br><span class="line">    &#125;, <span class="number">0</span>); </span><br><span class="line">&#125; <span class="keyword">catch</span> (e) &#123;  </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°è¿™é‡Œçš„é—®é¢˜äº†å—ï¼Ÿè¿™é‡Œçš„try&#x2F;catchè¯­å¥å—åªæ•è·setTimeoutå‡½æ•°è‡ªèº«å†…éƒ¨å‘ç”Ÿçš„é‚£äº›é”™è¯¯ã€‚å› ä¸ºsetTimeoutå¼‚æ­¥åœ°è¿è¡Œå…¶å›è°ƒï¼Œæ‰€ä»¥å³ä½¿å»¶æ—¶è®¾ç½®ä¸º0ï¼Œå›è°ƒæŠ›å‡ºçš„é”™è¯¯ä¹Ÿä¼šç›´æ¥æµå‘åº”ç”¨ç¨‹åºçš„æœªæ•è·å¼‚å¸¸å¤„ç†å™¨ï¼ˆè¯·å‚é˜…1.4.2èŠ‚ï¼‰</p>
<p>æ€»çš„æ¥è¯´ï¼Œå–ç”¨å¼‚æ­¥å›è°ƒçš„å‡½æ•°å³ä½¿åŒ…è£…ä¸Štry&#x2F;catchè¯­å¥å—ï¼Œä¹Ÿåªæ˜¯æ— ç”¨ä¹‹ä¸¾ã€‚ï¼ˆç‰¹ä¾‹æ˜¯ï¼Œè¯¥å¼‚æ­¥å‡½æ•°ç¡®å®æ˜¯åœ¨åŒæ­¥åœ°åšæŸäº›äº‹ä¸”å®¹æ˜“å‡ºé”™ã€‚ä¾‹å¦‚ï¼ŒNodeçš„fs.watch(file,callback)å°±æ˜¯è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒåœ¨ç›®æ ‡æ–‡ä»¶ä¸å­˜åœ¨æ—¶ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚ï¼‰æ­£å› ä¸ºæ­¤ï¼ŒNode.jsä¸­çš„å›è°ƒå‡ ä¹æ€»æ˜¯æ¥å—ä¸€ä¸ªé”™è¯¯ä½œä¸ºå…¶é¦–ä¸ªå‚æ•°ï¼Œè¿™æ ·å°±å…è®¸å›è°ƒè‡ªå·±æ¥å†³å®šå¦‚ä½•å¤„ç†è¿™ä¸ªé”™è¯¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢è¿™ä¸ªNodeåº”ç”¨å°è¯•å¼‚æ­¥åœ°è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œè¿˜è´Ÿè´£è®°å½•ä¸‹ä»»ä½•é”™è¯¯ï¼ˆå¦‚â€œæ–‡ä»¶ä¸å­˜åœ¨â€ï¼‰ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EventModel/readFile.js </span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>); </span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;fhgwgdz.txt&#x27;</span>, <span class="keyword">function</span>(<span class="params">err, data</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span> (err) &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">error</span>(err);   </span><br><span class="line">    &#125;;   </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data.<span class="title function_">toString</span>(<span class="string">&#x27;utf8&#x27;</span>)); </span><br><span class="line">&#125;); </span><br></pre></td></tr></table></figure>

<p>å®¢æˆ·ç«¯JavaScriptåº“çš„ä¸€è‡´æ€§è¦ç¨å¾®å·®äº›ï¼Œä¸è¿‡æœ€å¸¸è§çš„æ¨¡å¼æ˜¯ï¼Œé’ˆå¯¹æˆè´¥è¿™ä¸¤ç§æƒ…å½¢å„è§„å®šä¸€ä¸ªå•ç‹¬çš„å›è°ƒã€‚jQueryçš„Ajaxæ–¹æ³•å°±éµå¾ªäº†è¿™ä¸ªæ¨¡å¼ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$.<span class="title function_">get</span>(<span class="string">&#x27;/data&#x27;</span>, &#123;  </span><br><span class="line">     <span class="attr">success</span>: successHandler,   </span><br><span class="line">     <span class="attr">failure</span>: failureHandler &#125;); </span><br></pre></td></tr></table></figure>
<p>ä¸ç®¡APIå½¢æ€åƒä»€ä¹ˆï¼Œå§‹ç»ˆè¦è®°ä½çš„æ˜¯ï¼Œåªèƒ½åœ¨å›è°ƒå†…éƒ¨å¤„ç†æºäºå›è°ƒçš„å¼‚æ­¥é”™è¯¯ã€‚å¼‚æ­¥å°¤è¾¾å¤§å¸ˆä¼šè¯´ï¼šâ€œåšï¼Œæˆ–è€…ä¸åšï¼Œæ²¡æœ‰è¯•è¯•çœ‹ä¸€è¯´ã€‚â€</p>
<h3 id="æœªæ•è·å¼‚å¸¸çš„å¤„ç†"><a href="#æœªæ•è·å¼‚å¸¸çš„å¤„ç†" class="headerlink" title="æœªæ•è·å¼‚å¸¸çš„å¤„ç†"></a>æœªæ•è·å¼‚å¸¸çš„å¤„ç†</h3><p>å¦‚æœæ˜¯ä»å›è°ƒä¸­æŠ›å‡ºå¼‚å¸¸çš„ï¼Œåˆ™ç”±é‚£ä¸ªè°ƒç”¨äº†å›è°ƒçš„äººè´Ÿè´£æ•è·è¯¥å¼‚å¸¸ã€‚ä½†å¦‚æœå¼‚å¸¸ä»æœªè¢«æ•è·ï¼Œåˆä¼šæ€ä¹ˆæ ·ï¼Ÿè¿™æ—¶ï¼Œä¸åŒçš„JavaScriptå›¾ç¯å¢ƒæœ‰ç€ä¸åŒçš„æ¸¸æˆè§„åˆ™â€¦â€¦</p>
<p>1.åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­ç°ä»£æµè§ˆå™¨ä¼šåœ¨å¼€å‘äººå‘˜æ§åˆ¶å°æ˜¾ç¤ºé‚£äº›æœªæ•è·çš„å¼‚å¸¸ï¼Œæ¥ç€è¿”å›äº‹ä»¶é˜Ÿåˆ—ã€‚è¦æƒ³ä¿®æ”¹è¿™ç§è¡Œä¸ºï¼Œå¯ä»¥ç»™window.onerroré™„åŠ ä¸€ä¸ªå¤„ç†å™¨ã€‚å¦‚æœwindows.onerrorå¤„ç†å™¨è¿”å›trueï¼Œåˆ™èƒ½é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤é”™è¯¯å¤„ç†è¡Œä¸ºã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">onerror</span> = <span class="keyword">function</span>(<span class="params">err</span>) &#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;  </span><br><span class="line">    <span class="comment">//å½»åº•å¿½ç•¥æ‰€æœ‰é”™è¯¯</span></span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<p>åœ¨æˆå“åº”ç”¨ä¸­ï¼Œä¼šè€ƒè™‘æŸç§JavaScripté”™è¯¯å¤„ç†æœåŠ¡ï¼Œè­¬å¦‚Errorceptionâ‘ ã€‚Errorceptionæä¾›äº†ä¸€ä¸ªç°æˆçš„windows.onerrorå¤„ç†å™¨ï¼Œå®ƒå‘åº”ç”¨æœåŠ¡å™¨æŠ¥å‘Šæ‰€æœ‰æœªæ•è·çš„å¼‚å¸¸ï¼Œæ¥ç€åº”ç”¨æœåŠ¡å™¨å‘é€æ¶ˆæ¯é€šçŸ¥æˆ‘ä»¬ã€‚</p>
<p>2.åœ¨Node.jsç¯å¢ƒä¸­åœ¨Nodeç¯å¢ƒä¸­ï¼Œwindow.onerrorçš„ç±»ä¼¼ç‰©å°±æ˜¯processå¯¹è±¡çš„uncaughtExceptionäº‹ä»¶ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼ŒNodeåº”ç”¨ä¼šå› æœªæ•è·çš„å¼‚å¸¸è€Œç«‹å³é€€å‡ºã€‚ä½†åªè¦è‡³å°‘è¿˜æœ‰ä¸€ä¸ªuncaughtExceptionäº‹ä»¶å¤„ç†å™¨ï¼ŒNodeåº”ç”¨å°±ä¼šç›´æ¥è¿”å›äº‹ä»¶é˜Ÿåˆ—ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">process.<span class="title function_">on</span>(<span class="string">&#x27;uncaughtException&#x27;</span>, <span class="keyword">function</span>(<span class="params">err</span>) &#123;   </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(err);  </span><br><span class="line">    <span class="comment">//é¿å…äº†å…³åœçš„å‘½è¿ï¼</span></span><br><span class="line">&#125;); </span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œè‡ªNode  0.8.4èµ·ï¼ŒuncaughtExceptionäº‹ä»¶å°±è¢«åºŸå¼ƒäº†ã€‚æ®å…¶æ–‡æ¡£æ‰€è¨€ï¼Œå¯¹å¼‚å¸¸å¤„ç†è€Œè¨€ï¼ŒuncaughtExceptionæ˜¯ä¸€ç§éå¸¸ç²—æš´çš„æœºåˆ¶ï¼Œå®ƒåœ¨å°†æ¥å¯èƒ½ä¼šè¢«æ”¾å¼ƒâ€¦â€¦</p>
<blockquote>
<p>è¯·å‹¿ä½¿ç”¨uncaughtExceptionï¼Œè€Œåº”ä½¿ç”¨Domainå¯¹è±¡ã€‚Domainå¯¹è±¡åˆæ˜¯ä»€ä¹ˆï¼Ÿä½ å¯èƒ½ä¼šè¿™æ ·é—®ã€‚</p>
</blockquote>
<p>Domainå¯¹è±¡æ˜¯äº‹ä»¶åŒ–å¯¹è±¡ï¼ˆç¬¬2ç« ä¼šè¯¦ç»†è®¨è®ºï¼‰ï¼Œå®ƒå°†throwè½¬åŒ–ä¸ºâ€™errorâ€™äº‹ä»¶ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//EventModel/domainThrow.js </span></span><br><span class="line"><span class="keyword">var</span> myDomain = <span class="built_in">require</span>(<span class="string">&#x27;domain&#x27;</span>).<span class="title function_">create</span>();</span><br><span class="line">myDomain.<span class="title function_">run</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;Listen to me!&#x27;</span>)</span><br><span class="line">    &#125;, <span class="number">50</span>);</span><br><span class="line">&#125;);</span><br><span class="line">myDomain.<span class="title function_">on</span>(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Error ignored!&#x27;</span>);</span><br><span class="line">&#125;); </span><br></pre></td></tr></table></figure>

<p>æºäºå»¶æ—¶äº‹ä»¶çš„throwåªæ˜¯ç®€å•åœ°è§¦å‘äº†Domainå¯¹è±¡çš„é”™è¯¯å¤„ç†å™¨ã€‚<br>Error ignored!<br>å¾ˆå¥‡å¦™ï¼Œæ˜¯ä¸æ˜¯ï¼ŸDomainå¯¹è±¡è®©throwè¯­å¥ç”ŸåŠ¨äº†å¾ˆå¤šã€‚é—æ†¾çš„æ˜¯ï¼Œä»…åœ¨Node  0.8+ç¯å¢ƒä¸­æ‰èƒ½ä½¿ç”¨Domainå¯¹è±¡ï¼›åœ¨æˆ‘å†™ä½œæœ¬ä¹¦æ—¶ï¼ŒDomainå¯¹è±¡ä»è¢«è§†ä½œè¯•éªŒæ€§çš„ç‰¹æ€§ã€‚æ›´å¤šä¿¡æ¯è¯·å‚é˜…Nodeæ–‡æ¡£ã€‚â‘¡ä¸ç®¡åœ¨æµè§ˆå™¨ç«¯è¿˜æ˜¯æœåŠ¡å™¨ç«¯ï¼Œå…¨å±€çš„å¼‚å¸¸å¤„ç†å™¨éƒ½åº”è¢«è§†ä½œæœ€åä¸€æ ¹æ•‘å‘½ç¨»è‰ã€‚è¯·ä»…åœ¨è°ƒè¯•æ—¶æ‰ä½¿ç”¨å®ƒã€‚</p>
<h3 id="æŠ›å‡ºè¿˜æ˜¯ä¸æŠ›å‡º"><a href="#æŠ›å‡ºè¿˜æ˜¯ä¸æŠ›å‡º" class="headerlink" title="æŠ›å‡ºè¿˜æ˜¯ä¸æŠ›å‡º"></a>æŠ›å‡ºè¿˜æ˜¯ä¸æŠ›å‡º</h3><p>é‡åˆ°é”™è¯¯æ—¶ï¼Œæœ€ç®€å•çš„è§£å†³æ–¹æ³•å°±æ˜¯æŠ›å‡ºè¿™ä¸ªé”™è¯¯ã€‚åœ¨Nodeä»£ç ä¸­ï¼Œå¤§å®¶ä¼šç»å¸¸çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å›è°ƒï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;   <span class="comment">// ... </span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ç¬¬4ç« ä¸­ï¼Œæˆ‘ä»¬ä¼šç»å¸¸æ²¿ç”¨è¿™ä¸€åšæ³•ã€‚ä½†æ˜¯ï¼Œåœ¨æˆå“åº”ç”¨ä¸­ï¼Œå…è®¸ä¾‹è¡Œçš„å¼‚å¸¸åŠè‡´å‘½çš„é”™è¯¯åƒè¸¢çš®çƒä¸€æ ·è¸¢ç»™å…¨å±€å¤„ç†å™¨ï¼Œè¿™æ˜¯ä¸å¯æ¥å—çš„ã€‚å›è°ƒä¸­çš„throwç›¸å½“äºJavaScriptå†™æ‰‹åœ¨è¯´â€œç°åœ¨æˆ‘è¿˜ä¸æƒ³è€ƒè™‘è¿™ä¸ªâ€ã€‚</p>
<p>å¦‚æœæŠ›å‡ºé‚£äº›è‡ªå·±çŸ¥é“è‚¯å®šä¼šè¢«æ•è·çš„å¼‚å¸¸å‘¢ï¼Ÿè¿™ç§åšæ³•åŒæ ·å‡¶é™©ä¸‡åˆ†ã€‚2011å¹´ï¼ŒIsaac Schlueterï¼ˆnpmçš„å¼€å‘è€…ï¼Œåœ¨ä»»çš„Nodeå¼€å‘è´Ÿè´£äººï¼‰å°±ä¸»å¼ try&#x2F;catchæ˜¯ä¸€ç§â€œåæ¨¡å¼â€çš„æ–¹å¼ã€‚</p>
<blockquote>
<p>try&#x2F;catchåªæ˜¯åŒ…è£…ç€æ¼‚äº®èŠ±æ‹¬å¼§çš„gotoè¯­å¥ã€‚ä¸€æ—¦è·‘å»å¤„ç†é”™è¯¯ï¼Œå°±æ— æ³•å›åˆ°ä¸­æ–­ä¹‹å¤„ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œé€šè¿‡throwè¯­å¥çš„ä»£ç ï¼Œå®Œå…¨ä¸çŸ¥é“è‡ªå·±ä¼šè·³åˆ°ä»€ä¹ˆåœ°æ–¹ã€‚è¿”å›é”™è¯¯ç çš„æ—¶å€™ï¼Œå°±ç›¸å½“äºæ­£åœ¨å±¥è¡Œåˆçº¦ã€‚æŠ›å‡ºé”™è¯¯çš„æ—¶å€™ï¼Œå°±å¥½åƒåœ¨è¯´ï¼Œâ€œæˆ‘çŸ¥é“æˆ‘æ­£åœ¨å’Œä½ è¯´è¯ï¼Œä½†æˆ‘ç°åœ¨ä¸æƒ³æ­ç†ä½ ï¼Œæˆ‘è¦å…ˆæ‰¾ä½ è€æ¿è°ˆè°ˆâ€ï¼Œè¿™å¤ªç²—ä¿—æ— ç¤¼äº†ã€‚å¦‚æœä¸æ˜¯ä»€ä¹ˆç´§æ€¥æƒ…å†µï¼Œè¯·åˆ«è¿™ä¹ˆåšï¼›å¦‚æœç¡®å®æ˜¯ç´§æ€¥æƒ…å†µï¼Œåˆ™åº”è¯¥ç›´æ¥å´©æºƒæ‰ã€‚</p>
</blockquote>
<p>Schlueteræå€¡å®Œå…¨å°†throwç”¨ä½œæ–­è¨€ä¼¼çš„æ„é€ ç»“æ„ï¼Œä½œä¸ºä¸€ç§æŒ‚èµ·åº”ç”¨çš„æ–¹å¼â€”â€”å½“åº”ç”¨åœ¨åšå®Œå…¨æ²¡é¢„æ–™åˆ°çš„äº‹æ—¶ï¼Œå³æŒ‚èµ·åº”ç”¨ã€‚Nodeç¤¾åŒºä¸»è¦éµå¾ªè¿™ä¸€å»ºè®®ï¼Œå°½ç®¡è¿™ç§æƒ…å†µå¯èƒ½ä¼šéšç€Domainå¯¹è±¡çš„å‡ºç°è€Œæ”¹å˜ã€‚</p>
<p>é‚£ä¹ˆï¼Œå…³äºå¼‚æ­¥é”™è¯¯çš„å¤„ç†ï¼Œç›®å‰çš„æœ€ä½³å®è·µæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘è®¤ä¸ºåº”è¯¥å¬ä»Schlueterçš„å»ºè®®ï¼šå¦‚æœæƒ³è®©æ•´ä¸ªåº”ç”¨åœæ­¢å·¥ä½œï¼Œè¯·å‹‡å¾€ç›´å‰åœ°å¤§èƒ†ä½¿ç”¨throwã€‚å¦åˆ™ï¼Œè¯·è®¤çœŸè€ƒè™‘ä¸€ä¸‹åº”è¯¥å¦‚ä½•å¤„ç†é”™è¯¯ã€‚æ˜¯æƒ³ç»™ç”¨æˆ·æ˜¾ç¤ºä¸€æ¡å‡ºé”™æ¶ˆæ¯å—ï¼Ÿæ˜¯æƒ³é‡è¯•è¯·æ±‚å—ï¼Ÿè¿˜æ˜¯æƒ³å”±ä¸€æ›²â€œé›èŠé“ƒä¹‹æ­Œâ€ï¼Ÿé‚£å°±è¿™ä¹ˆå¤„ç†å§ï¼Œåªæ˜¯è¯·å°½å¯èƒ½åœ°é è¿‘é”™è¯¯æºå¤´ã€‚</p>
<h2 id="åµŒå¥—å¼å›è°ƒçš„è§£åµŒå¥—"><a href="#åµŒå¥—å¼å›è°ƒçš„è§£åµŒå¥—" class="headerlink" title="åµŒå¥—å¼å›è°ƒçš„è§£åµŒå¥—"></a>åµŒå¥—å¼å›è°ƒçš„è§£åµŒå¥—</h2><p>JavaScriptä¸­æœ€å¸¸è§çš„åæ¨¡å¼åšæ³•æ˜¯ï¼Œå›è°ƒå†…éƒ¨å†åµŒå¥—å›è°ƒã€‚è¿˜è®°å¾—å‰è¨€é‡Œæåˆ°çš„é‡‘å­—å¡”å„è¿å—ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œä½ ä¹Ÿå¯èƒ½åœ¨NodeæœåŠ¡å™¨ä¸Šçœ‹åˆ°è¿‡ç±»ä¼¼çš„ä»£ç ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkPassword</span>(<span class="params">username, passwordGuess, callback</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> queryStr = <span class="string">&#x27;SELECT * FROM user WHERE username = ?&#x27;</span>;</span><br><span class="line">    db.<span class="title function_">query</span>(queryStr, username,</span><br><span class="line">        <span class="keyword">function</span> (<span class="params">err, result</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">throw</span> err; </span><br><span class="line">            <span class="title function_">hash</span>(passwordGuess,<span class="keyword">function</span> (<span class="params">passwordGuessHash</span>) &#123;</span><br><span class="line">                    <span class="title function_">callback</span>(passwordGuessHash === result[<span class="string">&#x27;password_hash&#x27;</span>]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªå¼‚æ­¥å‡½æ•°checkPasswordï¼Œå®ƒè§¦å‘äº†å¦ä¸€ä¸ªå¼‚æ­¥å‡½æ•°db.queryï¼Œè€Œåè€…åˆå¯èƒ½è§¦å‘å¦å¤–ä¸€ä¸ªå¼‚æ­¥å‡½æ•°hashã€‚ï¼ˆåœ¨ä¹‹å‰ï¼Œæ— æ³•ç¡®è®¤è¿™äº›å‡½æ•°æ˜¯å¦çœŸçš„å¼‚æ­¥ï¼Œä½†è¿™é‡Œçš„å‡ ä¸ªå‡½æ•°ç†åº”å¦‚æ­¤ã€‚ï¼‰</p>
<p>è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿç›®å‰ä¸ºæ­¢ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚å®ƒèƒ½ç”¨ï¼Œè€Œä¸”ç®€æ´æ˜äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¯•å›¾å‘å…¶æ·»åŠ æ–°ç‰¹æ€§ï¼Œå®ƒå°±ä¼šå˜å¾—æ¯›é‡Œæ¯›èºã€é™©è±¡ç¯ç”Ÿï¼Œæ¯”å¦‚å»å¤„ç†é‚£ä¸ªæ•°æ®åº“é”™è¯¯ï¼Œè€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯ï¼ˆè¯·å‚é˜…1.4.3èŠ‚ï¼‰ã€è®°å½•å°è¯•è®¿é—®æ•°æ®åº“çš„æ¬¡æ•°ã€é˜»å¡è®¿é—®æ•°æ®åº“ï¼Œç­‰ç­‰ã€‚</p>
<p>åµŒå¥—å¼å›è°ƒè¯±æƒ‘æˆ‘ä»¬é€šè¿‡æ·»åŠ æ›´å¤šä»£ç æ¥æ·»åŠ æ›´å¤šç‰¹æ€§ï¼Œè€Œä¸æ˜¯å°†è¿™äº›ç‰¹æ€§å®ç°ä¸ºå¯ç®¡ç†ã€å¯é‡ç”¨çš„ä»£ç ç‰‡æ®µã€‚checkPasswordæœ‰ä¸€ç§å¯ä»¥é¿å…å‡ºç°ä¸Šè¿°è‹—å¤´çš„ç­‰ä»·å®ç°æ–¹å¼ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">checkPassword</span>(<span class="params">username, passwordGuess, callback</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> passwordHash; <span class="keyword">var</span> queryStr = <span class="string">&#x27;SELECT * FROM user WHERE username = ?&#x27;</span>;</span><br><span class="line">    db.<span class="title function_">query</span>(qyeryStr, username, queryCallback);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">queryCallback</span>(<span class="params">err, result</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span> err; passwordHash = result[<span class="string">&#x27;password_hash&#x27;</span>];</span><br><span class="line">        <span class="title function_">hash</span>(passwordGuess, hashCallback);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">hashCallback</span>(<span class="params">passwordGuessHash</span>) &#123;</span><br><span class="line">        <span class="title function_">callback</span>(passwordHash === passwordGuessHash);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ç§å†™æ³•æ›´å•°å—¦ä¸€äº›ï¼Œä½†è¯»èµ·æ¥æ›´æ¸…æ™°ï¼Œä¹Ÿæ›´å®¹æ˜“æ‰©å±•ã€‚ç”±äºè¿™é‡Œèµ‹äºˆäº†å¼‚æ­¥ç»“æœï¼ˆå³passwordHashï¼‰æ›´å®½å¹¿çš„ä½œç”¨åŸŸï¼Œæ‰€ä»¥è·å¾—äº†æ›´å¤§çš„çµæ´»æ€§ã€‚<br>æŒ‰ç…§æƒ¯ä¾‹ï¼Œè¯·é¿å…ä¸¤å±‚ä»¥ä¸Šçš„å‡½æ•°åµŒå¥—ã€‚å…³é”®æ˜¯æ‰¾åˆ°ä¸€ç§åœ¨æ¿€æ´»å¼‚æ­¥è°ƒç”¨ä¹‹å‡½æ•°çš„å¤–éƒ¨å­˜å‚¨å¼‚æ­¥ç»“æœçš„æ–¹å¼ï¼Œè¿™æ ·å›è°ƒæœ¬èº«å°±æ²¡æœ‰å¿…è¦å†åµŒå¥—äº†ã€‚</p>
<p>å¦‚æœè¿™æ ·å¬èµ·æ¥æœ‰ç‚¹è¯˜è±éš¾æ‡‚ï¼Œè¯·åˆ«æ‹…å¿ƒã€‚æˆ‘ä»¬åœ¨åç»­å‡ ç« ä¸­ä¼šçœ‹åˆ°å¤§é‡çš„å¼‚æ­¥äº‹ä»¶ä¾‹å­ï¼Œé‚£é‡Œçš„å¼‚æ­¥äº‹ä»¶é¡ºåºè¿è¡Œä¸”æ²¡æœ‰åµŒå¥—å¼äº‹ä»¶å¤„ç†å™¨ã€‚</p>
]]></content>
      <categories>
        <category>è½¬è½½</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>MongoDBåŸºç¡€ç¯‡ï¼ˆä¸€ï¼‰</title>
    <url>/mongodb_sql/</url>
    <content><![CDATA[<p>MongoDB æ˜¯ä¸€ä¸ªä»‹äºå…³ç³»æ•°æ®åº“å’Œéå…³ç³»æ•°æ®åº“ä¹‹é—´çš„äº§å“ã€‚é¢å‘æ–‡æ¡£çš„ NoSQL çš„æ•°æ®åº“ï¼Œå­˜å‚¨ç»“æ„ä¹Ÿéå¸¸è‡ªç”±ï¼Œæ˜¯ç±»ä¼¼ json çš„ bson æ ¼å¼ï¼Œå› æ­¤å¯ä»¥å­˜å‚¨æ¯”è¾ƒå¤æ‚çš„æ•°æ®ç±»å‹ã€‚å…¶å¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€å‡ ä¹æ”¯æŒç»å¤§éƒ¨åˆ†å…³ç³»æ•°æ®çš„çš„æŸ¥è¯¢çš„åŠŸèƒ½ã€‚</p>
<span id="more"></span>

<h2 id="åŸºæœ¬ç»„æˆ"><a href="#åŸºæœ¬ç»„æˆ" class="headerlink" title="åŸºæœ¬ç»„æˆ"></a>åŸºæœ¬ç»„æˆ</h2><p>åœ¨ MongoDB ä¸­åŸºæœ¬çš„æ¦‚å¿µæ˜¯æ–‡æ¡£ã€é›†åˆã€æ•°æ®åº“ï¼Œæ²¡æœ‰å…³ç³»å‹æ•°æ®åº“ä¸­è¡¨ã€è¡Œç­‰è¿™äº›æ¦‚å¿µçš„</p>
<table>
<thead>
<tr>
<th>MongoDB</th>
<th>SQL</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>database</td>
<td>database</td>
<td>æ•°æ®åº“</td>
</tr>
<tr>
<td>collection</td>
<td>table</td>
<td>é›†åˆ&#x2F;è¡¨</td>
</tr>
<tr>
<td>document</td>
<td>row</td>
<td>æ–‡æ¡£&#x2F;è¡Œ</td>
</tr>
<tr>
<td>field</td>
<td>column</td>
<td>åŸŸ&#x2F;å­—æ®µ</td>
</tr>
<tr>
<td>index</td>
<td>index</td>
<td>ç´¢å¼•</td>
</tr>
<tr>
<td>ä¸æ”¯æŒ</td>
<td>table joins</td>
<td>è¿è¡¨</td>
</tr>
</tbody></table>
<p>MongoDB æ›¾ç»æ˜¯ä¸æ”¯æŒè¿è¡¨çš„ï¼Œåœ¨ 3.2 ä»¥åç‰ˆæœ¬å¢åŠ äº† $lookup å¯ä»¥å®ç°å·¦è¿æ¥ </p>
<h2 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥çœ‹é›†åˆ</span></span><br><span class="line">show collections</span><br><span class="line"></span><br><span class="line"><span class="comment">/// é›†åˆåç§°ï¼Œé…ç½®é€‰é¡¹ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">db.<span class="title function_">createCollection</span>(<span class="string">&#x27;table_name&#x27;</span>, &#123;</span><br><span class="line">    <span class="comment">//(å¯é€‰ï¼‰æŒ‡å®šæ˜¯å¦åˆ›å»ºå›ºå®šå¤§å°é›†åˆï¼Œå¦‚æœæ˜¯true åœ¨è¾¾åˆ°æœ€å¤§å€¼çš„æ—¶å€™ä¼šè¦†ç›–æœ€æ—©çš„æ–‡æ¡£</span></span><br><span class="line">    <span class="attr">capped</span>: <span class="literal">true</span> ,</span><br><span class="line">    <span class="comment">//(å¯é€‰ï¼‰ä¸ºå›ºå®šé›†åˆæŒ‡å®šä¸€ä¸ªæœ€å¤§å¤§å°</span></span><br><span class="line">    <span class="attr">size</span>:<span class="number">1000000</span>, </span><br><span class="line">    <span class="comment">//(å¯é€‰ï¼‰æŒ‡å®šå›ºå®šé›†åˆä¸­åŒ…å«æ–‡æ¡£çš„æœ€å¤§æ•°é‡</span></span><br><span class="line">    <span class="attr">max</span>:<span class="number">100</span> </span><br><span class="line">    <span class="comment">// æŒ‡å®šåˆ›å»ºå›ºå®šé›†åˆå,é‡Œé¢çš„æ–‡æ¡£ä¸å¯ä»¥åˆ é™¤äº†,é™¤éåˆ é™¤æ•´ä¸ªé›†åˆé‡æ–°åˆ›å»º</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤é›†åˆ</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">drop</span>()</span><br></pre></td></tr></table></figure>

<h2 id="æ–°å¢"><a href="#æ–°å¢" class="headerlink" title="æ–°å¢"></a>æ–°å¢</h2><p>MongoDB æä¾›äº†ä¸‰ä¸ªæ–¹æ³•</p>
<ul>
<li>insert æ’å…¥å•ä¸ªæˆ–è€…å¤šä¸ª</li>
<li>insertOne æ’å…¥å•ä¸ªæ–‡æ¡£</li>
<li>insertMany æ’å…¥å¤šä¸ªæ–‡æ¡£</li>
</ul>
<p>å¦‚æœæ’å…¥æ–‡æ¡£æ²¡æœ‰æä¾› _id,MongoDB ä¼šé»˜è®¤ç”Ÿæˆä¸€ä¸ª ObjectId çš„ _id,</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">db.<span class="property">table_name</span>.<span class="title function_">insert</span>(</span><br><span class="line">    [</span><br><span class="line">        &#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">_id</span>:<span class="string">&#x27;12312312&#x27;</span>, <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª2&#x27;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">    &#123; <span class="comment">// insertOne,insertManyä¹Ÿå¯ä»¥è®¾ç½®</span></span><br><span class="line">        <span class="attr">writeConcern</span>: &#123; <span class="comment">// å†™å…¥ç­–ç•¥</span></span><br><span class="line">            <span class="attr">w</span>: <span class="number">1</span>,  <span class="comment">// 0 ä¸è¦æ±‚è¿›è¡Œå†™å…¥ç¡®è®¤  1 è¦æ±‚è¿›è¡Œå†™å…¥ç¡®è®¤  majority è¦æ±‚å·²å†™å…¥åˆ°å‰¯æœ¬é›†ä¸­çš„å¤§å¤šæ•°æœåŠ¡å™¨ä¸­ , é»˜è®¤ä¸º1 </span></span><br><span class="line">            <span class="attr">j</span>: <span class="literal">false</span>, <span class="comment">// å¦‚æœä¸ºtrueï¼Œå†™å…¥è¯·æ±‚å°†ç­‰åˆ°æ—¥å¿—åŒæ­¥å®Œæˆåå†è¿”å›,é»˜è®¤false</span></span><br><span class="line">            <span class="attr">wtimeout</span>: <span class="number">5000</span> <span class="comment">// è¶…æ—¶æ—¶é—´</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">ordered</span>: <span class="literal">false</span> <span class="comment">// æŒ‡å®šæ˜¯å¦æœ‰åºæ’å…¥é»˜è®¤ä¸ºtrue</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// insertOne é…ç½®æ²¡æœ‰ ordered</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">insertOne</span>(&#123;</span><br><span class="line">    <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å•ä¸ª&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">insertMany</span>([</span><br><span class="line">    &#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span>&#125;,</span><br><span class="line">    &#123; <span class="attr">_id</span>:<span class="string">&#x27;12312312&#x27;</span>, <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª2&#x27;</span>&#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
<h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><p>åˆ é™¤ä¹Ÿå†…éƒ¨æä¾›äº†ä¸‰ä¸ªæ–¹æ³•</p>
<ul>
<li>remove  åˆ é™¤å•ä¸ªæˆ–è€…å¤šä¸ªæ–‡æ¡£</li>
<li>deleteOne åˆ é™¤å•ä¸ªæ–‡æ¡£,3.2+ æä¾›çš„</li>
<li>deleteMany åˆ é™¤å¤šä¸ªæ–‡æ¡£,3.2+ æä¾›çš„</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">db.<span class="property">table_name</span>.<span class="title function_">remove</span>(</span><br><span class="line">    &#123; <span class="comment">// æŒ‡å®šè¿‡æ»¤æ¡ä»¶</span></span><br><span class="line">        <span class="attr">title</span>: <span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;<span class="comment">// é…ç½®,å¯å¿½ç•¥</span></span><br><span class="line">        <span class="attr">justOne</span>: <span class="literal">true</span>,<span class="comment">// æŒ‡å®šæ˜¯å¦ä»…åˆ é™¤ä¸€ä¸ª</span></span><br><span class="line">        <span class="attr">writeConcern</span>:&#123;&#125;,<span class="comment">// å†™å…¥ç­–ç•¥</span></span><br><span class="line">        <span class="attr">collation</span>:&#123;&#125; <span class="comment">// Collationå…è®¸æ ¹æ®è¯­è¨€æŒ‡å®šè‡ªå®šä¹‰æ’åºè§„åˆ™,ä½ç‰ˆæœ¬é‡Œé»˜è®¤æ˜¯æŒ‰å­—èŠ‚å¯¹æ¯”çš„</span></span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"><span class="comment">// ä¸æŒ‡å®šæ¡ä»¶,é»˜è®¤åˆ é™¤æ‰€æœ‰</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">remove</span>(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// deleteOne,deleteManyä¸remove ç±»ä¼¼,å»æ‰äº†justOneé…ç½®,å¢åŠ äº†hint æŒ‡å®šç´¢å¼•</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">deleteOne</span>(&#123;&#125;,&#123;&#125;)</span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">deleteMany</span>(&#123;&#125;,&#123;&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><p>æŸ¥è¯¢ä¹Ÿæä¾›äº†å•ä¸ªå’Œå¤šä¸ªæ–‡æ¡£æŸ¥è¯¢ç­‰</p>
<ul>
<li>find æŸ¥æ‰¾é›†åˆä¸­ç¬¦åˆæ¡ä»¶çš„æ‰€æœ‰è®°å½•</li>
<li>findOne æŸ¥è¯¢å•æ¡</li>
</ul>
<h3 id="å¸¸ç”¨æ¡ä»¶ä½¿ç”¨æ–¹å¼"><a href="#å¸¸ç”¨æ¡ä»¶ä½¿ç”¨æ–¹å¼" class="headerlink" title="å¸¸ç”¨æ¡ä»¶ä½¿ç”¨æ–¹å¼"></a>å¸¸ç”¨æ¡ä»¶ä½¿ç”¨æ–¹å¼</h3><p>find ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæŒ‡å®šæŸ¥è¯¢æ¡ä»¶æ–‡æ¡£ï¼Œä¸€ä¸ªæŒ‡å®šå­—æ®µ</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¯­æ³•</span></span><br><span class="line"><span class="comment">// projection å¯é€‰ï¼Œä¸æŒ‡å®šprojectioné»˜è®¤æŸ¥æ‰€æœ‰</span></span><br><span class="line">db.<span class="property">collection</span>.<span class="title function_">find</span>(query, projection)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¢åŠ å‡ æ¡ç¤ºä¾‹æ•°æ®</span></span><br><span class="line">[</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª1&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125;, <span class="attr">arr</span>: [ &#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125; ] &#125;,</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª2&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125;, <span class="attr">arr</span>: [ &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125;,&#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125; ] &#125;,</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª3&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;C&#x27;</span> &#125;, <span class="attr">arr</span>: [ &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;C&#x27;</span> &#125;,&#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125; ] &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ™®é€šæŸ¥è¯¢</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; <span class="attr">title</span>:<span class="string">&quot;æ’å…¥å¤šä¸ª1&quot;</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢æ•°ç»„ä¸­åµŒå¥—æ–‡æ¡£</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æŸ¥è¯¢ arr æ•°ç»„, æŸ¥è¯¢æ¡ä»¶é‡Œçš„ç»“æ„é¡ºåºå¿…é¡»å’Œå­˜å‚¨çš„ä¿æŒä¸€ç›´ï¼Œ å¦‚æœæ˜¯ arr:&#123; title:&#x27;A&#x27;ï¼Œstatue:1 &#125; åˆ™æŸ¥è¯¢ä¸å‡ºæ¥</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; </span><br><span class="line">    <span class="attr">arr</span>:&#123; </span><br><span class="line">        <span class="attr">statue</span>:<span class="number">1</span>,</span><br><span class="line">        <span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// arr æ•°ç»„ä¸­å¯¹è±¡å­—æ®µä½œä¸ºæ¡ä»¶</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; </span><br><span class="line">    <span class="string">&#x27;arr.statue&#x27;</span>: <span class="number">9</span> </span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// ä½¿ç”¨å¤šä¸ªå­—æ®µä½œä¸ºæ¡ä»¶çš„æ—¶å€™ï¼Œçœ‹çš„ä¸Šé¢çš„å¯èƒ½ä¼šè”æƒ³åˆ°è¿™å†™ã€‚ å®é™…ä¸Šè¿™æ ·ä¼šæŠŠç¬¬2ï¼Œ3æ¡éƒ½æŸ¥è¯¢å‡ºæ¥ï¼Œè¿™æ ·å®é™…æ˜¯æŸ¥è¯¢ statueä¸º9å’Œtitleä¸ºAçš„ï¼Œä½†æ˜¯å¹¶ä¸éœ€è¦æ˜¯åŒä¸€ä¸ªæ–‡æ¡£é‡Œ</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; </span><br><span class="line">    <span class="string">&#x27;arr.statue&#x27;</span>: <span class="number">9</span> ,</span><br><span class="line">    <span class="string">&#x27;arr.title&#x27;</span>: <span class="string">&#x27;A&#x27;</span> </span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æƒ³è¦ä½¿ç”¨ä¸€ä¸ªæ–‡æ¡£ä¸­å¤šä¸ªå­—æ®µ éœ€è¦ä½¿ç”¨ è¿ç®—ç¬¦ $elemMatch</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123;</span><br><span class="line">  <span class="attr">arr</span>:&#123;</span><br><span class="line">    <span class="attr">$elemMatch</span>:&#123;</span><br><span class="line">      <span class="attr">title</span>:<span class="string">&quot;A&quot;</span>,</span><br><span class="line">      <span class="attr">statue</span>: <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æŸ¥è¯¢åµŒå¥—çš„æ–‡æ¡£</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™æ ·å†™ å’Œæ•°ç»„ä¸€æ ·ï¼Œéƒ½æ˜¯å®Œå…¨åŒ¹é…ä¸€è‡´</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123;</span><br><span class="line">  <span class="attr">obj</span>:&#123;</span><br><span class="line">    <span class="attr">statue</span>:<span class="number">1</span>,</span><br><span class="line">    <span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// æŒ‡å®šæ–‡æ¡£å­—æ®µ</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123;</span><br><span class="line"> <span class="string">&#x27;obj.statue&#x27;</span>:<span class="number">1</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="æŒ‡å®šè¿”å›å­—æ®µ"><a href="#æŒ‡å®šè¿”å›å­—æ®µ" class="headerlink" title="æŒ‡å®šè¿”å›å­—æ®µ"></a>æŒ‡å®šè¿”å›å­—æ®µ</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMongoDB ä¸­çš„æŸ¥è¯¢è¿”å›åŒ¹é…æ–‡æ¡£ä¸­çš„æ‰€æœ‰å­—æ®µ,å¯ä»¥é…ç½®ä¸€ä¸ª projection æ–‡æ¡£ä»¥æŒ‡å®šæˆ–é™åˆ¶è¦è¿”å›çš„å­—æ®µã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¤ºä¾‹æ•°æ®ç»“æ„</span></span><br><span class="line">&#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª1&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125;, <span class="attr">arr</span>: [ &#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125; ] &#125;</span><br><span class="line"></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span> &#125;)</span><br><span class="line"><span class="comment">// ç±»ä¼¼sqlçš„</span></span><br><span class="line">select * <span class="keyword">from</span> table_name where title=<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡å®šè¿”å›å­—æ®µ</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span> &#125;,&#123; <span class="attr">title</span>: <span class="number">1</span>,<span class="attr">staus</span>:<span class="number">1</span>  &#125;)  <span class="comment">// 1 ä»£è¡¨è¿”å›å­—æ®µ, 0 ä»£è¡¨è¿‡æ»¤çš„å­—æ®µ</span></span><br><span class="line"><span class="comment">// ç±»ä¼¼sqlçš„</span></span><br><span class="line">select _id,title,staus <span class="keyword">from</span> table_name where title=<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span></span><br><span class="line"><span class="comment">// _id MongoDBæ˜¯é»˜è®¤æŒ‡å®šè¿”å›çš„,å¦‚æœæƒ³è¦ä¸è¿”å› å¯ä»¥æŒ‡å®š &#123; _id:0 &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‡å®šåµŒå¥—æ–‡æ¡£è¿”å›å­—æ®µ  4.4ä»¥åç‰ˆæœ¬,è¿˜å¯ä»¥ç›´æ¥åµŒå¥—ä½¿ç”¨ &#123; title: 1,obj:&#123; statue:1  &#125; &#125;</span></span><br><span class="line"><span class="comment">// åµŒå¥—çš„æ•°ç»„å’ŒåµŒå¥—æ–‡æ¡£æ“ä½œä¸€è‡´</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span> &#125;,&#123; <span class="attr">title</span>: <span class="number">1</span>,<span class="string">&#x27;obj.statue&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;arr.title&#x27;</span>: <span class="number">1</span> &#125;) </span><br><span class="line"><span class="comment">// è¿”å›ç»“æœ</span></span><br><span class="line">&#123;  <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª1&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">1</span> &#125;, <span class="attr">arr</span>: [&#123; <span class="attr">title</span>:<span class="number">1</span> &#125;]&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ©ç”¨è¿ç®—ç¬¦ æ•°ç»„æŒ‡å®šæ•°æ® $slice è¿”å›æ•°ç»„æœ€åä¸€ä¸ª</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">find</span>(&#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span> &#125;,&#123; <span class="attr">title</span>: <span class="number">1</span>,<span class="string">&#x27;obj.statue&#x27;</span>: <span class="number">1</span>, <span class="attr">arr</span>: &#123; <span class="attr">$slice</span>: -<span class="number">1</span> &#125; &#125;) </span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨æŸ¥è¯¢è¿ç®—ç¬¦å’Œæ˜ å°„è¿ç®—ç¬¦ï¼Œè¿˜èƒ½å®ç°æ›´ä¸ºå¤æ‚çš„æ¡ä»¶è¿‡æ»¤å’Œå­—æ®µåŒ¹é…</p>
<h3 id="æŸ¥è¯¢å¸¸ç”¨çš„è¿ç®—ç¬¦"><a href="#æŸ¥è¯¢å¸¸ç”¨çš„è¿ç®—ç¬¦" class="headerlink" title="æŸ¥è¯¢å¸¸ç”¨çš„è¿ç®—ç¬¦"></a>æŸ¥è¯¢å¸¸ç”¨çš„è¿ç®—ç¬¦</h3><ul>
<li>$eq,$gt ç­‰è¿™ç±»æ¯”è¾ƒå¤§å°çš„ã€‚</li>
<li>$in,$nin ç±»ä¼¼ sql ä¸­çš„ in å’Œ not in ã€‚</li>
<li>$regex ä½¿ç”¨æ­£åˆ™åŒ¹é…ã€‚</li>
<li>$exists åˆ¤æ–­æ˜¯å¦æœ‰æŒ‡å®šå­—æ®µã€‚</li>
<li>$and ç±»ä¼¼ sql çš„ andã€‚</li>
<li>$or ç±»ä¼¼ sql çš„ orã€‚</li>
<li>$not æŸ¥è¯¢æŒ‡å®šæ¡ä»¶ä»¥å¤–çš„æ•°æ®ã€‚</li>
<li>$nor å’Œ $or ç»“æœæ˜¯ç›¸åçš„ã€‚</li>
<li>$all åŒ¹é…åŒ…å«æŸ¥è¯¢ä¸­æŒ‡å®šçš„æ‰€æœ‰å…ƒç´ çš„æ•°ç»„ã€‚</li>
<li>$elemMatch å¦‚æœ array å­—æ®µä¸­çš„å…ƒç´ ç¬¦åˆæ‰€æœ‰æŒ‡å®š $elemMatch æ¡ä»¶ï¼Œåˆ™é€‰æ‹©æ–‡æ¡£ã€‚</li>
<li>$size å¦‚æœæ•°ç»„å­—æ®µä¸ºæŒ‡å®šå¤§å°ï¼Œåˆ™é€‰æ‹©æ–‡æ¡£ã€‚</li>
</ul>
<h3 id="æŸ¥è¯¢ä¸­çš„æ˜ å°„"><a href="#æŸ¥è¯¢ä¸­çš„æ˜ å°„" class="headerlink" title="æŸ¥è¯¢ä¸­çš„æ˜ å°„"></a>æŸ¥è¯¢ä¸­çš„æ˜ å°„</h3><ul>
<li>$ æ•°ç»„ä¸­åŒ¹é…æŸ¥è¯¢æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li>
<li>$elemMatch ç¬¦åˆæŒ‡å®š $elemMatch æ¡ä»¶çš„æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li>
<li>$meta é¡¹ç›®åœ¨ $text æ“ä½œæœŸé—´åˆ†é…çš„æ–‡æ¡£åˆ†æ•°ã€‚</li>
<li>$slice é™åˆ¶ä»æ•°ç»„ä¸­æŠ•å½±çš„å…ƒç´ æ•°é‡ã€‚æ”¯æŒ limit å’Œ skipã€‚</li>
</ul>
<h3 id="æŸ¥è¯¢ä¿®é¥°ç¬¦"><a href="#æŸ¥è¯¢ä¿®é¥°ç¬¦" class="headerlink" title="æŸ¥è¯¢ä¿®é¥°ç¬¦"></a>æŸ¥è¯¢ä¿®é¥°ç¬¦</h3><ul>
<li>$comment å‘æŸ¥è¯¢æ·»åŠ æ³¨é‡Šï¼Œä»¥æ ‡è¯†æ•°æ®åº“æ¢æŸ¥å™¨è¾“å‡ºä¸­çš„æŸ¥è¯¢ã€‚</li>
<li>$explain å¼ºåˆ¶ MongoDB æŠ¥å‘ŠæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ã€‚è¯·å‚é˜… explain()ã€‚</li>
<li>$hint ä»…å¼ºåˆ¶ MongoDB ä½¿ç”¨ç‰¹å®šç´¢å¼•ã€‚è¯·çœ‹ hint()</li>
<li>$max æŒ‡å®šè¦åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„æ’ä»–ä¸Šé™ã€‚è¯·å‚é˜… max()ã€‚</li>
<li>$maxTimeMS æŒ‡å®šå¯¹æ¸¸æ ‡è¿›è¡Œå¤„ç†æ“ä½œçš„ç´¯ç§¯æ—¶é—´é™åˆ¶ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚è¯·å‚é˜… maxTimeMS()ã€‚</li>
<li>$min æŒ‡å®šä¸€ä¸ªåŒ…å®¹æ€§çš„ä¸‹é™ä¸ºç´¢å¼•åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ã€‚è¯·å‚é˜… min()ã€‚</li>
<li>$orderby è¿”å›å¸¦æœ‰æ ¹æ®æ’åºè§„èŒƒæ’åºçš„æ–‡æ¡£çš„æ¸¸æ ‡ã€‚è¯·å‚é˜… sort()ã€‚</li>
<li>$query åŒ…è£…æŸ¥è¯¢æ–‡æ¡£ã€‚</li>
<li>$returnKey å¼ºåˆ¶æ¸¸æ ‡ä»…è¿”å›ç´¢å¼•ä¸­åŒ…å«çš„å­—æ®µã€‚</li>
<li>$showDiskLoc ä¿®æ”¹è¿”å›çš„æ–‡æ¡£ä»¥åŒ…æ‹¬å¯¹æ¯ä¸ªæ–‡æ¡£åœ¨ç£ç›˜ä¸Šä½ç½®çš„å¼•ç”¨ã€‚</li>
</ul>
<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>MongoDBä¸­æ›´æ–°æ–‡æ¡£ï¼Œéœ€è¦ä¸æ›´æ–°è¿ç®—ç¬¦ç»“åˆä½¿ç”¨æ¥ä¿®æ”¹å­—æ®µå€¼ã€‚<br>æä¾›çš„æ›´æ–°æ–¹æ³•</p>
<ul>
<li>update æ›´æ–°æˆ–æ›¿æ¢å•ä¸ªæˆ–è€…å¤šä¸ªæ–‡æ¡£</li>
<li>updateOne æ›´æ–°å•ä¸ªæ–‡æ¡£</li>
<li>updateMany æ›´æ–°å¤šä¸ªæ–‡æ¡£</li>
<li>replaceOne æ›¿æ¢å•ä¸ªæ–‡æ¡£<br>åŸºæœ¬ä½¿ç”¨æ–¹å¼<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¢åŠ å‡ æ¡ç¤ºä¾‹æ•°æ®</span></span><br><span class="line">[</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª1&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;A&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125;, <span class="attr">arr</span>: [ &#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125; ] &#125;,</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª2&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;B&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125;, <span class="attr">arr</span>: [ &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125;,&#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125; ] &#125;,</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª3&quot;</span>, <span class="attr">status</span>: <span class="string">&quot;C&quot;</span>, <span class="attr">obj</span>: &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;C&#x27;</span> &#125;, <span class="attr">arr</span>: [ &#123; <span class="attr">statue</span>:<span class="number">9</span>,<span class="attr">title</span>:<span class="string">&#x27;C&#x27;</span> &#125;,&#123; <span class="attr">statue</span>:<span class="number">1</span>,<span class="attr">title</span>:<span class="string">&#x27;A&#x27;</span> &#125; ] &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯­æ³• </span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">update</span>(<span class="string">&#x27;æŸ¥è¯¢æ¡ä»¶&#x27;</span>,<span class="string">&#x27;æ›´æ–°ç®¡é“&#x27;</span>,<span class="string">&#x27;è®¾ç½®&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›¿æ¢æŸ¥è¯¢çš„æ•´ä¸ªæ–‡æ¡£</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">update</span>(&#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span> &#125;,&#123; <span class="attr">status</span>:<span class="string">&#x27;D&#x27;</span> &#125;)</span><br><span class="line"><span class="comment">// æ›´æ–°æŒ‡å®šå­—æ®µ</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">update</span>(</span><br><span class="line">  &#123; <span class="attr">title</span>:<span class="string">&#x27;æ’å…¥å¤šä¸ª1&#x27;</span> &#125;,</span><br><span class="line">  &#123; </span><br><span class="line">    <span class="attr">$set</span>:&#123;</span><br><span class="line">      <span class="attr">status</span>:<span class="string">&#x27;D&#x27;</span> </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">multi</span>: <span class="literal">true</span> ,<span class="comment">// é»˜è®¤false, æ˜¯å¦æ›´æ–°å¤šæ¡</span></span><br><span class="line">    <span class="attr">upsert</span>: <span class="literal">true</span>,<span class="comment">// é»˜è®¤fals, å¦‚æœä¸å­˜åœ¨æ–‡æ¡£è¿™æ–°å¢ä¸€æ¡</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹åµŒå¥—æ•°ç»„å­—æ®µ</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">update</span>(</span><br><span class="line">  &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª1&quot;</span>, <span class="string">&quot;arr.statue&quot;</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;$set&quot;</span>: &#123;</span><br><span class="line">        <span class="comment">//&quot;arr.0.statue&quot;: 3 // ä¿®æ”¹ç¬¬1æ¡</span></span><br><span class="line">        <span class="string">&quot;arr.$.statue&quot;</span>: <span class="number">3</span> <span class="comment">// å•ä¸ªä¿®æ”¹éœ€è¦æŒ‡å®šæ•°ç»„æ¡ä»¶</span></span><br><span class="line">        <span class="comment">//&quot;arr.$[].statue&quot;: 3 //ä¿®æ”¹å¤šä¸ª</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»é™¤å­—æ®µ</span></span><br><span class="line">db.<span class="property">table_name</span>.<span class="title function_">update</span>(</span><br><span class="line">  &#123; <span class="attr">title</span>: <span class="string">&quot;æ’å…¥å¤šä¸ª1&quot;</span> &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="string">&quot;$unset&quot;</span>:&#123;</span><br><span class="line">          <span class="attr">status</span>: <span class="number">0</span></span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.2åçš„ç‰ˆæœ¬è¿˜å¯ä»¥å°†èšåˆç®¡é“ç”¨æ¥æ›´æ–°</span></span><br><span class="line"><span class="comment">// å°†åˆè®¡å€¼æ›´æ–°åˆ° total ä¸Š</span></span><br><span class="line">db.<span class="property">collection</span>.<span class="title function_">update</span>(&#123;&#125;,</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;$set&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">total</span>: &#123;</span><br><span class="line">        <span class="string">&quot;$sum&quot;</span>: [</span><br><span class="line">          <span class="string">&quot;$arr.statue&quot;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">],</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">multi</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="å­—æ®µæ›´æ–°è¿ç®—ç¬¦"><a href="#å­—æ®µæ›´æ–°è¿ç®—ç¬¦" class="headerlink" title="å­—æ®µæ›´æ–°è¿ç®—ç¬¦"></a>å­—æ®µæ›´æ–°è¿ç®—ç¬¦</h3><ul>
<li>$currentDate å°†å­—æ®µçš„å€¼è®¾ç½®ä¸ºå½“å‰æ—¥æœŸï¼Œå³æ—¥æœŸæˆ–æ—¶é—´æˆ³ã€‚</li>
<li>$inc å°†å­—æ®µçš„å€¼å¢åŠ æŒ‡å®šçš„æ•°é‡ã€‚</li>
<li>$min ä»…å½“æŒ‡å®šå€¼å°äºç°æœ‰å­—æ®µå€¼æ—¶æ‰æ›´æ–°è¯¥å­—æ®µã€‚</li>
<li>$max ä»…å½“æŒ‡å®šå€¼å¤§äºç°æœ‰å­—æ®µå€¼æ—¶æ‰æ›´æ–°è¯¥å­—æ®µã€‚</li>
<li>$mul å°†å­—æ®µçš„å€¼ä¹˜ä»¥æŒ‡å®šçš„æ•°é‡ã€‚</li>
<li>$rename é‡å‘½åå­—æ®µã€‚</li>
<li>$set è®¾ç½®æ–‡æ¡£ä¸­å­—æ®µçš„å€¼ã€‚</li>
<li>$setOnInsert å¦‚æœæ›´æ–°å¯¼è‡´æ’å…¥æ–‡æ¡£ï¼Œåˆ™è®¾ç½®å­—æ®µçš„å€¼ã€‚å¯¹ä¿®æ”¹ç°æœ‰æ–‡æ¡£çš„æ›´æ–°æ“ä½œæ²¡æœ‰å½±å“ã€‚</li>
<li>$unset ä»æ–‡æ¡£ä¸­åˆ é™¤æŒ‡å®šçš„å­—æ®µã€‚</li>
</ul>
<h3 id="æ•°ç»„æ›´æ–°è¿ç®—ç¬¦"><a href="#æ•°ç»„æ›´æ–°è¿ç®—ç¬¦" class="headerlink" title="æ•°ç»„æ›´æ–°è¿ç®—ç¬¦"></a>æ•°ç»„æ›´æ–°è¿ç®—ç¬¦</h3><ul>
<li>$[] å……å½“å ä½ç¬¦ï¼Œä»¥æ›´æ–°åŒ¹é…æŸ¥è¯¢æ¡ä»¶çš„æ–‡æ¡£çš„æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚</li>
<li>$ å……å½“å ä½ç¬¦ï¼Œä»¥æ›´æ–°ä¸æŸ¥è¯¢æ¡ä»¶åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li>
<li>$[<identifier>] å……å½“å ä½ç¬¦ï¼Œä»¥æ›´æ–° arrayFilters ä¸æŸ¥è¯¢æ¡ä»¶åŒ¹é…çš„æ–‡æ¡£ä¸­æ‰€æœ‰ä¸æ¡ä»¶åŒ¹é…çš„å…ƒç´ ã€‚</li>
<li>$addToSet ä»…å½“å…ƒç´ ä¸å­˜åœ¨äºé›†åˆä¸­æ—¶æ‰å°†å®ƒä»¬æ·»åŠ åˆ°æ•°ç»„ä¸­ã€‚</li>
<li>$pop åˆ é™¤æ•°ç»„çš„ç¬¬ä¸€é¡¹æˆ–æœ€åä¸€é¡¹ã€‚</li>
<li>$pull åˆ é™¤ä¸æŒ‡å®šæŸ¥è¯¢åŒ¹é…çš„æ‰€æœ‰æ•°ç»„å…ƒç´ ã€‚</li>
<li>$push å°†é¡¹ç›®æ·»åŠ åˆ°æ•°ç»„ã€‚</li>
<li>$pullAll ä»æ•°ç»„ä¸­åˆ é™¤æ‰€æœ‰åŒ¹é…çš„å€¼ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>MongoDB</tag>
      </tags>
  </entry>
  <entry>
    <title>node å®ç°ç®€å• http è½¬å‘</title>
    <url>/node_proxy/</url>
    <content><![CDATA[<p>ç”±äºåŒæºç­–ç•¥çš„é™åˆ¶ï¼Œå‰ç«¯æƒ³è¦éšä¾¿è°ƒç”¨åˆ«äººçš„æ•°æ®æ²¡æœ‰é‚£ä¹ˆå®¹æ˜“ï¼Œåˆ©ç”¨jsonpå»è°ƒç”¨è™½ç„¶å¯ä»¥ï¼Œä½†æ˜¯ä¹Ÿå¾—åˆ«äººæ”¯æŒï¼Œè€Œä¸”è¿˜åªèƒ½æ˜¯get è¯·æ±‚ã€‚æƒ³è¦éšä¾¿è°ƒç”¨åˆ«äººæ•°æ®ï¼Œæœ€ç®€å•å°±æ˜¯å¼„ä¸€ä¸ªä»£ç†æœåŠ¡ï¼Œå®ç°æ•°æ®çš„è½¬å‘ã€‚</p>
<span id="more"></span>

<h2 id="node-å®ç°é€æ˜è½¬å‘"><a href="#node-å®ç°é€æ˜è½¬å‘" class="headerlink" title="node å®ç°é€æ˜è½¬å‘"></a>node å®ç°é€æ˜è½¬å‘</h2><p>ä¸»è¦å°±æ˜¯ä½¿ç”¨ stream.pipe()ï¼Œå°†è¯·æ±‚å¾—æµå†™å…¥è‡ªå·±å†™å¾—è¯·æ±‚ä¸­ï¼Œå†å°†è¯·æ±‚åˆ°çš„æ•°æ®å†™å…¥å“åº”æµä¸­ã€‚<br>ç®€å•å®ç°ä¾‹å­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">&#x27;https&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> os = <span class="built_in">require</span>(<span class="string">&#x27;os&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;https://www.imalun.com/&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">7000</span>,</span><br><span class="line">    <span class="attr">ip</span>: <span class="title function_">getIpv4</span>(),</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;http&#x27;</span>,</span><br><span class="line">    http,</span><br><span class="line">    https</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> argv = process.<span class="property">argv</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (argv.<span class="property">length</span> &lt; <span class="number">3</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;\t\n\x1B[41m\x1B[1m%s\x1B[22m\x1B[49m  %s\t\n&#x27;</span>, <span class="string">&#x27; error &#x27;</span>, <span class="string">&#x27;è¯·æŒ‡å®š proxy url \t\n demo :  node proxy www.imalun.com &#x27;</span>);</span><br><span class="line">    process.<span class="title function_">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> [, , ...par] = argv;</span><br><span class="line">    config.<span class="property">url</span> = par[<span class="number">0</span>];</span><br><span class="line">    config.<span class="property">port</span> = par[<span class="number">1</span>] || config.<span class="property">port</span>;</span><br><span class="line">    <span class="keyword">if</span> (par[<span class="number">0</span>].<span class="title function_">substr</span>(<span class="number">0</span>, <span class="number">5</span>) === <span class="string">&#x27;https&#x27;</span>) &#123;</span><br><span class="line">        config.<span class="property">type</span> = <span class="string">&#x27;https&#x27;</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (par[<span class="number">0</span>].<span class="title function_">substr</span>(<span class="number">0</span>, <span class="number">4</span>) === <span class="string">&#x27;http&#x27;</span>) &#123;</span><br><span class="line">        config.<span class="property">type</span> = <span class="string">&#x27;http&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;content-type&quot;</span>);</span><br><span class="line">    res.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;DELETE,PUT,POST,GET,OPTIONS&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span>.<span class="title function_">toLowerCase</span>() == <span class="string">&#x27;options&#x27;</span>)</span><br><span class="line">        res.<span class="title function_">end</span>();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        req.<span class="title function_">pipe</span>(config[config.<span class="property">type</span>].<span class="title function_">request</span>(config.<span class="property">url</span> + req.<span class="property">url</span>, <span class="function">(<span class="params">respo</span>) =&gt;</span> respo.<span class="title function_">pipe</span>(res)))</span><br><span class="line">&#125;).<span class="title function_">listen</span>(config.<span class="property">port</span>, <span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;\x1B[42m\x1B[1m%s\x1B[22m\x1B[49m&#x27;</span>, <span class="string">&#x27; success \t\n&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;\x1B[44m\x1B[1m%s\x1B[22m\x1B[49m %s\t\n&#x27;</span>, <span class="string">&#x27; prot &#x27;</span>, <span class="string">&#x27;http://&#x27;</span> + config.<span class="property">ip</span> + <span class="string">&#x27;:&#x27;</span> + config.<span class="property">port</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;\x1B[44m\x1B[1m%s\x1B[22m\x1B[49m  %s\t\n&#x27;</span>, <span class="string">&#x27; proxy url &#x27;</span>, config.<span class="property">url</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getIpv4</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> net = os.<span class="title function_">networkInterfaces</span>();</span><br><span class="line">    <span class="keyword">let</span> ipv4;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> key <span class="keyword">in</span> net) &#123;</span><br><span class="line">        net[key].<span class="title function_">forEach</span>(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (element.<span class="property">address</span> !== <span class="string">&#x27;127.0.0.1&#x27;</span> &amp;&amp; element.<span class="property">family</span>.<span class="title function_">toLocaleLowerCase</span>() === <span class="string">&#x27;ipv4&#x27;</span>) ipv4 = element.<span class="property">address</span></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ipv4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå¦‚ä¸‹</p>
<p><img src="/images/posts/node_proxy/20200629201153.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>node</tag>
      </tags>
  </entry>
  <entry>
    <title>2023å¹´ï¼Œè¿˜åœ¨æ‰‹åŠ¨å‘å¸ƒ npm åŒ…ï¼Ÿ</title>
    <url>/npm_publish_package/</url>
    <content><![CDATA[<p>è¿˜åœ¨æ‰‹åŠ¨ <code>npm publish</code> å‘å¸ƒ <code>npm</code> ï¼Ÿ è¿˜åœ¨æ‰‹åŠ¨æ›´æ–°ç‰ˆæœ¬åˆ›å»ºå‘å¸ƒ <code>Github Release</code> ï¼Ÿè¿˜åœ¨æ‰‹åŠ¨æ·»åŠ  <code>Changelog</code>ï¼Ÿæ˜¯æ—¶å€™åˆ©ç”¨  <code>CI/CD</code> è§£æ”¾åŒæ‰‹å•¦ã€‚å¸¸è§çš„ <code>CI/CD</code> æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ Jenkinsã€GitLab CIã€CircleCI ã€Github Actions ç­‰ã€‚æœ¬æ–‡ä¸»è¦æ˜¯é€šè¿‡ <code>Github Actions</code> æ¥è‡ªåŠ¨åŒ–å¤„ç† <code>npm</code> åŒ…ç®¡ç†ã€‚</p>
<h2 id="Github-Actions"><a href="#Github-Actions" class="headerlink" title="Github Actions"></a>Github Actions</h2><p><code>GitHub Actions</code> è·ç¦»æ¨å‡ºå·²ç»å¥½å‡ å¹´äº†ï¼Œç›¸ä¿¡å°ä¼™ä¼´ä»¬æ²¡ç”¨è¿‡ï¼Œä¹Ÿå¬è¯´è¿‡ã€‚<code>GitHub Actions</code> ä¸ä»…ä»…æ˜¯èƒ½è‡ªåŠ¨æ‰§è¡Œç”Ÿæˆã€æµ‹è¯•å’Œéƒ¨ç½²æ“ä½œï¼Œè¿˜å…è®¸æ‚¨åœ¨å­˜å‚¨åº“ä¸­å‘ç”Ÿå…¶ä»–äº‹ä»¶æ—¶è¿è¡Œå·¥ä½œæµç¨‹ã€‚ ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥è¿è¡Œå·¥ä½œæµç¨‹ï¼Œä»¥ä¾¿åœ¨æœ‰äººåœ¨æ‚¨çš„å­˜å‚¨åº“ä¸­åˆ›å»ºæ–°é—®é¢˜æ—¶è‡ªåŠ¨æ·»åŠ ç›¸åº”çš„æ ‡ç­¾ã€‚è€Œä¸” GitHub æä¾› Linuxã€Windows å’Œ macOS å¤šç§è™šæ‹Ÿæœºæ¥è¿è¡Œå·¥ä½œæµç¨‹ï¼Œå¯ä»¥æ›´å…·é¡¹ç›®é€‰æ‹©åˆé€‚çš„è™šæ‹Ÿæœºç¯å¢ƒã€‚</p>
<p><code>GitHub Actions</code> å…¶å®ä¸»è¦æ­¥éª¤åªæœ‰ä¸¤ä¸ªï¼Œ<code>event</code> (äº‹ä»¶è§¦å‘æ—¶æœº)ã€<code>jobs</code>ï¼ˆå·¥ä½œæµç¨‹ï¼‰ã€‚å¦‚æœè¿˜ä¸ç†Ÿæ‚‰ <code>GitHub Actions</code>ï¼Œå¯ä»¥<a href="https://docs.github.com/zh/actions">å‚è€ƒæ–‡æ¡£</a>å¯¹å…¶å¤§è‡´ä½¿ç”¨æœ‰ä¸ªäº†è§£ã€‚</p>
<h2 id="å‘å¸ƒ-Npm"><a href="#å‘å¸ƒ-Npm" class="headerlink" title="å‘å¸ƒ Npm"></a>å‘å¸ƒ Npm</h2><p>åœ¨æœ¬åœ°å‘å¸ƒ npm åŒ…éƒ½æ˜¯æœ¬åœ°æ‰“åŒ…æˆç»„ä»¶åï¼Œç™»å½• npm è´¦å·è¿è¡Œ npm publish å‘å¸ƒã€‚ä½¿ç”¨ <code>GitHub Actions</code> æ¥å‘å¸ƒ <code>npm</code> å¯ä»¥ä½¿ç”¨ <code>Npm Access Tokens</code>ï¼Œå¯ä»¥æ›´æ®éœ€è¦åˆ†é… <code>Tokens</code> æƒé™ï¼Œä¸éœ€è¦ä½¿ç”¨è´¦å·å¯†ç ç™»å½•ã€‚</p>
<h3 id="Github-Actions-å‘å¸ƒ-Npm"><a href="#Github-Actions-å‘å¸ƒ-Npm" class="headerlink" title="Github Actions å‘å¸ƒ Npm"></a>Github Actions å‘å¸ƒ Npm</h3><p>é¦–å…ˆéœ€è¦ç¡®å®šä½ å·¥ä½œæµè§¦å‘æ—¶æœºï¼Œè¿™ä¸ªéœ€è¦æ ¹æ®ä½ ä¸ªäººä¹ æƒ¯å†³å®šã€‚</p>
<p>ä¸¾ä¾‹ï¼š</p>
<div class="trm-tabs" id="test1"><ul class="trm-nav-tabs"><li class="trm-tab active"><button type="button" data-href="#test1-1">tag</button></li><li class="trm-tab"><button type="button" data-href="#test1-2">branches</button></li><li class="trm-tab"><button type="button" data-href="#test1-3">paths</button></li></ul><div class="trm-tab-contents"><div class="trm-tab-item-content active" id="test1-1"><p>æ¨é€ Tag æ—¶è§¦å‘</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;v*&quot;</span></span><br></pre></td></tr></table></figure></div><div class="trm-tab-item-content" id="test1-2"><p>ä»…åœ¨ master æ¨é€æ—¶è§¦å‘</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">master</span>]</span><br></pre></td></tr></table></figure></div><div class="trm-tab-item-content" id="test1-3"><p>ä»…åœ¨ master æ¨é€æ—¶ï¼Œä¸” docs ä¸‹æ–‡ä»¶ä¿®æ”¹æ—¶è§¦å‘ï¼Œæ›´å¤šå¯ä»¥<a href="https://docs.github.com/zh/actions/using-workflows/events-that-trigger-workflows">å‚è€ƒæ–‡æ¡£</a></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span> [<span class="string">master</span>]</span><br><span class="line">    <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;docs/**&#x27;</span></span><br></pre></td></tr></table></figure></div></div></div>

<p>æœ¬æ–‡å°±ä»¥ä¸ºæ¨é€ Tag è§¦å‘ä¸ºä¾‹ï¼š</p>
<p>åœ¨ä½ é¡¹ç›®ä¸‹æ·»åŠ  <code>.github\workflows\publish.yml</code> æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">NPM</span> <span class="string">Publish</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;v*&quot;</span></span><br></pre></td></tr></table></figure>
<h4 id="ä»£ç æ‹‰å–å’ŒNodeé…ç½®"><a href="#ä»£ç æ‹‰å–å’ŒNodeé…ç½®" class="headerlink" title="ä»£ç æ‹‰å–å’ŒNodeé…ç½®"></a>ä»£ç æ‹‰å–å’ŒNodeé…ç½®</h4><p>åœ¨ <code>jobs</code> æ·»åŠ ä¸€ä¸ªåä¸º <code>build</code> çš„ jobï¼Œé…ç½® <code>build</code> çš„ç¯å¢ƒå’Œæ‹‰å–ä»£ç ã€‚<code>runs-on: ubuntu-latest</code> é…ç½®è™šæ‹Ÿæœºä¸º <code>ubuntu</code>ï¼Œä½¿ç”¨å®˜æ–¹æå–ä»£ç æ‹‰å–å’Œ é…ç½® Node çš„ Actionsï¼Œæ›´å¤š <a href="https://github.com/actions">å®˜æ–¹æä¾› Actions</a></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">build:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span>   <span class="comment"># æ‹‰å–ä»£ç </span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/setup-node@v3</span> <span class="comment"># è®¾ç½® Node ç‰ˆæœ¬</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="number">16</span></span><br><span class="line">          <span class="attr">registry-url:</span> <span class="string">&#x27;https://registry.npmjs.org&#x27;</span></span><br><span class="line">          <span class="attr">cache:</span> <span class="string">yarn</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®ç¯å¢ƒå¯†é’¥"><a href="#é…ç½®ç¯å¢ƒå¯†é’¥" class="headerlink" title="é…ç½®ç¯å¢ƒå¯†é’¥"></a>é…ç½®ç¯å¢ƒå¯†é’¥</h4><p>æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œåœ¨ä½ é¡¹ç›® &#x3D;&gt; Settings &#x3D;&gt; Secrets and variables &#x3D;&gt; Actions ä¸­ æ·»åŠ ä½ çš„å¯†é’¥ï¼Œåç§°éšæ„å–ï¼Œå¯†é’¥å€¼ä¸ºä½ ä¸Šé¢ç”Ÿæˆçš„ <code>Npm Access Tokens</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼š<br>Name &#x3D;&gt; NPM_TOKEN<br>Secret &#x3D;&gt; ä½ çš„ <code>Npm Access Tokens</code></p>
<h4 id="å‘å¸ƒ-Npm-1"><a href="#å‘å¸ƒ-Npm-1" class="headerlink" title="å‘å¸ƒ Npm"></a>å‘å¸ƒ Npm</h4><p><code>build</code> çš„ job ä¸­ï¼Œæ·»åŠ å‘å¸ƒ Npm æ“ä½œï¼Œåˆ©ç”¨ NPM_TOKEN å‘å¸ƒ npm åŒ…</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">steps:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Npm</span> <span class="string">Publish</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">npm</span> <span class="string">publish</span></span><br><span class="line">    <span class="attr">env:</span></span><br><span class="line">      <span class="attr">NODE_AUTH_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.NPM_TOKEN</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>åˆ°æ­¤æ—¶ï¼Œå½“ä½ æ¨é€ä¸€ä¸ªä»¥ vå¼€å¤´ tag åˆ°ä»“åº“æ—¶ï¼Œå°±ä¼šæ‰§è¡Œè¿™ä¸ª publish.ymlï¼Œè¿™ä¸ª Action ä¼šå°†å½“å‰ä»“åº“å‘å¸ƒåˆ° Npm äº†ã€‚</p>
<p>å½“ç„¶ä½ çš„åŒ…å¯èƒ½è¿˜éœ€è¦æ‰§è¡Œä¸€äº›æ„å»ºæ“ä½œç­‰ç­‰ï¼Œä½ å¯ä»¥åœ¨ <code>run</code> é‡Œæ‰§è¡Œå¤šæ¡å‘½ä»¤</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    npm run build</span></span><br><span class="line"><span class="string">    #...æ›´å¤šæ“ä½œ</span></span><br><span class="line"><span class="string">    npm publish</span></span><br></pre></td></tr></table></figure>

<h3 id="åŒºåˆ†-Beta-å’Œ-latest"><a href="#åŒºåˆ†-Beta-å’Œ-latest" class="headerlink" title="åŒºåˆ† Beta å’Œ latest"></a>åŒºåˆ† Beta å’Œ latest</h3><p>é»˜è®¤æƒ…å†µä¸‹ <code>npm publish</code> å‘å¸ƒæ—¶æ­£å¼åŒ…ï¼Œå¦‚æœéœ€è¦æµ‹è¯•åŒ…éœ€è¦æ‰§è¡Œ <code>npm publish --tag beta</code>ã€‚åˆ©ç”¨ git tag æˆ‘ä»¬å¯ä»¥å°† v1.0.2 æ ¼å¼å‘ä¸ºæ­£å¼åŒ…ï¼Œå°† v1.0.2-beta.1 æ ¼å¼å‘å¸ƒæµ‹è¯•åŒ…ã€‚</p>
<p>ä¿®æ”¹ publish æµç¨‹ï¼Œ<code>Github Action</code> æ”¯æŒ <code>if</code> æ“ä½œï¼Œå¹¶ä¸æ”¯æŒ <code>else</code>ï¼Œåªèƒ½é€šè¿‡å¦‚ä¸‹æ¨¡æ‹Ÿ <code>if else</code> æ“ä½œã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">steps:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Beta</span> <span class="string">Publish</span></span><br><span class="line">    <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">contains(github.ref,&#x27;beta&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">npm</span> <span class="string">publish</span> <span class="string">--tag</span> <span class="string">beta</span></span><br><span class="line">    <span class="attr">env:</span></span><br><span class="line">      <span class="attr">NODE_AUTH_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.NPM_TOKEN</span> <span class="string">&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Publish</span></span><br><span class="line">    <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="type">!contains(github.ref,&#x27;beta&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">npm</span> <span class="string">publish</span></span><br><span class="line">    <span class="attr">env:</span></span><br><span class="line">      <span class="attr">NODE_AUTH_TOKEN:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.NPM_TOKEN</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ ¹æ®-Tag-æ›´æ–°ç‰ˆæœ¬å·"><a href="#æ ¹æ®-Tag-æ›´æ–°ç‰ˆæœ¬å·" class="headerlink" title="æ ¹æ® Tag æ›´æ–°ç‰ˆæœ¬å·"></a>æ ¹æ® Tag æ›´æ–°ç‰ˆæœ¬å·</h3><p>ä¸ºä¾‹é¿å…æ¯æ¬¡ä¿®æ”¹ package.json ä¸­ç‰ˆæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ® tag æ¥ä¿®æ”¹ package.json ä¸­ç‰ˆæœ¬ï¼Œå› ä¸ºä¸Šé¢é…ç½® node ç¯å¢ƒï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œ node ä»£ç ï¼Œæˆ‘ä»¬ç›´æ¥æ·»åŠ ä¸€ä¸ª publish.js æ–‡ä»¶ï¼Œå»ä¿®æ”¹ package.json ä¸­ version ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (process.<span class="property">env</span>.<span class="property">RELEASE_VERSION</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> version = process.<span class="property">env</span>.<span class="property">RELEASE_VERSION</span>.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>).<span class="title function_">reverse</span>()[<span class="number">0</span>]</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å½“å‰ç‰ˆæœ¬ï¼š&#x27;</span>, version);</span><br><span class="line">    <span class="keyword">const</span> pkg = <span class="built_in">require</span>(<span class="string">&#x27;./package.json&#x27;</span>)</span><br><span class="line">    pkg.<span class="property">version</span> = version.<span class="title function_">replace</span>(<span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    fs.<span class="title function_">writeFileSync</span>(path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;./package.json&#x27;</span>), <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(pkg, <span class="literal">null</span>, <span class="number">4</span>), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹ publish æµç¨‹ï¼Œåœ¨å‘å¸ƒå‰ä¿®æ”¹ç‰ˆæœ¬ï¼Œå¹¶å°† github.ref æ·»åŠ ç¯å¢ƒå˜é‡ RELEASE_VERSION</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">steps:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">node</span> <span class="string">./publish</span></span><br><span class="line">    <span class="attr">env:</span></span><br><span class="line">      <span class="attr">RELEASE_VERSION:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.ref</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºå‘å¸ƒ-Github-Release"><a href="#åˆ›å»ºå‘å¸ƒ-Github-Release" class="headerlink" title="åˆ›å»ºå‘å¸ƒ Github Release"></a>åˆ›å»ºå‘å¸ƒ Github Release</h3><p>å®˜æ–¹ <code>actions/create-release</code> ä¸åœ¨ç»´æŠ¤ï¼Œæ¨èå¦‚ä¸‹ Actionsï¼Œå¯ä»¥ç»“åˆéœ€è¦é€‰æ‹©ï¼Œä½ ä¹Ÿå¯ä»¥å»å‰å¾€ <a href="https://github.com/marketplace">marketplace</a> é€‰æ‹©æ›´å¤š Actionsã€‚</p>
<ul>
<li><a href="https://github.com/elgohr/Github-Release-Action">elgohr&#x2F;Github-Release-Action</a></li>
<li><a href="https://github.com/marvinpinto/action-automatic-releases">marvinpinto&#x2F;action-automatic-releases</a></li>
<li><a href="https://github.com/softprops/action-gh-release">softprops&#x2F;action-gh-release</a></li>
<li><a href="https://github.com/ncipollo/release-action">ncipollo&#x2F;release-action</a></li>
</ul>
<p>å¾ˆå¤šåˆ›å»º <code>Release</code> çš„ <code>Actions</code>ï¼Œå¹¶ä¸ä¼šå°†ä½ çš„æäº¤è‡ªåŠ¨ç”Ÿæˆå‘ç‰ˆè¯´æ˜ï¼Œæ‰€ä»¥æˆ‘ç¼–å†™äº†ä¸€ä¸ªå‘å¸ƒ <code>Release</code> çš„ <code>Actions</code>ï¼Œå…·ä½“å®ç°å‚è€ƒ <a href="https://github.com/MaLuns/add-release">MaLuns&#x2F;add-release</a> ä»¥æ»¡è¶³æˆ‘çš„éœ€æ±‚ã€‚Github ä¸ºæˆ‘ä»¬æä¾› <a href="https://github.com/actions/toolkit"><code>actions/toolkit</code></a> å¸®åŠ©æˆ‘ä»¬ç®€åŒ–äº†å¾ˆå¤šæ“ä½œã€‚</p>
<p>ç®€å•æè¿°å¦‚ä½•å®ç°ï¼š</p>
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 730.4648101751317 852.9999999999993" filter="invert(93%) hue-rotate(180deg)">

  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
    </style>
  </defs>
  <g stroke-linecap="round" transform="translate(10 10) rotate(0 139.5 27.5)"><path d="M13.75 0 M13.75 0 C109.38 -2.41, 205.68 1.99, 265.25 0 M13.75 0 C70.18 2.36, 124.81 0.97, 265.25 0 M265.25 0 C273.89 1.09, 281.74 7.28, 279 13.75 M265.25 0 C277.97 4.59, 274.44 8.78, 279 13.75 M279 13.75 C276.09 18.18, 279.75 24.18, 279 41.25 M279 13.75 C277.83 23.76, 280.05 32.76, 279 41.25 M279 41.25 C280.53 49.75, 271.57 52.1, 265.25 55 M279 41.25 C276.2 54.43, 269.9 58.1, 265.25 55 M265.25 55 C209.34 55.8, 147.98 55.99, 13.75 55 M265.25 55 C169.39 56.68, 70.38 55.24, 13.75 55 M13.75 55 C8.57 51.9, -0.4 48.89, 0 41.25 M13.75 55 C7.04 56.87, -3.65 50.34, 0 41.25 M0 41.25 C0.8 31.53, 3.38 23.71, 0 13.75 M0 41.25 C-1.05 30.71, 0.18 22.03, 0 13.75 M0 13.75 C-0.72 6.24, 2.74 3.88, 13.75 0 M0 13.75 C4.5 8.33, 4.37 -1.58, 13.75 0" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(28.5 27.5) rotate(0 121 10)"><text x="121" y="14" font-family="Virgil, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">ä»å½“å‰ä½ç½®å¼€å§‹åˆ†é¡µè·å–æäº¤è®°å½•</text></g><g stroke-linecap="round" transform="translate(70.88888888888926 119.11111111111086) rotate(0 87 27.5)"><path d="M13.75 0 M13.75 0 C70.27 -1.27, 132.16 -5.78, 160.25 0 M13.75 0 C49.11 3.38, 82.62 0.94, 160.25 0 M160.25 0 C172.31 1.56, 177.77 6.12, 174 13.75 M160.25 0 C168.65 -3.27, 170.67 1.79, 174 13.75 M174 13.75 C170.69 27.99, 173.48 37.63, 174 41.25 M174 13.75 C175.49 23.48, 174.56 32.65, 174 41.25 M174 41.25 C174.25 47.02, 166.12 58.98, 160.25 55 M174 41.25 C170.43 49.95, 167.66 57.46, 160.25 55 M160.25 55 C108.89 54.23, 59.37 55.65, 13.75 55 M160.25 55 C126.86 53.71, 92.28 51.97, 13.75 55 M13.75 55 C4.11 55.89, 2.76 49.69, 0 41.25 M13.75 55 C6.49 52.89, 4.47 54.92, 0 41.25 M0 41.25 C-2.82 31.53, 2.41 23.49, 0 13.75 M0 41.25 C-0.4 35.03, -0.56 28.24, 0 13.75 M0 13.75 C-2.36 7.79, 4.22 1.59, 13.75 0 M0 13.75 C3.15 8.94, 5.15 2.29, 13.75 0" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(101.38888888888926 137.11111111111086) rotate(0 56.5 9.5)"><text x="56.5" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">è·å–æ‰€æœ‰ tags</text></g><g stroke-linecap="round"><g transform="translate(150.88997153960383 67.18500722316435) rotate(0 -2.375925603429664 26.98165787361677)"><path d="M-1.36 1.74 C-3.05 10.23, -6.88 42.36, -7.85 50.27 M3.1 0.21 C2.04 9.22, -2.05 45.19, -2.81 53.75" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(150.88997153960383 67.18500722316435) rotate(0 -2.375925603429664 26.98165787361677)"><path d="M-6.52 25.54 C-7.15 35.91, -6.31 49.69, -6.21 57.11 M-9.03 28.39 C-6.66 37.72, -6.6 43.18, -3.49 52.44" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(150.88997153960383 67.18500722316435) rotate(0 -2.375925603429664 26.98165787361677)"><path d="M10.78 27.32 C3.54 36.85, -2.23 49.95, -6.21 57.11 M8.26 30.18 C5.44 38.84, 0.29 43.76, -3.49 52.44" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask/><g stroke-linecap="round" transform="translate(76.88888888888852 359.55555555555543) rotate(0 81.00000000000003 26)"><path d="M13 0 M13 0 C48.15 0.59, 83.48 -1.4, 149 0 M13 0 C65.81 -1.5, 120.05 -1.13, 149 0 M149 0 C156.96 3.43, 160.63 2.94, 162 13 M149 0 C155.72 3.81, 163.79 6.52, 162 13 M162 13 C164.97 21.93, 165.32 33.71, 162 39 M162 13 C164.16 18.66, 162.04 22.96, 162 39 M162 39 C165.01 45.04, 159.76 50.22, 149 52 M162 39 C158.91 43.92, 155.83 52.56, 149 52 M149 52 C114.38 51.99, 76.13 50.26, 13 52 M149 52 C111.19 51.86, 73.18 49.38, 13 52 M13 52 C7.36 54.09, 3.81 48.54, 0 39 M13 52 C8.37 50.93, 2.61 49.39, 0 39 M0 39 C-1.37 29.54, -3.76 16.5, 0 13 M0 39 C-1.16 33.31, -0.27 25.99, 0 13 M0 13 C1.34 5.4, 4.26 0.12, 13 0 M0 13 C2.13 1.13, 6.08 -3.88, 13 0" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(108.88888888888857 376.05555555555543) rotate(0 49 9.5)"><text x="49" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">å¾ªç¯è¯»å–è®°å½•</text></g><g stroke-linecap="round"><g transform="translate(153.3959809829115 291.96031746031736) rotate(0 -0.3315164564070301 34.81390687762939)"><path d="M-1.1 1.87 C-1.35 13.84, -1.54 58.15, -1.67 69.21 M3.5 0.42 C2.86 11.92, -2.91 55.14, -4.16 65.69" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(153.3959809829115 291.96031746031736) rotate(0 -0.3315164564070301 34.81390687762939)"><path d="M-8.15 35.78 C-5.5 44.13, -4.91 50.69, -0.7 68.1 M-12.33 36.4 C-8.54 41.49, -7.37 47.65, -4.34 66.81" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(153.3959809829115 291.96031746031736) rotate(0 -0.3315164564070301 34.81390687762939)"><path d="M12.21 38.34 C8.95 45.78, 3.58 51.59, -0.7 68.1 M8.04 38.96 C7.36 43.64, 4.02 49.23, -4.34 66.81" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask/><g stroke-linecap="round" transform="translate(44.6666666666664 485.7777777777778) rotate(0 115.5 39)"><path d="M145 10 M145 10 C162.03 19.72, 175.77 22.64, 202 30 M145 10 C159.69 16.01, 180.29 22.75, 202 30 M202 30 C229.68 38.79, 234.91 36.37, 202 50 M202 30 C234.35 42.28, 233.99 37.91, 202 50 M202 50 C192.22 56.54, 175.36 56.51, 145 68 M202 50 C188.07 54.67, 172.39 58.19, 145 68 M145 68 C115.61 78.88, 117.97 79.22, 87 68 M145 68 C113.83 80.47, 118.56 74.15, 87 68 M87 68 C71.29 61.04, 60.56 59.32, 29 50 M87 68 C74.64 64.74, 64.44 62.94, 29 50 M29 50 C-3.74 39.97, -2.56 38.48, 29 30 M29 50 C-0.37 39.37, 0.33 35.89, 29 30 M29 30 C50.44 21.61, 67.95 19.5, 87 10 M29 30 C39.74 28.07, 53.86 23.06, 87 10 M87 10 C117.55 -3.73, 116.15 -0.35, 145 10 M87 10 C117.11 0.05, 111.75 1.9, 145 10" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(103.6666666666664 515.2777777777778) rotate(0 56.5 9.5)"><text x="56.5" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">æ˜¯å¦æ˜¯ tag å¤„</text></g><g stroke-linecap="round"><g transform="translate(149.86229137715839 412.9312169312168) rotate(0 4.208753635864298 44.00826718116923)"><path d="M1.74 2.04 C2.05 16.64, 3.37 73.22, 4.27 87.33 M-0.76 0.69 C0.16 14.55, 8.15 69.98, 9.18 83.55" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(149.86229137715839 412.9312169312168) rotate(0 4.208753635864298 44.00826718116923)"><path d="M-1.29 52.77 C4.13 67.04, 8.41 74.67, 7.63 79.71 M-2.42 55.64 C-2.41 61.14, 1.58 70.44, 9.2 82.95" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(149.86229137715839 412.9312169312168) rotate(0 4.208753635864298 44.00826718116923)"><path d="M19.1 50.44 C16.66 65.86, 13.09 74.39, 7.63 79.71 M17.97 53.31 C13.25 59.65, 12.55 69.49, 9.2 82.95" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask/><g mask="url(#mask-lviM0Dprq1R14gecoqO6G)" stroke-linecap="round"><g transform="translate(166.8423381162429 563.3610819644362) rotate(0 -0.029376666403038598 53.384134448982536)"><path d="M0.06 2.21 C0.81 19.68, 2.3 86.2, 3.29 102.65 M-3.35 0.94 C-2.86 19.01, -0.44 88.88, 1.06 105.83" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(166.8423381162429 563.3610819644362) rotate(0 -0.029376666403038598 53.384134448982536)"><path d="M-7.63 78.3 C-9.36 89.25, -8.79 91.6, -1.31 103.66 M-12.18 79.05 C-6.4 85.8, -5.97 92.15, -0.21 106.83" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(166.8423381162429 563.3610819644362) rotate(0 -0.029376666403038598 53.384134448982536)"><path d="M12.86 77.13 C5.84 88.39, 1.15 91.04, -1.31 103.66 M8.31 77.88 C9.45 84.56, 5.22 91.18, -0.21 106.83" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask id="mask-lviM0Dprq1R14gecoqO6G"><rect x="0" y="0" fill="#fff" width="270.10521586848984" height="766.8482905982908"/><rect x="159.47377699236642" y="605.6046862813637" fill="#000" width="18" height="19" opacity="1"/></mask><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(159.47377699236642 605.6046862813635) rotate(0 7.339184457473436 11.140530132055233)"><text x="9" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">æ˜¯</text></g><g mask="url(#mask-dn1DNiDydmoukLwp9itsL)" stroke-linecap="round"><g transform="translate(272.9215136092465 524.3635848425745) rotate(0 93.08055415379027 2.589871462680776)"><path d="M-2.42 0.27 C29.3 1.24, 156.92 6.29, 188.59 7.23 M1.45 -2.05 C33.19 -1.97, 156.82 2.91, 187.66 3.39" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(272.9215136092465 524.3635848425745) rotate(0 93.08055415379027 2.589871462680776)"><path d="M159.57 16.3 C168.89 13.09, 173.73 7.2, 190.18 3.32 M157.45 12.33 C169.03 10.09, 179.3 6.48, 188.03 3.06" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(272.9215136092465 524.3635848425745) rotate(0 93.08055415379027 2.589871462680776)"><path d="M160.16 -4.22 C169.55 -2.58, 174.25 -3.64, 190.18 3.32 M158.04 -8.18 C169.25 -2.93, 179.3 0.95, 188.03 3.06" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask id="mask-dn1DNiDydmoukLwp9itsL"><rect x="0" y="0" fill="#fff" width="559.084892031994" height="629.4457914278037"/><rect x="357.0032028206201" y="517.4046881351887" fill="#000" width="18" height="19" opacity="1"/></mask><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(357.00320282062034 517.4046881351892) rotate(0 8.99886494241656 9.548768170066296)"><text x="9" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">å¦</text></g><g stroke-linecap="round" transform="translate(409.9999999999998 321.33333333333326) rotate(0 111.50000000000006 54.5)"><path d="M140 13.75 M140 13.75 C157.74 27.59, 177.39 33.69, 195 41.25 M140 13.75 C155.68 22.1, 172.88 29.02, 195 41.25 M195 41.25 C223.92 57.76, 223.16 52.04, 195 68.75 M195 41.25 C221.74 55.91, 221.28 54.16, 195 68.75 M195 68.75 C174.48 77.98, 156.9 89.76, 140 95.25 M195 68.75 C176.24 79.02, 157.82 86.35, 140 95.25 M140 95.25 C115.54 111.32, 113.06 111.06, 84 95.25 M140 95.25 C110.54 112.93, 109.07 112.88, 84 95.25 M84 95.25 C72.36 88.5, 55.7 82.61, 28 68.75 M84 95.25 C71.99 87.21, 57.91 82.69, 28 68.75 M28 68.75 C-3.55 52.86, 2.53 52.47, 28 41.25 M28 68.75 C-1.04 54.5, -3.77 51.3, 28 41.25 M28 41.25 C47.04 32.45, 64.14 19.94, 84 13.75 M28 41.25 C41.45 36.17, 49.87 29.58, 84 13.75 M84 13.75 C115.99 -3.48, 108.31 3.81, 140 13.75 M84 13.75 C114.89 2.11, 113.09 -1.44, 140 13.75" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(440.4999999999998 366.33333333333326) rotate(0 81.00000000000006 9.5)"><text x="81" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">æ­¤é¡µè®°å½•æ˜¯å¦å¾ªç¯å®Œæˆ</text></g><g mask="url(#mask-xcMQVAjcvj1r3ryoOnPyv)" stroke-linecap="round"><g stroke-opacity="0.8" fill-opacity="0.8" transform="translate(520.0171788653535 317.97819876515473) rotate(0 1.0365626996742208 -65.70638529036205)"><path d="M-0.93 1.37 C-0.81 -8.92, 2.85 -38.98, 2.72 -60.51 C2.59 -82.04, -1.62 -116.07, -1.71 -127.79 M3.76 -0.35 C3.35 -10.26, 0.6 -34.72, 0.61 -56.79 C0.61 -78.86, 3.29 -120.7, 3.78 -132.79" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.8" fill-opacity="0.8" transform="translate(520.0171788653535 317.97819876515473) rotate(0 1.0365626996742208 -65.70638529036205)"><path d="M14.55 -103.79 C9.29 -118.36, 7.19 -123.42, 0.85 -131.58 M12.36 -105.03 C12.28 -112.11, 9.44 -115.41, 5.29 -131.94" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.8" fill-opacity="0.8" transform="translate(520.0171788653535 317.97819876515473) rotate(0 1.0365626996742208 -65.70638529036205)"><path d="M-5.95 -104.84 C-3.57 -118.88, 1.95 -123.56, 0.85 -131.58 M-8.13 -106.09 C-3.76 -112.82, -2.15 -115.89, 5.29 -131.94" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask id="mask-xcMQVAjcvj1r3ryoOnPyv"><rect x="0" y="0" fill="#fff" width="622.5158286778401" height="546.75576390573"/><rect x="513.5158286778401" y="247.80329352153376" fill="#000" width="18" height="19" opacity="1"/></mask><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(513.51582867784 247.80329352153376) rotate(0 7.537912887187588 4.4685199532589195)"><text x="9" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">æ˜¯</text></g><g stroke-opacity="0.9" fill-opacity="0.9" stroke-linecap="round" transform="translate(56.5555555555552 673.4444444444446) rotate(0 113.5 24.5)"><path d="M12.25 0 M12.25 0 C80.56 1.92, 153.89 -1.93, 214.75 0 M12.25 0 C53.14 1.75, 95.9 2.73, 214.75 0 M214.75 0 C223.7 3.04, 227.3 7.2, 227 12.25 M214.75 0 C219.49 -0.15, 223.59 0.92, 227 12.25 M227 12.25 C223.82 18.43, 225.57 28.52, 227 36.75 M227 12.25 C226.67 21.57, 227.76 28.71, 227 36.75 M227 36.75 C226.75 46.38, 220.69 52.67, 214.75 49 M227 36.75 C227.84 48.84, 227.08 50.17, 214.75 49 M214.75 49 C163.88 47.29, 109.37 51.41, 12.25 49 M214.75 49 C166.16 52.94, 117.26 51.83, 12.25 49 M12.25 49 C7.93 47.41, -3.81 48.45, 0 36.75 M12.25 49 C1.79 52.1, -0.76 40.84, 0 36.75 M0 36.75 C-2.28 29.8, -1.8 17.06, 0 12.25 M0 36.75 C0.07 32.46, -0.16 24.17, 0 12.25 M0 12.25 C2.11 5.72, 6.43 3.54, 12.25 0 M0 12.25 C-3.71 2.03, 0.2 2.71, 12.25 0" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(73.5555555555552 688.4444444444439) rotate(0 96.5 9.500000000000114)"><text x="96.5" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">å¤„ç†ä¸¤ä¸ª tag é—´æäº¤è®°å½•</text></g><g stroke-opacity="0.9" fill-opacity="0.9" stroke-linecap="round" transform="translate(461.33333333333326 496.8888888888887) rotate(0 77.00000000000006 27)"><path d="M13.5 0 M13.5 0 C52.54 4.63, 87.08 -1.09, 140.5 0 M13.5 0 C54.78 -0.19, 94.59 -1.46, 140.5 0 M140.5 0 C151.16 2.05, 156.62 7.43, 154 13.5 M140.5 0 C148.78 -4.53, 156.9 4.74, 154 13.5 M154 13.5 C153.67 23.76, 154.01 32.17, 154 40.5 M154 13.5 C153.69 20.03, 155.09 29.48, 154 40.5 M154 40.5 C151.9 48.31, 152.42 55.48, 140.5 54 M154 40.5 C158.58 47.05, 149.9 53.28, 140.5 54 M140.5 54 C92.73 56.56, 44.57 55.85, 13.5 54 M140.5 54 C99.1 54.72, 59.62 55.8, 13.5 54 M13.5 54 C3.64 51.47, 3.88 52.76, 0 40.5 M13.5 54 C3.28 52.41, 2.77 48.88, 0 40.5 M0 40.5 C-3.41 27.56, 0.43 19.97, 0 13.5 M0 40.5 C-1.74 30.09, -0.98 21.58, 0 13.5 M0 13.5 C1.34 3.46, 1.46 -3.49, 13.5 0 M0 13.5 C3.03 0.45, 6.07 3.66, 13.5 0" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(489.33333333333326 514.3888888888887) rotate(0 49 9.5)"><text x="49" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">å­˜å‚¨è¿™æ¡è®°å½•</text></g><g stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(526.9611864061793 495.7777777777774) rotate(0 -1.730755265804703 -32.76731269019899)"><path d="M-0.27 -1.78 C0.12 -13.72, 0 -58.07, 0.41 -68.95 M-3.87 3.42 C-3.72 -6.97, -2.95 -54.93, -2.15 -66.12" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(526.9611864061793 495.7777777777774) rotate(0 -1.730755265804703 -32.76731269019899)"><path d="M4.46 -38.39 C2.26 -42.51, 2.85 -47.14, -2.9 -66.91 M5.96 -39.49 C3.91 -47.53, 2.07 -55.37, -2.97 -67.2" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(526.9611864061793 495.7777777777774) rotate(0 -1.730755265804703 -32.76731269019899)"><path d="M-16.05 -39.19 C-13.51 -43.08, -8.2 -47.53, -2.9 -66.91 M-14.55 -40.29 C-9.93 -47.81, -5.1 -55.39, -2.97 -67.2" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask/><g stroke-linecap="round" transform="translate(54.3888888888884 232.99999999999932) rotate(0 98.49999999999997 28.5)"><path d="M14.25 0 M14.25 0 C78.38 -3.38, 134.75 -2.41, 182.75 0 M14.25 0 C64.81 3.59, 113.9 1.23, 182.75 0 M182.75 0 C195.67 0.21, 196.9 6.13, 197 14.25 M182.75 0 C188.16 -3.7, 200.62 2.08, 197 14.25 M197 14.25 C196.7 21.46, 196.24 27.54, 197 42.75 M197 14.25 C197.4 24.64, 198.76 34.94, 197 42.75 M197 42.75 C195.52 51.97, 194.74 61, 182.75 57 M197 42.75 C198.44 53.95, 194.09 52.48, 182.75 57 M182.75 57 C141.09 58.76, 94.28 58.09, 14.25 57 M182.75 57 C116.66 53.79, 53.06 54.36, 14.25 57 M14.25 57 C2.51 55.22, 0.37 55.7, 0 42.75 M14.25 57 C7.7 60.72, -2.38 49.94, 0 42.75 M0 42.75 C1.61 35.14, 2.81 28.04, 0 14.25 M0 42.75 C2.18 33.07, -1.43 23.87, 0 14.25 M0 14.25 C3.61 2.93, 4.27 -2.51, 14.25 0 M0 14.25 C1.43 6.72, 3.94 -0.41, 14.25 0" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g transform="translate(87.88888888888835 251.99999999999932) rotate(0 65 9.5)"><text x="65" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">å¾ªç¯å½“é¡µæäº¤è®°å½•</text></g><g stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(154.8206469186399 177.6770234674325) rotate(0 0.3185349686685299 26.076701043304183)"><path d="M-0.13 -0.37 C0.98 8.05, 3.6 42.58, 4.29 51.5 M-3.65 -3.04 C-2.45 5.79, 2.27 46.6, 3.46 55.2" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(154.8206469186399 177.6770234674325) rotate(0 0.3185349686685299 26.076701043304183)"><path d="M-8.78 36.03 C-5.42 40.54, -0.57 38.94, -0.26 51.91 M-8.41 33.47 C-5.2 39.99, -0.84 45.72, 4.37 56.78" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(154.8206469186399 177.6770234674325) rotate(0 0.3185349686685299 26.076701043304183)"><path d="M8.66 33.86 C8.31 38.81, 9.42 37.68, -0.26 51.91 M9.04 31.3 C6.57 38.21, 5.28 44.64, 4.37 56.78" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask/><g mask="url(#mask-B-XvH6s17K3nnXY-_28km)" stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(412.44444444444423 375.7777777777774) rotate(0 -83.27295419193706 3.372453728701089)"><path d="M-2.06 1.1 C-29.78 1.95, -138.77 6.19, -166.13 7.52 M2.02 -0.78 C-26.13 0.44, -140.18 2.16, -168.57 3.13" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(412.44444444444423 375.7777777777774) rotate(0 -83.27295419193706 3.372453728701089)"><path d="M-139.06 -8.31 C-147.4 -5.49, -153.74 1.12, -171.09 3.37 M-140.15 -7.35 C-151.03 -3.83, -162.8 1.33, -169.1 2.37" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(412.44444444444423 375.7777777777774) rotate(0 -83.27295419193706 3.372453728701089)"><path d="M-138.58 12.2 C-147.42 8.7, -153.9 9.01, -171.09 3.37 M-139.67 13.17 C-150.65 8.7, -162.6 5.87, -169.1 2.37" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask id="mask-B-XvH6s17K3nnXY-_28km"><rect x="0" y="0" fill="#fff" width="678.2125603864733" height="482.1529406001787"/><rect x="320.56038647342984" y="369.465359188978" fill="#000" width="18" height="19" opacity="1"/></mask><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(320.56038647342973 369.465359188978) rotate(0 8.611103779077439 9.684872317500435)"><text x="9" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">å¦</text></g><g stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(169.11111111111074 386.88888888888846) rotate(0 0.1255754212662623 0.5311599435285643)"><path d="M-1.94 -2.01 C-1.84 -1.87, 1.06 2.74, 0.96 2.71 M2.2 3.07 C1.98 2.33, -0.87 -0.27, -0.76 -0.83" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(169.11111111111074 386.88888888888846) rotate(0 0.1255754212662623 0.5311599435285643)"><path d="M-0.76 -0.83 C-0.76 -0.83, -0.76 -0.83, -0.76 -0.83 M-0.76 -0.83 C-0.76 -0.83, -0.76 -0.83, -0.76 -0.83" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(169.11111111111074 386.88888888888846) rotate(0 0.1255754212662623 0.5311599435285643)"><path d="M-0.76 -0.83 C-0.76 -0.83, -0.76 -0.83, -0.76 -0.83 M-0.76 -0.83 C-0.76 -0.83, -0.76 -0.83, -0.76 -0.83" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask/><g stroke-opacity="0.9" fill-opacity="0.9" stroke-linecap="round" transform="translate(420.11111111111074 99.3333333333328) rotate(0 94.5 46)"><path d="M118.75 11.75 M118.75 11.75 C135.03 21.3, 149.19 30.6, 165.25 35.25 M118.75 11.75 C134.18 19.84, 152.05 28.4, 165.25 35.25 M165.25 35.25 C187.48 45.81, 185.7 50.8, 165.25 58.75 M165.25 35.25 C190 47.22, 186.22 49.04, 165.25 58.75 M165.25 58.75 C151.54 67.12, 132.58 74.51, 118.75 80.25 M165.25 58.75 C154.75 64.96, 145.4 68.12, 118.75 80.25 M118.75 80.25 C94.28 92.54, 93.31 91.04, 71.25 80.25 M118.75 80.25 C92.74 93.24, 95.8 87.97, 71.25 80.25 M71.25 80.25 C57.4 74.18, 42.08 68.79, 23.75 58.75 M71.25 80.25 C59.29 75.01, 48.22 72.31, 23.75 58.75 M23.75 58.75 C0.68 45.28, 0.96 49.41, 23.75 35.25 M23.75 58.75 C-4.55 48.6, -0.31 50.72, 23.75 35.25 M23.75 35.25 C39.63 30.01, 56.54 22.76, 71.25 11.75 M23.75 35.25 C36.36 27.73, 51.16 22.03, 71.25 11.75 M71.25 11.75 C91.68 2.98, 95.92 -3.26, 118.75 11.75 M71.25 11.75 C95.13 -0.89, 98.93 3.17, 118.75 11.75" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(465.61111111111074 135.8333333333328) rotate(0 49 9.5)"><text x="49" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">æ˜¯å¦è¿˜æœ‰ä¸‹é¡µ</text></g><g mask="url(#mask-AIvfQd-vju-X_S_dSBPaU)" stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(516.8888888888886 100.22222222222172) rotate(0 -110.21043321811385 -31.322581191467634)"><path d="M1.95 1.23 C-0.98 -8.31, 20.56 -46.86, -17.4 -57.53 C-55.37 -68.2, -191.2 -61.99, -225.85 -62.8 M-0.44 -0.57 C-3.62 -9.58, 17.79 -43.72, -18.83 -53.77 C-55.45 -63.82, -185.69 -59.69, -220.13 -60.85" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(516.8888888888886 100.22222222222172) rotate(0 -110.21043321811385 -31.322581191467634)"><path d="M-190.16 -68.91 C-200.21 -70.48, -212.25 -66.55, -222.62 -59.3 M-191.22 -72.17 C-201.37 -66.88, -209.77 -66.92, -220.04 -62.38" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(516.8888888888886 100.22222222222172) rotate(0 -110.21043321811385 -31.322581191467634)"><path d="M-190.22 -48.39 C-200.21 -56.23, -212.23 -58.58, -222.62 -59.3 M-191.28 -51.65 C-201.7 -52.2, -210.09 -58.07, -220.04 -62.38" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask id="mask-AIvfQd-vju-X_S_dSBPaU"><rect x="0" y="0" fill="#fff" width="840.670309653916" height="260.8790323125929"/><rect x="488.99999999999955" y="32.944444444444116" fill="#000" width="18" height="19" opacity="1"/></mask><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(488.9999999999998 32.944444444444116) rotate(0 -82.32154432922493 35.95519658630997)"><text x="9" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">æ˜¯</text></g><g mask="url(#mask-CU9fllVOFQ9hv_BUEtdnP)" stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(709.111111111111 149.11111111111086) rotate(0 -203.9724014016603 284.3480313714674)"><path d="M1.47 1.85 C-4.03 88.31, 40.45 427.87, -29.35 519.32 C-99.15 610.77, -352.88 545.12, -417.34 550.53 M5.34 0.38 C-0.48 86.08, 39.39 423.61, -31.38 515.78 C-102.15 607.95, -355.35 546.88, -419.3 553.39" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(709.111111111111 149.11111111111086) rotate(0 -203.9724014016603 284.3480313714674)"><path d="M-387.86 545.53 C-394.94 546.53, -407.83 550.69, -418.15 553.4 M-390.49 546.44 C-396.9 545.93, -404.31 547.57, -418.86 552.24" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(709.111111111111 149.11111111111086) rotate(0 -203.9724014016603 284.3480313714674)"><path d="M-389.19 566.01 C-395.97 561.09, -408.47 559.31, -418.15 553.4 M-391.83 566.92 C-398.26 561.38, -405.35 557.96, -418.86 552.24" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask id="mask-CU9fllVOFQ9hv_BUEtdnP"><rect x="0" y="0" fill="#fff" width="1230.1111111111109" height="800.1111111111109"/><rect x="670.3788246397446" y="656.2208126174994" fill="#000" width="18" height="19" opacity="1"/></mask><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(670.3788246397444 656.2208126174996) rotate(0 -165.24011493029383 -222.76167013492136)"><text x="9" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">å¦</text></g><g stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(602.4444444444442 144.6666666666663) rotate(0 53.916350204956984 1.7562233025888645)"><path d="M-1.22 -0.92 C16.39 -0.04, 86.37 6.44, 104.07 7.41 M3.31 -3.89 C21.9 -4.1, 91.13 0.98, 109.06 2.8" stroke="#c92a2a" stroke-width="1" fill="none"/></g></g><mask/><g stroke-opacity="0.9" fill-opacity="0.9" stroke-linecap="round" transform="translate(54.666666666666515 787.9999999999993) rotate(0 107 27.5)"><path d="M13.75 0 M13.75 0 C87.52 5.11, 154.72 3.57, 200.25 0 M13.75 0 C69.94 -1.17, 120.39 -0.6, 200.25 0 M200.25 0 C207.03 2.66, 217.32 4.98, 214 13.75 M200.25 0 C206.48 -0.5, 217.78 5.61, 214 13.75 M214 13.75 C214.97 21.16, 215.94 34.85, 214 41.25 M214 13.75 C213.24 21.11, 214.99 24.12, 214 41.25 M214 41.25 C216.9 51.08, 208.54 54.2, 200.25 55 M214 41.25 C210.64 51.13, 211.66 58.98, 200.25 55 M200.25 55 C158.88 49.84, 117.18 48.88, 13.75 55 M200.25 55 C160.04 55.32, 124.45 55.88, 13.75 55 M13.75 55 C8.02 51.2, 2.47 48.84, 0 41.25 M13.75 55 C0.75 54.33, 1.13 47.7, 0 41.25 M0 41.25 C3.44 35.46, 4.34 28.78, 0 13.75 M0 41.25 C0.1 31.79, -0.96 26.01, 0 13.75 M0 13.75 C0.83 6.06, 2.07 -2.08, 13.75 0 M0 13.75 C1.75 7.83, 1.69 -3.8, 13.75 0" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(66.66666666666652 805.9999999999993) rotate(0 95 9.5)"><text x="95" y="15" font-family="Cascadia, Segoe UI Emoji" font-size="16px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">æ ¹æ®è§„åˆ™ï¼Œå°†è®°å½•ç”Ÿæˆ MD</text></g><g stroke-linecap="round"><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(165.71746592082616 725.503082527672) rotate(0 -0.7108549617225322 28.413311323170547)"><path d="M0.43 1.36 C0.75 10.84, 1.42 45.89, 1.35 54.82 M-2.78 -0.36 C-2.56 9.57, 0.17 47.65, 0.43 57.19" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(165.71746592082616 725.503082527672) rotate(0 -0.7108549617225322 28.413311323170547)"><path d="M-8.78 34.34 C-11.31 39.76, -7.97 44.68, -1.84 55.08 M-10.46 29.37 C-8.94 38.42, -5.93 44.32, -1.48 58.42" stroke="#c92a2a" stroke-width="1" fill="none"/></g><g stroke-opacity="0.9" fill-opacity="0.9" transform="translate(165.71746592082616 725.503082527672) rotate(0 -0.7108549617225322 28.413311323170547)"><path d="M10.74 33.32 C2.73 39.09, 0.6 44.29, -1.84 55.08 M9.06 28.35 C6.28 37.32, 5.01 43.44, -1.48 58.42" stroke="#c92a2a" stroke-width="1" fill="none"/></g>
  </g>
  <mask/>
</svg>

<p>ç¼–å†™å®Œè‡ªå®šä¹‰ Actions åï¼Œä½¿ç”¨è‡ªå®šä¹‰ Actionsã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">steps:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Release</span></span><br><span class="line">    <span class="attr">uses:</span> <span class="string">MaLuns/add-release@æŒ‡å®šç‰ˆæœ¬</span></span><br><span class="line">    <span class="attr">with:</span></span><br><span class="line">      <span class="attr">files:</span> <span class="string">Demo.zip</span></span><br><span class="line">      <span class="attr">generate_by_commit:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>æ•ˆæœå›¾ï¼š</p>
<p><img src="https://github.com/MaLuns/add-release/blob/master/demo/demo.png?raw=true" alt="æ•ˆæœå›¾" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<p>åˆ°æ­¤ï¼Œä¸€ä¸ªæ ¹æ® Git tag è‡ªåŠ¨å‘å¸ƒ Npm å’Œ Release çš„å·¥ä½œæµç¼–å†™å®Œæˆäº†ã€‚ä½ è¿˜å¯ä»¥åœ¨ç»“åˆ Github Pagesã€Vercel ç­‰åŒæ—¶è‡ªåŠ¨åŒ–éƒ¨ç½²ä½ çš„ Npm åŒ…çš„æ–‡æ¡£å’Œç¤ºä¾‹ç«™ç‚¹ç­‰ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>npm</tag>
      </tags>
  </entry>
  <entry>
    <title>one-wallhaven å£çº¸ç¨‹åº</title>
    <url>/one_wallhaven/</url>
    <content><![CDATA[<p>åŸºäº Electron + vue  çš„ä¸€ä¸ªå£çº¸ç¨‹åº</p>
<span id="more"></span>

<ul>
<li>giteeï¼š<a href="https://gitee.com/ml13/wallhaven-electron">https://gitee.com/ml13/wallhaven-electron</a></li>
<li>githubï¼š<a href="https://github.com/MaLuns/wallhaven-electron">https://github.com/MaLuns/wallhaven-electron</a></li>
</ul>
<h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># å®‰è£…ä¾èµ–</span><br><span class="line">yarn</span><br><span class="line"></span><br><span class="line"># è¿è¡Œå¼€å‘æ¨¡å¼</span><br><span class="line">npm run serve:web</span><br><span class="line">npm run serve:exe</span><br><span class="line"></span><br><span class="line"># æ‰“åŒ…å®‰è£…æ–‡ä»¶ </span><br><span class="line">npm run build:web</span><br><span class="line">npm run build:exe</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- build æ‰“åŒ…å›¾æ ‡</span><br><span class="line">- layout å‰ç«¯æ–‡ä»¶</span><br><span class="line">  - public</span><br><span class="line">  - src</span><br><span class="line">- src</span><br><span class="line">  - main ä¸»çº¿ç¨‹ç›®å½•</span><br><span class="line">  - renderer æ¸²æŸ“çº¿ç¨‹ï¼ˆå‰ç«¯æ‰“åŒ…è¾“å‡ºç›®å½•ï¼‰</span><br></pre></td></tr></table></figure>
<h2 id="æˆªå›¾"><a href="#æˆªå›¾" class="headerlink" title="æˆªå›¾"></a>æˆªå›¾</h2><img src="https://pan.bilnn.com/api/v3/file/sourcejump/Xm9Gtd/MwMX00DchbCDz3Wb_hv3ew**" alt="é¦–é¡µ"  loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'/>
<img src="https://pan.bilnn.com/api/v3/file/sourcejump/K59mHQ/xWd46Fcu7xNtcDpTQjNmcA**" alt="åˆ†ç±»"  loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'/>
<img src="https://pan.bilnn.com/api/v3/file/sourcejump/YdZXiv/kkjnhlZeH2P0XOPHaMgUYA**" alt="æ”¶è—"  loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'/>
<img src="https://pan.bilnn.com/api/v3/file/sourcejump/B3P4U2/o8_yKHJCTDywb0bQ-VJinQ**" alt="æŸ¥çœ‹"  loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'/>
<img src="https://pan.bilnn.com/api/v3/file/sourcejump/Q29QFb/t-QYGpR2JC92tlyrSCAZRQ**" alt="ä¸‹è½½"  loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'/>]]></content>
      <categories>
        <category>åˆ›ä½œç±»</category>
      </categories>
      <tags>
        <tag>electron</tag>
      </tags>
  </entry>
  <entry>
    <title>Pjax ä¸‹åŠ¨æ€åŠ è½½æ’ä»¶æ–¹æ¡ˆ</title>
    <url>/pjax_dynamic_plugins/</url>
    <content><![CDATA[<p>åœ¨çº¯é™æ€ç½‘ç«™é‡Œï¼Œæœ‰æ—¶å€™ä¼šåŠ¨æ€æ›´æ–°æŸä¸ªåŒºåŸŸå¾€ä¼šé€‰æ‹© Pjaxï¼ˆswupã€barba.jsï¼‰å»å¤„ç†ï¼Œä»–ä»¬éƒ½æ˜¯ä½¿ç”¨ ajax å’Œ pushState é€šè¿‡çœŸæ­£çš„æ°¸ä¹…é“¾æ¥ï¼Œé¡µé¢æ ‡é¢˜å’Œåé€€æŒ‰é’®æä¾›å¿«é€Ÿæµè§ˆä½“éªŒã€‚</p>
<span id="more"></span>
<p>ä½†æ˜¯å®é™…ä½¿ç”¨ä¸­å¯èƒ½ä¼šé‡åˆ°ä¸åŒé¡µé¢å¯èƒ½ä¼šéœ€è¦åŠ è½½ä¸åŒæ’ä»¶å¤„ç†ï¼Œæœ‰äº›äººå¯èƒ½ä¼šå…¨é‡é€‰æ‹©åŠ è½½ï¼Œè¿™æ ·ä¼šå¯¼è‡´åŠ è½½å¾ˆå¤šæ— ç”¨çš„è„šæœ¬ï¼Œæœ‰å¯èƒ½åœ¨ç”¨æˆ·å…³é—­é¡µé¢æ—¶éƒ½ä¸ä¸€å®šä¼šè®¿é—®åˆ°ï¼Œä¼šå¾ˆæµªè´¹èµ„æºã€‚</p>
<h2 id="è§£å†³æ€è·¯"><a href="#è§£å†³æ€è·¯" class="headerlink" title="è§£å†³æ€è·¯"></a>è§£å†³æ€è·¯</h2><p>é¦–å…ˆæƒ³åˆ°çš„è‚¯å®šæ˜¯åœ¨è¯·æ±‚åˆ°æ–°çš„é¡µé¢åï¼Œæˆ‘ä»¬æ‰‹åŠ¨å»æ¯”è¾ƒå½“å‰ DOM å’Œ æ–° DOM ä¹‹é—´ <code>script</code> æ ‡ç­¾çš„å·®å¼‚ï¼Œæ‰‹åŠ¨ç»™ä»–æ’å…¥åˆ° body é‡Œã€‚</p>
<h3 id="å¤„ç†-Script"><a href="#å¤„ç†-Script" class="headerlink" title="å¤„ç† Script"></a>å¤„ç† Script</h3><p>ä¸€èˆ¬æ¥è¯´ JavaScript è„šæœ¬éƒ½æ˜¯æ”¾åœ¨ <code>body</code> åï¼Œé¿å…é˜»å¡é¡µé¢æ¸²æŸ“ï¼Œå‡è®¾æˆ‘ä»¬é¡µé¢è„šæœ¬ä¹Ÿéƒ½æ˜¯åœ¨ <code>body</code> åï¼Œå¹¶åœ¨ script æ·»åŠ  <code>[data-reload-script]</code> è¡¨æ˜å“ªäº›æ˜¯éœ€è¦åŠ¨æ€åŠ è½½çš„ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬ç›´æ¥è·å–åˆ°å¸¦æœ‰ <code>[data-reload-script]</code> å±æ€§çš„ script æ ‡ç­¾:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// NewHTML ä¸º æ–°é¡µé¢ HTML</span></span><br><span class="line"><span class="keyword">const</span> pageContent = <span class="title class_">NewHTML</span>.<span class="title function_">replace</span>(<span class="string">&#x27;&lt;body&#x27;</span>, <span class="string">&#x27;&lt;div id=&quot;DynamicPluginBody&quot;&#x27;</span>).<span class="title function_">replace</span>(<span class="string">&#x27;&lt;/body&gt;&#x27;</span>, <span class="string">&#x27;&lt;/div&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">let</span> element = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">element.<span class="property">innerHTML</span> = pageContent;</span><br><span class="line"><span class="keyword">const</span> children = element.<span class="title function_">querySelector</span>(<span class="string">&#x27;#DynamicPluginBody&#x27;</span>).<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;script[data-reload-script]&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>ç„¶åé€šè¿‡åˆ›å»º script æ ‡ç­¾æ’å…¥åˆ° <code>body</code>ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">children.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> &#123; name, value &#125; <span class="keyword">of</span> <span class="title function_">arrayify</span>(item.<span class="property">attributes</span>)) &#123;</span><br><span class="line">        element.<span class="title function_">setAttribute</span>(name, value);</span><br><span class="line">    &#125;</span><br><span class="line">    element.<span class="property">textContent</span> = item.<span class="property">textContent</span>;</span><br><span class="line">    element.<span class="title function_">setAttribute</span>(<span class="string">&#x27;async&#x27;</span>, <span class="string">&#x27;false&#x27;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">insertBefore</span>(element)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ çš„æ’ä»¶éƒ½æ˜¯é€šè¿‡ script å¼•å…¥ï¼Œä¸”ä¸éœ€è¦æ‰§è¡Œé¢å¤–çš„ JavaScript ä»£ç ï¼Œåªéœ€è¦åœ¨ Pjax é’©å­å‡½æ•°è¿™æ ·å¤„ç†å°±å¯ä»¥äº†ã€‚</p>
<h4 id="æ‰§è¡Œä»£ç å—"><a href="#æ‰§è¡Œä»£ç å—" class="headerlink" title="æ‰§è¡Œä»£ç å—"></a>æ‰§è¡Œä»£ç å—</h4><p>å®é™…å¾ˆå¤šæ’ä»¶ä¸ä»…ä»…éœ€è¦ä½ å¼•å…¥ï¼Œè¿˜éœ€è¦ä½ æ‰‹åŠ¨å»åˆå§‹åŒ–åšä¸€äº›æ“ä½œçš„ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>src</code> å»åˆ¤æ–­æ˜¯å¼•å…¥çš„è„šæœ¬ï¼Œè¿˜æ˜¯ä»£ç å—ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> scripts = <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="variable language_">document</span>.<span class="property">scripts</span>)</span><br><span class="line"><span class="keyword">let</span> scriptCDN = []</span><br><span class="line"><span class="keyword">let</span> scriptBlock = []</span><br><span class="line"></span><br><span class="line">children.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">src</span>)</span><br><span class="line">        scripts.<span class="title function_">findIndex</span>(<span class="function"><span class="params">s</span> =&gt;</span> s.<span class="property">src</span> === item.<span class="property">src</span>) &lt; <span class="number">0</span> &amp;&amp; scriptCDN.<span class="title function_">push</span>(item);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        scriptBlock.<span class="title function_">push</span>(item.<span class="property">innerText</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>scriptCDN ç»§ç»­é€šè¿‡ä¸Šé¢æ–¹å¼æ’å…¥åˆ° body é‡Œï¼Œç„¶åé€šè¿‡ eval æˆ–è€… new Function å»æ‰§è¡Œ scriptBlock ã€‚å› ä¸º scriptBlock é‡Œçš„ä»£ç å¯èƒ½æ˜¯ä¼šä¾èµ– scriptCDN é‡Œçš„æ’ä»¶çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨ scriptCDN åŠ è½½å®Œæˆååœ¨æ‰§è¡Œ scriptBlock ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">loadScript</span> = (<span class="params">item</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> &#123; name, value &#125; <span class="keyword">of</span> <span class="title function_">arrayify</span>(item.<span class="property">attributes</span>)) &#123;</span><br><span class="line">            element.<span class="title function_">setAttribute</span>(name, value);</span><br><span class="line">        &#125;</span><br><span class="line">        element.<span class="property">textContent</span> = item.<span class="property">textContent</span>;</span><br><span class="line">        element.<span class="title function_">setAttribute</span>(<span class="string">&#x27;async&#x27;</span>, <span class="string">&#x27;false&#x27;</span>);</span><br><span class="line">        element.<span class="property">onload</span> = resolve</span><br><span class="line">        element.<span class="property">onerror</span> = reject</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">insertBefore</span>(element)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">runScriptBlock</span> = (<span class="params">code</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> func = <span class="keyword">new</span> <span class="title class_">Function</span>(code);</span><br><span class="line">        <span class="title function_">func</span>()</span><br><span class="line">    &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="variable language_">window</span>.<span class="built_in">eval</span>(code)</span><br><span class="line">        &#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>(scriptCDN.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> <span class="title function_">loadScript</span>(item))).<span class="title function_">then</span>(<span class="function"><span class="params">_</span> =&gt;</span> &#123;</span><br><span class="line">    scriptBlock.<span class="title function_">forEach</span>(<span class="function"><span class="params">code</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">runScriptBlock</span>(code)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="å¸è½½æ’ä»¶"><a href="#å¸è½½æ’ä»¶" class="headerlink" title="å¸è½½æ’ä»¶"></a>å¸è½½æ’ä»¶</h4><p>æŒ‰ç…§ä¸Šé¢æ€å»å¤„ç†ä¹‹åï¼Œä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ã€‚ æ¯”å¦‚ï¼šæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª å…¨å±€çš„ â€˜resizeâ€™ äº‹ä»¶çš„ç›‘å¬ï¼Œåœ¨è·³è½¬å…¶ä»–é¡µé¢æ—¶å€™æˆ‘ä»¬éœ€è¦ç§»é™¤è¿™ä¸ªç›‘å¬äº‹ä»¶ã€‚</p>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹ä»£ç å—çš„æ ¼å¼è¿›è¡Œä¸€ä¸ªçº¦æŸï¼Œæ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼Œåœ¨åˆæ¬¡åŠ è½½æ—¶æ‰§è¡Œ mount é‡Œä»£ç ï¼Œé¡µé¢å¸è½½æ—¶æ‰§è¡Œ unmount é‡Œä»£ç ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;script data-reload-script&gt;</span><br><span class="line">    <span class="title class_">DynamicPlugin</span>.<span class="title function_">add</span>(&#123;</span><br><span class="line">        <span class="comment">// é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ</span></span><br><span class="line">        <span class="title function_">mount</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;time&#x27;</span>).<span class="property">innerText</span> = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">toString</span>()</span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// é¡µé¢å¸è½½æ—¶æ‰§è¡Œ</span></span><br><span class="line">        <span class="title function_">unmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">window</span>.<span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">timer</span> = <span class="literal">null</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>DynamicPlugin å¤§è‡´ç»“æ„ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> cacheMount = []</span><br><span class="line"><span class="keyword">let</span> cacheUnMount = []</span><br><span class="line"><span class="keyword">let</span> context = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DynamicPlugin</span> &#123;</span><br><span class="line">    <span class="title function_">add</span>(<span class="params">options</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isFunction</span>(options))</span><br><span class="line">            cacheMount.<span class="title function_">push</span>(options)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">isPlainObject</span>(options)) &#123;</span><br><span class="line">            <span class="keyword">let</span> &#123; mount, unmount &#125; = options</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isFunction</span>(mount))</span><br><span class="line">                cacheMount.<span class="title function_">push</span>(mount)</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_">isFunction</span>(unmount))</span><br><span class="line">                cacheUnMount.<span class="title function_">push</span>(unmount)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰§è¡Œå½“å‰é¡µé¢åŠ è½½é’©å­</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">runMount</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">runMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (cacheMount.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> item = cacheMount.<span class="title function_">shift</span>();</span><br><span class="line">            item.<span class="title function_">call</span>(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">runUnMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (cacheUnMount.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="keyword">let</span> item = cacheUnMount.<span class="title function_">shift</span>();</span><br><span class="line">            item.<span class="title function_">call</span>(context);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é¡µé¢å¸è½½æ—¶è°ƒç”¨ DynamicPlugin.runUnMount()ã€‚</p>
<h3 id="å¤„ç†-Head"><a href="#å¤„ç†-Head" class="headerlink" title="å¤„ç† Head"></a>å¤„ç† Head</h3><p>Head éƒ¨åˆ†å¤„ç†æ¥è¯´ç›¸å¯¹æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥é€šè¿‡æ‹¿åˆ°æ–°æ—§ä¸¤ä¸ª Headï¼Œç„¶åå¾ªç¯å¯¹æ¯”æ¯ä¸ªæ ‡ç­¾çš„ <code>outerHTML</code>ï¼Œç”¨æ¥åˆ¤æ–­å“ªäº›æ¯”æ˜¯éœ€è¦æ–°å¢çš„å“ªäº›æ˜¯éœ€è¦åˆ é™¤çš„ã€‚</p>
<h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>æœ¬æ–‡ç¤ºä¾‹ä»£ç å®Œæ•´ç‰ˆæœ¬å¯ä»¥ <a href="https://github.com/MaLuns/dynamic-plugin">å‚è€ƒè¿™é‡Œ</a></p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>Pjax</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»­è´¹åŸŸåäº†</title>
    <url>/renew_domains/</url>
    <content><![CDATA[<p>å…«æœˆä»½çš„æ—¶å€™å°±çœ‹åˆ°åŸŸåè¦æ¶¨ä»·äº†ï¼Œæƒ³ç€ç»­è´¹æ¥è‡ªï¼Œå¿™äº†ä¸€é˜µå¿˜è®°è¿™èŒ¬äº†ã€‚å†æƒ³èµ·äº†å°±ç°åœ¨äº†ï¼Œè¡€äºäº†ä¸€æ³¢ã€‚</p>
<span id="more"></span>
<p><img src="/images/posts/renew_domains/pic_1636458264700.png" alt="åŸŸåç»­è´¹" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>ç›´æ¥ç»­åˆ°äº† 2030 å¹´ï¼Œåˆšç»­è´¹å®Œï¼Œå¿˜è®°è¿˜æœ‰ä»£é‡‘åˆ¸æ²¡ç”¨ï¼ŒğŸ˜­åˆè¡€äºäº†ä¸€æ³¢ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
  </entry>
  <entry>
    <title>äº‘å¼€å‘åˆåˆåˆæ¶¨ä»·äº†</title>
    <url>/txgdx/</url>
    <content><![CDATA[<p>ä¹‹å‰ä¸€æ³¢ææ²¡äº†å…è´¹é¢åº¦ï¼Œè¿™æ¬¡ç›´æ¥è¦å›æ”¶ä»¥å‰å¼€é€šå…è´¹ç‰ˆçš„èµ„æºäº†ã€‚ææˆåŸºç¡€å¥—é¤+æŒ‰é‡è®¡è´¹æ¨¡å¼ï¼Œç›´æ¥æœ€ä½39.9å—ä¸€ä¸ªæœˆã€‚ç”¨ä¸èµ·äº†ï¼Œè…¾è®¯æ˜¯çœŸTMçš„ç‹—ã€‚</p>
<span id="more"></span>
<p><img src="/images/posts/cloudbase_comment_two/pic_1657700995751.png" alt="å…¬å‘Š" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>è¶…å‡ºåŸºç¡€åï¼Œä»·æ ¼æ¯”åŸæ¥ä¹Ÿç¿»äº†å¥½å¤šå€ã€‚<br><img src="/images/posts/cloudbase_comment_two/pic_1657701583297.png" alt="ä»·æ ¼" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>å‡†å¤‡å…³äº†è¯„è®ºæ’ä»¶ï¼Œæ¢å›¾åºŠäº†ï¼Œä¹‹å‰å›¾åºŠç”¨çš„äº‘å­˜å‚¨ï¼Œè¿˜ä¸è®©æ•´ä¸ªæ–‡ä»¶ä¸‹è½½ï¼Œç®€ç›´æ— è¯­å­äº†ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
  </entry>
  <entry>
    <title>uni-app ä½¿ç”¨ä½“éªŒ</title>
    <url>/uniapp/</url>
    <content><![CDATA[<p>ä¸€å¥è¯æ€»ç»“å°±æ˜¯ï¼Œå‘æ˜¯çœŸçš„å¤šï¼Œå¡«å®Œä¸€ä¸ªå‘ç­‰ç€ä½ çš„å°±æ˜¯ä¸‹ä¸ªå‘ã€‚</p>
<span id="more"></span>

<h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>å› ä¸ºæ‰€åœ¨é¡¹ç›®ç»„å±äºç”Ÿæ´»æœåŠ¡ç±»ç›¸å…³çš„ï¼Œéœ€è¦åšç”µå½±ã€è›‹ç³•ã€æ‰“è½¦ã€åŠ æ²¹ã€è½¦ç¥¨ã€é…’åº—ç­‰ä¸€ç³»åˆ—çš„æ¿å—ï¼Œéœ€è¦åµŒå…¥åœ¨å…¶ä»–é¡¹ç›®çš„ app ã€å°ç¨‹åºã€h5 ä¸­ã€‚æˆ‘ä»¬éœ€è¦æä¾› H5 å’Œ å°ç¨‹åºåŒç«¯æœåŠ¡ï¼Œç”±äºæ¯ä¸ªé¡¹ç›®å‘¨æœŸåˆçŸ­ï¼Œä¸ºäº†èŠ‚çœå¼€å‘å‘¨æœŸæ—¶é—´ï¼Œæ‰€ä»¥é€‰äº† uni-app æ¥å¼€å‘ã€‚</p>
<h2 id="åˆè¯†"><a href="#åˆè¯†" class="headerlink" title="åˆè¯†"></a>åˆè¯†</h2><p>uni-app ä½¿ç”¨ä¸Šï¼ŒåŸºæœ¬ä¸Šå’Œæ™®é€š vue å¼€å‘å·®ä¸å¤šï¼Œåªè¦é¿å…ç›´æ¥ä½¿ç”¨ web api å°±å¯ä»¥ï¼Œæ‹ä¸€éæ–‡æ¡£åŸºæœ¬å¯ä»¥ä¸Šæ‰‹äº†ã€‚è¸©å¾—çš„ç¬¬ä¸€ä¸ªå‘æ¥äº†ï¼Œç”±äºæˆ‘å…¥èŒæ—¶ç¬¬ä¸€ä¸ªæ¿å—å·²ç»å¼€å§‹åšäº†ï¼Œé¡¹ç›®ä½¿ç”¨ HBuilderX åˆ›å»ºçš„ã€‚HBuilderX åˆ›å»ºçš„é¡¹ç›®åªèƒ½ä½¿ç”¨ HBuilderX å¯åŠ¨ï¼ŒHBuilderX è¿™ä¸œè¥¿ä¹Ÿä¸å¥½ç”¨ï¼Œåªèƒ½å†å¼€ä¸ª vscode å¼€å‘äº†ï¼Œå¼€å‘é˜¶æ®µä¹Ÿæ²¡è§‰å¾—å•¥ï¼Œæ— éå¤šå¼€å‘ç¼–è¾‘å™¨å¤šå ç‚¹å†…å­˜ã€‚</p>
<p>ç­‰æµ‹è¯•é˜¶æ®µå‚»çœ¼äº†ï¼ŒHBuilderX åˆ›å»ºé¡¹ç›®åªèƒ½å† HBuilderX æ„å»ºå‘å¸ƒï¼Œæ²¡æ³•é›†æˆåˆ°ç°æœ‰ CI&#x2F;CD ä¸Šå»ï¼Œå† HBuilderX æ‰“åŒ…å°±æ‰“åŒ…å§ï¼Œè¿™ç©æ„è¿˜å¼ºåˆ¶ç™»é™†ï¼Œä¸€ä¸ªç¼–è¾‘å™¨ä¸ç™»é™†è¿˜ä¸è®©æ‰“åŒ…ã€‚æœç´¢äº†ä¸€ä¸‹ï¼Œè¿˜æ˜¯æœ‰æ–¹æ³•å°† HBuilderX åˆ›å»ºé¡¹ç›®è½¬æ¢æˆ cli å½¢å¼çš„ï¼Œä¸è¿‡ç”±äºé¡¹ç›®æ¨¡å—å¯¼å…¥æ–¹å¼æ··ç”¨ï¼Œæ— æ³•æ— ç—›åˆ‡æ¢è¿‡å»ï¼Œé¡¹ç›®ä¹Ÿå¿«ä¸Šçº¿ï¼Œäºæ˜¯å°±æ²¡æœ‰å»æŠ˜è…¾äº†ï¼Œåœ¨ä¸‹ä¸€ä¸ªé¡¹ç›®å»åˆ‡æ¢åˆ° cli æ–¹å¼ã€‚</p>
<h2 id="ç”Ÿæ€"><a href="#ç”Ÿæ€" class="headerlink" title="ç”Ÿæ€"></a>ç”Ÿæ€</h2><p>uni-app æœ‰è‡ªå·±æ’ä»¶å¸‚åœºï¼Œæœ‰å¾ˆå¤šç°æˆçš„æ’ä»¶å¯ä»¥ç”¨ã€‚ä½†æ˜¯å‘¢å½“ä½ å»ä¸‹è½½æ’ä»¶æ˜¯éªšæ“ä½œæ¥äº†ï¼Œé¦–å…ˆæ˜¯å¼ºåˆ¶éœ€è¦ä½ ç™»é™†ï¼Œç„¶åç™»é™†åè¿˜éœ€è¦ä½ å¼ºåˆ¶çœ‹å¹¿å‘Šæ‰èƒ½ä¸‹è½½ï¼Œè¿™æ³¢éªšæ“ä½œçœŸçš„æ˜¯éªšã€‚æœ‰äº›ä½œè€…å¸Œæœ›æ•´ç‚¹æ’ä»¶èµšç‚¹å¤–å¿«ï¼Œå¯ä»¥æ”¶è´¹ä¸‹è½½å¯ä»¥ç†è§£ï¼Œä½†æ˜¯åˆ«äººå…è´¹å¼€æºçš„æ’ä»¶ï¼Œuni-app è¿˜å¼ºåˆ¶ä½ æ‰«ç çœ‹å¹¿å‘Šæ˜¯çœŸçš„æ¶å¿ƒäº†ã€‚</p>
<p>uni-app ä¸€ç›´éƒ½åœ¨åŠ æ–°åŠŸèƒ½ï¼Œå¯¹äº bug å¤„ç†é€Ÿåº¦çœŸçš„æ˜¯æ…¢ï¼Œå®˜æ–¹è®ºå›ä¸€å¤§å †æ²¡äººå›å¤çš„é—®é¢˜ï¼Œä¸€ä¸ªåŠ²çš„å †æ–°åŠŸèƒ½ï¼Œbug æ²¡è§ä¿®å¤å¤šå°‘ï¼Œbug å…¨ç•™ç€å½“ä¼ å®¶å®äº†ã€‚HBuilderX ä¹Ÿæ˜¯æœ‰ç‚¹ç¦»è°±ï¼Œç¬¬ä¸€æ¬¡åœ¨å¼€å‘è€…å·¥å…·é‡Œè¾¹çœ‹åˆ°æ‹›è˜å¹¿å‘Šçš„ï¼Œåªèƒ½è¯´ newb äº†ã€‚</p>
<h2 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h2><h3 id="å®šä½"><a href="#å®šä½" class="headerlink" title="å®šä½"></a>å®šä½</h3><h4 id="åœ¨-H5-ä¸­-uni-getLocationï¼Œå†…éƒ¨æŠ›å‡ºå¼‚å¸¸ï¼Œæ²¡åšå¤„ç†ï¼Œå¯¼è‡´æ— æ³•æ•è·åˆ°ï¼Œä¹Ÿä¸ä¼šè¿›å…¥-fail-å›è°ƒï¼Œå¯¼è‡´æ— æ³•å¾—çŸ¥å®šä½å¤±è´¥ã€‚æ¯”å¦‚-åœ°å›¾-key-ip-å®šä½è¶…ä¸Šé™ï¼Œ-navigator-geolocation-å®šä½å¤±è´¥ç­‰ã€‚"><a href="#åœ¨-H5-ä¸­-uni-getLocationï¼Œå†…éƒ¨æŠ›å‡ºå¼‚å¸¸ï¼Œæ²¡åšå¤„ç†ï¼Œå¯¼è‡´æ— æ³•æ•è·åˆ°ï¼Œä¹Ÿä¸ä¼šè¿›å…¥-fail-å›è°ƒï¼Œå¯¼è‡´æ— æ³•å¾—çŸ¥å®šä½å¤±è´¥ã€‚æ¯”å¦‚-åœ°å›¾-key-ip-å®šä½è¶…ä¸Šé™ï¼Œ-navigator-geolocation-å®šä½å¤±è´¥ç­‰ã€‚" class="headerlink" title="åœ¨ H5 ä¸­ uni.getLocationï¼Œå†…éƒ¨æŠ›å‡ºå¼‚å¸¸ï¼Œæ²¡åšå¤„ç†ï¼Œå¯¼è‡´æ— æ³•æ•è·åˆ°ï¼Œä¹Ÿä¸ä¼šè¿›å…¥ fail å›è°ƒï¼Œå¯¼è‡´æ— æ³•å¾—çŸ¥å®šä½å¤±è´¥ã€‚æ¯”å¦‚ åœ°å›¾ key ip å®šä½è¶…ä¸Šé™ï¼Œ navigator.geolocation å®šä½å¤±è´¥ç­‰ã€‚"></a>åœ¨ H5 ä¸­ uni.getLocationï¼Œå†…éƒ¨æŠ›å‡ºå¼‚å¸¸ï¼Œæ²¡åšå¤„ç†ï¼Œå¯¼è‡´æ— æ³•æ•è·åˆ°ï¼Œä¹Ÿä¸ä¼šè¿›å…¥ fail å›è°ƒï¼Œå¯¼è‡´æ— æ³•å¾—çŸ¥å®šä½å¤±è´¥ã€‚æ¯”å¦‚ åœ°å›¾ key ip å®šä½è¶…ä¸Šé™ï¼Œ navigator.geolocation å®šä½å¤±è´¥ç­‰ã€‚</h4><p>è§£å†³æ–¹å¼ï¼š</p>
<p>h5 ç«¯è‡ªå·±å¯¹ navigator.geolocation å°è£…ï¼Œå…¶ä»–ç«¯ä½¿ç”¨ uni.getLocationã€‚æˆ–è€…å¯¹ uni.getLocation è¿›è¡Œå°è£…å¢åŠ è¶…æ—¶è®¾ç½®ï¼Œè¶…è¿‡å‡ ç§’æœªè¿”å›ï¼Œè¿”å›é»˜è®¤å®šä½ç‚¹ã€‚è‡ªå·±å°è£… navigator.geolocation éœ€è¦åšå¥½åæ ‡è½¬æ¢ï¼Œåº”è¯¥æµè§ˆå™¨é»˜è®¤è¿”å›æ˜¯ wgs84 ï¼Œéœ€è¦è‡ªå·±è½¬æ¢ä¸º gcj02 æˆ–å…¶ä»–çš„åæ ‡ç³»ã€‚</p>
<h4 id="å®šæ—¶å¤±è´¥æ—¶å€™ï¼Œåªè¦ä½ é…ç½®äº†åœ°å›¾-keyï¼Œå°±ä¼šä½¿ç”¨å¯¹åº”åœ°å›¾æœåŠ¡å•†-ip-å®šä½ã€‚å› ä¸ºæ­£å¸¸æƒ…å†µä¸‹å‰ç«¯çš„åœ°å›¾çš„-key-åªéœ€æœ‰åœ°å›¾ç»˜åˆ¶ç›¸å…³åŠŸèƒ½ä½¿ç”¨ï¼Œä¸éœ€è¦åŒ…å«åœ°å›¾æœåŠ¡å•†-WebService-API-åŠŸèƒ½çš„ï¼Œ-ä¸ºäº†é¿å…ç›—åˆ·ä¹Ÿä¸ä¼šå°†-WebService-API-çš„-key-å­˜æ”¾åœ¨å‰ç«¯ï¼Œè¿™å°±å¯¼è‡´ä½ ä½¿ç”¨-uni-app-çš„-map-ç»„ä»¶ï¼Œå°±ä¼šä½¿ç”¨-ip-å®šä½ï¼Œä½†ä½ çš„-key-å¹¶ä¸æ”¯æŒã€‚"><a href="#å®šæ—¶å¤±è´¥æ—¶å€™ï¼Œåªè¦ä½ é…ç½®äº†åœ°å›¾-keyï¼Œå°±ä¼šä½¿ç”¨å¯¹åº”åœ°å›¾æœåŠ¡å•†-ip-å®šä½ã€‚å› ä¸ºæ­£å¸¸æƒ…å†µä¸‹å‰ç«¯çš„åœ°å›¾çš„-key-åªéœ€æœ‰åœ°å›¾ç»˜åˆ¶ç›¸å…³åŠŸèƒ½ä½¿ç”¨ï¼Œä¸éœ€è¦åŒ…å«åœ°å›¾æœåŠ¡å•†-WebService-API-åŠŸèƒ½çš„ï¼Œ-ä¸ºäº†é¿å…ç›—åˆ·ä¹Ÿä¸ä¼šå°†-WebService-API-çš„-key-å­˜æ”¾åœ¨å‰ç«¯ï¼Œè¿™å°±å¯¼è‡´ä½ ä½¿ç”¨-uni-app-çš„-map-ç»„ä»¶ï¼Œå°±ä¼šä½¿ç”¨-ip-å®šä½ï¼Œä½†ä½ çš„-key-å¹¶ä¸æ”¯æŒã€‚" class="headerlink" title="å®šæ—¶å¤±è´¥æ—¶å€™ï¼Œåªè¦ä½ é…ç½®äº†åœ°å›¾ keyï¼Œå°±ä¼šä½¿ç”¨å¯¹åº”åœ°å›¾æœåŠ¡å•† ip å®šä½ã€‚å› ä¸ºæ­£å¸¸æƒ…å†µä¸‹å‰ç«¯çš„åœ°å›¾çš„ key åªéœ€æœ‰åœ°å›¾ç»˜åˆ¶ç›¸å…³åŠŸèƒ½ä½¿ç”¨ï¼Œä¸éœ€è¦åŒ…å«åœ°å›¾æœåŠ¡å•† WebService API åŠŸèƒ½çš„ï¼Œ ä¸ºäº†é¿å…ç›—åˆ·ä¹Ÿä¸ä¼šå°† WebService API çš„ key å­˜æ”¾åœ¨å‰ç«¯ï¼Œè¿™å°±å¯¼è‡´ä½ ä½¿ç”¨ uni-app çš„ map ç»„ä»¶ï¼Œå°±ä¼šä½¿ç”¨ ip å®šä½ï¼Œä½†ä½ çš„ key å¹¶ä¸æ”¯æŒã€‚"></a>å®šæ—¶å¤±è´¥æ—¶å€™ï¼Œåªè¦ä½ é…ç½®äº†åœ°å›¾ keyï¼Œå°±ä¼šä½¿ç”¨å¯¹åº”åœ°å›¾æœåŠ¡å•† ip å®šä½ã€‚å› ä¸ºæ­£å¸¸æƒ…å†µä¸‹å‰ç«¯çš„åœ°å›¾çš„ key åªéœ€æœ‰åœ°å›¾ç»˜åˆ¶ç›¸å…³åŠŸèƒ½ä½¿ç”¨ï¼Œä¸éœ€è¦åŒ…å«åœ°å›¾æœåŠ¡å•† WebService API åŠŸèƒ½çš„ï¼Œ ä¸ºäº†é¿å…ç›—åˆ·ä¹Ÿä¸ä¼šå°† WebService API çš„ key å­˜æ”¾åœ¨å‰ç«¯ï¼Œè¿™å°±å¯¼è‡´ä½ ä½¿ç”¨ uni-app çš„ map ç»„ä»¶ï¼Œå°±ä¼šä½¿ç”¨ ip å®šä½ï¼Œä½†ä½ çš„ key å¹¶ä¸æ”¯æŒã€‚</h4><p>è§£å†³æ–¹å¼ï¼š</p>
<p>å’Œä¸Šé¢å¤„ç†æ–¹å¼ä¸€æ ·ï¼Œæœ€ç›´æ¥å°±æ˜¯è‡ªå·±å°è£… h5 å®šä½ï¼Œå°† ip å®šä½åœ°å€ï¼Œæ›¿æ¢æˆè‡ªå·±æœåŠ¡å™¨åœ°å€ä½œä¸ºä»£ç†ã€‚</p>
<h4 id="uni-openLocation-åœ¨-vue3-ts-ä¸­ï¼ŒH5-ç«¯æ˜¯ä»¥ç»„ä»¶å½¢å¼å­˜åœ¨çš„ï¼Œä¸æƒ³å…¶ä»–-vue2-æ˜¯ä»¥è·¯ç”±å½¢å¼å­˜åœ¨ï¼Œçœ‹å†…éƒ¨å®ç°å¹¶æ²¡æœ‰ç›‘å¬è·¯ç”±å˜åŒ–å¸è½½ç»„ä»¶ï¼Œä¼šå¯¼è‡´é€šè¿‡æµè§ˆæ—¶è¿”å›ä¸Šä¸€é¡µæ—¶ï¼Œç»„ä»¶è¿˜æ˜¯è¦†ç›–åœ¨é¡µé¢ä¸Šã€‚"><a href="#uni-openLocation-åœ¨-vue3-ts-ä¸­ï¼ŒH5-ç«¯æ˜¯ä»¥ç»„ä»¶å½¢å¼å­˜åœ¨çš„ï¼Œä¸æƒ³å…¶ä»–-vue2-æ˜¯ä»¥è·¯ç”±å½¢å¼å­˜åœ¨ï¼Œçœ‹å†…éƒ¨å®ç°å¹¶æ²¡æœ‰ç›‘å¬è·¯ç”±å˜åŒ–å¸è½½ç»„ä»¶ï¼Œä¼šå¯¼è‡´é€šè¿‡æµè§ˆæ—¶è¿”å›ä¸Šä¸€é¡µæ—¶ï¼Œç»„ä»¶è¿˜æ˜¯è¦†ç›–åœ¨é¡µé¢ä¸Šã€‚" class="headerlink" title="uni.openLocation åœ¨ vue3 + ts ä¸­ï¼ŒH5 ç«¯æ˜¯ä»¥ç»„ä»¶å½¢å¼å­˜åœ¨çš„ï¼Œä¸æƒ³å…¶ä»– vue2 æ˜¯ä»¥è·¯ç”±å½¢å¼å­˜åœ¨ï¼Œçœ‹å†…éƒ¨å®ç°å¹¶æ²¡æœ‰ç›‘å¬è·¯ç”±å˜åŒ–å¸è½½ç»„ä»¶ï¼Œä¼šå¯¼è‡´é€šè¿‡æµè§ˆæ—¶è¿”å›ä¸Šä¸€é¡µæ—¶ï¼Œç»„ä»¶è¿˜æ˜¯è¦†ç›–åœ¨é¡µé¢ä¸Šã€‚"></a>uni.openLocation åœ¨ vue3 + ts ä¸­ï¼ŒH5 ç«¯æ˜¯ä»¥ç»„ä»¶å½¢å¼å­˜åœ¨çš„ï¼Œä¸æƒ³å…¶ä»– vue2 æ˜¯ä»¥è·¯ç”±å½¢å¼å­˜åœ¨ï¼Œçœ‹å†…éƒ¨å®ç°å¹¶æ²¡æœ‰ç›‘å¬è·¯ç”±å˜åŒ–å¸è½½ç»„ä»¶ï¼Œä¼šå¯¼è‡´é€šè¿‡æµè§ˆæ—¶è¿”å›ä¸Šä¸€é¡µæ—¶ï¼Œç»„ä»¶è¿˜æ˜¯è¦†ç›–åœ¨é¡µé¢ä¸Šã€‚</h4><p>è§£å†³æ–¹å¼ï¼š</p>
<p>è‡ªå®šä¹‰æŸ¥çœ‹ä½ç½®ç»„ä»¶ï¼Œåœ¨ H5 ç«¯æ›¿æ¢æ‰ uni-app çš„ã€‚</p>
<h3 id="map-æ¸²æŸ“é—®é¢˜"><a href="#map-æ¸²æŸ“é—®é¢˜" class="headerlink" title="map æ¸²æŸ“é—®é¢˜"></a>map æ¸²æŸ“é—®é¢˜</h3><h4 id="uni-app-çš„-map-å°è£…äº†ä¸€äº›è¦†ç›–ç‰©ç»˜åˆ¶å±æ€§ã€‚æ¯”å¦‚ç»˜åˆ¶å¤šè¾¹å½¢åŒºåŸŸç»˜åˆ¶ï¼Œå¦‚æœåœ¨åœ°å›¾ç»˜åˆ¶å‰å°±å·²ç»ç»™-map-çš„-polygons-å±æ€§è®¾ç½®äº†æ•°æ®ï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€é¡µé¢ä¸ä¼šç”Ÿæ•ˆã€‚é¿å…è¿™ç§æƒ…å†µå‡ºç°ï¼Œéœ€è¦åœ¨åœ°å›¾æ¸²æŸ“ååœ¨è®¾ç½®è¿™äº›æ•°æ®ï¼Œä½†æ˜¯åœ¨-updated-äº‹ä»¶è§¦å‘åç«‹å³è®¾ç½®ä¹Ÿä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ç§æƒ…å†µåœ¨ç¬¬ä¸€æ‰“å¼€é¡µé¢æ—¶ç”Ÿæ•ˆï¼Œç¬¬äºŒæ¬¡è¿›å…¥æ—¶å€™ä¼šå‡ºç°ä¸ç”Ÿæ•ˆæƒ…å†µï¼Œæœªæ‰¾åˆ°å‡ºç°è¿™ç§é—®é¢˜åŸå› ã€‚"><a href="#uni-app-çš„-map-å°è£…äº†ä¸€äº›è¦†ç›–ç‰©ç»˜åˆ¶å±æ€§ã€‚æ¯”å¦‚ç»˜åˆ¶å¤šè¾¹å½¢åŒºåŸŸç»˜åˆ¶ï¼Œå¦‚æœåœ¨åœ°å›¾ç»˜åˆ¶å‰å°±å·²ç»ç»™-map-çš„-polygons-å±æ€§è®¾ç½®äº†æ•°æ®ï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€é¡µé¢ä¸ä¼šç”Ÿæ•ˆã€‚é¿å…è¿™ç§æƒ…å†µå‡ºç°ï¼Œéœ€è¦åœ¨åœ°å›¾æ¸²æŸ“ååœ¨è®¾ç½®è¿™äº›æ•°æ®ï¼Œä½†æ˜¯åœ¨-updated-äº‹ä»¶è§¦å‘åç«‹å³è®¾ç½®ä¹Ÿä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ç§æƒ…å†µåœ¨ç¬¬ä¸€æ‰“å¼€é¡µé¢æ—¶ç”Ÿæ•ˆï¼Œç¬¬äºŒæ¬¡è¿›å…¥æ—¶å€™ä¼šå‡ºç°ä¸ç”Ÿæ•ˆæƒ…å†µï¼Œæœªæ‰¾åˆ°å‡ºç°è¿™ç§é—®é¢˜åŸå› ã€‚" class="headerlink" title="uni-app çš„ map å°è£…äº†ä¸€äº›è¦†ç›–ç‰©ç»˜åˆ¶å±æ€§ã€‚æ¯”å¦‚ç»˜åˆ¶å¤šè¾¹å½¢åŒºåŸŸç»˜åˆ¶ï¼Œå¦‚æœåœ¨åœ°å›¾ç»˜åˆ¶å‰å°±å·²ç»ç»™ map çš„ polygons å±æ€§è®¾ç½®äº†æ•°æ®ï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€é¡µé¢ä¸ä¼šç”Ÿæ•ˆã€‚é¿å…è¿™ç§æƒ…å†µå‡ºç°ï¼Œéœ€è¦åœ¨åœ°å›¾æ¸²æŸ“ååœ¨è®¾ç½®è¿™äº›æ•°æ®ï¼Œä½†æ˜¯åœ¨ updated äº‹ä»¶è§¦å‘åç«‹å³è®¾ç½®ä¹Ÿä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ç§æƒ…å†µåœ¨ç¬¬ä¸€æ‰“å¼€é¡µé¢æ—¶ç”Ÿæ•ˆï¼Œç¬¬äºŒæ¬¡è¿›å…¥æ—¶å€™ä¼šå‡ºç°ä¸ç”Ÿæ•ˆæƒ…å†µï¼Œæœªæ‰¾åˆ°å‡ºç°è¿™ç§é—®é¢˜åŸå› ã€‚"></a>uni-app çš„ map å°è£…äº†ä¸€äº›è¦†ç›–ç‰©ç»˜åˆ¶å±æ€§ã€‚æ¯”å¦‚ç»˜åˆ¶å¤šè¾¹å½¢åŒºåŸŸç»˜åˆ¶ï¼Œå¦‚æœåœ¨åœ°å›¾ç»˜åˆ¶å‰å°±å·²ç»ç»™ map çš„ polygons å±æ€§è®¾ç½®äº†æ•°æ®ï¼Œç¬¬ä¸€æ¬¡æ‰“å¼€é¡µé¢ä¸ä¼šç”Ÿæ•ˆã€‚é¿å…è¿™ç§æƒ…å†µå‡ºç°ï¼Œéœ€è¦åœ¨åœ°å›¾æ¸²æŸ“ååœ¨è®¾ç½®è¿™äº›æ•°æ®ï¼Œä½†æ˜¯åœ¨ updated äº‹ä»¶è§¦å‘åç«‹å³è®¾ç½®ä¹Ÿä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ç§æƒ…å†µåœ¨ç¬¬ä¸€æ‰“å¼€é¡µé¢æ—¶ç”Ÿæ•ˆï¼Œç¬¬äºŒæ¬¡è¿›å…¥æ—¶å€™ä¼šå‡ºç°ä¸ç”Ÿæ•ˆæƒ…å†µï¼Œæœªæ‰¾åˆ°å‡ºç°è¿™ç§é—®é¢˜åŸå› ã€‚</h4><p>è§£å†³æ–¹å¼ï¼š<br>updated äº‹ä»¶åï¼Œå†åŠ å…¥å®šæ—¶å™¨å»¶è¿Ÿæ‰§è¡Œç»˜åˆ¶æ“ä½œã€‚</p>
<h3 id="åµŒå¥—æ¸²æŸ“"><a href="#åµŒå¥—æ¸²æŸ“" class="headerlink" title="åµŒå¥—æ¸²æŸ“"></a>åµŒå¥—æ¸²æŸ“</h3><h4 id="æœ‰å¤šä¸ª-v-for-åµŒå¥—æ¸²æŸ“æ—¶å€™ï¼Œ-å†…å±‚çš„-v-for-ä¸Šçš„ç‚¹å‡»äº‹ä»¶åœ¨å°ç¨‹åºä¸­æ— æ³•è§¦å‘ã€‚"><a href="#æœ‰å¤šä¸ª-v-for-åµŒå¥—æ¸²æŸ“æ—¶å€™ï¼Œ-å†…å±‚çš„-v-for-ä¸Šçš„ç‚¹å‡»äº‹ä»¶åœ¨å°ç¨‹åºä¸­æ— æ³•è§¦å‘ã€‚" class="headerlink" title="æœ‰å¤šä¸ª v-for åµŒå¥—æ¸²æŸ“æ—¶å€™ï¼Œ å†…å±‚çš„ v-for ä¸Šçš„ç‚¹å‡»äº‹ä»¶åœ¨å°ç¨‹åºä¸­æ— æ³•è§¦å‘ã€‚"></a>æœ‰å¤šä¸ª v-for åµŒå¥—æ¸²æŸ“æ—¶å€™ï¼Œ å†…å±‚çš„ v-for ä¸Šçš„ç‚¹å‡»äº‹ä»¶åœ¨å°ç¨‹åºä¸­æ— æ³•è§¦å‘ã€‚</h4><p>è§£å†³æ–¹å¼ï¼š<br>å°†éƒ¨åˆ† v-for æ‹†åˆ†æˆç»„ä»¶å½¢å¼ï¼Œé¿å…é¡µé¢ä¸Š v-for åµŒå¥—è¿‡å¤šã€‚</p>
<h3 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h3><h3 id="ç»„ä»¶å·®å¼‚æ€§"><a href="#ç»„ä»¶å·®å¼‚æ€§" class="headerlink" title="ç»„ä»¶å·®å¼‚æ€§"></a>ç»„ä»¶å·®å¼‚æ€§</h3><p>æœ‰äº›ç»„ä»¶ä¼šåœ¨ä¸åŒå¹³å°å‡ºç°ä¸åŒå·®å¼‚æ•ˆæœï¼Œéœ€è¦ä½ æ…¢æ…¢å»è¸©å‘å¡«å‘ï¼Œä¸€ä¸ªä¸ªçš„è¶Ÿè¿‡å»ã€‚æ¯”å¦‚ popup ç»„ä»¶ï¼Œå°ç¨‹åºä¼šå‡ºç°æ»šåŠ¨é€ä¼ é—®é¢˜ï¼Œè€Œåœ¨ h5 ä¸Šåšäº†å…¼å®¹å¤„ç†ï¼Œä½†æ˜¯å¦‚æœä½ æ‰“å¼€åï¼Œæœªå…³é—­ç›´æ¥è·³è½¬åˆ°æ–°çš„é¡µé¢ï¼Œä¼šå¯¼è‡´æ–°çš„é¡µé¢æ— æ³•æ»šåŠ¨ï¼Œéœ€è¦åœ¨è·¯ç”±å˜åŒ–æ—¶å…³é—­å½“å‰é¡µé¢é‡Œçš„ popup ç»„ä»¶ï¼Œè¿™ç§é—®é¢˜çœŸçš„æ˜¯åªèƒ½è‡ªå·±é‡åˆ°ä¸€ä¸ªå¡«ä¸€ä¸ªäº†ã€‚</p>
<h3 id="æ–‡æ¡£æ··ä¹±"><a href="#æ–‡æ¡£æ··ä¹±" class="headerlink" title="æ–‡æ¡£æ··ä¹±"></a>æ–‡æ¡£æ··ä¹±</h3><p>uni-app åšäº†å¾ˆå¤šå¹³å°å°è£…ä¿è¯ api çš„ä¸€è‡´æ€§ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šç»å¸¸å†™ç€å‘ç°å¹³å°ä¸æ”¯æŒï¼Œåªèƒ½è‡ªå·±å¦è¾Ÿè¹Šå¾„ã€‚</p>
<h2 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h2><p>ç”±äºæ²¡æœ‰ app éœ€æ±‚ï¼Œä¸çŸ¥é“åœ¨ app ä¸Šå‘å¤šä¸å¤šï¼Œæ®ä»¥å‰åŒäº‹ä½¿ç”¨ä½“éªŒæ¥çœ‹æ®è¯´å‘æ›´å¤šğŸ¤£ã€‚ä¸è¿‡å¯¹äºä¸€äº›ç®€å•åº”ç”¨å¯ä»¥å°è¯•ä½¿ç”¨ï¼Œæ¯•ç«Ÿèƒ½ä¸€å¥—ä»£ç æ„å»ºå¤šç«¯è¿˜æ˜¯èƒ½æå‡ä¸å°‘æ•ˆç‡çš„ã€‚ä½†æ˜¯ä½ çš„åº”ç”¨å¤æ‚èµ·æ¥ï¼Œä»€ä¹ˆå¤šç«¯å¼€å‘ï¼Œæé«˜æ•ˆç‡ï¼Œè¿™ç©æ„æ•ˆç‡çœŸçš„ä¸ä¸€å®šèƒ½é«˜åˆ°å“ªé‡Œå»ï¼Œè¿˜ä¸å¦‚åˆ†å¼€æ•ˆç‡é«˜.</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
  </entry>
  <entry>
    <title>æœ±é›€äº‘ä¸¹ Â· é£é‡‡é“ƒ</title>
    <url>/video_yztx/</url>
    <content><![CDATA[<p>ä¸€å£¶ç”Ÿæ­»æ›¾å…¥å–‰ï¼Œé†‰æ¢¦é»„æ³‰ä¹åƒå®µã€‚è½¬çœ¼å½¢éª¸å…·ä»˜ç­ï¼Œæ‚²æ¬¢ä¸¤æ•£å¤©æ¶¯è€ã€‚</p>
<span id="more"></span>
<!-- <iframe src="//player.bilibili.com/player.html?aid=54488812&bvid=BV1Z4411n7my&cid=95263211&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width="100%" height="500px"> </iframe>
 -->
<iframe src="//player.bilibili.com/player.html?aid=54488812&bvid=BV1Z4411n7my&cid=95263211&page=1&high_quality=1&danmaku=0" allowfullscreen="allowfullscreen" width="100%" height="500" scrolling="no" frameborder="0" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts"></iframe>]]></content>
      <categories>
        <category>åˆ†äº«ç±»</category>
      </categories>
      <tags>
        <tag>video</tag>
      </tags>
  </entry>
  <entry>
    <title>VS Code æ’ä»¶å¼€å‘æŒ‡åŒ— (ä¸€)</title>
    <url>/vscode_extension/</url>
    <content><![CDATA[<p>æœ€è¿‘é—²æ¥æ— äº‹ï¼Œç»™å…¬å¸æ¡†æ¶åšäº†å¼€å‘ä»£ç ç‰‡æ®µæç¤ºå’Œä¸€äº›å¸¸ç”¨å·¥å…·æ•´åˆçš„æ’ï¼Œåœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹è¸©è¿‡çš„å‘å’Œä¸€äº›å¸¸ç”¨çš„åŸºæœ¬åŠŸèƒ½ç¤ºä¾‹ã€‚</p>
<span id="more"></span>
<h2 id="æ’ä»¶èƒ½åšä»€ä¹ˆ"><a href="#æ’ä»¶èƒ½åšä»€ä¹ˆ" class="headerlink" title="æ’ä»¶èƒ½åšä»€ä¹ˆ"></a>æ’ä»¶èƒ½åšä»€ä¹ˆ</h2><p>å› ä¸º VS Code æ˜¯åŸºäº Electron çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬ node èƒ½åšçš„ä¸€èˆ¬åŸºæœ¬ä¸Šéƒ½æ˜¯å¯ä»¥æ˜¯ç°å®ã€‚å¦‚æœä½ æƒ³å¯¹ VS Code åšäº›ä¸ªæ€§åŒ–çš„é…ç½®ï¼Œä½ å¯ä»¥å¼€å‘è‡ªå®šä¹‰ä¸»é¢˜ã€å›¾æ ‡ä¸»é¢˜ã€æ¬¢è¿é¡µé¢ã€è‡ªå®šä¹‰å·¦ä¾§çš„é¢æ¿ï¼ˆä¾‹å¦‚èµ„æºç®¡ç†å™¨æ é‚£ç§ï¼‰ç­‰ã€‚ä½ è¿˜å¯ä»¥è‡ªå·±å®šä¹‰å‘½ä»¤ã€å¿«æ·é”®ã€è‡ªåŠ¨è¡¥å…¨ã€èœå•ç­‰æ¥æå‡ä½ çš„å¼€å‘æ•ˆç‡ã€‚ç”šè‡³ä½ å¯ä»¥å¯¹ç°æœ‰è¯­è¨€åšæ‰©å±•æˆ–è€…å®šä¹‰æ–°çš„è¯­è¨€çš„æ”¯æŒã€‚</p>
<h2 id="åˆ›å»ºæ’ä»¶é¡¹ç›®"><a href="#åˆ›å»ºæ’ä»¶é¡¹ç›®" class="headerlink" title="åˆ›å»ºæ’ä»¶é¡¹ç›®"></a>åˆ›å»ºæ’ä»¶é¡¹ç›®</h2><p>é¦–å…ˆå®‰è£…å®˜æ–¹çš„è„šæ‰‹æ¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®‰è£…è„šæ‰‹æ¶</span></span><br><span class="line">npm install -g yo generator-code</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºé¡¹ç›®</span></span><br><span class="line">yo code </span><br><span class="line"><span class="comment">// ä¼šä¸€è·¯æç¤ºä½  è¾“å…¥æ’ä»¶å æ’ä»¶id ç­‰ç­‰ã€‚æ ¹æ®éœ€è¦å¡«å†™</span></span><br></pre></td></tr></table></figure>
<p>å¾®è½¯æä¾›äº†ä¸¤ç§æ–¹å¼å»å¼€å‘ï¼Œä¸€ç§æ˜¯ JavaScript å’Œ TypeScript å»å¼€å‘ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„ä¹ æƒ¯é€‰æ‹©ã€‚åˆ›å»ºå¥½åæŒ‰ F5 ä¼šæ‰“å¼€è°ƒè¯•ç”¨çš„ VS Code çª—å£æ¥è°ƒè¯•æ’ä»¶</p>
<p>ä½¿ç”¨ JavaScript ç”Ÿæˆçš„é¡¹ç›®ç»“æ„ï¼Œ<br>â”œâ”€â”€ .vscode<br>â”‚   â”œâ”€â”€ launch.json     &#x2F;&#x2F; æ’ä»¶åŠ è½½å’Œè°ƒè¯•çš„é…ç½®<br>â”‚   â””â”€â”€ tasks.json      &#x2F;&#x2F; é…ç½®TypeScriptç¼–è¯‘ä»»åŠ¡<br>â”œâ”€â”€ .gitignore          &#x2F;&#x2F; å¿½ç•¥æ„å»ºè¾“å‡ºå’Œnode_modulesæ–‡ä»¶<br>â”œâ”€â”€ README.md           &#x2F;&#x2F; æ’ä»¶æ–‡æ¡£<br>â”œâ”€â”€ CHANGELOG.md        &#x2F;&#x2F; æ’ä»¶æ›´æ–°æ—¥å¿—<br>â”œâ”€â”€ extension.ts        &#x2F;&#x2F; æ’ä»¶æºä»£ç <br>â”œâ”€â”€ package.json        &#x2F;&#x2F; æ’ä»¶é…ç½®æ¸…å•<br>â”œâ”€â”€ jsconfig.json       &#x2F;&#x2F; </p>
<p>å…ˆçœ‹ä¸‹å…¥å£æ–‡ä»¶ï¼Œå…¥å£æ–‡ä»¶éœ€è¦å¯¼å‡ºä¸¤ä¸ªå‡½æ•° activate å’Œ deactivate</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//extension.js æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ’ä»¶æ¿€æ´»è°ƒç”¨ï¼Œä¹Ÿæ˜¯æ’ä»¶çš„å…¥å£</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">activate</span>(<span class="params">context</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Congratulations, your extension &quot;vscode-demo&quot; is now active!&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ³¨å†Œä¸€ä¸ªå‘½ä»¤</span></span><br><span class="line">    <span class="keyword">let</span> disposable = vscode.<span class="property">commands</span>.<span class="title function_">registerCommand</span>(<span class="string">&#x27;vscode-demo.helloWorld&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//å‘½ä»¤è§¦å‘æ˜¯è°ƒç”¨</span></span><br><span class="line">        vscode.<span class="property">window</span>.<span class="title function_">showInformationMessage</span>(<span class="string">&#x27;Hello World from vscode-demo!&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    context.<span class="property">subscriptions</span>.<span class="title function_">push</span>(disposable);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ’ä»¶é”€æ¯è°ƒç”¨</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">deactivate</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    activate,</span><br><span class="line">    deactivate</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªåˆå§‹åŒ–æ’ä»¶é¡¹ç›®ï¼Œé»˜è®¤å°±æ˜¯æ³¨å†Œäº†ä¸ª hello world å‘½ä»¤ï¼Œç„¶åè¿è¡Œå‘½ä»¤æ˜¾ç¤º hello world çš„é€šçŸ¥ï¼ŒæŒ‰F5è¿è¡Œé¡¹ç›®ï¼Œåœ¨å‘½ä»¤é¢æ¿è¾“å…¥ hello worldï¼Œå¯ä»¥çœ‹åˆ°å³ä¸‹è§’å¼¹å‡ºé€šçŸ¥<br><img src="/images/posts/vscode_extension/20210615205632.png" alt="é¡¹ç›®ç»“æ„" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br><img src="/images/posts/vscode_extension/20210615205655.png" alt="é¡¹ç›®ç»“æ„" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h2 id="é…ç½®è¯´æ˜"><a href="#é…ç½®è¯´æ˜" class="headerlink" title="é…ç½®è¯´æ˜"></a>é…ç½®è¯´æ˜</h2><p>vscode æ’ä»¶çš„ package.json æ˜¯ npm çš„ä¸€ä¸ªè¶…é›†ï¼Œæ’ä»¶çš„å›¾æ ‡ã€å‘½ä»¤æ³¨å†Œã€èœå•é…ç½®ã€è¯­è¨€æ³¨å†Œã€ä¸»é¢˜æ³¨å†Œã€ä»£ç ç‰‡æ®µç­‰ä¸€ç³»åˆ—çš„éƒ½éœ€è¦åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé…ç½®ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;displayName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;publisher&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> <span class="comment">//å‘å¸ƒè€…idï¼Œåé¢ä¼šè®²æ€ä¹ˆå‘å¸ƒåˆ°æ’ä»¶å¸‚åœº</span></span><br><span class="line">    <span class="attr">&quot;engines&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="comment">//vscode æœ€ä½ç‰ˆæœ¬</span></span><br><span class="line">        <span class="attr">&quot;vscode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^1.57.0&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;categories&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="comment">//æ’ä»¶å¸‚åœºçš„åˆ†ç±» å¯ä»¥è®¾ç½®æˆè¯­è¨€ä¸»é¢˜ç­‰å…¶ä»–ç±»å‹</span></span><br><span class="line">        <span class="string">&quot;Other&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;activationEvents&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="comment">//æ‰©å±•çš„æ¿€æ´»äº‹ä»¶</span></span><br><span class="line">        <span class="string">&quot;onCommand:vscode-demo.helloWorld&quot;</span><span class="punctuation">,</span> <span class="comment">//è°ƒç”¨å‘½ä»¤æ—¶æ¿€æ´»</span></span><br><span class="line">        <span class="string">&quot;onLanguage:python&quot;</span><span class="punctuation">,</span> <span class="comment">//pyæ—¶æ¿€æ´»æ’ä»¶</span></span><br><span class="line">        <span class="string">&quot;workspaceContains:**/.editorconfig&quot;</span><span class="punctuation">,</span><span class="comment">// æ–‡ä»¶å¤¹æ‰“å¼€æ—¶æ¿€æ´»</span></span><br><span class="line">        <span class="string">&quot;onDebug&quot;</span><span class="punctuation">,</span><span class="comment">//è°ƒè¯•å‰æ¿€æ´»</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="string">&quot;*&quot;</span> <span class="comment">//å¯åŠ¨æ—¶å€™æ¿€æ´»ï¼Œä½¿ç”¨è¿™ä¸ªä¸éœ€è¦è®¾ç½®å…¶ä»–çš„</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./extension.js&quot;</span><span class="punctuation">,</span> <span class="comment">//æŒ‡å®šæ’ä»¶å…¥å£æ–‡ä»¶</span></span><br><span class="line">    <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> <span class="comment">//æ’ä»¶å›¾æ ‡</span></span><br><span class="line">    <span class="attr">&quot;contributes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="comment">//å¤§éƒ¨åˆ†çš„é…ç½®éƒ½è¦åœ¨è¿™é‡Œé…ç½®</span></span><br><span class="line">        <span class="attr">&quot;commands&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®å‘½ä»¤,å¦‚æœéœ€è¦æš´éœ²ç»™ç”¨æˆ·ä½¿ç”¨çš„éœ€è¦åœ¨è¿™é‡Œé…ç½®</span></span><br><span class="line">        <span class="attr">&quot;menus&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®èœå•</span></span><br><span class="line">        <span class="attr">&quot;submenus&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®å­èœå•ä¼šç”¨åˆ°</span></span><br><span class="line">        <span class="attr">&quot;languages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®è¯­è¨€</span></span><br><span class="line">        <span class="attr">&quot;grammars&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//ä¸ºè¯­è¨€é…ç½®TextMateè¯­æ³•</span></span><br><span class="line">        <span class="attr">&quot;keybindings&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®å¿«æ·é”®</span></span><br><span class="line">        <span class="attr">&quot;snippets&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®ä»£ç ç‰‡æ®µ</span></span><br><span class="line">        <span class="attr">&quot;themes&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®ä¸»é¢˜</span></span><br><span class="line">        <span class="attr">&quot;views&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®æ´»åŠ¨æ è§†å›¾</span></span><br><span class="line">        <span class="attr">&quot;viewsWelcome&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®å·¦ä¾§è§†å›¾æ¬¢è¿é¡µ</span></span><br><span class="line">        <span class="attr">&quot;viewsContainers&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="comment">//é…ç½®è§†å›¾å®¹å™¨</span></span><br><span class="line">        <span class="attr">&quot;configuration&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  <span class="comment">//é…ç½®æ’ä»¶é…ç½®</span></span><br><span class="line">        <span class="attr">&quot;configurationDefaults&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="comment">//é…ç½®æ’ä»¶é»˜è®¤é…ç½®</span></span><br><span class="line">        <span class="attr">&quot;colors&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;problemMatchers&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;taskDefinitions&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;typescriptServerPlugins&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="å‘½ä»¤ç¤ºä¾‹"><a href="#å‘½ä»¤ç¤ºä¾‹" class="headerlink" title="å‘½ä»¤ç¤ºä¾‹"></a>å‘½ä»¤ç¤ºä¾‹</h2><p>ä¸€èˆ¬æä¾›ç»™è¢«äººä½¿ç”¨çš„åŠŸèƒ½éƒ½æ˜¯é€šè¿‡å‘½ä»¤æ³¨å†Œï¼Œåœ¨å‘½ä»¤çš„å›è°ƒå‡½æ•°é‡Œå¤„ç†ç›¸å…³åŠŸèƒ½é€»è¾‘ï¼Œç„¶åå°±å¯ä»¥åœ¨ VS Code çš„å‘½ä»¤é¢æ¿è°ƒç”¨ç›¸å…³å‘½ä»¤ã€‚ä½ ä¹Ÿå¯ä»¥æ³¨å†Œå¿«æ·é”®ã€èœå•ç­‰å’Œå‘½ä»¤ç»‘å®šåœ¨ä¸€èµ·æ¥è§¦å‘å‘½ä»¤ã€‚VS Code å†…éƒ¨å«æœ‰å¤§é‡å’Œç¼–è¾‘å™¨äº¤äº’ã€æ§åˆ¶UIã€åå°æ“ä½œçš„å†…ç½®å‘½ä»¤ç»™æˆ‘ä»¬ä½¿ç”¨ã€‚</p>
<h3 id="æ³¨å†Œå‘½ä»¤"><a href="#æ³¨å†Œå‘½ä»¤" class="headerlink" title="æ³¨å†Œå‘½ä»¤"></a>æ³¨å†Œå‘½ä»¤</h3><p>vscode åœ¨ commands ä¸‹æä¾›äº† <strong>registerCommand</strong> å’Œ <strong>registerTextEditorCommand</strong>ç”¨æ¥æ³¨å†Œå‘½ä»¤ï¼ŒregisterTextEditorCommand æ³¨å†Œçš„å‘½ä»¤åªä¼šåœ¨ç¼–è¾‘å™¨æ¿€æ´»çš„æ—¶å€™æ‰è°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åœ¨activateå‡½æ•°æ³¨å†Œå‘½ä»¤</span></span><br><span class="line"></span><br><span class="line">context.<span class="property">subscriptions</span>.<span class="title function_">push</span>(</span><br><span class="line">    <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå‘½ä»¤ID,ç¬¬äºŒæ¬¡å‚æ•°å‘½ä»¤å›è°ƒå‡½æ•°</span></span><br><span class="line">    vscode.<span class="property">commands</span>.<span class="title function_">registerCommand</span>(<span class="string">&#x27;vscode-demo.currentText&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// è·å–å½“å‰æ¿€æ´»çš„ç¼–è¾‘å™¨</span></span><br><span class="line">        <span class="keyword">let</span> currentEditor = vscode.<span class="property">window</span>.<span class="property">activeTextEditor</span>; </span><br><span class="line">        <span class="comment">// è·å–ç¼–è¾‘å™¨é€‰æ‹©çš„å†…å®¹</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(currentEditor.<span class="property">document</span>.<span class="title function_">getText</span>(currentEditor.<span class="property">selection</span>));</span><br><span class="line">    &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>å‘½ä»¤æ³¨å†Œåé»˜è®¤æ˜¯ä¸ä¼šå¯¹å¤–æä¾›çš„ï¼Œå¦‚æœéœ€è¦æä¾›ç»™ç”¨æˆ·ä½¿ç”¨è¿˜éœ€è¦åœ¨ <strong>package.json</strong> çš„ <strong>contributes.commands</strong> æ·»åŠ ç›¸åº”é…ç½®</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;contributes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;commands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo.currentText&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è·å–é€‰æ‹©æ–‡æœ¬&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>æŒ‰ä½ F5 è¿è¡Œæ’ä»¶ï¼Œåœ¨å‘½ä»¤é¢æ¿è¾“å…¥ <em>è·å–é€‰æ‹©æ–‡æœ¬</em> ï¼Œä¼šå‘ç°æŠ¥é”™äº†ã€‚æ˜¯å› ä¸º <strong>activationEvents</strong> é…ç½®é‡Œåªé…ç½®äº† â€œonCommand:vscode-demo.helloWorldâ€ æ‰ä¼šæ¿€æ´»æ’ä»¶ï¼Œæˆ‘ä»¬éœ€è¦æŠŠæ–°åŠ çš„å‘½ä»¤ä¹ŸåŠ å…¥è¿›å»ï¼Œæˆ–è€…æ”¹ä¸º *</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    activationEvents<span class="punctuation">:</span> <span class="punctuation">[</span> <span class="string">&quot;*&quot;</span> <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ‰§è¡Œå‘½ä»¤"><a href="#æ‰§è¡Œå‘½ä»¤" class="headerlink" title="æ‰§è¡Œå‘½ä»¤"></a>æ‰§è¡Œå‘½ä»¤</h3><p>åœ¨ commands æä¾›äº† <strong>executeCommand</strong> APIç”¨æ¥è°ƒç”¨å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨å®ƒè°ƒç”¨æˆ‘ä»¬æ’ä»¶é‡Œçš„å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ VS Code å†…ç½®çš„å‘½ä»¤ã€‚<br>ä½¿ç”¨ç¤ºä¾‹</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è°ƒç”¨</span></span><br><span class="line">vscode.<span class="property">commands</span>.<span class="title function_">executeCommand</span>(<span class="string">&#x27;vscode-demo.helloWorld&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="èœå•ç¤ºä¾‹"><a href="#èœå•ç¤ºä¾‹" class="headerlink" title="èœå•ç¤ºä¾‹"></a>èœå•ç¤ºä¾‹</h2><p>package.json ä¸­çš„ <strong>contributes.menus</strong> ç”¨æ¥çš„é…ç½®èœå•é¡¹ï¼Œä¸‹é¢è¿™äº›ç¼–è¾‘å™¨å¯ä»¥é…ç½®èœå•çš„åœ°æ–¹ã€‚</p>
<ul>
<li>å…¨å±€å‘½ä»¤é¢æ¿ - commandPalette</li>
<li>èµ„æºç®¡ç†å™¨ä¸Šä¸‹æ–‡èœå• - explorer&#x2F;context</li>
<li>ç¼–è¾‘å™¨ä¸Šä¸‹æ–‡èœå• - editor&#x2F;context</li>
<li>ç¼–è¾‘å™¨æ ‡é¢˜æ  - editor&#x2F;title</li>
<li>ç¼–è¾‘å™¨æ ‡é¢˜ä¸Šä¸‹æ–‡èœå• - editor&#x2F;title&#x2F;context</li>
<li>è°ƒè¯•æ ˆè§†å›¾çš„ä¸Šä¸‹æ–‡èœå• - debug&#x2F;callstack&#x2F;context</li>
<li>è§†å›¾çš„æ ‡é¢˜èœå• - view&#x2F;title</li>
<li>è§†å›¾é¡¹çš„èœå• - view&#x2F;item&#x2F;context</li>
<li>SCM æ ‡é¢˜èœå• - scm&#x2F;title</li>
<li>SCM èµ„æºç»„ - scm&#x2F;resourceGroup&#x2F;context</li>
<li>SCM èµ„æº - scm&#x2F;resource&#x2F;context</li>
<li>SCM æ”¹å˜æ ‡é¢˜ - scm&#x2F;change&#x2F;title</li>
</ul>
<p>é…ç½®èœå•éœ€è¦æä¾›ï¼Œé€‰ä¸­èœå•æ—¶æ‰§è¡Œçš„å‘½ä»¤å’Œèœå•å‡ºç°çš„æ¡ä»¶ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å‘½ä»¤&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;when&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ¡ä»¶&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;alt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¯é€‰å‘½ä»¤&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="string">&quot;èœå•åˆ†ç»„&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;submenu&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é…ç½®äºŒçº§èœå•&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;icon&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å›¾æ ‡&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="æ§åˆ¶å‘½ä»¤é¢æ¿çš„å‘½ä»¤"><a href="#æ§åˆ¶å‘½ä»¤é¢æ¿çš„å‘½ä»¤" class="headerlink" title="æ§åˆ¶å‘½ä»¤é¢æ¿çš„å‘½ä»¤"></a>æ§åˆ¶å‘½ä»¤é¢æ¿çš„å‘½ä»¤</h3><p>é»˜è®¤æƒ…å†µä¸‹æ³¨å†Œçš„å‘½ä»¤éƒ½ä¼šæ˜¾ç¤ºåœ¨å‘½ä»¤é¢æ¿ä¸­ï¼Œæœ‰æ—¶å€™éœ€è¦æ›´å…·æ¡ä»¶æ˜¾ç¤ºï¼Œå°±å¯ä»¥åœ¨ <strong>commandPalette</strong> é…ç½®æŒ‡å®šå‘½ä»¤ç„¶åé€šè¿‡ <strong>when</strong> æ§åˆ¶ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;contributes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;commands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo.currentText&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è·å–é€‰æ‹©æ–‡æœ¬&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;menus&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;commandPalette&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo.currentText&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è·å–é€‰æ‹©æ–‡æœ¬&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;when&quot;</span><span class="punctuation">:</span> <span class="string">&quot;editorHasSelection&quot;</span> <span class="comment">// åªæœ‰é€‰æ‹©æ–‡æœ¬æ‰æ˜¾ç¤º</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="when-æ¡ä»¶"><a href="#when-æ¡ä»¶" class="headerlink" title="when æ¡ä»¶"></a>when æ¡ä»¶</h3><p>when æä¾›çš„é€»è¾‘æ“ä½œç¬¦æœ‰ &#x3D;&#x3D;ã€!&#x3D;ã€||ã€&amp;&amp;ã€!ã€&#x3D;~(æ­£åˆ™)ã€&gt;ã€&gt;&#x3D;ã€&lt;ã€&lt;&#x3D;ã€in ç­‰æ“ä½œç¬¦ï¼Œå’Œjsçš„ç±»ä¼¼ï¼Œå¤šäº†ä¸€ä¸ª <strong>&#x3D;~</strong> ç¬¦åŒ¹é…æ­£åˆ™ã€‚VS Code è¿˜æä¾›äº†å¾ˆå¤šä¸Šä¸‹æ–‡å¯ä»¥å’Œè¿™äº›æ“ä½œç¬¦ç»„åˆä½¿ç”¨ã€‚<a href="https://code.visualstudio.com/api/references/when-clause-contexts">æŸ¥çœ‹ä¸Šä¸‹æ–‡è¯¦æƒ…</a><br>ç¤ºä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&quot;when&quot;:&quot;resourceExtname != .js&quot; //ä¸æ˜¯jsæ–‡ä»¶æ—¶</span><br><span class="line">&quot;when&quot;:&quot;editorHasSelection&quot; //é€‰æ‹©æ–‡æœ¬æ‰æ˜¾ç¤º</span><br><span class="line">&quot;when&quot;:&quot;!editorHasSelection&quot; //ä¸é€‰æ‹©æ–‡æœ¬æ‰æ˜¾ç¤º</span><br></pre></td></tr></table></figure>


<h3 id="é…ç½®å¤šçº§èœå•"><a href="#é…ç½®å¤šçº§èœå•" class="headerlink" title="é…ç½®å¤šçº§èœå•"></a>é…ç½®å¤šçº§èœå•</h3><p>ä½¿ç”¨ <strong>submenu</strong> æŒ‡å®šçˆ¶çº§èœå•çš„IDï¼Œ<strong>submenus</strong> é…ç½®çˆ¶çº§èœå•åç§°ç­‰ä¿¡æ¯ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;contributes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;menus&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;editor/context&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo.currentText&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;submenu&quot;</span><span class="punctuation">:</span> <span class="string">&quot;first.menu&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;first.menu&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo.currentText&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;submenu&quot;</span><span class="punctuation">:</span> <span class="string">&quot;two.menu&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;two.menu&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo.currentText&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;submenus&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;first.menu&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä¸€çº§èœå•&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;two.menu&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;äºŒçº§èœå•&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="/images/posts/vscode_extension/20210616211914.png" alt="ç¤ºä¾‹" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="åˆ†ç»„æ’åº"><a href="#åˆ†ç»„æ’åº" class="headerlink" title="åˆ†ç»„æ’åº"></a>åˆ†ç»„æ’åº</h3><p>èœå•é¡¹å¯ä»¥é€šè¿‡ç»„æ¥åˆ†ç±»ã€‚æ ¹æ®ä¸‹åˆ—é»˜è®¤è§„åˆ™ï¼Œç„¶åæŒ‰ç…§å­—æ¯æ’åºï¼Œ</p>
<ul>
<li>ç¼–è¾‘å™¨ä¸Šä¸‹æ–‡èœå•(editor&#x2F;context)é»˜è®¤æœ‰è¿™äº›åˆ†ç»„ï¼š<ul>
<li>navigation - navigationç»„å§‹ç»ˆåœ¨æœ€ä¸Šæ–¹ã€‚</li>
<li>1_modification - ç´§æ¥ä¸Šä¸€ä¸ªç»„ï¼Œè¿™ä¸ªç»„åŒ…å«å¯ä»¥ä¿®æ”¹ä½ ä»£ç çš„å‘½ä»¤ã€‚</li>
<li>9_cutcopypaste - ç„¶åæ˜¯åŸºç¡€ç¼–è¾‘å‘½ä»¤ã€‚</li>
<li>z_commands - æœ€åä¸€ä¸ªåˆ†ç»„åˆ™æ˜¯å‘½ä»¤é¢æ¿å…¥å£ã€‚</li>
</ul>
</li>
<li>èµ„æºç®¡ç†å™¨ä¸Šä¸‹æ–‡èœå•(explorer&#x2F;context)é»˜è®¤æœ‰ä¸‹åˆ—åˆ†ç»„ï¼š<ul>
<li>navigation - åœ¨VS Code ä¸­å¯¼èˆªçš„ç›¸å…³å‘½ä»¤ã€‚navigation ç»„å§‹ç»ˆåœ¨æœ€ä¸Šæ–¹ã€‚</li>
<li>2_workspace - å’Œå·¥ä½œåŒºæ“ä½œç›¸å…³çš„å‘½ä»¤ã€‚</li>
<li>3_compare - æ¯”è¾ƒæ–‡ä»¶å’Œdiffç›¸å…³çš„å‘½ä»¤ã€‚</li>
<li>4_search - åœ¨æœç´¢è§†å›¾ä¸­å’Œæœç´¢ç›¸å…³çš„å‘½ä»¤ã€‚</li>
<li>5_cutcopypaste - å’Œå‰ªåˆ‡ã€å¤åˆ¶ã€ç²˜è´´æ–‡ä»¶ç›¸å…³çš„å‘½ä»¤ã€‚</li>
<li>7_modification - ä¿®æ”¹æ–‡ä»¶çš„ç›¸å…³å‘½ä»¤ã€‚</li>
</ul>
</li>
<li>ç¼–è¾‘å™¨æ ‡ç­¾èœå•é»˜è®¤æœ‰ä¸‹åˆ—åˆ†ç»„<ul>
<li>1_close - å’Œå…³é—­ç¼–è¾‘å™¨ç›¸å…³çš„å‘½ä»¤ã€‚</li>
<li>3_preview - å’Œå›ºå®šç¼–è¾‘å™¨ç›¸å…³çš„å‘½ä»¤ã€‚</li>
</ul>
</li>
<li>ç¼–è¾‘å™¨æ ‡é¢˜æ (editor&#x2F;title)çš„é»˜è®¤åˆ†ç»„<ul>
<li>1_diff - ä¸ä½¿ç”¨å·®å¼‚ç¼–è¾‘å™¨ç›¸å…³çš„å‘½ä»¤ã€‚</li>
<li>3_open - ä¸æ‰“å¼€ç¼–è¾‘å™¨ç›¸å…³çš„å‘½ä»¤ã€‚</li>
<li>5_close - ä¸å…³é—­ç¼–è¾‘å™¨ç›¸å…³çš„å‘½ä»¤ã€‚</li>
</ul>
</li>
</ul>
<p>ç»„å†…çš„èœå•é¡ºåºå–å†³äºæ ‡é¢˜æˆ–è€…åºå·å±æ€§ã€‚èœå•çš„ç»„å†…é¡ºåºç”±@<number>åŠ åˆ° group å€¼çš„åé¢å¾—ä»¥ç¡®å®šï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;editor/title&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;when&quot;</span><span class="punctuation">:</span> <span class="string">&quot;editorHasSelection&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;extension.Command&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="string">&quot;myGroup@1&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h2 id="æ³¨å†Œå¿«æ·é”®"><a href="#æ³¨å†Œå¿«æ·é”®" class="headerlink" title="æ³¨å†Œå¿«æ·é”®"></a>æ³¨å†Œå¿«æ·é”®</h2><p>å¿«æ·é”®è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼ŒWindows å’ŒLinux æ˜¯ key æŒ‡å®šï¼ŒmacOS ä½¿ç”¨ mac æŒ‡å®šçš„å¿«æ·é”®ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;contributes&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;keybindings&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vscode-demo.currentText&quot;</span><span class="punctuation">,</span> <span class="comment">//å¿«æ·é”®ç»‘å®šå‘½ä»¤</span></span><br><span class="line">        <span class="attr">&quot;key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ctrl+f1&quot;</span><span class="punctuation">,</span> </span><br><span class="line">        <span class="attr">&quot;mac&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cmd+f1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;when&quot;</span><span class="punctuation">:</span> <span class="string">&quot;editorHasSelection&quot;</span> <span class="comment">// å‡ºç°æ—¶æœº</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>è®¾ç½®å¥½åï¼Œä½¿ç”¨äº†å¯¹åº”å‘½ä»¤çš„èœå•é¡¹ä¹Ÿä¼šæ˜¾ç¤ºå¯¹åº”å¿«æ·é”®ï¼Œå¦‚å›¾æ‰€ç¤º<br><img src="/images/posts/vscode_extension/20210616230737.png" alt="ç¤ºä¾‹" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>VS Code æ’ä»¶å¼€å‘æŒ‡åŒ— (äºŒ)</title>
    <url>/vscode_extension_two/</url>
    <content><![CDATA[<p>æ¥ç€ä¸Šé¢çš„ç»§ç»­ä»‹ç»ä¸€äº›å¸¸ç”¨çš„ VS Code æ’ä»¶çš„é…ç½®å’Œ APIã€‚</p>
<span id="more"></span>
<h2 id="ä»£ç ç‰‡æ®µ"><a href="#ä»£ç ç‰‡æ®µ" class="headerlink" title="ä»£ç ç‰‡æ®µ"></a>ä»£ç ç‰‡æ®µ</h2><p>åœ¨ package.json å¢åŠ  snippets é…ç½®ã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;snippets&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;language&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vue&quot;</span><span class="punctuation">,</span> <span class="comment">// æŒ‡å®šæ”¯æŒçš„è¯­è¨€</span></span><br><span class="line">        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./snippets/demo.json&quot;</span> <span class="comment">// æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>åœ¨ snippets æ–‡ä»¶å¤¹ä¸‹åˆ›å»º demo.json æ–‡ä»¶ï¼Œä»£ç æ ¼å¼å¦‚ä¸‹</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ç‰‡æ®µåç§°&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä»£ç ç‰‡æ®µè§¦å‘å‰ç¼€&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="string">&quot;ç‰‡æ®µå†…å®¹&quot;</span> <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä»£ç ç‰‡æ®µæè¿°&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¤ºä¾‹</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;selectCheckBox&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;select-check-box&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;body&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;&lt;select-check-box v-model=&#x27;$&#123;1:search.statusList&#125;&#x27;  :sourceOpt=&#x27;$&#123;2:statusOpt&#125;&#x27; @change=&#x27;$&#123;3:getList(1)&#125;&#x27; title=&#x27;$&#123;4:çŠ¶æ€&#125;&#x27;&gt;&lt;/select-check-box&gt;&quot;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¤šé€‰ä¸‹æ‹‰æ¡†&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>ç‰‡æ®µä¸­çš„ ${1:xxx} æ˜¯å ä½ç¬¦ï¼Œæ•°å­—è¡¨ç¤ºå…‰æ ‡èšç„¦çš„é¡ºåºï¼Œ1è¡¨ç¤ºé»˜è®¤å…‰æ ‡è½åœ¨è¿™é‡Œï¼ŒæŒ‰ä¸‹å›è½¦æˆ–è€…tabè·³åˆ°2çš„ä½ç½®ï¼Œä»¥æ­¤ç±»æ¨ï¼Œxxx è¡¨ç¤ºæ­¤ä½ç½®çš„é»˜è®¤å€¼ï¼Œå¯çœç•¥ï¼Œæ¯”å¦‚ç›´æ¥å†™$3ã€‚ä¸€ä¸ªç‰‡æ®µé‡Œå¯ä»¥è®¾ç½®å¤šä¸ªç›¸åŒçš„å ä½ç¬¦ï¼Œæ¥åŒæ—¶ä¿®æ”¹å¤šå‡ºå ä½å¤„ã€‚ç‰‡æ®µä¸­ä¹Ÿæ˜¯æ”¯æŒä½¿ç”¨ VS Code å†…ç½®çš„å¾ˆå¤šå˜é‡çš„ï¼Œæ¯”å¦‚å¯ä»¥æ ¹æ®è·å–å½“å‰é€‰æ‹©çš„å€¼(${TM_SELECTED_TEXT}) å¡«å……åˆ°ä»£ç ç‰‡æ®µä¸­ã€‚</p>
<p>å ä½ç¬¦å‡ ç§ä½¿ç”¨</p>
<ul>
<li>$1 åªæ˜¾ç¤ºå…‰æ ‡</li>
<li>${1:xxxx} é»˜è®¤ä½¿ç”¨ xxx å¡«å……</li>
<li>${1|a,b,c|} å½“å…‰æ ‡åœ¨æ­¤å¤„æ—¶ æä¾› a,b,c ä¸‰ä¸ªé€‰æ‹©ç»™é€‰æ‹©</li>
<li>${1:${TM_SELECTED_TEXT}} ä½¿ç”¨å†…ç½®çš„å˜é‡å ä½</li>
</ul>
<p>å¸¸ç”¨ç”¨çš„å˜é‡ï¼Œ<a href="https://code.visualstudio.com/docs/editor/variables-reference#_environment-variables">æŸ¥çœ‹æ›´å¤šå˜é‡</a></p>
<ul>
<li>TM_SELECTED_TEXTå½“å‰é€‰å®šçš„æ–‡æœ¬æˆ–ç©ºå­—ç¬¦ä¸²</li>
<li>TM_CURRENT_LINEå½“å‰è¡Œçš„å†…å®¹</li>
<li>TM_CURRENT_WORDå…‰æ ‡ä¸‹çš„å•è¯æˆ–ç©ºå­—ç¬¦ä¸²çš„å†…å®¹</li>
<li>TM_LINE_INDEXåŸºäºé›¶ç´¢å¼•çš„è¡Œå·</li>
<li>TM_LINE_NUMBERåŸºäºå•ç´¢å¼•çš„è¡Œå·</li>
<li>TM_FILENAMEå½“å‰æ–‡æ¡£çš„æ–‡ä»¶å</li>
<li>TM_FILENAME_BASEæ²¡æœ‰æ‰©å±•åçš„å½“å‰æ–‡æ¡£çš„æ–‡ä»¶å</li>
<li>TM_DIRECTORYå½“å‰æ–‡æ¡£çš„ç›®å½•</li>
<li>TM_FILEPATHå½“å‰æ–‡æ¡£çš„å®Œæ•´æ–‡ä»¶è·¯å¾„</li>
<li>CLIPBOARDå‰ªè´´æ¿çš„å†…å®¹</li>
<li>CURRENT_YEARå½“å‰å¹´ä»½</li>
<li>CURRENT_YEAR_SHORTå½“å‰å¹´ä»½çš„æœ€åä¸¤ä½æ•°å­—</li>
<li>CURRENT_MONTHä¸¤ä¸ªæ•°å­—çš„æœˆä»½ï¼ˆä¾‹å¦‚â€™02â€™ï¼‰</li>
<li>CURRENT_MONTH_NAMEæœˆä»½çš„å…¨åï¼ˆä¾‹å¦‚â€œä¸ƒæœˆâ€ï¼‰</li>
<li>CURRENT_MONTH_NAME_SHORTæœˆä»½çš„ç®€ç§°ï¼ˆä¾‹å¦‚â€™Julâ€™ï¼‰</li>
<li>CURRENT_DATEæ¯æœˆçš„æŸä¸€å¤©</li>
<li>CURRENT_DAY_NAMEå¤©çš„åç§°ï¼ˆä¾‹å¦‚â€™æ˜ŸæœŸä¸€â€™ï¼‰</li>
<li>CURRENT_DAY_NAME_SHORTå½“å¤©çš„ç®€ç§°ï¼ˆä¾‹å¦‚â€™Monâ€™ï¼‰</li>
<li>CURRENT_HOUR 24å°æ—¶åˆ¶æ ¼å¼çš„å½“å‰å°æ—¶</li>
<li>CURRENT_MINUTEå½“å‰åˆ†é’Ÿ</li>
<li>CURRENT_SECONDå½“å‰ç§’</li>
</ul>
<h2 id="æ’ä»¶é…ç½®"><a href="#æ’ä»¶é…ç½®" class="headerlink" title="æ’ä»¶é…ç½®"></a>æ’ä»¶é…ç½®</h2><p>åœ¨ configuration ä¸­é…ç½®çš„å†…å®¹ä¼šæš´éœ²ç»™ç”¨æˆ·ï¼Œç”¨æˆ·å¯ä»¥ä»â€œç”¨æˆ·è®¾ç½®â€å’Œâ€œå·¥ä½œåŒºè®¾ç½®â€ä¸­ä¿®æ”¹ä½ æš´éœ²çš„é€‰é¡¹ã€‚configuration æ˜¯ JSON æ ¼å¼çš„é”®å€¼å¯¹ï¼Œç”¨æˆ·ä¼šåœ¨ä¿®æ”¹è®¾ç½®æ—¶è·å¾—å¯¹åº”çš„æç¤ºå’Œæ›´å¥½çš„ä½“éªŒã€‚</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="comment">// package.json</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;contributes&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;configuration&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;object&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;title&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ˜¾ç¤ºåœ¨é…ç½®é¡µå·¦ä¾§æ ‡é¢˜&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;demo.showtick&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;boolean&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;default&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é…ç½®demo&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ’ä»¶å†…è·å–å’Œä¿®æ”¹å½“å‰æ’ä»¶é…ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å¦‚æœå½“å‰é…ç½®æ²¡æœ‰å€¼ é»˜è®¤è¿”å› undefined</span></span><br><span class="line"><span class="keyword">const</span> result = vscode.<span class="property">workspace</span>.<span class="title function_">getConfiguration</span>().<span class="title function_">get</span>(<span class="string">&#x27;demo.showtick&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¿®æ”¹é…ç½® ç¬¬ä¸‰ä¸ªå‚æ•°å¦‚æœä¼ true åˆ™ä¿®æ”¹å…¨å±€é…ç½®ï¼Œfalseåªä¿®æ”¹å½“å‰å·¥ä½œåŒºé…ç½®</span></span><br><span class="line">vscode.<span class="property">workspace</span>.<span class="title function_">getConfiguration</span>().<span class="title function_">update</span>(<span class="string">&#x27;demo.showtick&#x27;</span>, <span class="literal">false</span>, <span class="literal">true</span>);</span><br></pre></td></tr></table></figure>

<h2 id="æ‰“åŒ…å‘å¸ƒ"><a href="#æ‰“åŒ…å‘å¸ƒ" class="headerlink" title="æ‰“åŒ…å‘å¸ƒ"></a>æ‰“åŒ…å‘å¸ƒ</h2><p>å¦‚æœåªæ˜¯è‡ªå·±ä½¿ç”¨å¯ä»¥ç›´æ¥æ‰“åŒ…æœ¬åœ°å®‰è£…ï¼Œå‘å¸ƒåˆ°æ’ä»¶å¸‚åœºæ„Ÿè§‰åˆ›å»ºå‘å¸ƒå‰æœŸè¿˜æ˜¯æœ‰ç‚¹ç¹ççš„ã€‚</p>
<h3 id="æœ¬åœ°æ‰“åŒ…"><a href="#æœ¬åœ°æ‰“åŒ…" class="headerlink" title="æœ¬åœ°æ‰“åŒ…"></a>æœ¬åœ°æ‰“åŒ…</h3><p><strong>vsce</strong> æ˜¯ä¸€ä¸ªç”¨äºå°†æ’ä»¶å‘å¸ƒåˆ°å¸‚åœºä¸Šçš„å‘½ä»¤è¡Œå·¥å…·ã€‚ä¸è®ºæ˜¯æœ¬åœ°æ‰“åŒ…è¿˜æ˜¯è¦å‘å¸ƒåˆ°æ’ä»¶å¸‚åœºéƒ½éœ€è¦ä½¿ç”¨è¿™ä¸ªå·¥å…·</p>
<p>é¦–å…ˆå®‰è£…vsce</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install -g vsce</span><br></pre></td></tr></table></figure>
<p>æ‰“åŒ…æˆvsixåŒ…</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vsce package</span><br></pre></td></tr></table></figure>
<h3 id="å‘å‡ºæ’ä»¶å¸‚åœº"><a href="#å‘å‡ºæ’ä»¶å¸‚åœº" class="headerlink" title="å‘å‡ºæ’ä»¶å¸‚åœº"></a>å‘å‡ºæ’ä»¶å¸‚åœº</h3><p>å‘å¸ƒåˆ°æ’ä»¶å¸‚åœºæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯åœ¨ VS Code æ’ä»¶å¸‚åœºç›´æ¥å‘å¸ƒ vsix åŒ…ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨ vsce å‘å¸ƒ</p>
<h4 id="åœ¨æ’ä»¶å¸‚åœºå‘å¸ƒ"><a href="#åœ¨æ’ä»¶å¸‚åœºå‘å¸ƒ" class="headerlink" title="åœ¨æ’ä»¶å¸‚åœºå‘å¸ƒ"></a>åœ¨æ’ä»¶å¸‚åœºå‘å¸ƒ</h4><p>é¦–å…ˆåœ¨ <a href="https://marketplace.visualstudio.com/VSCode">æ’ä»¶å¸‚åœº</a> ç™»å½•ä½ çš„è´¦å·ï¼Œå¯ä»¥ä½¿ç”¨ github è´¦æˆ·æˆ–è€… Microsoftè´¦æˆ·ç™»å½•<br><img src="/images/posts/vscode_extension_two/20210623231124.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>åˆ›å»ºå‘å¸ƒè€…ï¼ˆè¿™é‡Œéœ€è¦ç¿»å¢™ï¼‰ï¼Œè¿™é‡Œå‘å¸ƒè€… ID éœ€è¦å’Œæ’ä»¶ package.json çš„ publisher ä¿æŒä¸€è‡´ã€‚<br><img src="/images/posts/vscode_extension_two/20210623230340.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br><img src="/images/posts/vscode_extension_two/20210623230642.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>ä¸Šä¼ vsixåŒ…æ–‡ä»¶<br><img src="/images/posts/vscode_extension_two/20210623231651.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h4 id="ä½¿ç”¨vsceå‘å¸ƒ"><a href="#ä½¿ç”¨vsceå‘å¸ƒ" class="headerlink" title="ä½¿ç”¨vsceå‘å¸ƒ"></a>ä½¿ç”¨vsceå‘å¸ƒ</h4><p>ä½¿ç”¨ vsce å‘å¸ƒé¦–å…ˆéœ€è¦ ä¸€ä¸ªå¾®è½¯ <strong>Azure</strong> è´¦æˆ·ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª <strong>Azure DevOps</strong>ï¼Œç„¶ååœ¨ç»„ç»‡é‡Œåˆ›å»ºå‘å¸ƒ Tokenï¼Œç„¶åå°±èƒ½ä½¿ç”¨ vsce å‘å¸ƒæ’ä»¶ã€‚</p>
<p>é¦–å…ˆæ‰“å¼€  <a href="https://dev.azure.com/">azure</a> ï¼Œç›´æ¥ä½¿ç”¨å¾®è½¯è´¦æˆ·ç™»å½•åˆ›å»ºä¸€ä¸ªç»„ç»‡ã€‚æŒ‰ç…§æ­¥éª¤é»˜è®¤ä¼šåˆ›å»ºä¸€ä¸ªä»¥é‚®ç®±å‰ç¼€ä¸ºåçš„ç»„ç»‡ã€‚<br>åˆ›å»ºå®Œå<br><img src="/images/posts/vscode_extension_two/20210623232915.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>åˆ›å»º tonken,ç„¶åå°†ç”Ÿæˆtonkenä¿å­˜ä¸‹æ¥<br><img src="/images/posts/vscode_extension_two/20210623233248.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>ç„¶åéœ€è¦åˆ›å»ºä¸€ä¸ª publisherï¼Œ ä»¥å‰å¯ä»¥ vsce ç›´æ¥åˆ›å»º ï¼Œæ–°çš„ä¸åœ¨æ”¯æŒäº†ï¼Œåªèƒ½é€šè¿‡åœ¨ä¸Šä¸€ç§æ–¹å¼åœ¨ç½‘é¡µåˆ›å»ºäº†ã€‚<br>åˆ›å»ºå¥½åå°±å¯ä»¥åœ¨ä½¿ç”¨ vsce publish å‘½ä»¤å‘å¸ƒæ’ä»¶ï¼Œè¿™ä¸ªæ—¶å€™ä¼šæç¤ºéœ€è¦ tonkenï¼Œå°†åˆšåˆšç”Ÿæˆå¤åˆ¶ä¸Šå»ã€‚å¯ä»¥çœ‹åˆ°æ’ä»¶å·²ç»å‘å¸ƒä¸Šå»äº†ã€‚<br><img src="/images/posts/vscode_extension_two/20210623234418.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="å‘å¸ƒæ³¨æ„äº‹é¡¹"><a href="#å‘å¸ƒæ³¨æ„äº‹é¡¹" class="headerlink" title="å‘å¸ƒæ³¨æ„äº‹é¡¹"></a>å‘å¸ƒæ³¨æ„äº‹é¡¹</h3><ul>
<li>README.md æ–‡ä»¶é»˜è®¤ä¼šæ˜¾ç¤ºåœ¨æ’ä»¶ä¸»é¡µï¼Œä¸”é‡Œé¢è¿æ¥éœ€è¦æ˜¯ https çš„</li>
<li>CHANGELOG.md ä¼šæ˜¾ç¤ºåœ¨å˜æ›´é€‰é¡¹å¡</li>
</ul>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vscode</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue ä¸­çš„ mixin,component,render,hoc</title>
    <url>/vue_hoc/</url>
    <content><![CDATA[<p>åœ¨é¡¹ç›®ä¸­ï¼Œä¸€èˆ¬æˆ‘ä»¬ç»å¸¸ä¼šåŸºäºä¸€å¥—ç°æœ‰ç»„ä»¶åº“è¿›è¡Œå¿«é€Ÿå¼€å‘ï¼Œä½†æ˜¯ç°å®ä¸­å¾€å¾€éœ€è¦å¯¹ç»„ä»¶åº“è¿›è¡Œå®šåˆ¶åŒ–æ”¹é€ äºŒæ¬¡å°è£…</p>
<span id="more"></span>

<h2 id="æ··å…¥-mixin"><a href="#æ··å…¥-mixin" class="headerlink" title="æ··å…¥(mixin)"></a>æ··å…¥(mixin)</h2><p>vue å®˜æ–¹ä»‹ç»</p>
<blockquote>
<p>æ··å…¥ (mixin) æä¾›äº†ä¸€ç§éå¸¸çµæ´»çš„æ–¹å¼ï¼Œæ¥åˆ†å‘ Vue ç»„ä»¶ä¸­çš„å¯å¤ç”¨åŠŸèƒ½ã€‚ä¸€ä¸ªæ··å…¥å¯¹è±¡å¯ä»¥åŒ…å«ä»»æ„ç»„ä»¶é€‰é¡¹ã€‚å½“ç»„ä»¶ä½¿ç”¨æ··å…¥å¯¹è±¡æ—¶ï¼Œæ‰€æœ‰æ··å…¥å¯¹è±¡çš„é€‰é¡¹å°†è¢«â€œæ··åˆâ€è¿›å…¥è¯¥ç»„ä»¶æœ¬èº«çš„é€‰é¡¹ã€‚</p>
</blockquote>
<p>ç®€å•æ¥è¯´å°±æ˜¯å°†ç»„ä»¶çš„å¯¹è±¡çš„å±æ€§ï¼Œæ–¹æ³•ï¼Œé’©å­å‡½æ•°ç­‰ç­‰è¿›è¡Œæå–å°è£…ï¼Œä»¥ä¾¿è¾¾åˆ°å¯ä»¥å¤šå‡ºå¤ç”¨ã€‚æ¥çœ‹ä¸€ä¸ªç®€å•ä¾‹å­</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:v-loading</span>=<span class="string">&#x27;isLoading&#x27;</span> <span class="attr">:data</span>=<span class="string">&quot;tableData&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>  <span class="attr">ref</span>=<span class="string">&quot;table&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">width</span>=<span class="string">&quot;55&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;name&quot;</span> <span class="attr">label</span>=<span class="string">&quot;è§„åˆ™åç§°&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;description&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æè¿°&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;count&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æœåŠ¡è°ƒç”¨æ¬¡æ•°(ä¸‡)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span> <span class="attr">label</span>=<span class="string">&quot;çŠ¶æ€&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;&#123;row&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;run-state&#x27;,row.state]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#123;&#123; row.state==&#x27;close&#x27;?&#x27;å…³é—­&#x27;:&#x27;è¿è¡Œä¸­&#x27; &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;time&quot;</span> <span class="attr">label</span>=<span class="string">&quot;ä¸Šæ¬¡è°ƒåº¦æ—¶é—´&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;æ“ä½œ&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span>ç¼–è¾‘<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span>è®¢é˜…è­¦æŠ¥<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">el-pagination</span> <span class="attr">:current-page.sync</span>=<span class="string">&quot;page.pageIndex&quot;</span> <span class="attr">:page-sizes</span>=<span class="string">&quot;[20, 30, 40, 50]&quot;</span> @<span class="attr">size-change</span>=<span class="string">&quot;(e)=&gt;page.pageSize=e&quot;</span> <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span> <span class="attr">layout</span>=<span class="string">&quot;total, sizes, prev, pager, next, jumper&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    data () &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">tableData</span>:[],</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">isLoading</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">total</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">page</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">pageSize</span>: <span class="number">20</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">pageIndex</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">watch</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&#x27;page&#x27;</span>:&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">deep</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">immediate</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">handler</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="title function_">getList</span>()</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">getList</span>(<span class="params">pageIndex = <span class="variable language_">this</span>.page.pageIndex,pageSize = <span class="variable language_">this</span>.page.pageSize</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//è·å–åˆ—è¡¨æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">tableData</span> = <span class="title class_">MockData</span>();</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">total</span>=<span class="number">300</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">2000</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢æ˜¯ä¸ªå¸¸è§æŠ¥è¡¨åˆ†é¡µä½¿ç”¨åœºæ™¯ï¼Œå‡å¦‚æœ‰å¾ˆå¤šä¸ªè¡¨æŠ¥ï¼Œé‚£å°±éœ€è¦å†™å¾ˆå¤šæ¬¡åˆ†é¡µçš„é€»è¾‘ï¼Œæ­£å¸¸å¼€å‘ä¸­å½“ç„¶ä¸å¯èƒ½è¿™ä¹ˆå¤„ç†çš„ï¼Œè¿™ç§æƒ…å†µå°±å¯ä»¥ä½¿ç”¨ mixins æ¥æå–åˆ†é¡µçš„é€»è¾‘ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mixins.js</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data () &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">isLoading</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">total</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">page</span>: &#123;</span><br><span class="line">                <span class="attr">pageSize</span>: <span class="number">20</span>,</span><br><span class="line">                <span class="attr">pageIndex</span>: <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">watch</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;page&#x27;</span>:&#123;</span><br><span class="line">            <span class="attr">deep</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">immediate</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="title function_">handler</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">getList</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:v-loading</span>=<span class="string">&#x27;isLoading&#x27;</span> <span class="attr">:data</span>=<span class="string">&quot;tableData&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>  <span class="attr">ref</span>=<span class="string">&quot;table&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">width</span>=<span class="string">&quot;55&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;name&quot;</span> <span class="attr">label</span>=<span class="string">&quot;è§„åˆ™åç§°&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;description&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æè¿°&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;count&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æœåŠ¡è°ƒç”¨æ¬¡æ•°(ä¸‡)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span> <span class="attr">label</span>=<span class="string">&quot;çŠ¶æ€&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;&#123;row&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;run-state&#x27;,row.state]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    &#123;&#123; row.state==&#x27;close&#x27;?&#x27;å…³é—­&#x27;:&#x27;è¿è¡Œä¸­&#x27; &#125;&#125;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;time&quot;</span> <span class="attr">label</span>=<span class="string">&quot;ä¸Šæ¬¡è°ƒåº¦æ—¶é—´&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;æ“ä½œ&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span>ç¼–è¾‘<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span>è®¢é˜…è­¦æŠ¥<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">el-pagination</span> <span class="attr">:current-page.sync</span>=<span class="string">&quot;page.pageIndex&quot;</span> <span class="attr">:page-sizes</span>=<span class="string">&quot;[20, 30, 40, 50]&quot;</span> @<span class="attr">size-change</span>=<span class="string">&quot;(e)=&gt;page.pageSize=e&quot;</span> <span class="attr">:total</span>=<span class="string">&quot;page.total&quot;</span> <span class="attr">layout</span>=<span class="string">&quot;total, sizes, prev, pager, next, jumper&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">PageMixins</span> <span class="keyword">from</span> <span class="string">&quot;./mixins.js&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">mixins</span>:[<span class="title class_">PageMixins</span>],</span></span><br><span class="line"><span class="language-javascript">    data () &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">tableData</span>:[]</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">getList</span>(<span class="params">pageIndex = <span class="variable language_">this</span>.page.pageIndex,pageSize = <span class="variable language_">this</span>.page.pageSize</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//è·å–åˆ—è¡¨æ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">tableData</span> = <span class="title class_">MockData</span>();</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">total</span>=<span class="number">300</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">isLoading</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">2000</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±å°†åˆ†é¡µçš„é€»è¾‘åˆ†ç¦»å‡ºæ¥äº†ï¼Œä¹Ÿå¯ä»¥è¢«å…¶ä»–ç»„ä»¶æ··å…¥ä½¿ç”¨ï¼Œå¤§å¤§çš„å‡å°‘äº†ä»£ç é‡ï¼Œå½“ç„¶ mixin è¿‡åº¦æ»¥ç”¨ä¹Ÿæ˜¯å­˜åœ¨ç¼ºç‚¹çš„ã€‚</p>
<ul>
<li>å‘½åå†²çª<br>  ä½¿ç”¨ mixins æ˜¯å°†ä¸¤ä¸ªç»„ä»¶å¯¹è±¡åˆå¹¶çš„ï¼Œå½“ä¸¤ä¸ªç»„ä»¶å±æ€§åé‡å¤æ—¶å€™ï¼Œvue é»˜è®¤ä¼šå°†æœ¬åœ°ç»„ä»¶çš„å±æ€§è¦†ç›– mixin çš„ï¼Œè™½ç„¶ vue æä¾›äº†åˆå¹¶ç­–ç•¥é…ç½®ï¼Œä½†æ˜¯åŒæ—¶å­˜åœ¨å¤šä¸ª mixin å­˜åœ¨å‘½åå†²çªæ—¶å€™å°±ä¼šå˜å¾—å¤„ç†èµ·æ¥éå¸¸éº»çƒ¦äº†ã€‚</li>
<li>éšå«çš„ä¾èµ–å…³ç³»<br>  å¾ˆæ˜æ˜¾ä¸Šé¢çš„ç»„ä»¶æ˜¯ä¾èµ–äº mixin çš„ï¼Œè¿™ç§æƒ…å†µä¼šå­˜åœ¨æ½œåœ¨é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬ä»¥åæƒ³é‡æ„ä¸€ä¸ªç»„ä»¶ï¼Œæ”¹å˜äº† mixin éœ€è¦çš„å˜é‡çš„åç§°ï¼Œå°±ä¼šå½±å“ç°æœ‰çš„ç»„ä»¶çš„ä½¿ç”¨äº†ï¼Œè€Œä¸”å½“é¡¹ç›®ä¸­ä½¿ç”¨äº†å¾ˆå¤šè¿™ä¸ª mixin çš„æ—¶å€™ï¼Œå°±åªèƒ½å»æ‰‹åŠ¨æœç´¢ä¿®æ”¹äº†ï¼Œå› ä¸ºä¸çŸ¥é“å“ªäº›ç»„ä»¶ä½¿ç”¨äº†è¿™äº› mixinã€‚</li>
</ul>
<h2 id="ç»„ä»¶å°è£…"><a href="#ç»„ä»¶å°è£…" class="headerlink" title="ç»„ä»¶å°è£…"></a>ç»„ä»¶å°è£…</h2><p>ä¸Šé¢è¡¨æ ¼è¿˜æœ‰ä¸­å¤„ç†æ–¹æ³•ï¼Œå°±æ˜¯å°† el-table å’Œ el-pagination å°è£…æˆä¸€ä¸ªç»„ä»¶å»æ˜¯ä½¿ç”¨ï¼Œä¹Ÿèƒ½æé«˜å¤ç”¨æ€§ã€‚</p>
<h3 id="templateå°è£…"><a href="#templateå°è£…" class="headerlink" title="templateå°è£…"></a>templateå°è£…</h3><p>ä½¿ç”¨ template åˆ›å»ºç»„ä»¶ï¼Œæ¥å¯¹ el-table è¿›è¡ŒäºŒæ¬¡å°è£…æ»¡è¶³ä¸Šé¢éœ€æ±‚ï¼Œå¢åŠ ä¸€ä¸ª total å‚æ•°<br>æä¾›æ˜¯ä¸€ä¸ªåˆ†é¡µæ”¹å˜äº‹ä»¶ï¼Œå†æŠŠ m-table çš„ $attrs å’Œ $listeners ç»‘å®šåˆ° el-table ä¸Šï¼Œç„¶åæŠŠ el-table æ–¹æ³•æš´éœ²å‡ºå»ï¼Œè¿™æ ·å°±å¯åƒä½¿ç”¨ el-table ä¸€æ ·ä½¿ç”¨ m-tableã€‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">ref</span>=<span class="string">&quot;table&quot;</span> <span class="attr">v-bind</span>=<span class="string">&quot;$attrs&quot;</span> <span class="attr">v-on</span>=<span class="string">&quot;$listeners&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-pagination</span> <span class="attr">:current-page.sync</span>=<span class="string">&quot;page.pageIndex&quot;</span> <span class="attr">:page-sizes</span>=<span class="string">&quot;[20, 30, 40, 50]&quot;</span> @<span class="attr">size-change</span>=<span class="string">&quot;(e)=&gt;page.pageSize=e&quot;</span> <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span> <span class="attr">layout</span>=<span class="string">&quot;total, sizes, prev, pager, next, jumper&quot;</span>&gt;</span> <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;m-table&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">page</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">pageSize</span>: <span class="number">20</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">pageIndex</span>: <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">total</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">default</span>: <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">watch</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">page</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">deep</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">handler</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.$emit(<span class="string">&quot;page-chagne&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å°†el-table æ–¹æ³•æš´éœ²å‡ºå»</span></span></span><br><span class="line"><span class="language-javascript">        ...(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> methodsJson = &#123;&#125;;</span></span><br><span class="line"><span class="language-javascript">            [<span class="string">&#x27;reloadData&#x27;</span>, <span class="string">&#x27;clearSelection&#x27;</span>, <span class="string">&#x27;toggleRowSelection&#x27;</span>, <span class="string">&#x27;toggleAllSelection&#x27;</span>, <span class="string">&#x27;setCurrentRow&#x27;</span>, <span class="string">&#x27;clearSort&#x27;</span>, <span class="string">&#x27;clearFilter&#x27;</span>, <span class="string">&#x27;doLayout&#x27;</span>, <span class="string">&#x27;sort&#x27;</span>]</span></span><br><span class="line"><span class="language-javascript">                .<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    methodsJson = &#123;</span></span><br><span class="line"><span class="language-javascript">                        ...methodsJson, [key](...res) &#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">this</span>.<span class="property">$refs</span>[<span class="string">&#x27;table&#x27;</span>][key].<span class="title function_">apply</span>(<span class="variable language_">this</span>, res);</span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                    &#125;;</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> methodsJson;</span></span><br><span class="line"><span class="language-javascript">        &#125;)()</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ m-table</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">m-table</span> @<span class="attr">page-chagne</span>=<span class="string">&quot;GetTableDataList()&quot;</span> <span class="attr">:total</span>=<span class="string">&quot;page.total&quot;</span> <span class="attr">:data</span>=<span class="string">&quot;tableData&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">width</span>=<span class="string">&quot;55&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;name&quot;</span> <span class="attr">label</span>=<span class="string">&quot;è§„åˆ™åç§°&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;description&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æè¿°&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;count&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æœåŠ¡è°ƒç”¨æ¬¡æ•°(ä¸‡)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span> <span class="attr">label</span>=<span class="string">&quot;çŠ¶æ€&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;&#123;row&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">:class</span>=<span class="string">&quot;[&#x27;run-state&#x27;,row.state]&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            &#123;&#123; row.state==&#x27;close&#x27;?&#x27;å…³é—­&#x27;:&#x27;è¿è¡Œä¸­&#x27; &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;time&quot;</span> <span class="attr">label</span>=<span class="string">&quot;ä¸Šæ¬¡è°ƒåº¦æ—¶é—´&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;æ“ä½œ&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span>ç¼–è¾‘<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-divider</span> <span class="attr">direction</span>=<span class="string">&quot;vertical&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-divider</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span>è®¢é˜…è­¦æŠ¥<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">m-table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä¸€èˆ¬æƒ…å†µä¸‹è¿™æ ·ä½¿ç”¨ template å°è£…å°±æ»¡è¶³äº†éœ€æ±‚ï¼Œä½†æ˜¯æ€»æœ‰äº›æ—¶å€™è¿™æ ·å°è£…æ˜¯æ»¡è¶³ä¸äº†éœ€æ±‚çš„ã€‚æ¯”å¦‚ç°åœ¨ m-table ç°åœ¨éœ€è¦åŠ¨æ€æ”¯æŒä¿®æ”¹é…ç½®æ˜¾ç¤ºåˆ—ï¼Œå¹¶ä¸”ä¸å¸Œæœ›ä¿®æ”¹ m-table çš„åŸºæœ¬ä½¿ç”¨æ–¹å¼ï¼Œ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ä½¿ç”¨ render äº†ã€‚</p>
<h3 id="render-å‡½æ•°"><a href="#render-å‡½æ•°" class="headerlink" title="render å‡½æ•°"></a>render å‡½æ•°</h3><p>Vue çš„æ¨¡æ¿å®é™…ä¸Šéƒ½ä¼šè¢«ç¼–è¯‘æˆäº†æ¸²æŸ“å‡½æ•°ï¼Œrender å‡½æ•°æœ‰ä¸€ä¸ª createElement å‚æ•°ï¼Œç”¨æ¥åˆ›å»ºä¸€ä¸ª VNodeã€‚</p>
<p>è¦æ»¡è¶³ä¸Šé¢çš„éœ€æ±‚ï¼Œé¦–å…ˆæ˜¯çš„è·å¾— el-table çš„æ’æ§½(slot)ä¸­çš„å†…å®¹ï¼Œæ ¹æ®æ’æ§½çš„å†…å®¹ç”Ÿæˆæ¯åˆ—ä¿¡æ¯ï¼Œæ ¹æ®é…ç½®çš„ä¿¡æ¯åŠ¨æ€åˆ›å»ºæ’æ§½çš„å†…å®¹å°±å¯ä»¥å®ç°äº†ã€‚ç®€å•ç¤ºä¾‹ä»£ç å…¥ä¸‹</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> mSetting <span class="keyword">from</span> <span class="string">&#x27;./setting&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123; mSetting &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;m-table&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">showTable</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">setShow</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">config</span>: [],</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">copySlots</span>: [], <span class="comment">// å±•ç¤ºsoltæ•°æ®</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">page</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">pageSize</span>: <span class="number">20</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">pageIndex</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">total</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="title class_">Number</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">default</span>: <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">watch</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">page</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">deep</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">handler</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.$emit(<span class="string">&quot;page-chagne&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">initConfig</span>()</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> (</span></span><br><span class="line"><span class="language-javascript">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">ref</span>=<span class="string">&quot;table&quot;</span> &#123;<span class="attr">...</span>&#123; <span class="attr">attrs:</span> <span class="attr">this.</span>$<span class="attr">attrs</span> &#125;&#125; &#123;<span class="attr">...</span>&#123; <span class="attr">on:</span> <span class="attr">this.</span>$<span class="attr">listeners</span> &#125;&#125;&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        this.copySlots</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                &#123;this.showTable ? (<span class="tag">&lt;<span class="name">el-pagination</span> <span class="attr">layout</span>=<span class="string">&quot;total, sizes, prev, pager, next, jumper&quot;</span></span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="language-javascript">                    &#123;<span class="attr">...</span>&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="language-javascript">                        <span class="attr">on:</span> &#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="language-javascript">                            &#x27;<span class="attr">size-change</span>&#x27;<span class="attr">:</span> (<span class="attr">e</span>) =&gt;</span> this.page.pageSize = e,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            &#x27;current-change&#x27;: (e) =&gt; this.page.pageIndex = e</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#125;&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#123;...&#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        attrs: &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            &#x27;current-page&#x27;: this.page.pageIndex,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            &#x27;page-sizes&#x27;: [20, 30, 40, 50],</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            &#x27;total&#x27;: this.total</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#125;&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                &gt; <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span>) : null&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                <span class="tag">&lt;<span class="name">m-setting</span>  &#123;<span class="attr">...</span>&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="language-javascript">                    <span class="attr">on:</span> &#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml"><span class="language-javascript">                        &#x27;<span class="attr">update:show</span>&#x27;<span class="attr">:</span> <span class="attr">e</span> =&gt;</span> this.setShow = e,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        &#x27;change&#x27;: this.initConfig</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                &#125;&#125; show=&#123;this.setShow&#125; config=&#123;this.config&#125;&gt;<span class="tag">&lt;/<span class="name">m-setting</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            &lt;/div &gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">        )</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">    &#125;,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">    methods: &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">        initConfig(config = []) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            if (config.length === 0) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                config = this.$slots.default</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    .filter(item =&gt; item.componentOptions &amp;&amp; item.componentOptions.tag === &quot;el-table-column&quot;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    .map(item =&gt; &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        if (item.componentOptions.propsData.prop === &#x27;index&#x27;) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            if (!item.data.scopedSlots) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                                item.data.scopedSlots = &#123;&#125;;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            item.data.scopedSlots.header = () =&gt; (</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                                <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-s-tools&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.setShow = true&#125; /&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            );</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        return &#123; ...item.componentOptions.propsData &#125;;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#125;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                this.sourceConfig = JSON.parse(JSON.stringify(config))</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                this.copySlots = this.$slots.default;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                this.sourceSlots = this.$slots.default;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            &#125; else &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                let arr = []</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                this.sourceSlots.forEach(item =&gt; &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    let temp = config.find(subItem =&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        (subItem.prop &amp;&amp; subItem.prop === item.componentOptions.propsData.prop) ||</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        (subItem.type &amp;&amp; subItem.type === item.componentOptions.propsData.type)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    );</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    if (temp &amp;&amp; temp.isShow) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        Object.assign(item.componentOptions.propsData, temp);</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        arr.push(item)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                &#125;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                this.copySlots = arr;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                this.showTable = false</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                this.$nextTick(() =&gt; &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    this.showTable = true</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                &#125;)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            this.config = config;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">        &#125;,</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">        ...(() =&gt; &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            let methodsJson = &#123;&#125;;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            [&#x27;reloadData&#x27;, &#x27;clearSelection&#x27;, &#x27;toggleRowSelection&#x27;, &#x27;toggleAllSelection&#x27;, &#x27;setCurrentRow&#x27;, &#x27;clearSort&#x27;, &#x27;clearFilter&#x27;, &#x27;doLayout&#x27;, &#x27;sort&#x27;]</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                .forEach(key =&gt; &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    methodsJson = &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        ...methodsJson, [key](...res) &#123;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                            this.$refs[&#x27;table&#x27;][key].apply(this, res);</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                        &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                    &#125;;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">                &#125;);</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">            return methodsJson;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">        &#125;)()</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">    &#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript">&#125;</span></span></span><br><span class="line"><span class="language-xml"><span class="language-javascript"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">&quot;è¡¨æ ¼è®¾ç½®&quot;</span> <span class="attr">:visible.sync</span>=<span class="string">&quot;shows&quot;</span> <span class="attr">width</span>=<span class="string">&quot;600px&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> <span class="attr">:before-close</span>=<span class="string">&quot;handleClose&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;list&quot;</span> <span class="attr">size</span>=<span class="string">&#x27;mini&#x27;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;showLabel&quot;</span> <span class="attr">label</span>=<span class="string">&quot;åç§°&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;label&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æ˜¾ç¤ºåç§°&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;&#123;row&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;row.label&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;isShow&quot;</span> <span class="attr">label</span>=<span class="string">&quot;æ˜¯å¦æ˜¾ç¤º&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot-scope</span>=<span class="string">&quot;&#123;row&#125;&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">el-switch</span> <span class="attr">v-model</span>=<span class="string">&quot;row.isShow&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-switch</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;shows = false&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span>&gt;</span>å– æ¶ˆ<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleClose()&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span>&gt;</span>ç¡® å®š<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;m-setting&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">list</span>: []</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">shows</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">get</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">show</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">set</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.$emit(<span class="string">&quot;update:show&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">show</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">required</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">default</span>: <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">config</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="title class_">Array</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">default</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> []</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">init</span>()</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">init</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">list</span> = <span class="variable language_">this</span>.<span class="property">config</span>.<span class="title function_">map</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    ...item,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">showLabel</span>: item.<span class="property">showLabel</span> || item.<span class="property">label</span>, <span class="comment">// åç§°</span></span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">isShow</span>: item.<span class="property">isShow</span> || <span class="literal">true</span> <span class="comment">// æ˜¯å¦æ˜¾ç¤º</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">handleClose</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;change&#x27;</span>, <span class="variable language_">this</span>.<span class="property">list</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">shows</span> = <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·å°±ç®€å•å®ç°äº†å¯ä»¥åŠ¨æ€æ˜¾ç¤ºåˆ—ï¼Œè€Œä¸”ä¸éœ€è¦å»ä¿®æ”¹åŸç»„ä»¶çš„ä½¿ç”¨æ–¹å¼äº†ã€‚</p>
<h2 id="hoc-é«˜é˜¶ç»„ä»¶"><a href="#hoc-é«˜é˜¶ç»„ä»¶" class="headerlink" title="hoc é«˜é˜¶ç»„ä»¶"></a>hoc é«˜é˜¶ç»„ä»¶</h2><p><a href="http://hcysun.me/2018/01/05/%E6%8E%A2%E7%B4%A2Vue%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/">vueé«˜é˜¶ç»„ä»¶å¯ä»¥å‚è€ƒè¿™ç¯‡</a></p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>keep-alive ä¸ router-view</title>
    <url>/vue_keep_alive/</url>
    <content><![CDATA[<p>keep-alive ç”¨äºç¼“å­˜ä¸æ´»åŠ¨çš„ç»„ä»¶å®ä¾‹ï¼Œrouter-view ä¸€ä¸ª functional ç»„ä»¶ï¼Œæ¸²æŸ“è·¯å¾„åŒ¹é…åˆ°çš„è§†å›¾ç»„ä»¶ã€‚è¿™é‡Œå¯¹ä¸¤è€…ç»“åˆä½¿ç”¨æ—¶é‡åˆ°å‡ ç§æƒ…å†µåšä¸ªç®€å•è®°å½•</p>
<span id="more"></span>

<h2 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h2><p>å±æ€§ï¼š</p>
<ul>
<li>include - å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚åªæœ‰åç§°åŒ¹é…çš„ç»„ä»¶ä¼šè¢«ç¼“å­˜ã€‚</li>
<li>exclude - å­—ç¬¦ä¸²æˆ–æ­£åˆ™è¡¨è¾¾å¼ã€‚ä»»ä½•åç§°åŒ¹é…çš„ç»„ä»¶éƒ½ä¸ä¼šè¢«ç¼“å­˜ã€‚</li>
<li>max - æ•°å­—ã€‚æœ€å¤šå¯ä»¥ç¼“å­˜å¤šå°‘ç»„ä»¶å®ä¾‹ã€‚</li>
</ul>
<p>ç¼“å­˜ç»„ä»¶åä¸º aï¼Œb çš„ç»„ä»¶ï¼Œæ’é™¤ç»„æˆåä¸º c çš„</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">:include</span>=<span class="string">&quot;[&#x27;a&#x27;,&#x27;b&#x27;]&quot;</span> <span class="attr">:exclude</span>=<span class="string">&quot;[&#x27;c&#x27;]&quot;</span> <span class="attr">:max</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="ç»“åˆrouter-viewä½¿ç”¨"><a href="#ç»“åˆrouter-viewä½¿ç”¨" class="headerlink" title="ç»“åˆrouter-viewä½¿ç”¨"></a>ç»“åˆrouter-viewä½¿ç”¨</h2><p>å¦‚æœç›´æ¥è¢«åŒ…åœ¨ keep-alive é‡Œé¢ï¼Œæ‰€æœ‰è·¯å¾„åŒ¹é…åˆ°çš„è§†å›¾ç»„ä»¶éƒ½ä¼šè¢«ç¼“å­˜</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå®ç°æ€»æ˜¯ä¼šæœ‰å…¶ä»–ä¸åŒçš„éœ€æ±‚çš„</p>
<ul>
<li>æ¯”å¦‚åªç¼“å­˜æŸäº›ç»„ä»¶</li>
<li>æˆ–è€…ç›¸åŒè·¯ç”±ä¸åŒå‚æ•°éœ€è¦åˆ†å¼€ç¼“å­˜<!-- - åˆæˆ–è€…ä¸åŒè·¯ç”±ä½¿ç”¨ç›¸åŒç»„ä»¶ä¸€ä¸ªç¼“å­˜å¦ä¸€ä¸ªä¸éœ€è¦ç¼“å­˜ --></li>
<li>â€¦</li>
</ul>
<h3 id="ç¼“å­˜éƒ¨åˆ†ç»„ä»¶"><a href="#ç¼“å­˜éƒ¨åˆ†ç»„ä»¶" class="headerlink" title="ç¼“å­˜éƒ¨åˆ†ç»„ä»¶"></a>ç¼“å­˜éƒ¨åˆ†ç»„ä»¶</h3><p>æŒ‡å®šåªç¼“å­˜éƒ¨åˆ†ç»„ä»¶ï¼Œç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ã€‚ å¯ä»¥åœ¨ router.meta ä¸­å¢åŠ éœ€è¦ç¼“å­˜æ ‡è¯†ï¼Œç„¶åä½¿ç”¨<br>include æŒ‡å®šéœ€è¦ç¼“å­˜ç»„ä»¶</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">keep-alive</span> <span class="attr">:include</span>=<span class="string">&quot;include&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">include</span>: []</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">watch</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            $route(route) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> &#123; meta &#125; = route</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span> (meta.<span class="property">cache</span> &amp;&amp; !<span class="variable language_">this</span>.<span class="property">include</span>.<span class="title function_">includes</span>(meta.<span class="property">name</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="variable language_">this</span>.<span class="property">include</span>.<span class="title function_">push</span>(meta.<span class="property">name</span>)</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">// route è·¯ç”±æ•°ç»„</span><br><span class="line">[&#123;</span><br><span class="line">    path: &#x27;home&#x27;,</span><br><span class="line">    name: &quot;home&quot;,</span><br><span class="line">    meta:&#123;</span><br><span class="line">        name:&#x27;ç»„ä»¶åç§°&#x27;,</span><br><span class="line">        cache:true  //è®¾ç½®éœ€è¦ç¼“å­˜</span><br><span class="line">    &#125;,</span><br><span class="line">    component: () =&gt; import(&#x27;@/views/home&#x27;)</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    path: &#x27;/login&#x27;,</span><br><span class="line">    name: &#x27;login&#x27;,</span><br><span class="line">    meta:&#123;</span><br><span class="line">        name:&#x27;ç»„ä»¶åç§°&#x27;,</span><br><span class="line">        cache:true</span><br><span class="line">    &#125;,</span><br><span class="line">    component: () =&gt; import(&#x27;@/views/login&#x27;),</span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
<p>è¿™ç§æ–¹å¼éœ€è¦çŸ¥é“ç»„ä»¶çš„ nameï¼Œå½“é¡¹ç›®è¾ƒå¤§æ—¶å€™ï¼Œç»™è·¯ç”±åŒ¹é…ä¸Šå¯¹åº”ç»„ä»¶ name ä¹Ÿæ˜¯ä»¶æŒºç¹ççš„äº‹ã€‚æ”¹è¿›ä¸€ä¸‹ä½¿ç”¨ä¸¤ä¸ª router-view ç»„ä»¶ï¼Œä¸€ä¸ªç”¨ keep-alive åŒ…è£¹è¿›è¡Œç¼“å­˜ï¼Œä¸€ä¸ªä¸ç¼“å­˜ã€‚è¿™æ ·å°±ä¸éœ€è¦ä¾‹ä¸¾å‡ºéœ€è¦è¢«ç¼“å­˜ç»„ä»¶åç§°</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">router-view</span>  <span class="attr">v-if</span>=<span class="string">&quot;$route.meta.cache&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">router-view</span> <span class="attr">v-if</span>=<span class="string">&quot;!$route.meta.cache&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="ç›¸åŒè·¯ç”±ä¸åŒå‚æ•°"><a href="#ç›¸åŒè·¯ç”±ä¸åŒå‚æ•°" class="headerlink" title="ç›¸åŒè·¯ç”±ä¸åŒå‚æ•°"></a>ç›¸åŒè·¯ç”±ä¸åŒå‚æ•°</h3><p>å½“æœ‰ä¸€ä¸ªè·¯ç”±ä¸º &#x2F;params&#x2F;:id ï¼Œæ‰“å¼€ &#x2F;params&#x2F;1ã€&#x2F;params&#x2F;2 ã€&#x2F;params&#x2F;xxx æ­£å¸¸æƒ…å†µä¸‹ vue ä¼šå¯¹å…¶è¿›è¡Œå¤ç”¨ï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦å¯¹å…¶åˆ†å¼€ç¼“å­˜ã€‚ è¿™ä¸ªæ—¶å€™å¯ä»¥ç»™ router-view æŒ‡å®š key</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">router-view</span> <span class="attr">:key</span>=<span class="string">&quot;$route.fullPath&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>$route.fullPath : å®Œæˆè§£æåçš„ URLï¼ŒåŒ…å«æŸ¥è¯¢å‚æ•°å’Œ hash çš„å®Œæ•´è·¯å¾„ã€‚æ‰€ä»¥æ¯ä¸ªè·¯å¾„éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šå…¶ä»–çš„å€¼ï¼Œåªéœ€è¦ä¿æŒå”¯ä¸€å°±å¯ä»¥äº†</p>
<!-- ### ä¸åŒè·¯ç”±ä½¿ç”¨ç›¸åŒç»„ä»¶
å½“éƒ½éœ€è¦ç¼“å­˜çš„æ—¶å€™ï¼Œå’Œæ­£å¸¸æƒ…å†µä¸€æ ·å¤„ç†å°±å¯ä»¥äº†ã€‚ä½†æ˜¯å½“ä¸€ä¸ªéœ€è¦ç¼“å­˜ä¸€ä¸ªä¸éœ€è¦ç¼“å­˜æ—¶å€™ï¼ˆæ²¡æœ‰çš„è¿™ä¹ˆå¥‡è‘©è¦æ±‚ï¼Œä½†æ˜¯è¢«é¢è¯•é—®ç­”è¿‡ï¼‰ -->
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>vue ä½¿ç”¨ä¸­çš„å°æŠ€å·§ ï¼ˆä¸€ï¼‰</title>
    <url>/vue_use1/</url>
    <content><![CDATA[<p>åœ¨ vue çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šé‡åˆ°å„ç§åœºæ™¯ï¼Œå½“æ™®é€šä½¿ç”¨æ—¶è§‰å¾—æ²¡ä»€ä¹ˆï¼Œä½†æ˜¯æˆ–è®¸ä¼˜åŒ–ä¸€ä¸‹å¯ä»¥æ›´é«˜æ•ˆæ›´ä¼˜ç¾çš„è¿›è¡Œå¼€å‘ã€‚ä¸‹é¢æœ‰ä¸€äº›æˆ‘åœ¨æ—¥å¸¸å¼€å‘çš„æ—¶å€™ç”¨åˆ°çš„å°æŠ€å·§</p>
<span id="more"></span>

<h2 id="data-å’Œ-Object-freeze"><a href="#data-å’Œ-Object-freeze" class="headerlink" title="data å’Œ Object.freeze"></a>data å’Œ Object.freeze</h2><p>æ¯ä¸ª Vue å®ä¾‹éƒ½ä¼šä»£ç†å…¶ data å¯¹è±¡é‡Œæ‰€æœ‰çš„å±æ€§ï¼Œè¿™äº›è¢«ä»£ç†çš„æ•°æ®æ˜¯å“åº”å¼çš„ï¼Œåœ¨å…¶æ•°æ®æ”¹å˜æ—¶è§†å›¾ä¹Ÿä¼šéšä¹‹æ›´æ–°ã€‚<br>åœ¨æ¯ä¸ª vue ç»„ä»¶ä¸­éƒ½æœ‰ä¸€ä¸ª data å¯¹è±¡ï¼Œä¸è¦æŠŠæ‰€æœ‰æ•°æ®éƒ½æ”¾åœ¨ data ä¸­ã€‚åªæŠŠéœ€è¦åšå“åº”å¼çš„æ•°æ®æ”¾åœ¨ data å¯¹è±¡ä¸­ï¼›åŸå› æ˜¯ï¼šå¦‚æœä¸€ä¸ªæ•°æ®å­˜åœ¨äº data ä¸­ï¼Œæ•°æ®ä¼šè¢«åŠ«æŒï¼Œvue ä¼šç»™æ•°æ®æ·»åŠ ä¸€ä¸ª getterï¼ˆè·å–æ•°æ®ï¼‰ï¼Œä¸€ä¸ª setterï¼ˆè®¾ç½®æ•°æ®ï¼‰ï¼Œæ€§èƒ½ä¸ä¼šé«˜ã€‚<br>å¯ä»¥æŠŠä¸€äº›ä¸éœ€è¦å“åº”çš„æ•°æ®ç›´æ¥æ”¾åˆ°å®ä¾‹ä¸Šï¼Œè€Œä¸æ˜¯åœ¨ data é‡Œ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// ä¸éœ€è¦åšå“åº”çš„æ•°æ®</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span>=[...]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">list2</span>:[...]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Object.freeze() æ–¹æ³•å¯ä»¥å†»ç»“ä¸€ä¸ªå¯¹è±¡ã€‚ä¸€ä¸ªè¢«å†»ç»“çš„å¯¹è±¡å†ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ï¼›å†»ç»“äº†ä¸€ä¸ªå¯¹è±¡åˆ™ä¸èƒ½å‘è¿™ä¸ªå¯¹è±¡æ·»åŠ æ–°çš„å±æ€§ï¼Œä¸èƒ½åˆ é™¤å·²æœ‰å±æ€§ï¼Œä¸èƒ½ä¿®æ”¹è¯¥å¯¹è±¡å·²æœ‰å±æ€§çš„å¯æšä¸¾æ€§ã€å¯é…ç½®æ€§ã€å¯å†™æ€§ï¼Œä»¥åŠä¸èƒ½ä¿®æ”¹å·²æœ‰å±æ€§çš„å€¼ã€‚æ­¤å¤–ï¼Œå†»ç»“ä¸€ä¸ªå¯¹è±¡åè¯¥å¯¹è±¡çš„åŸå‹ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ã€‚freeze() è¿”å›å’Œä¼ å…¥çš„å‚æ•°ç›¸åŒçš„å¯¹è±¡</p>
</blockquote>
<p>å¯¹äºä¸€äº›ä¸éœ€è¦å“åº”åˆ—è¡¨æ•°æ®ï¼Œä¹Ÿå¯ä»¥ç”¨ Object.freeze() å¤„ç†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> &#123; </span><br><span class="line">        <span class="attr">list</span>: []</span><br><span class="line">   &#125;</span><br><span class="line">&#125;,</span><br><span class="line">created () &#123;</span><br><span class="line">    <span class="keyword">let</span> listData = <span class="title class_">Object</span>.<span class="title function_">freeze</span>([</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="number">1</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">value</span>: <span class="number">2</span> &#125;</span><br><span class="line">        ])</span><br><span class="line">    <span class="comment">// å†»ç»“ listData </span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span> = listData;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç•Œé¢ä¸ä¼šæœ‰å“åº”</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span>[<span class="number">0</span>].<span class="property">value</span> = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸‹é¢ä¸¤ç§åšæ³•ï¼Œç•Œé¢éƒ½ä¼šå“åº”ï¼Œåªæ˜¯å†»ç»“ listData æ²¡æœ‰å†»ç»“ this.list</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span> = [</span><br><span class="line">        &#123; <span class="attr">value</span>: <span class="number">100</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">value</span>: <span class="number">200</span> &#125;</span><br><span class="line">    ];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">list</span> = <span class="title class_">Object</span>.<span class="title function_">freeze</span>([</span><br><span class="line">        &#123; <span class="attr">value</span>: <span class="number">100</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">value</span>: <span class="number">200</span> &#125;</span><br><span class="line">    ]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¼˜é›…å¤„ç†äº‹ä»¶ç›‘å¬å’Œç§»é™¤"><a href="#ä¼˜é›…å¤„ç†äº‹ä»¶ç›‘å¬å’Œç§»é™¤" class="headerlink" title="ä¼˜é›…å¤„ç†äº‹ä»¶ç›‘å¬å’Œç§»é™¤"></a>ä¼˜é›…å¤„ç†äº‹ä»¶ç›‘å¬å’Œç§»é™¤</h2><p>æœ‰æ—¶å€™æˆ‘ä»¬ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯,éœ€è¦è‡ªå·±å»ç›‘å¬ä¸€äº›äº‹ä»¶ä»€ä¹ˆçš„ï¼Œå¯èƒ½ä¼šåƒä¸‹é¢è¿™ä¸ªå†™ï¼Œä½†æ˜¯æœ‰æ—¶å€™å¯èƒ½å› ä¸º mounted å’Œ destroyed ä¸å†ä¸€ä¸ªä½ç½®å•¥çš„ï¼Œå¯¼è‡´å¿˜è®°æ¸…é™¤å¯¹äº‹ä»¶ç›‘å¬ã€‚å¯ä»¥åˆ©ç”¨ hook å»ç›‘å¬é’©å­äº‹ä»¶å°†å®ƒä»¬å†™åœ¨ä¸€èµ·</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="variable language_">this</span>.<span class="property">func</span>)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="title function_">destroyed</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="variable language_">this</span>.<span class="property">func</span>)</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="title function_">func</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ›´æ”¹å</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="variable language_">this</span>.<span class="property">func</span>)</span><br><span class="line">    <span class="variable language_">this</span>.$once(<span class="string">&quot;hook:beforeDestroy&quot;</span>, <span class="function">()=&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;resize&#x27;</span>, <span class="variable language_">this</span>.<span class="property">func</span>)</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="title function_">func</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="sync-ä¿®é¥°ç¬¦"><a href="#sync-ä¿®é¥°ç¬¦" class="headerlink" title=".sync ä¿®é¥°ç¬¦"></a>.sync ä¿®é¥°ç¬¦</h2><p>åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å¯¹ä¸€ä¸ª <strong>prop</strong> è¿›è¡Œâ€œåŒå‘ç»‘å®šâ€ã€‚ ä¸å¹¸çš„æ˜¯ï¼ŒçœŸæ­£çš„åŒå‘ç»‘å®šä¼šå¸¦æ¥ç»´æŠ¤ä¸Šçš„é—®é¢˜ï¼Œå› ä¸ºå­ç»„ä»¶å¯ä»¥ä¿®æ”¹çˆ¶ç»„ä»¶ï¼Œä¸”åœ¨çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶éƒ½æ²¡æœ‰æ˜æ˜¾çš„æ”¹åŠ¨æ¥æºã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æ¨èä»¥ <strong>update:myPropName</strong> çš„æ¨¡å¼è§¦å‘äº‹ä»¶å–è€Œä»£ä¹‹ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨ä¸€ä¸ªåŒ…å« <strong>show</strong> prop çš„å‡è®¾çš„ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•è¡¨è¾¾å¯¹å…¶èµ‹æ–°å€¼çš„æ„å›¾ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.$emit(<span class="string">&#x27;update:show&#x27;</span>, newShow)</span><br></pre></td></tr></table></figure>
<p>çˆ¶ç»„ä»¶å¯ä»¥ç›‘å¬é‚£ä¸ªäº‹ä»¶å¹¶æ ¹æ®éœ€è¦æ›´æ–°ä¸€ä¸ªæœ¬åœ°çš„æ•°æ®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;dialog  v-<span class="attr">bind</span>:title=<span class="string">&quot;show&quot;</span>  v-<span class="attr">on</span>:<span class="attr">update</span>:show=<span class="string">&quot;show = $event&quot;</span>&gt;&lt;/dialog&gt;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ .sync ç®€å†™ </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;dialog :title.<span class="property">sync</span>=<span class="string">&quot;doc.title&quot;</span>&gt;&lt;/dialog&gt;</span><br></pre></td></tr></table></figure>

<h2 id="å±æ€§äº‹ä»¶ä¼ é€’"><a href="#å±æ€§äº‹ä»¶ä¼ é€’" class="headerlink" title="å±æ€§äº‹ä»¶ä¼ é€’"></a>å±æ€§äº‹ä»¶ä¼ é€’</h2><p>æœ‰æ—¶å€™éœ€è¦å¯¹ä¸€äº›ç»„ä»¶è¿›è¡Œæ›´é«˜å±‚æ¬¡å°è£…ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªæ™®é€šè¡¨æ ¼ç»„ä»¶ï¼Œéœ€è¦å®ç°èƒ½æœ‰è¡Œå†…ç¼–è¾‘ç­‰ä¸€äº›åŠŸèƒ½æ—¶å€™ï¼Œå°±éœ€è¦å¯¹è¡¨æ ¼è¿›è¡ŒäºŒæ¬¡å°è£…ã€‚åƒè¡¨æ ¼ç»„ä»¶å±æ€§è¾ƒå¤šæ—¶ï¼Œéœ€è¦ä¸€ä¸ªä¸ªå»ä¼ é€’ï¼Œéå¸¸ä¸å‹å¥½å¹¶ä¸”è´¹æ—¶</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">BaseTable</span> <span class="attr">v-bind</span>=<span class="string">&quot;$props&quot;</span> <span class="attr">v-on</span>=<span class="string">&quot;$listeners&quot;</span>&gt;</span> <span class="comment">&lt;!-- ... --&gt;</span> <span class="tag">&lt;/<span class="name">BaseTable</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">import</span> <span class="title class_">BaseTable</span> <span class="keyword">from</span> <span class="string">&quot;./BaseTable&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">components</span>: &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="title class_">BaseTable</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä¼ é€’å±æ€§å’Œäº‹ä»¶çš„æ–¹ä¾¿æ€§ï¼Œè€Œä¸ç”¨ä¸€ä¸ªä¸ªå»ä¼ é€’,è¿˜æœ‰$attrsï¼ˆpropsã€classã€style é™¤å¤–çš„å…¶ä»– attribute ï¼‰å¯ä»¥ä½¿ç”¨</p>
<h2 id="Watchçš„åˆå§‹ç«‹å³æ‰§è¡Œ"><a href="#Watchçš„åˆå§‹ç«‹å³æ‰§è¡Œ" class="headerlink" title="Watchçš„åˆå§‹ç«‹å³æ‰§è¡Œ"></a>Watchçš„åˆå§‹ç«‹å³æ‰§è¡Œ</h2><p>å½“ watch ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œåˆå§‹åŒ–æ—¶å¹¶ä¸ä¼šæ‰§è¡Œï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼Œä½ éœ€è¦åœ¨ created çš„æ—¶å€™æ‰‹åŠ¨è°ƒç”¨ä¸€æ¬¡ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="title function_">search</span>();</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">  <span class="title function_">searchText</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">search</span>()</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™æ ·çš„åšæ³•å¯ä»¥ä½¿ç”¨ï¼Œä½†å¾ˆéº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ  immediate å±æ€§ï¼Œè¿™æ ·åˆå§‹åŒ–çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨è§¦å‘(ä¸ç”¨å†å†™ created å»è°ƒç”¨äº†)ï¼Œç„¶åä¸Šé¢çš„ä»£ç å°±èƒ½ç®€åŒ–ä¸º</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">  <span class="attr">searchText</span>: &#123;</span><br><span class="line">    <span class="title function_">handler</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">search</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">immediate</span>: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ Vue3 æ„å»º Web Components</title>
    <url>/vue_web_components/</url>
    <content><![CDATA[<p>æœ‰æ—¶å€™æƒ³å†™ä¸€ä¸ªæ— å…³æ¡†æ¶ç»„ä»¶ï¼Œåˆä¸æƒ³ç”¨åŸç”Ÿæˆ–è€… Jquery é‚£å¥—å»å†™ï¼Œè€Œä¸”è¿˜è¦é¿å…æ ·å¼å†²çªï¼Œç”¨ Web Components å»åšåˆšè§‰å°±æŒºåˆé€‚çš„ã€‚ä½†æ˜¯ç°åœ¨ Web Components ä½¿ç”¨èµ·æ¥è¿˜æ˜¯ä¸å¤Ÿçµæ´»ï¼Œå¾ˆå¤šåœ°æ–¹è¿˜æ˜¯ä¸å¤ªæ–¹ä¾¿çš„ï¼Œå¦‚æœèƒ½å’Œ MVVM æ­é…ä½¿ç”¨å°±å¥½äº†ã€‚æ—©åœ¨ä¹‹å‰ Angular å°±æ”¯æŒå°†ç»„ä»¶æ„å»ºæˆ Web Componentsï¼Œ<strong>Vue3 3.2+</strong> å¼€å§‹ç»ˆäºæ”¯æŒå°†ç»„å»ºæ„å»ºæˆ Web Components äº†ã€‚æ­£å¥½æœ€è¿‘æƒ³é‡æ„ä¸‹è¯„è®ºæ’ä»¶ï¼Œäºæ˜¯ä¸Šæ‰‹è¯•äº†è¯•ã€‚</p>
<span id="more"></span>
<h2 id="æ„å»º-Web-Components"><a href="#æ„å»º-Web-Components" class="headerlink" title="æ„å»º Web Components"></a>æ„å»º Web Components</h2><p>vue æä¾›äº†ä¸€ä¸ª <strong>defineCustomElement</strong> æ–¹æ³•ï¼Œç”¨æ¥å°† vue ç»„ä»¶è½¬æ¢æˆä¸€ä¸ªæ‰©å±•è‡³HTMLElementçš„è‡ªå®šä¹‰å‡½æ•°æ„é€ å‡½æ•°ï¼Œä½¿ç”¨æ–¹å¼å’Œ <strong>defineComponent</strong> å‚æ•°apiåŸºæœ¬ä¿æŒä¸€è‡´ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; defineCustomElement &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyVueElement</span> = <span class="title function_">defineCustomElement</span>(&#123;</span><br><span class="line">  <span class="comment">// åœ¨æ­¤æä¾›æ­£å¸¸çš„ Vue ç»„ä»¶é€‰é¡¹</span></span><br><span class="line">  <span class="attr">props</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">emits</span>: &#123;&#125;,</span><br><span class="line">  <span class="attr">template</span>: <span class="string">`...`</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// defineCustomElement ç‹¬æœ‰ç‰¹æ€§: CSS ä¼šè¢«æ³¨å…¥åˆ°éšå¼æ ¹ (shadow root) ä¸­</span></span><br><span class="line">  <span class="attr">styles</span>: [<span class="string">`/* inlined css */`</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œ Web Components</span></span><br><span class="line">customElements.<span class="title function_">define</span>(<span class="string">&#x27;my-vue-element&#x27;</span>, <span class="title class_">MyVueElement</span>)</span><br></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦ä½¿ç”¨å•æ–‡ä»¶ï¼Œéœ€è¦ <strong>@vitejs&#x2F;plugin-vue@^1.4.0</strong> æˆ– <strong>vue-loader@^16.5.0</strong> æˆ–æ›´é«˜ç‰ˆæœ¬å·¥å…·ã€‚å¦‚æœåªæ˜¯éƒ¨åˆ†æ–‡ä»¶éœ€è¦ä½¿ç”¨ï¼Œå¯ä»¥å°†åç¼€æ”¹ä¸º <strong>.ce.vue</strong> ã€‚è‹¥æœéœ€è¦å°†æ‰€æœ‰æ–‡ä»¶éƒ½æ„å»º <strong>Web Components</strong> å¯ä»¥å°† <strong>@vitejs&#x2F;plugin-vue@^1.4.0</strong> æˆ– <strong>vue-loader@^16.5.0</strong> çš„ <strong>customElement</strong> é…ç½®é¡¹å¼€å¯ã€‚è¿™æ ·ä¸éœ€è¦å†ä½¿ç”¨ <strong>.ce.vue</strong> åç¼€åäº†ã€‚</p>
<h3 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h3><p>vue ä¼šæŠŠæ‰€æœ‰çš„çš„ props è‡ªå®šä¹‰å…ƒç´ çš„å¯¹è±¡çš„ property ä¸Šï¼Œä¹Ÿä¼šå°†è‡ªå®šä¹‰å…ƒç´ æ ‡ç­¾ä¸Šçš„ attribute åšä¸€ä¸ªæ˜ å°„ã€‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">com-demo</span> <span class="attr">type</span>=<span class="string">&quot;a&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">com-demo</span>&gt;</span></span><br><span class="line"></span><br><span class="line">props:&#123;</span><br><span class="line">  type:String</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å› ä¸º HTML çš„ <strong>attribute</strong> çš„åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œé™¤äº†åŸºç¡€ç±»å‹(Booleanã€Number) Vue åœ¨æ˜ å°„æ—¶ä¼šå¸®å¿™åšç±»å‹è½¬æ¢ï¼Œå…¶ä»–å¤æ‚ç±»å‹åˆ™éœ€è¦è®¾ç½®åˆ° DOM property ä¸Šã€‚</p>
<h3 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h3><p>åœ¨è‡ªå®šä¹‰å…ƒç´ ä¸­ï¼Œé€šè¿‡ <strong>this.$emit</strong> æˆ–åœ¨ <strong>setup</strong> ä¸­çš„ <strong>emit</strong> å‘å‡ºçš„äº‹ä»¶ä¼šè¢«è°ƒåº¦ä¸ºåŸç”Ÿ <a href="https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events#adding_custom_data_%E2%80%93_customevent">CustomEvents</a>ã€‚é™„åŠ çš„äº‹ä»¶å‚æ•° (payload) ä¼šä½œä¸ºæ•°ç»„æš´éœ²åœ¨ CustomEvent å¯¹è±¡çš„ details property ä¸Šã€‚</p>
<h3 id="æ’æ§½"><a href="#æ’æ§½" class="headerlink" title="æ’æ§½"></a>æ’æ§½</h3><p>ç¼–å†™ç»„ä»¶æ—¶ï¼Œå¯ä»¥æƒ³ vue ä¸€æ ·ï¼Œä½†æ˜¯ä½¿ç”¨æ—¶åªèƒ½åŸç”Ÿçš„æ’æ§½è¯­æ³•ï¼Œæ‰€ä»¥ä¹Ÿä¸åœ¨æ”¯æŒä½œç”¨åŸŸæ’æ§½ã€‚</p>
<h3 id="å­ç»„ä»¶æ ·å¼é—®é¢˜"><a href="#å­ç»„ä»¶æ ·å¼é—®é¢˜" class="headerlink" title="å­ç»„ä»¶æ ·å¼é—®é¢˜"></a>å­ç»„ä»¶æ ·å¼é—®é¢˜</h3><p>ä½¿ç”¨å­ç»„ä»¶åµŒå¥—çš„æ—¶ï¼Œæœ‰ä¸ªå‘çš„åœ°æ–¹å°±æ˜¯é»˜è®¤ä¸ä¼šå°†å­ç»„ä»¶é‡Œçš„æ ·å¼æŠ½ç¦»å‡ºæ¥ã€‚</p>
<p>çˆ¶ç»„ä»¶</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Childer</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Childer</span> <span class="keyword">from</span> <span class="string">&quot;./childer.vue&quot;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">components</span>: &#123; <span class="title class_">Childer</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">title</span>: <span class="string">&quot;çˆ¶ç»„ä»¶&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å­ç»„ä»¶</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;childer&quot;</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">title</span>: <span class="string">&quot;å­ç»„ä»¶&quot;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.childer</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#222</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: bold;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å­ç»„ä»¶çš„æ ·å¼æ²¡æœ‰æ’å…¥è¿›å»ï¼Œä½†æ˜¯æ ·å¼éš”ç¦»çš„æ ‡è¯†æ˜¯æœ‰ç”Ÿæˆçš„ data-v-5e87e937ã€‚ä¸çŸ¥é“vueå®˜æ–¹åç»­ä¼šä¸ä¼šä¿®å¤è¿™ä¸ªbug</p>
<p><img src="/images/posts/vue_web_components/pic_1637475879404.png" alt="æ’å…¥å›¾ç‰‡" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>ç”ŸæˆHTML</em></p>
<p>æŸ¥çœ‹ç»„ä»¶æ˜¯å¯ä»¥çœ‹åˆ°ï¼Œå­ç»„ä»¶çš„æ ·å¼æ˜¯æœ‰è¢«æŠ½ç¦»å‡ºæ¥çš„ï¼Œè¿™æ ·å°±åªéœ€è¦è‡ªå·±æ³¨å…¥è¿›å»äº†ã€‚</p>
<p><img src="/images/posts/vue_web_components/pic_1637476488307.png" alt="æ’å…¥å›¾ç‰‡" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>å®ä¾‹å¯¹è±¡</em></p>
<p>å°†å­ç»„ä»¶æ ·å¼æŠ½ç¦»æ’å…¥åˆ°çˆ¶ç»„ä»¶é‡Œï¼Œå‚è€ƒ<a href="https://github.com/vuejs/vue-loader/issues/1881">è¿™ä¸ªçš„å®ç°</a></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ComDemo</span> <span class="keyword">from</span> <span class="string">&#x27;~/demo/index.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">deepStylesOf</span> = (<span class="params">&#123; styles = [], components = &#123;&#125; &#125;</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">unique</span> = array =&gt; [...<span class="keyword">new</span> <span class="title class_">Set</span>(array)];</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">unique</span>([...styles, ...<span class="title class_">Object</span>.<span class="title function_">values</span>(components).<span class="title function_">flatMap</span>(deepStylesOf)]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å°†å­ç»„ä»¶æ ·å¼æ’å…¥åˆ°çˆ¶ç»„ä»¶é‡Œ</span></span><br><span class="line"><span class="title class_">ComDemo</span>.<span class="property">styles</span> = <span class="title function_">deepStylesOf</span>(<span class="title class_">ComDemo</span>)</span><br><span class="line"></span><br><span class="line">!customElements.<span class="title function_">get</span>(<span class="string">&#x27;com-demo&#x27;</span>) &amp;&amp; customElements.<span class="title function_">define</span>(<span class="string">&#x27;com-demo&#x27;</span>, <span class="title function_">defineCustomElement</span>(<span class="title class_">ComDemo</span>))</span><br></pre></td></tr></table></figure>
<p>å®Œç¾è§£å†³å­ç»„ä»¶æ ·å¼é—®é¢˜</p>
<p><img src="/images/posts/vue_web_components/pic_1637477447787.png" alt="æ’å…¥å›¾ç‰‡" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><em>æ•ˆæœå›¾</em></p>
<h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p><strong>defineCustomElement</strong> æ„å»ºçš„ç»„ä»¶é»˜è®¤æ˜¯ä¸ä¼šå°†æ–¹æ³•æŒ‚åˆ° <strong>customElement</strong> ä¸Šçš„ï¼Œçœ‹ Vue æºç ä¸­ï¼Œåªæœ‰ _defï¼ˆæ„é€ å‡½æ•°ï¼‰ï¼Œ_instanceï¼ˆç»„ä»¶å®ä¾‹)ï¼‰ã€‚å¦‚æœæƒ³è°ƒç”¨ç»„ä»¶å†…çš„æ–¹æ³•ï¼Œdom._instance.proxy.fun()ï¼Œæ„Ÿè§‰å®åœ¨ä¸å¤ªä¼˜é›…ã€‚<br><img src="/images/posts/vue_web_components/pic_1638631915396.png" alt="vuecode" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'><br>æˆ‘ä»¬å½“ç„¶å¸Œæœ›æˆ‘ä»¬ç»„ä»¶æš´éœ²çš„æ–¹æ³•èƒ½åƒæ™®é€šdomé‚£æ ·ç›´æ¥ dom.fun() å»æ‰ç”¨ï¼Œæˆ‘ä»¬å¯¹ <strong>defineCustomElement</strong> ç¨ä½œæ‰©å±•ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">VueElement</span>, defineComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">defineCustomElement</span> = (<span class="params">options, hydate</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="title class_">Comp</span> = <span class="title function_">defineComponent</span>(options);</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">VueCustomElement</span> <span class="keyword">extends</span> <span class="title class_ inherited__">VueElement</span> &#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params">initialProps</span>) &#123;</span><br><span class="line">            <span class="variable language_">super</span>(<span class="title class_">Comp</span>, initialProps, hydate);</span><br><span class="line">            <span class="keyword">if</span> (<span class="title class_">Comp</span>.<span class="property">methods</span>) &#123;</span><br><span class="line">                <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="title class_">Comp</span>.<span class="property">methods</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="comment">// å°†æ‰€æœ‰éä¸‹åˆ’çº¿å¼€å¤´æ–¹æ³• ç»‘å®šåˆ° å…ƒç´ ä¸Š</span></span><br><span class="line">                    <span class="keyword">if</span>(!<span class="regexp">/^_/</span>.<span class="title function_">test</span>(key))&#123;</span><br><span class="line">                        <span class="variable language_">this</span>[key] = <span class="keyword">function</span> (<span class="params">...res</span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_instance</span>) &#123;</span><br><span class="line">                                <span class="comment">// å°†æ–¹æ³•thiæ”¹ä¸º ç»„ä»¶å®ä¾‹çš„proxy</span></span><br><span class="line">                                <span class="keyword">return</span> <span class="title class_">Comp</span>.<span class="property">methods</span>[key].<span class="title function_">call</span>(<span class="variable language_">this</span>.<span class="property">_instance</span>.<span class="property">proxy</span>, ...res)</span><br><span class="line">                            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&#x27;æœªæ‰¾åˆ°ç»„ä»¶å®ä¾‹&#x27;</span>)</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title class_">VueCustomElement</span>.<span class="property">def</span> = <span class="title class_">Comp</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">VueCustomElement</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»ä½“æ¥è¯´å‘è¿˜æ˜¯æœ‰ä¸å°‘çš„ï¼Œå¦‚æœä»…ä»…éœ€è¦æ„å»ºä¸€äº›æ¯”è¾ƒç®€å•è·¨æ¡†æ¶æ’ä»¶ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼æ¥æ„å»º Web Components ä¹Ÿæ˜¯ä¸€ç§ä¸é”™çš„æ–¹æ¡ˆã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>WebComponents</tag>
      </tags>
  </entry>
  <entry>
    <title>ç€‘å¸ƒæµä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨æ€§èƒ½ä¼˜åŒ–</title>
    <url>/waterfalls_and_visiblelist/</url>
    <content><![CDATA[<p>ç€‘å¸ƒæµç®—æ˜¯æ¯”è¾ƒå¸¸è§çš„å¸ƒå±€äº†ï¼Œä¸€ä¸ªèˆ¬å¸¸è§çºµå‘ç€‘å¸ƒæµçš„äº¤äº’ï¼Œå½“æˆ‘ä»¬æ»šåŠ¨åˆ°åº•çš„æ—¶å€™åŠ è½½ä¸‹ä¸€é¡µçš„æ•°æ®è¿½åŠ åˆ°ä¸Šå»ã€‚å› ä¸ºä¸€æ¬¡åŠ è½½çš„æ•°æ®é‡ä¸æ˜¯å¾ˆå¤šï¼Œé¡µé¢æ“ä½œæ˜¯ä¹Ÿä¸ä¼šæœ‰å¤ªå¤§çš„æ€§èƒ½æ¶ˆè€—ã€‚ä½†æ˜¯å¦‚æœå½“ä½ ä¸€ç›´å¾€ä¸‹æ»šåŠ¨åŠ è½½ï¼ŒåŠ è½½å‡ åé¡µçš„æ—¶å€™ï¼Œå°±ä¼šå¼€å§‹æ„Ÿè§‰ä¸é‚£ä¹ˆæµç•…çš„ï¼Œè¿™æ˜¯å› ä¸ºè™½ç„¶æ¯æ¬¡æ“ä½œçš„å¾ˆå°‘ï¼Œä½†æ˜¯é¡µé¢çš„ DOM è¶Šæ¥è¶Šå¤šï¼Œå†…å­˜å ç”¨ä¹Ÿä¼šå¢å¤§ï¼Œè€Œä¸”å‘ç”Ÿé‡æ’é‡ç»˜æ—¶å€™æµè§ˆå™¨è®¡ç®—é‡è€—æ—¶ä¹Ÿä¼šå¢å¤§ï¼Œå°±å¯¼è‡´äº†æ…¢æ…¢ä¸èƒ½é‚£ä¹ˆæµç•…äº†ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥é€‰æ‹©ç»“åˆè™šæ‹Ÿåˆ—è¡¨æ–¹å¼ä½¿ç”¨ï¼Œè™šæ‹Ÿåˆ—è¡¨æœ¬èº«å°±æ˜¯ç”¨æ¥è§£å†³è¶…é•¿åˆ—è¡¨æ—¶çš„å¤„ç†æ–¹æ¡ˆã€‚</p>
<span id="more"></span>

<h2 id="ç€‘å¸ƒæµ"><a href="#ç€‘å¸ƒæµ" class="headerlink" title="ç€‘å¸ƒæµ"></a>ç€‘å¸ƒæµ</h2><p>ç€‘å¸ƒæµçš„å®ç°æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œå¤§ä½“åˆ†ä¸ºï¼š</p>
<ul>
<li>CSSï¼š CSS å®ç°çš„æœ‰ multi-columnã€grid ï¼ŒCSS å®ç°å­˜åœ¨ä¸€å®šå±€é™æ€§ï¼Œä¾‹å¦‚æ— æ³•è°ƒæ•´é¡ºåºï¼Œå½“å…ƒç´ é«˜åº¦å·®å¼‚è¾ƒå¤§æ—¶å€™ä¸æ˜¯å¾ˆå¥½å¤„ç†å„åˆ—é—´éš”å·®ç­‰ã€‚</li>
<li>JavaScriptï¼šJavaScript å®ç°çš„æœ‰ JavaScript + flexã€JavaScript + positionï¼ŒJavaScript å®ç°å…¼å®¹æ€§è¾ƒå¥½ï¼Œå¯æ§åˆ¶æ€§é«˜ã€‚</li>
</ul>
<p>å› ä¸ºæˆ‘çš„ç€‘å¸ƒæµæ˜¯å¯æå‰è®¡ç®—å…ƒç´ å®½é«˜ï¼Œåˆ—æ•°æ˜¯åŠ¨æ€çš„ï¼Œæ‰€ä»¥é‡‡ç”¨äº† JavaScript + position æ¥é…åˆ è™šæ‹Ÿåˆ—è¡¨ è¿›è¡Œä¼˜åŒ–ã€‚</p>
<h3 id="js-flex-å®ç°"><a href="#js-flex-å®ç°" class="headerlink" title="js + flex å®ç°"></a>js + flex å®ç°</h3><p>å¦‚æœä½ çš„ç€‘å¸ƒæµ åˆ—æ˜¯å›ºå®šï¼Œåˆ—å®½ä¸å›ºå®š çš„ï¼Œä½¿ç”¨ flex æ˜¯ä¸ªå¾ˆå¥½é€‰æ‹©ï¼Œå½“ä½ çš„å®¹å™¨å®½åº¦å˜è¯æ—¶å€™ï¼Œæ¯ä¸€åˆ—å®½åº¦ä¼šè‡ªé€‚åº”ï¼Œå¤§è‡´å®ç°æ–¹å¼</p>
<p>å°†ä½ çš„æ•°æ®åˆ†ä¸ºå¯¹åº”åˆ—æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> data1 = [], <span class="comment">//ç¬¬ä¸€åˆ—</span></span><br><span class="line">    data2 = [], <span class="comment">//ç¬¬äºŒåˆ—</span></span><br><span class="line">    data3 = [], <span class="comment">//ç¬¬ä¸‰åˆ—</span></span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (i &lt; data.<span class="property">length</span>) &#123;</span><br><span class="line">    data1.<span class="title function_">push</span>(data[i++]);</span><br><span class="line">    <span class="keyword">if</span> (i &lt; data.<span class="property">length</span>) &#123;</span><br><span class="line">        data2.<span class="title function_">push</span>(data[i++]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; data.<span class="property">length</span>) &#123;</span><br><span class="line">        data3.<span class="title function_">push</span>(data[i++]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°†ä½ çš„æ¯åˆ—æ•°æ®æ’å…¥è¿›å»å°±å¯ä»¥äº†ï¼Œè®¾ç½® list ä¸º flex å®¹å™¨ï¼Œå¹¶è®¾ç½®ä¸»è½´æ–¹å‘ä¸º row</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ç¬¬ä¸€åˆ— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;column&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- more items--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ç¬¬äºŒåˆ— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;column&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- more items--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ç¬¬ä¸‰åˆ— --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;column&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- more items--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="js-position-å®ç°"><a href="#js-position-å®ç°" class="headerlink" title="js + position å®ç°"></a>js + position å®ç°</h3><p>è¿™ç§æ–¹å¼æ¯”è¾ƒé€‚åˆ åˆ—å®šå®½ï¼Œåˆ—æ•°é‡ä¸å›ºå®šæƒ…å†µï¼Œè€Œä¸”æœ€å¥½èƒ½è®¡ç®—å‡ºæ¯ä¸ªå…ƒç´ çš„å¤§å°ã€‚</p>
<p>å¤§è‡´ HTML ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">&quot;list-item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- more items--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ui</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.list</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.list-item</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>JavaScript éƒ¨åˆ†ï¼Œé¦–å…ˆéœ€è¦è·å– list å®½åº¦ï¼Œæ ¹æ® list.width&#x2F;åˆ—å®½ è®¡ç®—å‡ºåˆ—çš„æ•°é‡ï¼Œç„¶åæ ¹æ®åˆ—æ•°é‡å»åˆ†ç»„æ•°æ®å’Œè®¡ç®—ä½ç½®</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ä»¥åˆ—å®½ä¸º300 é—´éš”ä¸º20 ä¸ºä¾‹</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> catchColumn = (<span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="built_in">parseInt</span>((dom.<span class="property">clientWidth</span> + <span class="number">20</span>) / (<span class="number">300</span> + <span class="number">20</span>)), <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">toTwoDimensionalArray</span> = (<span class="params">count</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> list = []</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> index = <span class="number">0</span>; index &lt; count; index++) &#123;</span><br><span class="line">        list.<span class="title function_">push</span>([])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">minValIndex</span> = (<span class="params">arr = []</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> val = <span class="title class_">Math</span>.<span class="title function_">min</span>(...arr);</span><br><span class="line">    <span class="keyword">return</span> arr.<span class="title function_">findIndex</span>(<span class="function"><span class="params">i</span> =&gt;</span> i === val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç¼“å­˜ç´¯è®¡é«˜åº¦</span></span><br><span class="line"><span class="keyword">let</span> sumHeight = <span class="title function_">toTwoDimensionalArray</span>(catchColumn)</span><br><span class="line"></span><br><span class="line">data.<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–ç´¯è®¡é«˜åº¦æœ€å°é‚£åˆ—</span></span><br><span class="line">    <span class="keyword">const</span> minIndex = <span class="title function_">minValIndex</span>(sumHeight)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> width = <span class="number">0</span> <span class="comment">// è¿™é‡Œå®½é«˜æ›´å…·éœ€æ±‚è®¡ç®—å‡ºæ¥</span></span><br><span class="line">    <span class="keyword">let</span> height = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	item.<span class="property">_top</span> = minIndex * (<span class="number">300</span> + <span class="number">20</span>) <span class="comment">// ç¼“å­˜ä½ç½®ä¿¡æ¯ï¼Œåé¢ä¼šç”¨åˆ°</span></span><br><span class="line">    item.<span class="property">style</span> = &#123;</span><br><span class="line">        <span class="attr">width</span>: width + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">        <span class="attr">height</span>: height + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">        <span class="comment">// è®¡ç®—åç§»ä½ç½®</span></span><br><span class="line">        <span class="attr">transform</span>: <span class="string">`translate(<span class="subst">$&#123;minIndex * (<span class="number">300</span> + <span class="number">20</span>)&#125;</span>px, <span class="subst">$&#123;sumHeight[minIndex]&#125;</span>px)`</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sumHeight[minIndex] = sumHeight[minIndex] + height + <span class="number">20</span> </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="åŠ¨æ€åˆ—æ•°"><a href="#åŠ¨æ€åˆ—æ•°" class="headerlink" title="åŠ¨æ€åˆ—æ•°"></a>åŠ¨æ€åˆ—æ•°</h3><p>å¯ä»¥ä½¿ç”¨ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ResizeObserver">ResizeObserver</a>(ç°ä»£æµè§ˆå™¨å…¼å®¹æ¯”è¾ƒå¥½äº†) ç›‘å¬å®¹å™¨å…ƒç´ å¤§å°å˜åŒ–ï¼Œå½“å®½åº¦å˜åŒ–æ—¶é‡æ–°è®¡ç®—åˆ—æ•°é‡ï¼Œå½“åˆ—æ•°é‡å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°è®¡ç®—æ¯é¡¹çš„ä½ç½®ä¿¡æ¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> observer = <span class="title function_">debounce</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> column = <span class="title function_">updateVisibleContainerInfo</span>(visibleContainer)</span><br><span class="line">    <span class="keyword">if</span> (column !== catchColumn) &#123;</span><br><span class="line">        catchColumn = column</span><br><span class="line">        <span class="comment">// é‡æ–°è®¡ç®—</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">resetLayout</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resizeObserver = <span class="keyword">new</span> <span class="title class_">ResizeObserver</span>(<span class="function"><span class="params">e</span> =&gt;</span> <span class="title function_">observer</span>(e));</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å§‹ç›‘å¬</span></span><br><span class="line">resizeObserver.<span class="title function_">observe</span>(dom);</span><br></pre></td></tr></table></figure>

<h3 id="è¿‡æ¸¡åŠ¨ç”»"><a href="#è¿‡æ¸¡åŠ¨ç”»" class="headerlink" title="è¿‡æ¸¡åŠ¨ç”»"></a>è¿‡æ¸¡åŠ¨ç”»</h3><p>å½“åˆ—æ•°é‡å‘ç”Ÿå˜åŒ–æ—¶å€™ï¼Œå…ƒç´ é¡¹çš„ä½ç½®å¾ˆå¤šéƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¦‚ä¸‹å›¾ï¼Œç¬¬ 4 é¡¹çš„ä½ç½®ä»ç¬¬ 3 åˆ—å˜åˆ°äº†ç¬¬ 4 é¡¹ï¼Œå¦‚æœä¸åšå¤„ç†ä¼šæ˜¾å¾—æ¯”è¾ƒåƒµç¡¬ã€‚</p>
<p align="center">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 460 298" width="460" height="298">
    <rect x="0" y="0" width="460" height="298" fill="#ffffff">
    </rect>
    <g stroke-linecap="round" transform="translate(10 113) rotate(0 220 87.5)">
        <path d="M-0.49 0.17 C99.14 1.36, 198.27 0.42, 439.01 -0.6 M-0.08 -0.06 C124.83 -1.08, 249.03 -1.15, 439.88 -0.3 M441.52 -1.12 C441.14 56.74, 440.97 108.16, 440.42 174.59 M440.47 0.31 C441.08 41.11, 441.73 83.9, 439.17 175.32 M440.53 174.55 C306.2 173.35, 173.32 173.64, -0.03 175.37 M439.94 175.07 C325.72 174.97, 210.49 174.53, 0.34 174.72 M-1.31 173.92 C-1.32 128.03, -0.73 80.94, -0.75 0.21 M-0.02 174.92 C-0.93 132.04, -1.82 87, 0.93 0.03" stroke="#000000" stroke-width="2" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(19 10) rotate(0 46 58.5)">
        <path d="M0.34 0.61 C36.77 1.67, 70.84 -1.52, 90.79 -0.34 M-0.11 0.63 C19.8 0.16, 39.54 -0.08, 91.41 0.15 M90.88 1.39 C93.57 34.66, 89.93 67.3, 91.59 115.77 M92.31 -0.64 C92.08 46.58, 93.12 92.3, 92.32 117.02 M91.09 115.47 C68.38 116.27, 45.77 117.43, 0.74 116.21 M92.14 117.51 C58.99 116, 24.94 117.57, -0.57 116.74 M-1.08 115.01 C0.47 84.99, 1.3 55.04, 0.21 -1.01 M-0.08 117.12 C-0.38 74.15, -1.73 33.8, 0.03 0.41" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(125 11.5) rotate(0 46 86.5)">
        <path d="M0.61 0.84 C24.89 -1.19, 45.37 -1.36, 91.66 -1.68 M0.63 -0.07 C31.97 -0.1, 63.69 -0.48, 92.15 -0.14 M93.39 1.68 C94.53 48.35, 93.73 100.21, 90.77 174.96 M91.36 -0.63 C92.84 62.73, 91.99 124.94, 92.02 172.52 M90.47 172.58 C69.22 172.76, 48.83 173.32, -0.79 174.21 M92.51 173.17 C63.97 172.42, 38.41 172.56, -0.26 172.62 M-1.99 173.94 C-0.26 115.9, 0.39 55.47, -1.01 1.19 M0.12 173.73 C-0.74 104.14, 0.97 36.58, 0.41 0.42" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(230 14.5) rotate(0 46 46.5)">
        <path d="M0.84 1.22 C22.02 -2.25, 44.91 -0.62, 90.32 0.95 M-0.07 0.01 C25.86 -0.81, 51.54 -0.43, 91.86 -0.09 M93.68 1.22 C89.52 35.39, 91.07 68.71, 93.96 94.2 M91.37 0.02 C92.71 31.48, 92.61 64.64, 91.52 92.34 M91.58 91.79 C59.74 92.25, 27.87 91.5, 1.21 92.9 M92.17 92.1 C64.74 94.15, 38.33 93.21, -0.38 93.4 M0.94 91.6 C2.28 70.46, 0.71 48.42, 1.19 1.89 M0.73 92.22 C-0.56 66.24, 0.1 38.04, 0.42 -0.53" stroke="#364fc7" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(344 15.5) rotate(0 46 58.5)">
        <path d="M-1.03 -1.97 C29.22 -0.9, 59.17 0.39, 91.67 -0.23 M91.58 -0.47 C90.73 42.75, 91.63 84.72, 93.52 115.88 M90.04 117.42 C57.59 116.33, 25.96 118.76, 0.95 117.63 M0.84 115.34 C1.37 89.38, -0.22 60.36, 1.05 -0.91" stroke="#c92a2a" stroke-width="4.5" fill="none" stroke-dasharray="8 12">
        </path>
    </g>
    <g transform="translate(61.5 56) rotate(0 3.5 12.5)">
        <text x="3.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            1
        </text>
    </g>
    <g transform="translate(163 85.5) rotate(0 8 12.5)">
        <text x="8" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            2
        </text>
    </g>
    <g transform="translate(268 48.5) rotate(0 8 12.5)">
        <text x="8" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#364fc7" text-anchor="middle" style="white-space: pre;" direction="ltr">
            3
        </text>
    </g>
    <g transform="translate(382.5 61.5) rotate(0 7.5 12.5)">
        <text x="7.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            4
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(232.5 129.75) rotate(0 46 58.5)">
        <path d="M0.1 -0.36 C35.38 -0.89, 70.24 0.22, 93.8 0.98 M0.7 0.69 C34.69 -0.96, 68.87 -1.35, 91.53 0.38 M93.77 -1.89 C91.58 30.33, 93.21 60.5, 91.19 117.89 M91.77 0.37 C90.74 34.26, 90.78 69.6, 92.47 116.82 M91.36 118.13 C65.56 115.98, 43.28 118.35, -1.28 115.14 M91.17 117.69 C58.79 117.86, 25.56 117.87, -0.5 117.24 M1.32 116.16 C-0.3 78.71, 0.11 38.79, -0.99 -1.08 M0.19 116.09 C1.6 91.53, -0.11 65.64, 0.55 -0.81" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(271 175.75) rotate(0 7.5 12.5)">
        <text x="7.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            4
        </text>
    </g>
</svg>
</p>

<p>å¥½åœ¨æˆ‘ä»¬ä½¿ç”¨äº† transformï¼ˆä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸ä½¿ç”¨ topã€left åŸå› ï¼Œtransform åŠ¨ç”»æ€§èƒ½æ›´é«˜ï¼‰ è¿›è¡Œä½ç½®åç§»ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ transition è¿‡æ¸¡ã€‚</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.list-item</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">transition</span>: transform .<span class="number">5s</span> ease-in-out;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨"><a href="#ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨" class="headerlink" title="ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨"></a>ä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨</h2><h3 id="ç€‘å¸ƒæµå­˜åœ¨çš„é—®é¢˜"><a href="#ç€‘å¸ƒæµå­˜åœ¨çš„é—®é¢˜" class="headerlink" title="ç€‘å¸ƒæµå­˜åœ¨çš„é—®é¢˜"></a>ç€‘å¸ƒæµå­˜åœ¨çš„é—®é¢˜</h3><p>å¾ˆå¤šè™šæ‹Ÿåˆ—è¡¨çš„éƒ½æ˜¯ä½¿ç”¨çš„å•åˆ—å®šé«˜ä½¿ç”¨æ–¹å¼ï¼Œä½†æ˜¯ç€‘å¸ƒæµä½¿ç”¨è™šæ‹Ÿåˆ—è¡¨æ–¹å¼æœ‰ç‚¹ä¸åŒï¼Œç€‘å¸ƒæµå­˜åœ¨å¤šåˆ—ä¸”æ—¶æ˜¯é”™ä½çš„ã€‚æ‰€ä»¥å¸¸è§„ length*height ä¸ºåˆ—è¡¨æ€»é«˜åº¦ï¼Œæ ¹æ® scrollTop&#x2F;height æ¥ç¡®å®šä¸‹æ ‡æ–¹å¼å°±è¡Œä¸é€šäº†ï¼Œè¿™ä¸ªæ—¶å€™é«˜åº¦éœ€è¦æ ¹æ®ç€‘å¸ƒæµé«˜åº¦åŠ¨æ€å†³å®šäº†ï¼Œå¯æ˜¾ç¤ºå…ƒç´ ä¹Ÿä¸èƒ½é€šè¿‡ starindex-endindex å»æˆªå–æ˜¾ç¤ºäº†ã€‚</p>
<p>å¦‚ä¸‹å›¾ï¼šè“è‰²æ¡†çš„å…ƒç´ æ˜¯ä¸åº”è¯¥æ˜¾ç¤ºçš„ï¼Œåªæœ‰ä¸å¯è§†åŒºåŸŸå­˜åœ¨äº¤å‰çš„å…ƒç´ æ‰åº”è¯¥æ˜¾ç¤º</p>
<p align="center">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353 758.5" width="353" height="758.5">
    <rect x="0" y="0" width="353" height="758.5" fill="#ffffff">
    </rect>
    <g stroke-linecap="round" transform="translate(10 117) rotate(0 166.5 250)">
        <path d="M0.72 1 C85.82 -0.51, 171.42 0.26, 333.25 0 M0.35 -0.53 C86.39 -0.22, 172.88 0.54, 332.59 -0.65 M333.72 -0.59 C331.75 138.3, 331.35 276.01, 333.39 499.35 M333.05 0.37 C331.22 121.97, 331.11 243.44, 333.2 499.61 M332.83 500.47 C221.23 497.05, 106.02 496.84, -0.33 499.21 M333.04 500.64 C253.92 500.48, 175.76 501.12, 0.15 499.67 M-0.64 500.38 C-1.44 333.69, -1.78 166.77, -0.16 -0.42 M-0.32 500.39 C1.58 380.41, 1.74 260.88, -0.19 -0.11" stroke="#000000" stroke-width="2" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(22 10) rotate(0 46 58.49999999999999)">
        <path d="M-1.06 -0.78 C31.6 -1.8, 68.39 -0.16, 90.86 0.72 M-0.27 -0.87 C31.57 -0.47, 62.36 -0.61, 91.06 0.06 M90.59 -0.72 C93.57 23.14, 92.92 48.07, 90.1 118.2 M92.59 0.64 C91.54 25.79, 91.84 48.77, 91.4 117.78 M91.63 117.89 C60.19 117.86, 32.15 118.89, 0.85 116.53 M92 116.75 C66.12 117.09, 41.53 116.61, 0.03 116.45 M-1.92 116.26 C0.71 74.42, -0.38 29.15, -1.19 0.01 M-0.27 116.88 C1.29 85.59, -0.09 54.8, 1 0.84" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(128 11.5) rotate(0 46 86.5)">
        <path d="M0.85 1.5 C26.04 1.21, 56.87 -0.75, 90.53 -0.61 M0.28 -0.1 C20.66 -0.77, 43.28 0.39, 91.41 -0.74 M90.36 1.13 C94.56 36.23, 91.37 72.5, 90.09 173.74 M92.89 0.38 C92.22 62.29, 91.71 123.93, 91.61 172.56 M91.14 173.54 C61.97 173.1, 32.44 173.8, 1.55 172.93 M92.45 172.99 C57.7 172.47, 22.59 172.26, 0.83 172.24 M1.63 171.19 C-1.73 134.92, -0.06 94.82, 0.92 1.1 M-0.33 172.76 C-1 136.8, -0.94 102.31, 0.87 0.64" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(233 14.5) rotate(0 46 46.49999999999999)">
        <path d="M1.5 -1.92 C34.3 0.56, 66.3 -1.85, 91.39 -1.4 M-0.1 -0.5 C35 0.7, 71.41 -0.85, 91.26 -0.87 M93.13 1.57 C90.61 31.6, 90.05 64.54, 92.74 94.22 M92.38 -0.15 C92.31 29.22, 91.53 59.37, 91.56 93.19 M92.54 92.29 C57.05 91.69, 21.9 94.16, -0.07 94.44 M91.99 92.93 C70.3 92.46, 48.32 94.24, -0.76 92.3 M-1.81 92.05 C1 61.66, 0.7 29.8, 1.1 -1.86 M-0.24 93.39 C-0.67 58.1, 0.62 23.18, 0.64 -0.54" stroke="#364fc7" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(23 143.5) rotate(0 46 58.5)">
        <path d="M-0.16 1.91 C26.05 0.41, 48.97 1.49, 90.17 -1.4 M0.92 0.77 C26.78 -0.71, 53.96 0.27, 92.13 -0.34 M93.12 -0.54 C90.67 25.41, 89.85 54.4, 93.25 118.3 M92.52 1 C92.11 26.6, 92.41 53.9, 91.76 116.57 M92.4 116.38 C60.05 117.38, 32.44 118.87, 0.83 117.28 M91.77 116.5 C71.51 116.15, 52.53 115.85, -0.4 117.31 M-0.92 118.5 C0.74 89.1, 1.33 61.5, 1.99 0.49 M0.75 117.4 C0.41 87.58, 1.55 58.47, -0.01 -0.67" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(235 137.5) rotate(0 46 58.5)">
        <path d="M-0.69 -1.37 C32.19 0.55, 67.17 -0.66, 91.16 -1.7 M0.65 -0.73 C20.23 -0.89, 40.43 0.42, 91.79 0.1 M91.14 0.57 C92.73 38.01, 93.44 71.56, 90.28 116.5 M92.14 -0.86 C93.09 39.99, 92.35 80.06, 91.19 116.41 M92.62 115.77 C65.3 117.48, 37.88 118.13, 0.68 116.99 M92.24 116.5 C57.79 116.93, 25.79 118.32, -0.44 116.84 M-1.35 118.8 C-1.39 72.23, -0.63 30.25, -0.54 -1.07 M0.64 116.73 C0.24 87.22, 0.82 58.36, -0.39 -0.67" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(130 200.5) rotate(0 46 58.5)">
        <path d="M-0.81 0.62 C20.98 0.72, 45.28 -0.11, 93.5 0.68 M1 0.24 C27.03 -0.85, 54.07 0.63, 92.4 -0.44 M91.99 -1.35 C94.61 31.82, 91.23 65.8, 91.64 116.46 M91.05 0.64 C91.13 28.53, 90.81 57.97, 91.72 116.61 M92.58 116.45 C72.28 116.64, 49.65 115.97, -1.97 115.48 M91.14 117.5 C67.24 115.93, 40.92 116.91, -0.89 116.82 M-1.9 117.01 C-0.78 72.29, -0.77 27.7, -0.11 -0.07 M-0.48 117.72 C1.8 74.6, 1.55 32.84, -0.35 0.6" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(64.5 56) rotate(0 3.5 12.5)">
        <text x="3.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            1
        </text>
    </g>
    <g transform="translate(166 85.5) rotate(0 8 12.5)">
        <text x="8" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            2
        </text>
    </g>
    <g transform="translate(271 48.5) rotate(0 8 12.5)">
        <text x="8" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#364fc7" text-anchor="middle" style="white-space: pre;" direction="ltr">
            3
        </text>
    </g>
    <g transform="translate(273.5 183.5) rotate(0 7.5 12.5)">
        <text x="7.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            4
        </text>
    </g>
    <g transform="translate(62 189.5) rotate(0 7 12.5)">
        <text x="7" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            5
        </text>
    </g>
    <g transform="translate(168.5 246.5) rotate(0 7.5 12.5)">
        <text x="7.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            6
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(22 283.5) rotate(0 46 58.5)">
        <path d="M-0.78 -0.59 C27.23 -0.65, 50.86 1.22, 91.41 0.37 M0.65 -0.88 C35.95 1.84, 70.95 1.2, 92.81 -0.47 M92.88 1.93 C93.54 24.45, 90.38 49.64, 92.62 117.53 M92.13 0.54 C93.6 38.02, 92.98 74.92, 92.32 116.73 M93.95 117.64 C73.79 117.41, 52.17 115.06, -0.16 117.48 M91.88 117.62 C58.53 116.44, 24.3 116.06, 0.44 117.84 M0.08 115.29 C2.68 92.32, 2.36 63.06, -0.71 1.62 M0.25 116.01 C-0.09 88.67, -1.08 57.96, -0.9 -0.7" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(59.5 329.5) rotate(0 8.5 12.5)">
        <text x="8.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            8
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(130 341.5) rotate(0 46 58.5)">
        <path d="M1 -0.59 C32.65 2.4, 64.71 -1.19, 93.3 -1.76 M0.32 0.81 C33.12 -1.25, 67.48 -0.82, 92.44 0.96 M93.09 0.62 C92.64 42.41, 93.54 84.48, 92.26 118.08 M92.26 0.32 C92.53 43.1, 91.96 87.36, 92.98 117.32 M90.59 116.84 C58.51 118.16, 24.11 115.78, -0.24 118.24 M91.49 117.44 C57.61 117.08, 20.63 117.77, 0.04 116.14 M-1.46 116.29 C0.71 71.41, 0.36 28.31, 0.49 -1.98 M-0.73 116.1 C-1.66 74.26, -0.99 31.55, -0.82 0.7" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(169 387.5) rotate(0 7 12.5)">
        <text x="7" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            9
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(239 402.5) rotate(0 46 58.5)">
        <path d="M-1.91 1.3 C27.56 1.23, 60.57 0.64, 92.63 1.61 M-0.49 0.44 C24.23 0.31, 46.63 -1.27, 92.54 0.31 M92.43 0.26 C93.31 39.73, 93.59 76.7, 92.52 117.64 M91.42 0.98 C91.3 32.62, 91.45 63.53, 91.3 116.92 M91.07 116.76 C63.44 118.68, 32.12 118.84, -1.02 117.88 M91.93 117.04 C55.82 116.98, 22.12 116.82, -0.73 116.65 M0.46 117.49 C-1.39 73.71, 2.24 27.13, -1.46 -1.8 M0.11 116.18 C0.66 90.47, 0.18 62.67, -0.63 -0.42" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(274.5 448.5) rotate(0 10.5 12.5)">
        <text x="10.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            10
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(236 269.5) rotate(0 46 58.5)">
        <path d="M0.71 0.63 C21.11 -1.83, 37.16 -0.28, 91.01 0.88 M-0.99 0.54 C36.77 0.19, 73.11 0.64, 92.21 0.13 M92.27 0.52 C93.52 40.89, 91.15 81.19, 90.84 118.95 M91.68 -0.7 C92.73 39.09, 93.54 77.72, 91.54 116.88 M93.83 115.98 C59.56 118.55, 23.85 115.06, -0.13 117.08 M92.65 116.27 C71.92 118.53, 52.04 118.36, 0.23 117.25 M-0.67 115.54 C-2.57 92.09, -0.69 69.9, 0.22 -1.65 M-0.43 116.37 C-0.92 74.02, -1.25 30.48, 0 -0.28" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(275.5 315.5) rotate(0 6.5 12.5)">
        <text x="6.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            7
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(132 481.5) rotate(0 46 58.5)">
        <path d="M-0.09 -0.12 C23.71 2.13, 48.58 -0.79, 90.97 -0.22 M0.86 -0.96 C20.51 0.59, 39.63 0.54, 92.21 0.07 M93.37 0.43 C90.65 34.55, 93.85 64.72, 91.87 116.49 M91.38 0.78 C91.26 30.42, 91.17 58.57, 91.8 117.59 M93.23 116.33 C63.71 114.95, 37.3 114.96, 0.33 116.58 M92.29 117.23 C55.88 116.15, 17.81 116.14, 0.34 117.36 M1.21 117.27 C0.07 78.92, 1.26 42.55, 0.64 0.41 M-0.61 116.09 C0.66 75.16, 0.77 33.51, 0.21 0.86" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(167 527.5) rotate(0 11 12.5)">
        <text x="11" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            12
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(27 424.5) rotate(0 46 58.5)">
        <path d="M-1.07 -1.03 C24.24 -1.65, 47.55 0.29, 93.72 -1.92 M0.63 0.21 C36.37 -0.64, 73.15 -1.15, 92.68 0.21 M90.95 -0.13 C92.46 22.58, 92.47 48.66, 90.76 118.55 M91.28 -0.2 C93.5 29.99, 92.52 59.61, 92.62 116.67 M90.18 117.33 C64.28 119.8, 36.51 117.1, 0.57 117.46 M91.46 117.34 C58.76 116.52, 24 117.36, 0.61 117.13 M-1.43 117.64 C1.33 88.17, 0.63 58.67, -1.22 -1.82 M0.48 117.21 C0.68 76.25, -0.98 35.79, -0.77 0.36" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(66.5 470.5) rotate(0 6.5 12.5)">
        <text x="6.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            11
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(29 558.5) rotate(0 46 58.5)">
        <path d="M1.81 0.03 C26.11 -2.26, 50.27 0.03, 92.69 -0.1 M-0.15 0.34 C30.65 -0.24, 59.96 -1.21, 92.97 -0.02 M91.82 1.12 C91.64 36.32, 91.7 75.52, 90.33 115.01 M92.13 0.61 C92.27 26.43, 92.61 54.51, 91.26 117.8 M91.96 117.34 C55.06 118.72, 18.7 116.9, 0.17 116.84 M92.42 116.04 C71.88 116.65, 53.23 117.9, 0.19 117.61 M0.06 115.34 C-0.02 78.36, 2.75 40.99, 0.23 -1.36 M-0.56 117.48 C-0.12 71.64, -0.45 24.91, 0.53 -0.14" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g stroke-linecap="round" transform="translate(241 544.5) rotate(0 46 58.5)">
        <path d="M-0.92 -1.7 C33.69 1.69, 65.55 2.11, 92.57 -1.76 M-0.52 -0.11 C33.19 1.17, 64.77 0.08, 92.94 0.81 M93.66 1.44 C92.34 35.96, 92.41 71.36, 92.77 118.36 M91.64 -0.63 C92.16 30.78, 92.24 61.78, 91.58 117.18 M93.34 116.25 C66.7 115.43, 39.37 118.67, 1.23 116.18 M91.34 116.92 C73.62 116.56, 52.63 116.57, -0.68 116.14 M1.81 118.41 C1.49 76.26, 1.67 32.91, 0.23 -1.96 M-0.6 117.22 C-0.29 92.07, -0.06 69.28, -0.44 0.17" stroke="#c92a2a" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(276.5 590.5) rotate(0 10.5 12.5)">
        <text x="10.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
            13
        </text>
    </g>
    <g stroke-linecap="round" transform="translate(134 631.5) rotate(0 46 58.5)">
        <path d="M-0.46 1.74 C25.38 -0.13, 46.51 2.25, 92.99 -1.32 M-0.72 -0.88 C26.22 -0.04, 54.35 0.01, 92.26 0.91 M92.72 -0.77 C92.54 41.38, 90.45 85.81, 92.21 115.79 M91.43 0.63 C90.62 37.79, 90.4 76, 92.03 116.12 M92 115.94 C67.24 118.96, 43.06 117.38, 0.31 116.54 M92.21 116.33 C72.71 117.24, 51.65 116.22, -0.83 117.88 M-0.29 118.94 C-1.61 68.79, 0.3 23.59, -1.8 -1.35 M0.13 116.21 C-0.88 81.19, -0.34 43.61, 0.78 -0.05" stroke="#364fc7" stroke-width="1" fill="none">
        </path>
    </g>
    <g transform="translate(170 677.5) rotate(0 10 12.5)">
        <text x="10" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#364fc7" text-anchor="middle" style="white-space: pre;" direction="ltr">
            15
        </text>
    </g>
    <g transform="translate(68 569) rotate(0 10 12.5)">
        <text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1864ab" text-anchor="start" style="white-space: pre;" direction="ltr">
            14
        </text>
    </g>
</svg>
</p>


<h3 id="å¯è§†å…ƒç´ åˆ¤å®š"><a href="#å¯è§†å…ƒç´ åˆ¤å®š" class="headerlink" title="å¯è§†å…ƒç´ åˆ¤å®š"></a>å¯è§†å…ƒç´ åˆ¤å®š</h3><p>å…ˆæ¥çœ‹ä¸‹é¢å›¾ï¼Œå½“å…ƒç´ å®Œå…¨ä¸åœ¨å¯è§†åŒºåŸŸæ—¶å€™å°±è§†ä¸ºå½“å‰å…ƒç´ ä¸éœ€è¦æ˜¾ç¤ºï¼Œåªæœ‰ä¸å¯è§†åŒºåŸŸå­˜åœ¨äº¤å‰æˆ–è¢«åŒ…å«æ—¶å€™è§†ä¸ºéœ€è¦æ˜¾ç¤ºã€‚</p>
<p align="center">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 543 688.2044864933938" width="543" height="688.2044864933938">
        <rect x="0" y="0" width="543" height="688.2044864933938" fill="#ffffff">
        </rect>
        <g stroke-linecap="round" transform="translate(131.5 160) rotate(0 166.5 165)">
            <path d="M0.24 0.87 C123.88 0.38, 245 0.23, 333.59 -0.63 M0.33 -0.24 C91.33 1.23, 182.61 1.05, 333.53 0.44 M332.71 0.36 C334.02 131.26, 334.08 262.73, 333.44 329.43 M332.73 -0.55 C331.42 104.57, 332.58 208.14, 332.71 330.48 M333.66 330.41 C261.8 332.32, 189.92 331.22, 0.11 328.77 M332.9 330.29 C219.76 331.08, 108.19 330.97, 0.25 329.34 M1.29 329.08 C-0.24 224.07, -1.91 117.31, 0.65 1.27 M0.12 329.96 C1.08 251.48, 1.35 173.06, 0.12 -0.13" stroke="#000000" stroke-width="2" fill="none">
            </path>
        </g>
        <g stroke-linecap="round" transform="translate(143.5 10) rotate(0 46 58.49999999999999)">
            <path d="M1.28 1.63 C19.47 -0.96, 38.05 0.71, 91.07 -0.51 M91.28 -0.33 C93.59 38.93, 93.06 81.02, 93.28 118.93 M92.53 116.37 C59.12 116.25, 26.55 117.45, -0.84 117.32 M-1.62 115.19 C1.37 88.48, -0.83 55.93, 1.4 -1.7" stroke="#364fc7" stroke-width="1.5" fill="none" stroke-dasharray="8 9">
            </path>
        </g>
        <g stroke-linecap="round" transform="translate(249.5 11.5) rotate(0 46 86.5)">
            <path d="M1.63 0.65 C27.02 -0.17, 56.51 -1.52, 91.49 0.79 M-0.17 0.95 C24.8 1.01, 51.19 0.97, 92.96 0.65 M91.37 0.67 C91.08 38.12, 92.27 72.12, 92.32 172.15 M91.09 0.37 C92.12 41.76, 90.9 85.68, 91.15 172.24 M92.63 173.64 C56.95 172.29, 21.57 171.46, 0.77 172.29 M91.23 172.91 C60.69 173.15, 27.94 172.42, 0.21 173.31 M0.65 173.07 C-3.41 105.29, -0.68 41.62, -1.26 -1.19 M-0.37 172.63 C-0.28 124.36, -0.11 76.74, 0.33 0.72" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g stroke-linecap="round" transform="translate(354.5 14.5) rotate(0 46 46.49999999999999)">
            <path d="M0.65 -0.8 C29.62 0.12, 57.47 -1.26, 92.79 -0.52 M93.89 -0.8 C93.03 33.92, 92.95 66.67, 93.29 91.22 M92.67 92.45 C67.99 93.35, 39.86 93.03, -0.85 91.91 M0.73 94.59 C-0.71 67.9, 2.16 42.79, -1.52 1.67" stroke="#364fc7" stroke-width="1.5" fill="none" stroke-dasharray="8 9">
            </path>
        </g>
        <g stroke-linecap="round" transform="translate(144.5 143.5) rotate(0 46 58.5)">
            <path d="M-0.8 0.42 C34.36 -1.23, 66.48 0.49, 91.48 0.96 M-0.4 0.68 C25.07 -0.23, 49.54 -0.22, 91.11 -0.21 M91.45 1.64 C92.27 37.35, 91.95 75.53, 90.91 116.22 M92.8 -0.73 C90.52 26.31, 90.09 50.46, 92.84 117.49 M92.25 116.02 C61.78 115.48, 32 116.59, 1 116.7 M92.91 116.76 C60.88 115.95, 29.22 117.23, 0.85 117.94 M-1.78 115.91 C0.57 91.61, -1.64 61.3, -0.45 0.34 M0.01 116.4 C0.62 82.43, 0.77 48.94, 0.77 0.48" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g stroke-linecap="round" transform="translate(356.5 137.5) rotate(0 46 58.5)">
            <path d="M0.42 0.87 C34.17 -0.14, 70.98 -0.15, 92.96 -0.72 M0.68 0.78 C26.71 1.33, 52.79 -0.52, 91.79 0.26 M93.64 0.64 C91.55 31.72, 91.54 61.71, 91.22 115.38 M91.27 -0.42 C93.13 23.66, 91.67 49.86, 92.49 117.3 M91.02 117.16 C59.69 117.88, 30.3 118.12, -0.3 117.85 M91.76 117.37 C70.56 118.05, 51.36 118.69, 0.94 116.33 M-1.09 117.95 C1.82 76.82, -1.23 38.71, 0.34 -0.12 M-0.6 117.18 C0.25 86.62, 1.15 56.33, 0.48 0.64" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g stroke-linecap="round" transform="translate(251.5 200.5) rotate(0 46 58.5)">
            <path d="M0.87 -0.93 C30.07 0.6, 60.63 0.77, 91.28 -0.33 M0.78 0.64 C37.27 0.02, 71.72 -0.84, 92.26 -0.32 M92.64 -0.84 C92 38.14, 90.59 77.2, 90.38 115.19 M91.58 0.7 C92.08 38.63, 93.77 79.26, 92.3 117.31 M92.16 115.18 C62.23 115.84, 31.93 116.24, 0.85 115.45 M92.37 116.03 C65.4 117.09, 39.22 117.73, -0.67 117.33 M0.95 118.86 C-0.22 80.31, 0.59 46.34, -0.12 -0.75 M0.18 116.82 C0.32 86.92, 0.76 55.89, 0.64 -0.76" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g transform="translate(186 56) rotate(0 3.5 12.5)">
            <text x="3.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#364fc7" text-anchor="middle" style="white-space: pre;" direction="ltr">
                1
            </text>
        </g>
        <g transform="translate(287.5 85.5) rotate(0 8 12.5)">
            <text x="8" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                2
            </text>
        </g>
        <g transform="translate(392.5 48.5) rotate(0 8 12.5)">
            <text x="8" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#364fc7" text-anchor="middle" style="white-space: pre;" direction="ltr">
                3
            </text>
        </g>
        <g transform="translate(395 183.5) rotate(0 7.5 12.5)">
            <text x="7.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                4
            </text>
        </g>
        <g transform="translate(183.5 189.5) rotate(0 7 12.5)">
            <text x="7" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                5
            </text>
        </g>
        <g transform="translate(290 246.5) rotate(0 7.5 12.5)">
            <text x="7.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                6
            </text>
        </g>
        <g stroke-linecap="round" transform="translate(143.5 283.5) rotate(0 46 58.5)">
            <path d="M-0.33 1.89 C24.4 1.69, 51.96 1.61, 93.93 1.29 M-0.32 0.33 C19.12 0.58, 39.12 -0.66, 92.16 -0.43 M90.19 0.73 C93.13 27.27, 90.69 58.87, 90.3 115.48 M92.31 0.32 C92.69 44.4, 92.65 88.87, 92.38 116.65 M90.45 116.83 C61.6 116.92, 28.32 115.45, 0.42 117.61 M92.33 117.03 C55.68 115.84, 21.62 117.31, -0.63 116.41 M-0.75 116.26 C-0.18 83.32, 0.16 51.66, 0.67 1.44 M-0.76 117.71 C-0.41 72.95, 0.1 29.7, -0.27 -0.63" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g transform="translate(181 329.5) rotate(0 8.5 12.5)">
            <text x="8.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                8
            </text>
        </g>
        <g stroke-linecap="round" transform="translate(251.5 341.5) rotate(0 46 58.5)">
            <path d="M-0.8 1.36 C25.84 0.41, 50.5 0.42, 90.22 -0.42 M-0.28 0.82 C30.35 -0.73, 60.22 -0.73, 91.46 -0.39 M93.59 -1.46 C90.09 27.01, 89.24 49.7, 93.67 117.97 M92.12 -0.49 C92.45 37.73, 92.75 76.93, 92.5 116.85 M93.81 116.53 C61.25 114.99, 29.43 117.53, 1.7 118.89 M91.11 116.45 C71.04 117.96, 48.51 116.44, -0.22 117.17 M0.03 115.8 C0.8 82.24, 1.11 49.66, 1.54 0.96 M0.15 117.07 C1.55 75.31, 0.62 31.12, -0.92 0.03" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g transform="translate(290.5 387.5) rotate(0 7 12.5)">
            <text x="7" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                9
            </text>
        </g>
        <g stroke-linecap="round" transform="translate(360.5 402.5) rotate(0 46 58.5)">
            <path d="M1.56 1.28 C38.23 0.67, 70.83 -1.05, 92.53 -0.63 M0.32 -0.42 C30.82 -1.18, 60.78 -1.15, 91.19 -0.91 M91.15 1.4 C91.23 37.87, 94.61 79.74, 92.61 117.63 M92.08 -0.91 C92.53 38.48, 92.65 77.51, 92.42 116.23 M92.75 115.07 C65.61 117.4, 40.07 118.67, -1.34 117.65 M92.48 117.93 C63.46 115.9, 35.94 116.67, -0.06 116.63 M0.37 116.63 C0.65 87.65, 1.53 56.37, 1.29 -1.53 M0.66 117.94 C-0.45 72.99, -1.1 30.27, 0.48 0.92" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g transform="translate(396 448.5) rotate(0 10.5 12.5)">
            <text x="10.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                10
            </text>
        </g>
        <g stroke-linecap="round" transform="translate(357.5 269.5) rotate(0 46 58.5)">
            <path d="M1.93 1.29 C32.09 -1.01, 68.27 -1.22, 92.67 -0.55 M0.16 -0.43 C34.6 -0.01, 69.47 -0.52, 92.37 0.8 M90.3 -1.52 C93.18 27.52, 92.11 53.73, 92.64 117.25 M92.38 -0.35 C92.6 29.19, 92.52 57.9, 91.91 117.91 M92.42 117.61 C68.27 118, 39.8 116.76, 0.07 115.22 M91.37 116.41 C69.19 118.03, 46.77 117.48, -0.37 117.01 M0.67 118.44 C1.33 89.86, 1.07 59.27, 1.42 0.3 M-0.27 116.37 C-1.69 81.11, -0.29 46.1, 0.96 0.17" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g transform="translate(397 315.5) rotate(0 6.5 12.5)">
            <text x="6.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                7
            </text>
        </g>
        <g stroke-linecap="round" transform="translate(253.5 481.5) rotate(0 46 58.5)">
            <path d="M-1.78 -0.42 C34.03 -1.23, 67.67 -1.15, 93.64 0.64 M-0.54 -0.39 C22.93 -0.51, 47.85 1.19, 91.27 -0.42 M93.67 0.97 C91.61 43.94, 91.64 86.86, 91.02 117.16 M92.5 -0.15 C92.87 23.7, 92.36 49.86, 91.76 117.37 M93.7 118.89 C71.96 117.94, 54.67 115.5, -1.09 117.95 M91.78 117.17 C55.77 116.08, 19.3 116.47, -0.6 117.18 M1.54 117.96 C0.89 82.51, 1.02 51.38, 0.14 1.32 M-0.92 117.03 C0.8 71.86, 1.28 25.05, 0.07 0.74" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g transform="translate(288.5 527.5) rotate(0 11 12.5)">
            <text x="11" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                12
            </text>
        </g>
        <g stroke-linecap="round" transform="translate(148.5 424.5) rotate(0 46 58.5)">
            <path d="M0.53 -0.63 C34.21 -0.36, 68.73 0.84, 91.16 0.32 M-0.81 -0.91 C24.04 1.16, 46.63 -0.06, 92.7 -0.85 M92.61 0.63 C93.62 26.46, 91.99 52.58, 90.18 117.77 M92.42 -0.77 C92.5 31.87, 92.35 62.3, 91.03 117.21 M90.66 117.65 C61.65 116.09, 30.07 118.82, 1.86 115.74 M91.94 116.63 C69.5 117.17, 47.14 117.34, -0.18 117.33 M1.29 115.47 C0.51 73.76, -0.76 31.24, 1.87 -0.55 M0.48 117.92 C2.04 89.45, 1.14 62.3, -0.87 -0.81" stroke="#c92a2a" stroke-width="1" fill="none">
            </path>
        </g>
        <g transform="translate(188 470.5) rotate(0 6.5 12.5)">
            <text x="6.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#c92a2a" text-anchor="middle" style="white-space: pre;" direction="ltr">
                11
            </text>
        </g>
        <g stroke-linecap="round" transform="translate(150.5 558.5) rotate(0 46 58.5)">
            <path d="M0.67 -0.55 C27.29 0.93, 50.46 0.61, 91.15 -1.09 M92.73 1.59 C89.59 29.67, 92.45 59.33, 90.48 118.67 M92.64 117.25 C58.94 117.45, 26.03 118.06, -0.71 118 M-0.17 118.81 C-0.97 84.42, -2.43 50.77, 0.61 1.7" stroke="#364fc7" stroke-width="1.5" fill="none" stroke-dasharray="8 9">
            </path>
        </g>
        <g stroke-linecap="round" transform="translate(362.5 544.5) rotate(0 46 58.5)">
            <path d="M1.64 0.64 C23.85 0.58, 48.53 -0.83, 91.22 -1.62 M90.54 -0.85 C93.83 22.81, 90.91 50.69, 92.97 117.61 M91.02 117.16 C59.69 117.88, 30.3 118.12, -0.3 117.85 M-0.47 117.75 C-1.83 91.39, 0.71 66.63, 1.89 -1.34" stroke="#364fc7" stroke-width="1.5" fill="none" stroke-dasharray="8 9">
            </path>
        </g>
        <g transform="translate(398 590.5) rotate(0 10.5 12.5)">
            <text x="10.5" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#364fc7" text-anchor="middle" style="white-space: pre;" direction="ltr">
                13
            </text>
        </g>
        <g transform="translate(184.5 603) rotate(0 10 12.5)">
            <text x="0" y="18" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1864ab" text-anchor="start" style="white-space: pre;" direction="ltr">
                14
            </text>
        </g>
        <g stroke-linecap="round">
            <g transform="translate(487.1804903262407 12.750000000000014) rotate(0 3.6758362127011424 72.03529622842932)">
                <path d="M1.35 0.68 C3.65 11.83, 13.85 44.93, 12.72 68.64 C11.58 92.36, -3.16 130.51, -5.45 142.96 M-1.36 -1.42 C0.73 10.1, 10.6 48.01, 10.89 72.49 C11.18 96.98, 3.48 133.32, 0.38 145.49" stroke="#e67700" stroke-width="1" fill="none">
                </path>
            </g>
        </g>
        <g stroke-linecap="round">
            <g transform="translate(117.53441886727751 157.75) rotate(0 -10.223491209581084 166.2962683300674)">
                <path d="M0.05 2.79 C-3.09 27.9, -20.26 97.29, -20.73 151.57 C-21.2 205.85, -5.76 298.74, -2.79 328.47 M-3.37 1.84 C-6.76 26.14, -24.26 93.14, -23.23 147.96 C-22.19 202.78, -0.45 299.99, 2.82 330.75" stroke="#2b8a3e" stroke-width="1" fill="none">
                </path>
            </g>
        </g>
        <g transform="translate(511 10.75) rotate(0 11 70)">
            <text x="0" y="21" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#e67700" text-anchor="start" style="white-space: pre;" direction="ltr">
                å·²
            </text>
            <text x="0" y="49" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#e67700" text-anchor="start" style="white-space: pre;" direction="ltr">
                æ»š
            </text>
            <text x="0" y="77" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#e67700" text-anchor="start" style="white-space: pre;" direction="ltr">
                åŠ¨
            </text>
            <text x="0" y="105" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#e67700" text-anchor="start" style="white-space: pre;" direction="ltr">
                é«˜
            </text>
            <text x="0" y="133" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#e67700" text-anchor="start" style="white-space: pre;" direction="ltr">
                åº¦
            </text>
        </g>
        <g transform="translate(68 242.75) rotate(0 10 65)">
            <text x="0" y="19" font-family="Virgil, Segoe UI Emoji" font-size="17.647058823529395px" fill="#2b8a3e" text-anchor="start" style="white-space: pre;" direction="ltr">
                å¯
            </text>
            <text x="0" y="45" font-family="Virgil, Segoe UI Emoji" font-size="17.647058823529395px" fill="#2b8a3e" text-anchor="start" style="white-space: pre;" direction="ltr">
                è§†
            </text>
            <text x="0" y="71" font-family="Virgil, Segoe UI Emoji" font-size="17.647058823529395px" fill="#2b8a3e" text-anchor="start" style="white-space: pre;" direction="ltr">
                åŒº
            </text>
            <text x="0" y="97" font-family="Virgil, Segoe UI Emoji" font-size="17.647058823529395px" fill="#2b8a3e" text-anchor="start" style="white-space: pre;" direction="ltr">
                é«˜
            </text>
            <text x="0" y="123" font-family="Virgil, Segoe UI Emoji" font-size="17.647058823529395px" fill="#2b8a3e" text-anchor="start" style="white-space: pre;" direction="ltr">
                åº¦
            </text>
        </g>
        <g stroke-linecap="round">
            <g transform="translate(126 10.75) rotate(0 -41.557524843499436 334.64067246239637)">
                <path d="M-2.22 2.78 C-15.51 51.66, -82.99 184.74, -82.27 295.52 C-81.55 406.3, -11.85 606.05, 2.08 667.45 M1.78 1.83 C-11.78 49.64, -85.13 180.83, -85.2 291.06 C-85.26 401.3, -13.23 600.77, 1.4 663.26" stroke="#5f3dc4" stroke-width="1" fill="none">
                </path>
            </g>
        </g>
        <g transform="translate(10 218.75) rotate(0 11 84)">
            <text x="0" y="21" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#5f3dc4" text-anchor="start" style="white-space: pre;" direction="ltr">
                ç€‘
            </text>
            <text x="0" y="49" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#5f3dc4" text-anchor="start" style="white-space: pre;" direction="ltr">
                å¸ƒ
            </text>
            <text x="0" y="77" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#5f3dc4" text-anchor="start" style="white-space: pre;" direction="ltr">
                æµ
            </text>
            <text x="0" y="105" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#5f3dc4" text-anchor="start" style="white-space: pre;" direction="ltr">
                æ€»
            </text>
            <text x="0" y="133" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#5f3dc4" text-anchor="start" style="white-space: pre;" direction="ltr">
                é«˜
            </text>
            <text x="0" y="161" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#5f3dc4" text-anchor="start" style="white-space: pre;" direction="ltr">
                åº¦
            </text>
        </g>
    </svg>
</p>

<p>å› ä¸ºä¸Šé¢ç€‘å¸ƒæµçš„å®ç°é‡‡ç”¨çš„æ˜¯ position å®šä½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨èƒ½çŸ¥é“æ‰€æœ‰å…ƒç´ è·ç¦»é¡¶éƒ¨çš„è·ç¦»ï¼Œå¾ˆå®¹æ˜“è®¡ç®—å‡ºä¸å¯è§†åŒºåŸŸäº¤å‰ä½ç½®ã€‚</p>
<p><strong>å…ƒç´ åç§»ä½ç½® &lt; æ»šåŠ¨é«˜åº¦+å¯è§†åŒºåŸŸé«˜åº¦  &amp;&amp; å…ƒç´ åç§»ä½ç½® + å…ƒç´ é«˜åº¦ &gt; æ»šåŠ¨é«˜åº¦</strong></p>
<p>å¦‚æœåªæ¸²æŸ“å¯è§†åŒºåŸŸèŒƒå›´ï¼Œæ»šåŠ¨æ—¶å€™ä¼šå­˜åœ¨ç™½å±å†å‡ºç°ï¼Œå¯è§†é€‚å½“çš„æ‰©å¤§æ¸²æŸ“åŒºåŸŸï¼Œä¾‹å¦‚æŠŠä¸Šä¸€å±å’Œä¸‹ä¸€å±éƒ½ç®—è¿›æ¥ï¼Œè¿›è¡Œé¢„å…ˆæ¸²æŸ“ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> top = scrollTop - clientHeight</span><br><span class="line"><span class="keyword">const</span> bottom = scrollTop + clientHeight * <span class="number">2</span></span><br><span class="line"><span class="keyword">const</span> visibleList = data.<span class="title function_">filter</span>(<span class="function"><span class="params">item</span> =&gt;</span> item.<span class="property">_top</span> + item.<span class="property">height</span> &gt; top &amp;&amp; item.<span class="property">_top</span> &lt; bottom)</span><br></pre></td></tr></table></figure>

<p>ç„¶åé€šè¿‡ç›‘å¬æ»šåŠ¨äº‹ä»¶ï¼Œæ ¹æ®æ»šåŠ¨ä½ç½®å»å¤„ç†ç­›é€‰æ•°ã€‚è¿™é‡Œä¼šå­˜åœ¨ä¸€ä¸ªéšè—æ€§èƒ½é—®é¢˜ï¼Œå½“æ»šåŠ¨åŠ è½½æ•°æ®æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œæ»šåŠ¨äº‹ä»¶è§¦å‘ä¹Ÿæ˜¯æ¯”è¾ƒå¿«çš„ï¼Œæ¯ä¸€æ¬¡éƒ½è¿›è¡Œä¸€æ¬¡éå†ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒæ¶ˆè€—æ€§èƒ½çš„ã€‚å¯ä»¥é€‚å½“æ§åˆ¶ä¸€ä¸‹äº‹ä»¶è§¦å‘é¢‘ç‡ï¼Œå½“ç„¶è¿™ä¹Ÿåªæ˜¯æ²»æ ‡ä¸æ²»æœ¬ï¼Œå½’æ ¹å€’æ˜¯æŸ¥è¯¢æ˜¾ç¤ºå…ƒç´ æ–¹æ³•é—®é¢˜ã€‚</p>
<p><strong>æ ‡è®°ä¸‹æ ‡</strong><br>åº”ä¸ºåˆ—è¡¨æ•°æ®çš„ _top å€¼æ˜¯ä»å°åˆ°å¤§æ­£åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ‡è®°åœ¨å¯è§†åŒºå…ƒç´ çš„ä¸‹æ ‡ï¼Œå½“å‘ç”Ÿæ»šåŠ¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç›´æ¥ä»æ ‡è®°ä¸‹æ ‡å¼€å§‹æŸ¥æ‰¾ï¼Œæ ¹æ®æ»šåŠ¨åˆ†å‡ ç§æƒ…å†µæ¥åˆ¤æ–­ã€‚<br>1&gt; å¦‚æœæ»šåŠ¨åï¼Œæ ‡è®°ä¸‹æ ‡å…ƒç´ è¿˜åœ¨å¯è§†èŒƒå›´å†…ï¼Œå¯ä»¥ç›´æ¥ä»æ ‡è®°ä¸‹æ ‡äºŒåˆ†æŸ¥æ‰¾ï¼Œå¾€ä¸Šå¾€ä¸‹æ‰¾ç›´åˆ°ä¸ç¬¦åˆæ¡ä»¶å°±åœæ­¢ã€‚<br>2&gt;  å¦‚æœæ»šåŠ¨åï¼Œæ ‡è®°ä¸‹æ ‡å…ƒç´ ä¸åœ¨å¯è§†èŒƒå›´å†…ï¼Œæ ¹æ®æ»šåŠ¨æ–¹å‘å¾€ä¸Šæˆ–è€…å¾€ä¸‹å»æŸ¥æ‰¾ã€‚è¿™ä¸ªæ—¶å€™å­˜åœ¨ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯æ»šåŠ¨å¹…åº¦æ¯”è¾ƒå°ï¼Œç›´æ¥æ ¹æ®å½“å‰ä¸‹æ ‡å¾€ä¸Šæˆ–è€…å¾€ä¸‹æ‰¾ã€‚å½“ç”¨æˆ·æ‹–åŠ¨æ»šåŠ¨æ¡æ»šåŠ¨å¹…åº¦ç‰¹åˆ«å¤§çš„æ—¶å€™ï¼Œå¯ä»¥å°†ä¸‹æ ‡å¾€ä¸Šæˆ–è€…å¾€ä¸‹åç§»ï¼Œåç§»é‡æ ¹æ® <strong>æ»šåŠ¨é«˜åº¦&#x2F;é¢„ä¼°å¹³å‡é«˜åº¦*åˆ—æ•°</strong> å»ä¼°ç®—ä¸€ä¸ªï¼Œç„¶ååœ¨æ ¹æ®è¿™ä¸ªé¢„ä¼°ä¸‹æ ‡è¿›è¡ŒæŸ¥æ‰¾ã€‚æ‰¾åˆ°åç„¶åç¼“å­˜ä¸€ä¸ªæ–°çš„ä¸‹æ ‡ã€‚</p>
<h3 id="æŠ–åŠ¨é—®é¢˜"><a href="#æŠ–åŠ¨é—®é¢˜" class="headerlink" title="æŠ–åŠ¨é—®é¢˜"></a>æŠ–åŠ¨é—®é¢˜</h3><p>æˆ‘ä»¬ absolute å®šä½ä¼šæ’‘å¼€å®¹å™¨é«˜åº¦ï¼Œä½†æ˜¯æ»šåŠ¨æ—¶å€™è¿˜æ˜¯ä¼šå­˜åœ¨æŠ–åŠ¨é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªå…ƒç´ é«˜åº¦å»æ’‘å¼€ï¼Œè¿™ä¸ªå…ƒç´ é«˜åº¦ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è®¡ç®—çš„æ¯ä¸€åˆ—ç´¯è®¡é«˜åº¦ sumHeight ä¸­æœ€å¤§çš„é‚£ä¸ªäº†ã€‚</p>
<h3 id="è¿‡æ¸¡åŠ¨ç”»é—®é¢˜"><a href="#è¿‡æ¸¡åŠ¨ç”»é—®é¢˜" class="headerlink" title="è¿‡æ¸¡åŠ¨ç”»é—®é¢˜"></a>è¿‡æ¸¡åŠ¨ç”»é—®é¢˜</h3><p>å½“åˆ—å®½å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå…ƒç´ ä½ç½®å‘ç”Ÿäº†å˜åŒ–ï¼Œåœ¨å¯è§†åŒºåŸŸçš„å…ƒç´ ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œæœ‰äº›å…ƒç´ å¯èƒ½ä¹‹å‰å¹¶æ²¡æœ‰æ¸²æŸ“ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šé¢ CSS ä¼šå­˜åœ¨æ–°å‡ºç°å…ƒç´ ä¸ä¼šäº§ç”Ÿè¿‡æ¸¡åŠ¨ç”»ã€‚å¥½åœ¨æˆ‘ä»¬èƒ½å¤Ÿå¾ˆæ¸…æ¥šçš„çŸ¥é“å…ƒç´ åŸä½ç½®ä¿¡æ¯å’Œæ–°çš„ä½ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ <strong>FLIP</strong> æ¥å¤„ç†è¿™åŠ¨ç”»ï¼Œå¾ˆå®¹æ˜“æ§åˆ¶å…ƒç´ è¿‡æ¸¡å˜åŒ–ï¼Œå¦‚æœæœ‰äº›å…ƒç´ ä¹‹å‰ä¸å­˜åœ¨ï¼Œå°±æ²¡æœ‰åŸä½ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯è§†èŒƒå›´å†…ç»™ä»–éšæœºç”Ÿæˆä¸€ä¸ªä½ç½®è¿›è¡Œè¿‡æ¸¡ï¼Œä¿è¯æ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¸ªè¿‡æ¸¡æ•ˆæœé¿å…åƒµç¡¬ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä¸Šé¢æƒ…å†µä»…ä»…æ˜¯é’ˆå¯¹åŠ¨æ€åˆ—æ•°é‡ï¼Œåˆèƒ½è®¡ç®—å‡ºé«˜åº¦æƒ…å†µä¸‹ä¼˜åŒ–ï¼Œå¯èƒ½ä¸šåŠ¡ä¸­ä¹Ÿæ˜¯å¯èƒ½å­˜åœ¨æ¯é¡¹é«˜åº¦æ˜¯åŠ¨æ€çš„ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥é‡‡ç”¨é¢„ä¼°å…ƒç´ é«˜åº¦åœ¨æ¸²æŸ“åç¼“å­˜å¤§å°ä½ç½®ç­‰ä¿¡æ¯ï¼Œæˆ–è€…ç¦»å±æ¸²æŸ“ç­‰æ–¹æ¡ˆè§£å†³åšå‡ºè¿›ä¸€æ­¥çš„ä¼˜åŒ–å¤„ç†ã€‚</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>Web Components</title>
    <url>/web_components/</url>
    <content><![CDATA[<p>ç»„ä»¶æ˜¯å‰ç«¯çš„å‘å±•æ–¹å‘ï¼Œç°åœ¨æµè¡Œçš„ React å’Œ Vue éƒ½æ˜¯ç»„ä»¶æ¡†æ¶ã€‚å¦‚ä»Š Web Components è¢«è¶Šæ¥è¶Šå¤šçš„æµè§ˆå™¨æ‰€æ”¯æŒï¼ŒWeb Components æˆ–è®¸æ˜¯æœªæ¥çš„æ–¹å‘ã€‚</p>
<span id="more"></span>
<p>Web Components çš„ç»„æˆä¸»è¦æ˜¯ç”±è¿™ä¸‰ç§ç»„æˆï¼Œå®ƒä»¬å¯ä»¥å°è£…è‡ªå®šä¹‰åŠŸèƒ½çš„å…ƒç´ ï¼Œå¯ä»¥åœ¨ä½ å–œæ¬¢çš„ä»»ä½•åœ°æ–¹é‡ç”¨ï¼Œä¸å¿…æ‹…å¿ƒä»£ç å†²çªã€‚</p>
<ul>
<li>Custom elementsï¼ˆè‡ªå®šä¹‰å…ƒç´ ï¼‰ï¼šå…è®¸è‡ªå®šä¹‰ä¸€ä¸ªæ ‡ç­¾ï¼Œä»¥åŠä¸€äº›æ“ä½œï¼Œç„¶åå¯ä»¥åƒæ™®é€šæ ‡ç­¾ä¸€æ ·ä½¿ç”¨å®ƒ</li>
<li>Shadow DOMï¼ˆå½±å­DOMï¼‰ï¼šå¯ä»¥å¯¹è„šæœ¬å’Œæ ·å¼è¿›è¡Œéš”ç¦»ï¼Œä¸ç”¨æ‹…å¿ƒå¤–éƒ¨å¯¹å…¶ç”±å½±å“</li>
<li>HTML templatesï¼ˆHTMLæ¨¡æ¿ï¼‰ï¼š&lt;template&gt; å’Œ &lt;slot&gt; å…ƒç´ ä½¿æ‚¨å¯ä»¥ç¼–å†™ä¸åœ¨å‘ˆç°é¡µé¢ä¸­æ˜¾ç¤ºçš„æ ‡è®°æ¨¡æ¿ã€‚ç„¶åå®ƒä»¬å¯ä»¥ä½œä¸ºè‡ªå®šä¹‰å…ƒç´ ç»“æ„çš„åŸºç¡€è¢«å¤šæ¬¡é‡ç”¨ã€‚</li>
</ul>
<h2 id="è‡ªå®šä¹‰å…ƒç´ "><a href="#è‡ªå®šä¹‰å…ƒç´ " class="headerlink" title="è‡ªå®šä¹‰å…ƒç´ "></a>è‡ªå®šä¹‰å…ƒç´ </h2><p>CustomElementRegistry æ¥å£çš„å®ä¾‹ç”¨æ¥æ³¨å†Œä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ ï¼Œwindow.customElements è·å–å»åˆ° CustomElementRegistry å®ä¾‹ã€‚customElements.define() æ–¹æ³•ç”¨æ¥æ³¨å†Œä¸€ä¸ª custom elementï¼Œè¯¥æ–¹æ³•æ¥å—ä»¥ä¸‹å‚æ•°ï¼š</p>
<ul>
<li>è¡¨ç¤ºæ‰€åˆ›å»ºçš„å…ƒç´ åç§°çš„ç¬¦åˆ DOMString æ ‡å‡†çš„å­—ç¬¦ä¸²ã€‚æ³¨æ„ï¼Œcustom element çš„åç§°ä¸èƒ½æ˜¯å•ä¸ªå•è¯ï¼Œä¸”å…¶ä¸­å¿…é¡»è¦æœ‰çŸ­æ¨ªçº¿ã€‚</li>
<li>ç”¨äºå®šä¹‰å…ƒç´ è¡Œä¸ºçš„ ç±» ã€‚</li>
<li>å¯é€‰å‚æ•°ï¼Œä¸€ä¸ªåŒ…å« extends å±æ€§çš„é…ç½®å¯¹è±¡ï¼Œæ˜¯å¯é€‰å‚æ•°ã€‚å®ƒæŒ‡å®šäº†æ‰€åˆ›å»ºçš„å…ƒç´ ç»§æ‰¿è‡ªå“ªä¸ªå†…ç½®å…ƒç´ ï¼Œå¯ä»¥ç»§æ‰¿ä»»ä½•å†…ç½®å…ƒç´ ã€‚</li>
</ul>
<p>åƒè¿™æ ·å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å…ƒç´ &lt;user-p&gt;ï¼Œå¹¶ä¸”ç»§æ‰¿å…ƒç´ &lt;p&gt;</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">customElements.<span class="title function_">define</span>(</span><br><span class="line">    <span class="string">&#x27;user-p&#x27;</span>, </span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">UserP</span> <span class="keyword">extends</span> <span class="title class_ inherited__">HTMLParagraphElement</span> &#123;</span><br><span class="line">        <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// å¿…é¡»é¦–å…ˆè°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•</span></span><br><span class="line">            <span class="variable language_">super</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">extends</span>: <span class="string">&#x27;p&#x27;</span> </span><br><span class="line">    &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>è‡ªå®šä¹‰å…ƒç´ çš„ä½¿ç”¨ä¹Ÿåˆ†ä¸¤ç§æƒ…å†µ<br>ä¸€ç§æ˜¯å¦‚æœå…ƒç´ ä¸ç»§æ‰¿å…¶ä»–å†…å»º HTML å…ƒç´ ,åªç»§æ‰¿ HTMLElementï¼Œå¯ä»¥ç›´æ¥åƒæ™®é€šæ ‡ç­¾ä¸€æ ·ä½¿ç”¨</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">user-p</span>&gt;</span><span class="tag">&lt;/<span class="name">user-p</span>&gt;</span></span><br><span class="line">//æˆ–è€…è¿™æ ·</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;user-p&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯ç»§æ‰¿äº†å…¶ä»–å…ƒç´ ï¼Œæ¯”å¦‚åƒä¸Šé¢é‚£ä¸ªä¾‹å­ HTMLParagraphElement </p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">is</span>=<span class="string">&#x27;user-p&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">//æˆ–è€…è¿™æ ·</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;p&#x27;</span>,&#123;<span class="attr">is</span>:<span class="string">&#x27;user-p&#x27;</span>&#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°"><a href="#ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°" class="headerlink" title="ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°"></a>ç”Ÿå‘½å‘¨æœŸå›è°ƒå‡½æ•°</h3><ul>
<li>connectedCallbackï¼šé¦–æ¬¡è¢«æ’å…¥æ–‡æ¡£DOMæ—¶ï¼Œè¢«è°ƒç”¨ã€‚</li>
<li>disconnectedCallbackï¼šä»æ–‡æ¡£DOMä¸­åˆ é™¤æ—¶ï¼Œè¢«è°ƒç”¨ã€‚</li>
<li>adoptedCallbackï¼šè¢«ç§»åŠ¨åˆ°æ–°çš„æ–‡æ¡£æ—¶ï¼Œè¢«è°ƒç”¨ã€‚</li>
<li>attributeChangedCallback:å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹è‡ªèº«å±æ€§æ—¶ï¼Œè¢«è°ƒç”¨ã€‚</li>
</ul>
<p>å¦‚æœéœ€è¦åœ¨å…ƒç´ å±æ€§å˜åŒ–åï¼Œè§¦å‘ attributeChangedCallback()å›è°ƒå‡½æ•°ï¼Œä½ å¿…é¡»ç›‘å¬è¿™ä¸ªå±æ€§ã€‚è¿™å¯ä»¥é€šè¿‡å®šä¹‰ observedAttributes() getå‡½æ•°æ¥å®ç°ï¼ŒobservedAttributes()å‡½æ•°ä½“å†…åŒ…å«ä¸€ä¸ª return è¯­å¥ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†éœ€è¦ç›‘å¬çš„å±æ€§åç§°ï¼š</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">get</span> <span class="title function_">observedAttributes</span>() &#123;<span class="keyword">return</span> [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;style&#x27;</span>]; &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Shadow-DOM"><a href="#Shadow-DOM" class="headerlink" title="Shadow DOM"></a>Shadow DOM</h2><p>Shadow DOM å¯ä»¥å°†ä¸€ä¸ªéšè—çš„ã€ç‹¬ç«‹çš„ DOM é™„åŠ åˆ°ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œå¯ä»¥å°†æ ‡è®°ç»“æ„ã€æ ·å¼å’Œè¡Œä¸ºéšè—èµ·æ¥ï¼Œå¹¶ä¸é¡µé¢ä¸Šçš„å…¶ä»–ä»£ç ç›¸éš”ç¦»ï¼Œä¿è¯ä¸åŒçš„éƒ¨åˆ†ä¸ä¼šæ··åœ¨ä¸€èµ·ï¼Œå¯ä½¿ä»£ç æ›´åŠ å¹²å‡€ã€æ•´æ´ã€‚</p>
<ul>
<li>Shadow hostï¼šä¸€ä¸ªå¸¸è§„ DOM èŠ‚ç‚¹ï¼ŒShadow DOM ä¼šè¢«é™„åŠ åˆ°è¿™ä¸ªèŠ‚ç‚¹ä¸Šã€‚</li>
<li>Shadow treeï¼šShadow DOM å†…éƒ¨çš„ DOM æ ‘ã€‚</li>
<li>Shadow boundaryï¼šShadow DOM ç»“æŸçš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯å¸¸è§„ DOM å¼€å§‹çš„åœ°æ–¹ã€‚</li>
<li>Shadow root: Shadow tree çš„æ ¹èŠ‚ç‚¹ã€‚</li>
</ul>
<p>åƒ&lt;video&gt;å°±æ˜¯ç”¨ Shadow DOM å°è£…çš„</p>
<p><img src="/images/posts/webcomponents/20200510202839.png" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'></p>
<h3 id="è‡ªå®šä¹‰Shadow-DOM"><a href="#è‡ªå®šä¹‰Shadow-DOM" class="headerlink" title="è‡ªå®šä¹‰Shadow DOM"></a>è‡ªå®šä¹‰Shadow DOM</h3><p>å¯ä»¥ä½¿ç”¨ Element.attachShadow() æ–¹æ³•æ¥å°†ä¸€ä¸ª shadow root é™„åŠ åˆ°ä»»ä½•ä¸€ä¸ªå…ƒç´ ä¸Š,æ–¹æ³•æ¥å—ä¸€ä¸ªå‚æ•°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">attachShadow å‚æ•°</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">mode</span>:<span class="string">&#x27;open&#x27;</span>|<span class="string">&#x27;closed&#x27;</span>, </span><br><span class="line">    <span class="comment">//open è¡¨ç¤ºå¤–éƒ¨å¯ä»¥è®¿é—®æ ¹èŠ‚ç‚¹,ä¾‹å¦‚ Element.shadowRoot </span></span><br><span class="line">    <span class="comment">//closed è¡¨ç¤ºä¸å…è®¸å¤–éƒ¨è®¿é—®</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">delegatesFocus</span>:<span class="literal">true</span>|<span class="literal">false</span></span><br><span class="line">    <span class="comment">//ç„¦ç‚¹å§”æ‰˜</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç®€å•ä¾‹å­</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.demo</span>&#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>:red <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.test</span>&#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-size</span>:<span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;test&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&#x27;demo&#x27;</span>&gt;</span></span><br><span class="line">        ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ Shadow DOM </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> demo = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;demo&#x27;</span>).<span class="title function_">attachShadow</span>(&#123; <span class="attr">mode</span>: <span class="string">&#x27;open&#x27;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> style = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;style&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">      style.<span class="property">textContent</span> = <span class="string">`</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      .demo &#123;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">          color: #38acfa;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &#125;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      :host&#123;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">          border:5px  dashed #3699ff;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &#125;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      :host-context(.test)&#123;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">          background:#000;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &#125;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      :host(#demo)&#123;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">          height:60px;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">          margin: 20px;</span></span></span><br><span class="line"><span class="string"><span class="language-javascript">      &#125;`</span></span></span><br><span class="line"><span class="language-javascript">      demo.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;div class=&quot;demo&quot;&gt;è‡ªå®šä¹‰Shadow DOM&lt;/div&gt;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      demo.<span class="title function_">appendChild</span>(style)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ•ˆæœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°å¤–éƒ¨æ ·å¼æ˜¯ä¸ä¼šå½±å“é‡Œé¢å…ƒç´ çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯æ ·å¼æ˜¯ç»§æ‰¿ç¥–å…ˆå…ƒç´ çš„æ˜¯ä¼šç©¿é€è¿›å»çš„</p>
<p>è¿™ä¸‰ä¸ªéƒ½æ˜¯ç”¨æ¥é€‰å®š å®¿ä¸»å…ƒç´  çš„</p>
<ul>
<li>:host å½“å‰ ShadowDOM å®¿ä¸»å…ƒç´ </li>
<li>:host() åœ¨å®¿ä¸»å…ƒç´ ä¸ŠæŸ¥æ‰¾ï¼Œæ¯”å¦‚ä¸Šé¢çš„ :host(#demo) å°±æ˜¯å½“å®¿ä¸»å…ƒç´  id&#x3D;â€™demoâ€™ æ—¶å€™ç”Ÿæ•ˆ</li>
<li>:host-context() åœ¨å½“å‰ ShadowDOM å®¿ä¸»å…ƒç´ çš„ç¥–å…ˆèŠ‚ç‚¹ä¸­æŸ¥æ‰¾ï¼Œæ¯”å¦‚ :host-context(.test) å¯ä»¥ä¸€ç›´å¾€å®¿ä¸»å…ƒç´ ç¥–å…ˆä¸Šæ‰¾ï¼Œç¬¦åˆå°±ç”Ÿæ•ˆ</li>
</ul>
<br>
<style>
    .demo{
        color:red !important;
    }
    .test{
        font-size:20px;
    }
</style>
<div class='test'>
    <div id='demo'>
        ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ Shadow DOM 
    </div>
</div>  
<script>
      let demo = document.getElementById('demo').attachShadow({ mode: 'open' })
      var style = document.createElement('style');
      style.textContent = `
      .demo {
          color: #38acfa;
      }
      :host{
          border:5px  dashed #3699ff;
      }
      :host-context(.test){
          background:#000;
      }
      :host(#demo){
          height:60px;
          margin: 20px;
      }`
      demo.innerHTML = '<div class="demo">è‡ªå®šä¹‰Shadow DOM</div>'
      demo.appendChild(style)
</script>


<h2 id="HTMLæ¨¡æ¿"><a href="#HTMLæ¨¡æ¿" class="headerlink" title="HTMLæ¨¡æ¿"></a>HTMLæ¨¡æ¿</h2><p>template ä¸»è¦ä½œç”¨å°±æ˜¯é¿å…é‡å¤å»åˆ›å»ºé‚£äº›æ ‡ç­¾ç»“æ„ã€‚æ¯”å¦‚å½“ä¸€ä¸ªç»„ä»¶è¢«é‡å¤ä½¿ç”¨æ—¶å€™ï¼Œå¦‚æœä¸ç”¨æ¨¡æ¿çš„è¯ï¼Œä¼šä¸€éåˆä¸€éçš„å»åˆ›å»ºç»„ä»¶ç±»çš„æ ‡ç­¾ç»“æ„ï¼Œä½¿ç”¨ template è¿™æ ·ä¼šé¿å…è¿™æ ·é‡å¤çš„åˆ›å»ºæ ‡ç­¾ç»“æ„ã€‚</p>
<p>template ä¸ä¼šå† DOM ä¸Šæ˜¾ç¤ºï¼Œä¸¾ä¾‹ï¼š</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;my-template&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        HTML æ¨¡æ¿</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ js å»è·å–å®ƒ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> template = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;my-template&#x27;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(template.<span class="property">content</span>);</span><br></pre></td></tr></table></figure>

<h2 id="ç»„åˆä½¿ç”¨"><a href="#ç»„åˆä½¿ç”¨" class="headerlink" title="ç»„åˆä½¿ç”¨"></a>ç»„åˆä½¿ç”¨</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-div</span> <span class="attr">image</span>=<span class="string">&#x27;/images/logo/admin_template.png&#x27;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&#x27;header&#x27;</span>&gt;</span>Web Components<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&#x27;footer&#x27;</span>&gt;</span></span><br><span class="line">        slot footer</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">my-div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">&quot;my-template&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.card</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="number">0</span> <span class="number">#00000038</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">ul</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">list-style</span>: disc;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">padding-left</span>: <span class="number">1.5em</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">li</span>+<span class="selector-tag">li</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#f1f1f1</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">img</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>:<span class="number">250px</span></span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.header</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#f1f1f1</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.footer</span>&#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#f1f1f1</span>;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;card&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;header&#x27;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&#x27;header&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&#x27;footer&#x27;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&#x27;footer&#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    customElements.<span class="title function_">define</span>(<span class="string">&#x27;my-div&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">class</span> <span class="title class_">extends</span> <span class="title class_">HTMLElement</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">super</span>();</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> template = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;my-template&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> templateContent = template.<span class="property">content</span>.<span class="title function_">cloneNode</span>(<span class="literal">true</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> shadowRoot = <span class="variable language_">this</span>.<span class="title function_">attachShadow</span>(&#123; <span class="attr">mode</span>: <span class="string">&#x27;open&#x27;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                templateContent.<span class="title function_">querySelector</span>(<span class="string">&#x27;img&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;src&#x27;</span>, <span class="variable language_">this</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;image&#x27;</span>));</span></span><br><span class="line"><span class="language-javascript">                shadowRoot.<span class="title function_">appendChild</span>(templateContent);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<my-div image='/images/logo/web_conponents.png'>
    <div slot='header'>Web Components</div>
    <div slot='footer'>
        slot footer
    </div>
</my-div>

<template id="my-template">
    <style>
        .card{
            padding: 10px 20px;
            box-shadow: 0 0 5px 0 #00000038;
            border-radius: 5px;
            display: inline-block;
        }
        ul {
            list-style: disc;
            padding-left: 1.5em;
        }
        li {
            height: 30px;
        }
        li+li {
            border-top: 1px solid #f1f1f1;
        }
        img{
            width:250px
        }
        .header{
            margin-bottom: 10px;
            border-bottom: 1px solid #f1f1f1;
        }
        .footer{
            margin-top: 10px;
            border-top: 1px solid #f1f1f1;
        }
    </style>
    <div class='card'>
        <div class='header'>
            <slot name='header'></slot>
        </div>
        <img>
        <div class='footer'>
            <slot name='footer'></slot>
        </div>
    </div>
</template>

<script>
    customElements.define('my-div',
        class extends HTMLElement {
            constructor() {
                super();
                let template = document.getElementById('my-template');
                let templateContent = template.content.cloneNode(true);

                const shadowRoot = this.attachShadow({ mode: 'open' })

                templateContent.querySelector('img').setAttribute('src', this.getAttribute('image'));
                shadowRoot.appendChild(templateContent);
            }
        })
</script>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>WebComponents</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo åœ¨çº¿ç¼–è¾‘å™¨</title>
    <url>/web_hexo_editor/</url>
    <content><![CDATA[<p>å¼€æºäº†ä¸€æ¬¾ Hexo åœ¨çº¿ç¼–è¾‘å™¨ï¼Œæä¾›åœ¨çº¿ç¼–å†™ Hexo æ–¹å¼ã€‚ç›®å‰å·²å®ç°å¯¹æœ¬åœ° Hexo ç¼–è¾‘ç»´æŠ¤</p>
<p><img src="/images/img_20230406222520_1.png" alt="Img" loading="lazy" onerror='this.onerror=null;this.src="/img/404.jpg"'> <em>ç¤ºä¾‹</em></p>
<span id="more"></span>

<p>è¯ä¸å¤šè¯´æ”¾é“¾æ¥ï¼š<a href="https://web-hexo-editor.imalun.com/">åœ¨çº¿åœ°å€</a>ã€<a href="https://github.com/MaLuns/hexo-editor">Github åœ°å€</a></p>
<h3 id="å®ç°å¤§è‡´åŸç†"><a href="#å®ç°å¤§è‡´åŸç†" class="headerlink" title="å®ç°å¤§è‡´åŸç†"></a>å®ç°å¤§è‡´åŸç†</h3><p>å®ç°ä¸ç®—å¤æ‚ï¼Œåˆ©ç”¨ FileSystemHandle è·å–æ–‡ä»¶è¯»å†™æƒé™ï¼Œå°±å¯ä»¥éšå¿ƒæ‰€æ¬²æ“ä½œ Hexo æ–‡ä»¶äº†ï¼Œå°±å¯å¯¹æ–‡ä»¶å¢åˆ æ”¹äº†ã€‚</p>
<p>è‡³äºé¢„è§ˆå°±æ›´ç®€å•äº†ï¼Œå°† hexo-renderer æ“ä½œæ›¿æ¢ markdown æ¸²æŸ“æ“ä½œï¼Œå®æ—¶æ¸²æŸ“è¾“å‡º HTML å°±å¯ä»¥äº†ï¼Œè¿™äº›éƒ½æœ‰å¾ˆå¤šç°æˆçš„æ¡ˆä¾‹ã€‚</p>
<p>éœ€è¦æ›´åŠ å®Œæ•´æ”¯æŒ Hexo åœ¨çº¿ç¼–è¾‘é¢„è§ˆï¼Œè¿˜æ˜¯æœ‰äº›ç»†èŠ‚éœ€è¦è°ƒæ•´çš„ï¼Œæ¯”å¦‚éœ€è¦æ”¯æŒé…ç½®é¢„è§ˆæ ·å¼ï¼Œæœ€å¥½èƒ½å’Œè‡ªå·±åšå®¢æ ·å¼ä¸€è‡´ï¼Œè¿˜éœ€è¦æ”¯æŒ Hexo Tag ç­‰è¿™äº›éœ€è¦å®Œå–„ã€‚</p>
<h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><p>ä»¥å®ç°åŠŸèƒ½</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> æ–‡ç« å¢åˆ æ”¹å’Œé¢„è§ˆ</li>
<li><input checked="" disabled="" type="checkbox"> å‘å¸ƒè‰ç¨¿ã€ä¸‹æ¶å‘å¸ƒ</li>
<li><input checked="" disabled="" type="checkbox"> Markdown ç¼–è¾‘ã€é¢„è§ˆã€æ ¼å¼åŒ–</li>
<li><input checked="" disabled="" type="checkbox"> front-matters ç¼–è¾‘</li>
<li><input checked="" disabled="" type="checkbox"> å›¾ç‰‡ç²˜è´´ã€Markdown è¯­æ³•æç¤ºã€è§£æ HTML</li>
<li><input checked="" disabled="" type="checkbox"> ä¸»é¢˜åˆ‡æ¢</li>
<li><input checked="" disabled="" type="checkbox"> é™æ€èµ„æºç®¡ç†</li>
<li><input checked="" disabled="" type="checkbox"> å‘½ä»¤é¢æ¿</li>
</ul>
<p>è®¡åˆ’å®ç°</p>
<ul>
<li><input disabled="" type="checkbox"> æ›¿æ¢ markdown æ¸²æŸ“å™¨ï¼ˆå› ä¸º Hexo é»˜è®¤ç”¨ markedï¼Œç»“æœ marked æ¸²æŸ“æ ‡è®°åˆ°å…·ä½“è¡Œï¼Œæ¯”è¾ƒéº»çƒ¦ï¼Œå¯¼è‡´åŒæ­¥æ»šåŠ¨è¿˜æ²¡å®ç°ï¼‰</li>
<li><input disabled="" type="checkbox"> æœç´¢æ–‡ç« å†…å®¹</li>
<li><input disabled="" type="checkbox"> æ”¯æŒå›¾åºŠ</li>
<li><input disabled="" type="checkbox"> Markdown åŒæ­¥æ»šåŠ¨</li>
<li><input disabled="" type="checkbox"> è¿æ¥ Github ä»“åº“ï¼Œå½»åº•åœ¨çº¿ç»´æŠ¤ Hexo åšå®¢</li>
</ul>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
  </entry>
  <entry>
    <title>è§£è¯» webpack æ‰“åŒ…åjs</title>
    <url>/webpack/</url>
    <content><![CDATA[<p>é¦–å…ˆæ–°å»º index.js,a.js,b.js ä¸‰ä¸ªæ–‡ä»¶,index.js é…ç½®ä¸ºå…¥å£,index.js åˆ†åˆ«åŠ è½½a.js,b.jsæ–‡ä»¶, b.jsåŠ è½½a.jsæ–‡ä»¶,jsä¸­ä»£ç å¦‚ä¸‹</p>
<span id="more"></span>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./a.js&#x27;</span>)()</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./b.js&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = test</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&#x27;./a.js&#x27;</span>)()</span><br></pre></td></tr></table></figure>


<p>å¯¹æ–‡ä»¶è¿›è¡Œæ‰“åŒ…,æ‰“åŒ…ç»“æœå¦‚ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/******/</span> (<span class="keyword">function</span>(<span class="params">modules</span>) &#123; </span><br><span class="line"><span class="comment">/******/</span> 	<span class="keyword">var</span> installedModules = &#123;&#125;; <span class="comment">//å¯¹æ¨¡å—è¿›è¡Œç¼“å­˜</span></span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	<span class="keyword">function</span> <span class="title function_">__webpack_require__</span>(<span class="params">moduleId</span>) &#123;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 		<span class="keyword">if</span>(installedModules[moduleId]) &#123;<span class="comment">//æœ‰ç¼“å­˜ ç›´æ¥è¿”å› exports</span></span><br><span class="line"><span class="comment">/******/</span> 			<span class="keyword">return</span> installedModules[moduleId].<span class="property">exports</span>;</span><br><span class="line"><span class="comment">/******/</span> 		&#125;</span><br><span class="line"><span class="comment">/******/</span> 		<span class="keyword">var</span> <span class="variable language_">module</span> = installedModules[moduleId] = &#123;</span><br><span class="line"><span class="comment">/******/</span> 			<span class="attr">i</span>: moduleId,</span><br><span class="line"><span class="comment">/******/</span> 			<span class="attr">l</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="comment">/******/</span> 			<span class="attr">exports</span>: &#123;&#125;</span><br><span class="line"><span class="comment">/******/</span> 		&#125;;</span><br><span class="line"><span class="comment">/******/</span>                <span class="comment">//åŠ è½½æ¨¡å—</span></span><br><span class="line"><span class="comment">/******/</span> 		modules[moduleId].<span class="title function_">call</span>(<span class="variable language_">module</span>.<span class="property">exports</span>, <span class="variable language_">module</span>, <span class="variable language_">module</span>.<span class="property">exports</span>, __webpack_require__);</span><br><span class="line"><span class="comment">/******/</span> 		<span class="variable language_">module</span>.<span class="property">l</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">/******/</span> 		<span class="keyword">return</span> <span class="variable language_">module</span>.<span class="property">exports</span>; <span class="comment">//è¿”å› exports</span></span><br><span class="line"><span class="comment">/******/</span> 	&#125;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	__webpack_require__.<span class="property">m</span> = modules;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	__webpack_require__.<span class="property">c</span> = installedModules;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	__webpack_require__.<span class="property">d</span> = <span class="keyword">function</span>(<span class="params"><span class="built_in">exports</span>, name, getter</span>) &#123;</span><br><span class="line"><span class="comment">/******/</span> 		<span class="keyword">if</span>(!__webpack_require__.<span class="title function_">o</span>(<span class="built_in">exports</span>, name)) &#123;</span><br><span class="line"><span class="comment">/******/</span> 			<span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="built_in">exports</span>, name, &#123;</span><br><span class="line"><span class="comment">/******/</span> 				<span class="attr">configurable</span>: <span class="literal">false</span>,</span><br><span class="line"><span class="comment">/******/</span> 				<span class="attr">enumerable</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="comment">/******/</span> 				<span class="attr">get</span>: getter</span><br><span class="line"><span class="comment">/******/</span> 			&#125;);</span><br><span class="line"><span class="comment">/******/</span> 		&#125;</span><br><span class="line"><span class="comment">/******/</span> 	&#125;;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	__webpack_require__.<span class="property">n</span> = <span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span></span>) &#123;</span><br><span class="line"><span class="comment">/******/</span> 		<span class="keyword">var</span> getter = <span class="variable language_">module</span> &amp;&amp; <span class="variable language_">module</span>.<span class="property">__esModule</span> ?</span><br><span class="line"><span class="comment">/******/</span> 			<span class="keyword">function</span> <span class="title function_">getDefault</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="variable language_">module</span>[<span class="string">&#x27;default&#x27;</span>]; &#125; :</span><br><span class="line"><span class="comment">/******/</span> 			<span class="keyword">function</span> <span class="title function_">getModuleExports</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> <span class="variable language_">module</span>; &#125;;</span><br><span class="line"><span class="comment">/******/</span> 		__webpack_require__.<span class="title function_">d</span>(getter, <span class="string">&#x27;a&#x27;</span>, getter);</span><br><span class="line"><span class="comment">/******/</span> 		<span class="keyword">return</span> getter;</span><br><span class="line"><span class="comment">/******/</span> 	&#125;;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	__webpack_require__.<span class="property">o</span> = <span class="keyword">function</span>(<span class="params">object, property</span>) &#123; <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">hasOwnProperty</span>.<span class="title function_">call</span>(object, property); &#125;;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	__webpack_require__.<span class="property">p</span> = <span class="string">&quot;/&quot;</span>;</span><br><span class="line"><span class="comment">/******/</span></span><br><span class="line"><span class="comment">/******/</span> 	<span class="keyword">return</span> <span class="title function_">__webpack_require__</span>(__webpack_require__.<span class="property">s</span> = <span class="number">1</span>);<span class="comment">//åŠ è½½å…¥å£ å¹¶è¿”å›exports</span></span><br><span class="line"><span class="comment">/******/</span> &#125;)</span><br><span class="line"><span class="comment">/************************************************************************/</span></span><br><span class="line">([</span><br><span class="line"><span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>)&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">3</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">module</span>.<span class="property">exports</span> = test</span><br><span class="line">&#125;,</span><br><span class="line"><span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>)&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        <span class="title function_">__webpack_require__</span>(<span class="number">0</span>)();</span><br><span class="line">        <span class="title function_">__webpack_require__</span>(<span class="number">2</span>);</span><br><span class="line">&#125;,</span><br><span class="line"><span class="keyword">function</span>(<span class="params"><span class="variable language_">module</span>, <span class="built_in">exports</span>, __webpack_require__</span>)&#123;</span><br><span class="line">    <span class="string">&quot;use strict&quot;</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>)</span><br><span class="line">        <span class="title function_">__webpack_require__</span>(<span class="number">0</span>)();</span><br><span class="line">&#125;])</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥çœ‹åˆ° webpack æ‰“åŒ…åjs æ˜¯ä¸€ä¸ªè‡ªæ‰§è¡ŒåŒ¿åå‡½æ•°,è€Œæˆ‘ä»¬çš„æ‰€æœ‰æ¨¡å—è¢«æ‰“åŒ…æˆäº†ä¸€ä¸ªæ•°ç»„ä¼ å…¥åŒ¿åå‡½æ•°ä¸­(modules),å…¶ä¸­æ¯ä¸ªå…ƒç´ ä»£è¡¨ä¸€ä¸ªæ¨¡å—.ç„¶åé€šè¿‡  <strong>webpack_require</strong>(<strong>webpack_require</strong>.s &#x3D; 1) åŠ è½½å…¥å£æ¨¡å—.è°ƒç”¨ <strong>webpack_require</strong> æ–¹æ³•ä¼šæ¥æ”¶ä¸€ä¸ªæ¨¡å—ID(å¯¹åº”æ•°ç»„ä¸‹æ ‡),ç„¶åæ£€æŸ¥ installedModules å˜é‡æ˜¯å¦å·²å­˜åœ¨å¯¹åº”æ¨¡å—,å¦‚æœå·²å­˜åœ¨ä¼šç›´æ¥è¿”å›å½“å‰æ¨¡å—module.exports,å¦åˆ™ä¼šå…ˆå»åŠ è½½æ¨¡å—,å†è¿”å›module.exports </p>
</blockquote>
<p>æ‰§è¡Œç»“æœ 1323</p>
]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
      <tags>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title>å°ç¨‹åº swiper æ€§èƒ½ä¼˜åŒ–</title>
    <url>/wx_swiper/</url>
    <content><![CDATA[<p>äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œæˆ‘åšäº†ä¸€ä¸ªåœ¨çº¿å£çº¸å°ç¨‹åºï¼Œå£çº¸é¢„è§ˆéƒ¨åˆ†ä¸ºäº†æ›´å¥½æ—¶ä½¿ç”¨ä½“éªŒï¼Œå¢åŠ äº†ç±»ä¼¼äºé‚£äº›çŸ­è§†é¢‘ä¸Šæ»‘ä¸‹æ»‘å¿«é€Ÿåˆ‡æ¢å£çº¸é¢„è§ˆçš„åŠŸèƒ½ï¼Œä¸ºäº†é¿å…é‡å¤é€ è½®å­ç›´æ¥ä½¿ç”¨äº† swiper æ¥æ—¶å®ç°æ»‘åŠ¨å¿«é€Ÿåˆ‡æ¢å£çº¸ã€‚</p>
<span id="more"></span>

<h3 id="é—®é¢˜æ‰€åœ¨"><a href="#é—®é¢˜æ‰€åœ¨" class="headerlink" title="é—®é¢˜æ‰€åœ¨"></a>é—®é¢˜æ‰€åœ¨</h3><p>å½“å£çº¸é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼Œå…¨éƒ¨æ¸²æŸ“æˆ swiper-itemï¼Œä¼šå‡ºç°æ˜æ˜¾æ€§èƒ½é—®é¢˜ã€‚è¿˜æœ‰ä¸ªåŸå› åº”è¯¥é¢„è§ˆå£çº¸æ—¶åŠ è½½çš„éƒ½æ˜¯é«˜æ¸…åŸå›¾ï¼Œç›´æ¥å…¨éƒ¨åŠ è½½å‡ºæ¥ï¼Œå¯¹æ€§èƒ½ä¹Ÿæ˜¯å¾ˆå¤§ä¸€ä¸ªæµªè´¹ã€‚å›¾ç‰‡çš„åŠ å¯ä»¥é€šè¿‡è®¾ç½® lazy-load æ‡’åŠ è½½å›¾ç‰‡ã€‚</p>
<h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><p>è§£å†³æ–¹æ¡ˆä¹ŸæŒºç®€å•ï¼Œç›´æ¥ä½¿ç”¨åˆ†é¡µå»å¤„ç†ï¼Œæ¯”å¦‚æœ‰ 200 é¡¹ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸€æ¬¡åªæ¸²æŸ“ 3 ä¸ª swiper-itemï¼Œæ¯”å¦‚å½“å‰ä¸‹æ ‡æ˜¯ 1ï¼ˆå¯¹åº”åŸåˆ—è¡¨ä¸‹æ ‡1ï¼‰ï¼Œå½“ä½ ä¸‹æ»‘æ—¶æ–°çš„ä¸‹æ ‡å°±æ˜¯ 2ï¼ˆå¯¹åº”åŸåˆ—è¡¨ä¸‹æ ‡2ï¼‰äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬æ›´æ–°ä¸‹æ ‡ 0ï¼ˆå¯¹åº”åŸåˆ—è¡¨ä¸‹æ ‡3ï¼‰ï¼Œä¸ºå½“å‰é¡¹ï¼Œå¯¹åº”åŸå§‹åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªï¼Œä¸Šæ»‘ä¹Ÿæ˜¯è¿™æ ·çš„é€»è¾‘ï¼Œè¿™æ ·å°±ä¿è¯æ¯æ¬¡æ»‘æ´éƒ½æŒ‰ç…§åŸå§‹åˆ—è¡¨é¡ºåºæ˜¾ç¤ºçš„ï¼Œä½†æ˜¯å®é™…é¡µé¢åªæ¸²æŸ“ 3 ä¸ª swiper-itemï¼Œå’Œè™šæ‹Ÿåˆ—è¡¨åŸç†ç±»ä¼¼ã€‚</p>
<p>å®˜æ–¹æä¾›äº†ä¸€ä¸ª <a href="https://developers.weixin.qq.com/miniprogram/dev/platform-capabilities/extended/component-plus/video-swiper.html">video-swiper</a> ç»„ä»¶ï¼ŒåŸç†æ—¶ç±»ä¼¼çš„ï¼Œåªä¸è¿‡æ˜¯ç»™è§†é¢‘åˆ—è¡¨ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬å‚è€ƒä»–çš„å®ç°è¿›è¡Œä¿®æ”¹ã€‚</p>
<h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>å‡è®¾æˆ‘ä»¬çš„æ•°æ®çš„ä¸º listï¼Œå®é™…æ¸²æŸ“çš„æ•°æ®ä¸º swiperListï¼Œæˆ‘ä»¬ç°åœ¨ç»™ä»–å°±å›ºå®š 3 ä¸ª swiper-itemï¼Œå‰åæ»‘åŠ¨çš„æ—¶å€™å»æ›¿æ¢æ•°æ®ï¼Œæ­£å‘æ»‘åŠ¨çš„æ—¶å€™å»æ›¿æ¢æ»‘åŠ¨åçš„ä¸‹ä¸€ä¸ªæ•°æ®ï¼Œåå‘æ»‘åŠ¨çš„æ—¶å€™å»æ›¿æ¢æ»‘åŠ¨åçš„ä¸Šä¸€ä¸ªæ•°æ®ï¼Œç„¶åå°† swiper è®¾ç½®ä¸ºå¯è¡”æ¥æ»‘åŠ¨ï¼Œè¿™æ ·ä¿è¯ä¸€ç›´å¯ä»¥å¾ªç¯æ»‘åŠ¨ï¼Œç„¶åæ›´å…·æ»‘åŠ¨æ–¹å‘æ›¿æ¢æ•°æ®ã€‚</p>
<p>ç›‘å¬ swiper çš„ bindchange äº‹ä»¶ï¼Œå¯ä»¥è·å–åˆ°æ»‘åŠ¨åçš„ currentï¼Œç„¶ååœ¨ bindchange äº‹ä»¶é‡Œæ›´æ–°æ•°æ®</p>
<p>æ»‘åŠ¨çš„æ–¹å‘åˆ¤æ–­</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// swiper é•¿åº¦</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">LEN</span> = <span class="number">3</span></span><br><span class="line"><span class="keyword">const</span> stateNum = current - <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">swiperIndex</span></span><br><span class="line"><span class="keyword">const</span> state = [-<span class="number">1</span>, <span class="variable constant_">LEN</span> - <span class="number">1</span>].<span class="title function_">includes</span>(stateNum) ? <span class="string">&quot;Last&quot;</span> : <span class="string">&quot;Next&quot;</span></span><br></pre></td></tr></table></figure>

<p>è·å– swiperList éœ€è¦æ›´æ–°çš„ä¸‹æ ‡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> updateIndex;</span><br><span class="line"><span class="keyword">if</span> (state === <span class="string">&quot;Next&quot;</span>) &#123;</span><br><span class="line">    updateIndex = current === (<span class="variable constant_">LEN</span> - <span class="number">1</span>) ? <span class="number">0</span> : current + <span class="number">1</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    updateIndex = current === <span class="number">0</span> ? (<span class="variable constant_">LEN</span> - <span class="number">1</span>) : current - <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤äº†éœ€è¦ swiperList æ›´æ–°ä¸‹æ ‡ï¼Œè¿˜å¾—è®°å½•å¯¹åº” list çš„ä¸‹æ ‡</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·å–å½“å‰é¡¹å¯¹åº” list ä¸‹æ ‡</span></span><br><span class="line"><span class="keyword">const</span> previewIndex = state === <span class="string">&quot;Last&quot;</span> ? <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">previewIndex</span> - <span class="number">1</span> : <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">previewIndex</span> + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>ç„¶åæ®å¯ä»¥æ ¹æ®æ»‘å—æ–¹å‘å’Œ previewIndexï¼Œå°±å¯ä»¥ç¡®å®šæ›´æ–° swiperList æ•°æ®äº†</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"> <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">    <span class="comment">// æ›´æ–°å®é™… list ä¸‹æ ‡</span></span><br><span class="line">    previewIndex, </span><br><span class="line">    [<span class="string">`swiperList[<span class="subst">$&#123;updateIndex&#125;</span>]`</span>]: state === <span class="string">&quot;Last&quot;</span> ? list[previewIndex - <span class="number">1</span>] : list[previewIndex + <span class="number">1</span>] </span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// è®°å½• swiper ä¸‹æ ‡</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">swiperIndex</span> = current</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®ä¸Šé¢æ€è·¯åŸºæœ¬ä¸Šå¯ä»¥è§£å†³ swiper æ•°æ®é‡å¤§æ€§èƒ½é—®é¢˜äº†ï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚</p>
<ul>
<li>æ»‘å—è¾¹ç•Œé—®é¢˜ï¼Œlist æ•°æ®ä¹Ÿæ˜¯æœ‰é™çš„ï¼Œä¹Ÿä¼šæ»‘åˆ°è¾¹ç•Œï¼Œéœ€è¦å¯¹è¾¹ç•Œåšä¸€ä¸ªåˆ¤æ–­å¤„ç†</li>
</ul>
<p>è¿™ä¸ªé—®é¢˜å¯ä»¥æ ¹æ® previewIndex ä¸‹æ ‡å»åˆ¤æ–­æ˜¯å¦åˆ°è¾¾äº†è¾¹ç•Œï¼Œå¦‚æœä¸éœ€è¦æ— é™åŠ è½½æ•°æ®ï¼Œå¯ä»¥åœ¨è¾¾åˆ°è¾¹ç•Œæ—¶ç›´æ¥å›å¼¹é™æ­¢æ»‘å—ç»§ç»­æ»šåŠ¨ï¼Œå› ä¸ºè®¾ç½® swiper ä¸ºè¡”æ¥æ»‘åŠ¨ï¼Œè¾¾åˆ°è¾¹ç•Œæ—¶æ»‘åŠ¨æ—¶ä¸Šä¸€ä¸ªæˆ–è€…ä¸‹ä¸€ä¸ªè¿˜æ˜¯ä¼šæ˜¾ç¤ºæœ‰å…¶ä»– swiper-itemï¼Œæ‰€æœ‰éœ€è¦æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªç©ºçš„ swiper-item ç”¨æ¥å ä½ã€‚å¦‚æœæ—¶éœ€è¦æ— é™åŠ è½½æ•°æ®ï¼Œå¯ä»¥åœ¨å¿«åˆ°è¾¾è¾¹ç•Œæ—¶æå‰æ‹‰å–æ•°æ®ï¼Œç­‰æ‹¿åˆ°æ•°æ®æ—¶ç»§ç»­ä¸‹æ»‘ï¼Œå¦åˆ™åå¼¹å›å»ä¿æŒåœ¨æœ€åä¸€ä¸ªã€‚</p>
<ul>
<li>å½“ previewIndex ä¸æ˜¯é€šè¿‡æ»‘å—æ›´æ–°æ—¶å€™ï¼Œæ¯”å¦‚ç›´æ¥ä» 0 è·³åˆ° 5 ä¼šæœ‰é»˜è®¤æ»šåŠ¨åŠ¨ç”»ï¼Œå¯¼è‡´ä½“éªŒå¾ˆå·®</li>
</ul>
<p>è¿™ä¸ªè§£å†³æ–¹å¼æ˜¯åœ¨éæ»‘åŠ¨æ›´æ–°æ—¶å€™ï¼Œå…ˆå°†åŠ¨ç”»æ—¶é—´ duration è®¾ç½®ä¸º 0 ï¼Œå»æ‰åŠ¨ç”»ï¼Œç„¶ååœ¨æ›´æ–°ä¸‹æ ‡å’Œæ¢å¤åŠ¨ç”»ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123; <span class="attr">duration</span>: <span class="number">0</span> &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        <span class="attr">previewIndex</span>: previewIndex,</span><br><span class="line">        <span class="attr">swiperIndex</span>: swiperIndex,</span><br><span class="line">        <span class="attr">swiperList</span>: swiperList,</span><br><span class="line">        <span class="attr">duration</span>: <span class="number">500</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><p>ç›¸å¯¹å®Œæ•´çš„ä»£ç å®ç°</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">vertical</span>=<span class="string">&quot;&#123;&#123;true&#125;&#125;&quot;</span> <span class="attr">duration</span>=<span class="string">&quot;&#123;&#123;duration&#125;&#125;&quot;</span> <span class="attr">current</span>=<span class="string">&quot;&#123;&#123;swiperIndex&#125;&#125;&quot;</span> <span class="attr">circular</span>=<span class="string">&quot;&#123;&#123;circular&#125;&#125;&quot;</span> <span class="attr">bindchange</span>=<span class="string">&quot;handleChangeBigImage&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;swiperList&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;index&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;item.type===&#x27;placeholder&#x27;&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;placeholder-view&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:else</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">show-menu-by-longpress</span> <span class="attr">lazy-load</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item.path&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ts"><table><tr><td class="code"><pre><span class="line"><span class="comment">// swiper é•¿åº¦</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">LEN</span> = <span class="number">3</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">SwiperPlaceholder</span> = &#123; <span class="attr">type</span>: <span class="string">&quot;placeholder&quot;</span> &#125;</span><br><span class="line"><span class="keyword">type</span> <span class="title class_">State</span> = <span class="string">&quot;Next&quot;</span> | <span class="string">&quot;Last&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Component</span>(&#123;</span><br><span class="line">  <span class="attr">properties</span>: &#123;</span><br><span class="line">    <span class="attr">list</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Array</span>,</span><br><span class="line">      <span class="attr">value</span>: [] <span class="keyword">as</span> <span class="title class_">Array</span>&lt;<span class="title class_">ImageItem</span>&gt;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">index</span>: &#123;</span><br><span class="line">      <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">      <span class="attr">value</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="comment">// å½“å‰å…ƒç´ ä¸‹æ ‡</span></span><br><span class="line">    <span class="attr">previewIndex</span>: <span class="number">0</span>,</span><br><span class="line">    <span class="comment">// swiper åˆ‡æ¢</span></span><br><span class="line">    <span class="attr">circular</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">duration</span>: <span class="number">300</span>,</span><br><span class="line">    <span class="attr">swiperIndex</span>: <span class="number">1</span>, <span class="comment">// å½“å‰ swiper ä¸‹æ ‡</span></span><br><span class="line">    <span class="attr">swiperList</span>: &lt;<span class="title class_">Array</span>&lt;<span class="title class_">ImageItem</span>&gt;&gt;[],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">observers</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;index,list&#x27;</span>: <span class="keyword">function</span> (<span class="params">index, list</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (list.<span class="property">length</span> &amp;&amp; list[index]) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_initSwiper</span>(index, list)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">// åˆ‡æ¢ swiper</span></span><br><span class="line">    <span class="title function_">handleChangeBigImage</span>(<span class="params">e: WechatMiniprogram.SwiperChange</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; current, source &#125; = e.<span class="property">detail</span></span><br><span class="line">      <span class="keyword">if</span> (source !== <span class="string">&quot;touch&quot;</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> state = <span class="variable language_">this</span>.<span class="title function_">_getSlideState</span>(current, <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">swiperIndex</span>)</span><br><span class="line">      <span class="keyword">const</span> previewIndex = state === <span class="string">&quot;Last&quot;</span> ? <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">previewIndex</span> - <span class="number">1</span> : <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">previewIndex</span> + <span class="number">1</span></span><br><span class="line">      <span class="keyword">const</span> currentItem = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">swiperList</span>[current]</span><br><span class="line"></span><br><span class="line">      <span class="comment">// åˆ°è¾¾äº†è¾¹ç•Œæ—¶ï¼Œåå¼¹å›å»</span></span><br><span class="line">      <span class="keyword">if</span> (currentItem.<span class="property">type</span> === <span class="string">&quot;placeholder&quot;</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">swiperIndex</span>: <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">swiperIndex</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">        previewIndex,</span><br><span class="line">        [<span class="string">`swiperList[<span class="subst">$&#123;<span class="variable language_">this</span>._updateUpdateIndex(current, state)&#125;</span>]`</span>]: <span class="variable language_">this</span>.<span class="title function_">_getUpdateSwiperItem</span>(previewIndex, state),</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">swiperIndex</span> = current</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– Swiper æ¨¡å¼</span></span><br><span class="line">    <span class="title function_">_initSwiper</span>(<span class="params">index: <span class="built_in">number</span>, list: <span class="built_in">Array</span>&lt;ImageItem&gt;, cb?: <span class="built_in">Function</span></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123; <span class="attr">duration</span>: <span class="number">0</span> &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> swiperIndex = <span class="number">1</span></span><br><span class="line">        <span class="keyword">let</span> <span class="attr">swiperList</span>: <span class="title class_">Array</span>&lt;<span class="title class_">ImageItem</span>&gt; = []</span><br><span class="line"></span><br><span class="line">        swiperList.<span class="title function_">push</span>(list[index - <span class="number">1</span>] || <span class="title class_">SwiperPlaceholder</span>)</span><br><span class="line">        swiperList.<span class="title function_">push</span>(list[index] || <span class="title class_">SwiperPlaceholder</span>)</span><br><span class="line">        swiperList.<span class="title function_">push</span>(list[index + <span class="number">1</span>] || <span class="title class_">SwiperPlaceholder</span>)</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setData</span>(&#123;</span><br><span class="line">          <span class="attr">previewIndex</span>: index,</span><br><span class="line">          swiperIndex,</span><br><span class="line">          swiperList,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">500</span>,</span><br><span class="line">          <span class="attr">isHide</span>: <span class="literal">false</span></span><br><span class="line">        &#125;, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (cb) <span class="title function_">cb</span>()</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// è·å–æ»šåŠ¨çŠ¶æ€</span></span><br><span class="line">    <span class="title function_">_getSlideState</span>(<span class="attr">current</span>: <span class="built_in">number</span>, <span class="attr">lastCurrent</span>: <span class="built_in">number</span>): <span class="title class_">State</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> state = current - lastCurrent</span><br><span class="line">      <span class="keyword">return</span> [-<span class="number">1</span>, <span class="variable constant_">LEN</span> - <span class="number">1</span>].<span class="title function_">includes</span>(state) ? <span class="string">&quot;Last&quot;</span> : <span class="string">&quot;Next&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// è·å–éœ€è¦æ›´æ–°ä¸‹æ ‡</span></span><br><span class="line">    <span class="title function_">_updateUpdateIndex</span>(<span class="params">current: <span class="built_in">number</span>, <span class="keyword">type</span>: State</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">type</span> === <span class="string">&quot;Next&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> current === (<span class="variable constant_">LEN</span> - <span class="number">1</span>) ? <span class="number">0</span> : current + <span class="number">1</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> current === <span class="number">0</span> ? (<span class="variable constant_">LEN</span> - <span class="number">1</span>) : current - <span class="number">1</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// è·å–éœ€è¦æ›´æ–°æ•°æ®</span></span><br><span class="line">    <span class="title function_">_getUpdateSwiperItem</span>(<span class="params">index: <span class="built_in">number</span>, <span class="keyword">type</span>: State</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">list</span></span><br><span class="line">      <span class="keyword">let</span> item</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">type</span> === <span class="string">&quot;Last&quot;</span>) &#123;</span><br><span class="line">        item = list[index - <span class="number">1</span>]</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        item = list[index + <span class="number">1</span>]</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// åˆ°è¾¾è¾¹ç•Œæ—¶ è¿”å›å¡«å……å…ƒç´ </span></span><br><span class="line">      <span class="keyword">if</span> (!item) &#123;</span><br><span class="line">        item = <span class="title class_">SwiperPlaceholder</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> item</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>è®°å½•ç±»</category>
      </categories>
  </entry>
</search>
